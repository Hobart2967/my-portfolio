var KT=Object.defineProperty,wM=Object.getOwnPropertySymbols,JT=Object.prototype.hasOwnProperty,eA=Object.prototype.propertyIsEnumerable,EM=(Nt,ut,se)=>ut in Nt?KT(Nt,ut,{enumerable:!0,configurable:!0,writable:!0,value:se}):Nt[ut]=se,MM=(Nt,ut)=>{for(var se in ut||(ut={}))JT.call(ut,se)&&EM(Nt,se,ut[se]);if(wM)for(var se of wM(ut))eA.call(ut,se)&&EM(Nt,se,ut[se]);return Nt};(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[736],{7844:(Nt,ut,se)=>{"use strict";se.d(ut,{Z:()=>bg});var G=se(7758);const $=new G.JOQ,We=new G.iMs,Ze=new G.FM8,Ae=new G.Pa4,Me=new G.Pa4,Te=new G.Pa4,Fe=new G.yGw;class Be extends G.pBf{constructor(d,g,v){super(),v.style.touchAction="none";let I=null,B=null;const X=[],Q=this;function de(){v.addEventListener("pointermove",xe),v.addEventListener("pointerdown",Oe),v.addEventListener("pointerup",Pe),v.addEventListener("pointerleave",Pe)}function ie(){v.removeEventListener("pointermove",xe),v.removeEventListener("pointerdown",Oe),v.removeEventListener("pointerup",Pe),v.removeEventListener("pointerleave",Pe),v.style.cursor=""}function xe($e){if(!1!==Q.enabled){if(Ye($e),We.setFromCamera(Ze,g),I)return We.ray.intersectPlane($,Me)&&I.position.copy(Me.sub(Ae).applyMatrix4(Fe)),void Q.dispatchEvent({type:"drag",object:I});if("mouse"===$e.pointerType||"pen"===$e.pointerType)if(X.length=0,We.setFromCamera(Ze,g),We.intersectObjects(d,!0,X),X.length>0){const Ce=X[0].object;$.setFromNormalAndCoplanarPoint(g.getWorldDirection($.normal),Te.setFromMatrixPosition(Ce.matrixWorld)),B!==Ce&&null!==B&&(Q.dispatchEvent({type:"hoveroff",object:B}),v.style.cursor="auto",B=null),B!==Ce&&(Q.dispatchEvent({type:"hoveron",object:Ce}),v.style.cursor="pointer",B=Ce)}else null!==B&&(Q.dispatchEvent({type:"hoveroff",object:B}),v.style.cursor="auto",B=null)}}function Oe($e){!1!==Q.enabled&&(Ye($e),X.length=0,We.setFromCamera(Ze,g),We.intersectObjects(d,!0,X),X.length>0&&(I=!0===Q.transformGroup?d[0]:X[0].object,$.setFromNormalAndCoplanarPoint(g.getWorldDirection($.normal),Te.setFromMatrixPosition(I.matrixWorld)),We.ray.intersectPlane($,Me)&&(Fe.copy(I.parent.matrixWorld).invert(),Ae.copy(Me).sub(Te.setFromMatrixPosition(I.matrixWorld))),v.style.cursor="move",Q.dispatchEvent({type:"dragstart",object:I})))}function Pe(){!1!==Q.enabled&&(I&&(Q.dispatchEvent({type:"dragend",object:I}),I=null),v.style.cursor=B?"pointer":"auto")}function Ye($e){const Ce=v.getBoundingClientRect();Ze.x=($e.clientX-Ce.left)/Ce.width*2-1,Ze.y=-($e.clientY-Ce.top)/Ce.height*2+1}de(),this.enabled=!0,this.transformGroup=!1,this.activate=de,this.deactivate=ie,this.dispose=function(){ie()},this.getObjects=function(){return d}}}var J=se(6995),K=se(6804);const Ve=4294967296;function kt(f){return f.x}function St(f){return f.y}function Wt(f){return f.z}var hn=Math.PI*(3-Math.sqrt(5)),an=20*Math.PI/(9+Math.sqrt(221));function er(f,d){d=d||2;var v,g=Math.min(3,Math.max(1,Math.round(d))),I=1,B=.001,X=1-Math.pow(B,1/300),Q=0,de=.6,ie=new Map,be=(0,K.HT)(Oe),fe=(0,J.Z)("tick","end"),xe=function(){let f=1;return()=>(f=(1664525*f+1013904223)%Ve)/Ve}();function Oe(){Pe(),fe.call("tick",v),I<B&&(be.stop(),fe.call("end",v))}function Pe(Ce){var Et,vt,ht=f.length;void 0===Ce&&(Ce=1);for(var et=0;et<Ce;++et)for(I+=(Q-I)*X,ie.forEach(function(qt){qt(I)}),Et=0;Et<ht;++Et)null==(vt=f[Et]).fx?vt.x+=vt.vx*=de:(vt.x=vt.fx,vt.vx=0),g>1&&(null==vt.fy?vt.y+=vt.vy*=de:(vt.y=vt.fy,vt.vy=0)),g>2&&(null==vt.fz?vt.z+=vt.vz*=de:(vt.z=vt.fz,vt.vz=0));return v}function Ye(){for(var ht,Ce=0,Et=f.length;Ce<Et;++Ce){if((ht=f[Ce]).index=Ce,null!=ht.fx&&(ht.x=ht.fx),null!=ht.fy&&(ht.y=ht.fy),null!=ht.fz&&(ht.z=ht.fz),isNaN(ht.x)||g>1&&isNaN(ht.y)||g>2&&isNaN(ht.z)){var vt=10*(g>2?Math.cbrt(.5+Ce):g>1?Math.sqrt(.5+Ce):Ce),et=Ce*hn,qt=Ce*an;1===g?ht.x=vt:2===g?(ht.x=vt*Math.cos(et),ht.y=vt*Math.sin(et)):(ht.x=vt*Math.sin(et)*Math.cos(qt),ht.y=vt*Math.cos(et),ht.z=vt*Math.sin(et)*Math.sin(qt))}(isNaN(ht.vx)||g>1&&isNaN(ht.vy)||g>2&&isNaN(ht.vz))&&(ht.vx=0,g>1&&(ht.vy=0),g>2&&(ht.vz=0))}}function $e(Ce){return Ce.initialize&&Ce.initialize(f,xe,g),Ce}return null==f&&(f=[]),Ye(),v={tick:Pe,restart:function(){return be.restart(Oe),v},stop:function(){return be.stop(),v},numDimensions:function(Ce){return arguments.length?(g=Math.min(3,Math.max(1,Math.round(Ce))),ie.forEach($e),v):g},nodes:function(Ce){return arguments.length?(f=Ce,Ye(),ie.forEach($e),v):f},alpha:function(Ce){return arguments.length?(I=+Ce,v):I},alphaMin:function(Ce){return arguments.length?(B=+Ce,v):B},alphaDecay:function(Ce){return arguments.length?(X=+Ce,v):+X},alphaTarget:function(Ce){return arguments.length?(Q=+Ce,v):Q},velocityDecay:function(Ce){return arguments.length?(de=1-Ce,v):1-de},randomSource:function(Ce){return arguments.length?(xe=Ce,ie.forEach($e),v):xe},force:function(Ce,Et){return arguments.length>1?(null==Et?ie.delete(Ce):ie.set(Ce,$e(Et)),v):ie.get(Ce)},find:function(){var Jt,yr,Gr,Ur,jr,Xi,Ce=Array.prototype.slice.call(arguments),Et=Ce.shift()||0,ht=(g>1?Ce.shift():null)||0,vt=(g>2?Ce.shift():null)||0,et=Ce.shift()||1/0,qt=0,yn=f.length;for(et*=et,qt=0;qt<yn;++qt)(Ur=(Jt=Et-(jr=f[qt]).x)*Jt+(yr=ht-(jr.y||0))*yr+(Gr=vt-(jr.z||0))*Gr)<et&&(Xi=jr,et=Ur);return Xi},on:function(Ce,Et){return arguments.length>1?(fe.on(Ce,Et),v):fe.on(Ce)}}}function Dn(f){return function(){return f}}function Cn(f){return 1e-6*(f()-.5)}function st(f){return f.index}function Bt(f,d){var g=f.get(d);if(!g)throw new Error("node not found: "+d);return g}function nn(f){var v,B,X,Q,de,ie,be,d=st,g=function(Ce){return 1/Math.min(de[Ce.source.index],de[Ce.target.index])},I=Dn(30),fe=1;function Oe(Ce){for(var Et=0,ht=f.length;Et<fe;++Et)for(var et,qt,yn,Ur,jr,vt=0,Jt=0,yr=0,Gr=0;vt<ht;++vt)Jt=(yn=(et=f[vt]).target).x+yn.vx-(qt=et.source).x-qt.vx||Cn(be),Q>1&&(yr=yn.y+yn.vy-qt.y-qt.vy||Cn(be)),Q>2&&(Gr=yn.z+yn.vz-qt.z-qt.vz||Cn(be)),yr*=Ur=((Ur=Math.sqrt(Jt*Jt+yr*yr+Gr*Gr))-B[vt])/Ur*Ce*v[vt],Gr*=Ur,yn.vx-=(Jt*=Ur)*(jr=ie[vt]),Q>1&&(yn.vy-=yr*jr),Q>2&&(yn.vz-=Gr*jr),qt.vx+=Jt*(jr=1-jr),Q>1&&(qt.vy+=yr*jr),Q>2&&(qt.vz+=Gr*jr)}function Pe(){if(X){var Ce,et,Et=X.length,ht=f.length,vt=new Map(X.map((qt,yn)=>[d(qt,yn,X),qt]));for(Ce=0,de=new Array(Et);Ce<ht;++Ce)(et=f[Ce]).index=Ce,"object"!=typeof et.source&&(et.source=Bt(vt,et.source)),"object"!=typeof et.target&&(et.target=Bt(vt,et.target)),de[et.source.index]=(de[et.source.index]||0)+1,de[et.target.index]=(de[et.target.index]||0)+1;for(Ce=0,ie=new Array(ht);Ce<ht;++Ce)ie[Ce]=de[(et=f[Ce]).source.index]/(de[et.source.index]+de[et.target.index]);v=new Array(ht),Ye(),B=new Array(ht),$e()}}function Ye(){if(X)for(var Ce=0,Et=f.length;Ce<Et;++Ce)v[Ce]=+g(f[Ce],Ce,f)}function $e(){if(X)for(var Ce=0,Et=f.length;Ce<Et;++Ce)B[Ce]=+I(f[Ce],Ce,f)}return null==f&&(f=[]),Oe.initialize=function(Ce,...Et){X=Ce,be=Et.find(ht=>"function"==typeof ht)||Math.random,Q=Et.find(ht=>[1,2,3].includes(ht))||2,Pe()},Oe.links=function(Ce){return arguments.length?(f=Ce,Pe(),Oe):f},Oe.id=function(Ce){return arguments.length?(d=Ce,Oe):d},Oe.iterations=function(Ce){return arguments.length?(fe=+Ce,Oe):fe},Oe.strength=function(Ce){return arguments.length?(g="function"==typeof Ce?Ce:Dn(+Ce),Ye(),Oe):g},Oe.distance=function(Ce){return arguments.length?(I="function"==typeof Ce?Ce:Dn(+Ce),$e(),Oe):I},Oe}function Rn(f,d,g){if(isNaN(d))return f;var v,de,ie,be,fe,xe,I=f._root,B={data:g},X=f._x0,Q=f._x1;if(!I)return f._root=B,f;for(;I.length;)if((be=d>=(de=(X+Q)/2))?X=de:Q=de,v=I,!(I=I[fe=+be]))return v[fe]=B,f;if(d===(ie=+f._x.call(null,I.data)))return B.next=I,v?v[fe]=B:f._root=B,f;do{v=v?v[fe]=new Array(2):f._root=new Array(2),(be=d>=(de=(X+Q)/2))?X=de:Q=de}while((fe=+be)==(xe=+(ie>=de)));return v[xe]=I,v[fe]=B,f}function vn(f,d,g){this.node=f,this.x0=d,this.x1=g}function Lt(f){return f[0]}function Pn(f,d){var g=new cn(null==d?Lt:d,NaN,NaN);return null==f?g:g.addAll(f)}function cn(f,d,g){this._x=f,this._x0=d,this._x1=g,this._root=void 0}function Qr(f){for(var d={data:f.data},g=d;f=f.next;)g=g.next={data:f.data};return d}var Br=Pn.prototype=cn.prototype;function pe(f,d,g,v){if(isNaN(d)||isNaN(g))return f;var I,fe,xe,Oe,Pe,Ye,$e,Ce,Et,B=f._root,X={data:v},Q=f._x0,de=f._y0,ie=f._x1,be=f._y1;if(!B)return f._root=X,f;for(;B.length;)if((Ye=d>=(fe=(Q+ie)/2))?Q=fe:ie=fe,($e=g>=(xe=(de+be)/2))?de=xe:be=xe,I=B,!(B=B[Ce=$e<<1|Ye]))return I[Ce]=X,f;if(Oe=+f._x.call(null,B.data),Pe=+f._y.call(null,B.data),d===Oe&&g===Pe)return X.next=B,I?I[Ce]=X:f._root=X,f;do{I=I?I[Ce]=new Array(4):f._root=new Array(4),(Ye=d>=(fe=(Q+ie)/2))?Q=fe:ie=fe,($e=g>=(xe=(de+be)/2))?de=xe:be=xe}while((Ce=$e<<1|Ye)==(Et=(Pe>=xe)<<1|Oe>=fe));return I[Et]=B,I[Ce]=X,f}function Ht(f,d,g,v,I){this.node=f,this.x0=d,this.y0=g,this.x1=v,this.y1=I}function ci(f){return f[0]}function Tn(f){return f[1]}function Pi(f,d,g){var v=new ii(null==d?ci:d,null==g?Tn:g,NaN,NaN,NaN,NaN);return null==f?v:v.addAll(f)}function ii(f,d,g,v,I,B){this._x=f,this._y=d,this._x0=g,this._y0=v,this._x1=I,this._y1=B,this._root=void 0}function rs(f){for(var d={data:f.data},g=d;f=f.next;)g=g.next={data:f.data};return d}Br.copy=function(){var g,v,f=new cn(this._x,this._x0,this._x1),d=this._root;if(!d)return f;if(!d.length)return f._root=Qr(d),f;for(g=[{source:d,target:f._root=new Array(2)}];d=g.pop();)for(var I=0;I<2;++I)(v=d.source[I])&&(v.length?g.push({source:v,target:d.target[I]=new Array(2)}):d.target[I]=Qr(v));return f},Br.add=function(f){var d=+this._x.call(null,f);return Rn(this.cover(d),d,f)},Br.addAll=function(f){var d,v,g=f.length,I=new Array(g),B=1/0,X=-1/0;for(d=0;d<g;++d)isNaN(v=+this._x.call(null,f[d]))||(I[d]=v,v<B&&(B=v),v>X&&(X=v));if(B>X)return this;for(this.cover(B).cover(X),d=0;d<g;++d)Rn(this,I[d],f[d]);return this},Br.cover=function(f){if(isNaN(f=+f))return this;var d=this._x0,g=this._x1;if(isNaN(d))g=(d=Math.floor(f))+1;else{for(var B,X,v=g-d||1,I=this._root;d>f||f>=g;)switch(X=+(f<d),B=new Array(2),B[X]=I,I=B,v*=2,X){case 0:g=d+v;break;case 1:d=g-v}this._root&&this._root.length&&(this._root=I)}return this._x0=d,this._x1=g,this},Br.data=function(){var f=[];return this.visit(function(d){if(!d.length)do{f.push(d.data)}while(d=d.next)}),f},Br.extent=function(f){return arguments.length?this.cover(+f[0][0]).cover(+f[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]},Br.find=function(f,d){var g,I,B,ie,be,v=this._x0,X=this._x1,Q=[],de=this._root;for(de&&Q.push(new vn(de,v,X)),null==d?d=1/0:(v=f-d,X=f+d);ie=Q.pop();)if(!(!(de=ie.node)||(I=ie.x0)>X||(B=ie.x1)<v))if(de.length){var fe=(I+B)/2;Q.push(new vn(de[1],fe,B),new vn(de[0],I,fe)),(be=+(f>=fe))&&(ie=Q[Q.length-1],Q[Q.length-1]=Q[Q.length-1-be],Q[Q.length-1-be]=ie)}else{var xe=Math.abs(f-+this._x.call(null,de.data));xe<d&&(d=xe,v=f-xe,X=f+xe,g=de.data)}return g},Br.remove=function(f){if(isNaN(de=+this._x.call(null,f)))return this;var d,v,I,B,de,ie,be,fe,xe,g=this._root,X=this._x0,Q=this._x1;if(!g)return this;if(g.length)for(;;){if((be=de>=(ie=(X+Q)/2))?X=ie:Q=ie,d=g,!(g=g[fe=+be]))return this;if(!g.length)break;d[fe+1&1]&&(v=d,xe=fe)}for(;g.data!==f;)if(I=g,!(g=g.next))return this;return(B=g.next)&&delete g.next,I?(B?I.next=B:delete I.next,this):d?(B?d[fe]=B:delete d[fe],(g=d[0]||d[1])&&g===(d[1]||d[0])&&!g.length&&(v?v[xe]=g:this._root=g),this):(this._root=B,this)},Br.removeAll=function(f){for(var d=0,g=f.length;d<g;++d)this.remove(f[d]);return this},Br.root=function(){return this._root},Br.size=function(){var f=0;return this.visit(function(d){if(!d.length)do{++f}while(d=d.next)}),f},Br.visit=function(f){var g,I,B,X,d=[],v=this._root;for(v&&d.push(new vn(v,this._x0,this._x1));g=d.pop();)if(!f(v=g.node,B=g.x0,X=g.x1)&&v.length){var Q=(B+X)/2;(I=v[1])&&d.push(new vn(I,Q,X)),(I=v[0])&&d.push(new vn(I,B,Q))}return this},Br.visitAfter=function(f){var v,d=[],g=[];for(this._root&&d.push(new vn(this._root,this._x0,this._x1));v=d.pop();){var I=v.node;if(I.length){var B,X=v.x0,Q=v.x1,de=(X+Q)/2;(B=I[0])&&d.push(new vn(B,X,de)),(B=I[1])&&d.push(new vn(B,de,Q))}g.push(v)}for(;v=g.pop();)f(v.node,v.x0,v.x1);return this},Br.x=function(f){return arguments.length?(this._x=f,this):this._x};var ti=Pi.prototype=ii.prototype;function zn(f,d,g,v,I){if(isNaN(d)||isNaN(g)||isNaN(v))return f;var B,Pe,Ye,$e,Ce,Et,ht,vt,et,qt,yn,Jt,X=f._root,Q={data:I},de=f._x0,ie=f._y0,be=f._z0,fe=f._x1,xe=f._y1,Oe=f._z1;if(!X)return f._root=Q,f;for(;X.length;)if((vt=d>=(Pe=(de+fe)/2))?de=Pe:fe=Pe,(et=g>=(Ye=(ie+xe)/2))?ie=Ye:xe=Ye,(qt=v>=($e=(be+Oe)/2))?be=$e:Oe=$e,B=X,!(X=X[yn=qt<<2|et<<1|vt]))return B[yn]=Q,f;if(Ce=+f._x.call(null,X.data),Et=+f._y.call(null,X.data),ht=+f._z.call(null,X.data),d===Ce&&g===Et&&v===ht)return Q.next=X,B?B[yn]=Q:f._root=Q,f;do{B=B?B[yn]=new Array(8):f._root=new Array(8),(vt=d>=(Pe=(de+fe)/2))?de=Pe:fe=Pe,(et=g>=(Ye=(ie+xe)/2))?ie=Ye:xe=Ye,(qt=v>=($e=(be+Oe)/2))?be=$e:Oe=$e}while((yn=qt<<2|et<<1|vt)==(Jt=(ht>=$e)<<2|(Et>=Ye)<<1|Ce>=Pe));return B[Jt]=X,B[yn]=Q,f}function Xn(f,d,g,v,I,B,X){this.node=f,this.x0=d,this.y0=g,this.z0=v,this.x1=I,this.y1=B,this.z1=X}function xr(f){return f[0]}function vs(f){return f[1]}function qa(f){return f[2]}function ds(f,d,g,v){var I=new ma(null==d?xr:d,null==g?vs:g,null==v?qa:v,NaN,NaN,NaN,NaN,NaN,NaN);return null==f?I:I.addAll(f)}function ma(f,d,g,v,I,B,X,Q,de){this._x=f,this._y=d,this._z=g,this._x0=v,this._y0=I,this._z0=B,this._x1=X,this._y1=Q,this._z1=de,this._root=void 0}function Ai(f){for(var d={data:f.data},g=d;f=f.next;)g=g.next={data:f.data};return d}ti.copy=function(){var g,v,f=new ii(this._x,this._y,this._x0,this._y0,this._x1,this._y1),d=this._root;if(!d)return f;if(!d.length)return f._root=rs(d),f;for(g=[{source:d,target:f._root=new Array(4)}];d=g.pop();)for(var I=0;I<4;++I)(v=d.source[I])&&(v.length?g.push({source:v,target:d.target[I]=new Array(4)}):d.target[I]=rs(v));return f},ti.add=function(f){const d=+this._x.call(null,f),g=+this._y.call(null,f);return pe(this.cover(d,g),d,g,f)},ti.addAll=function(f){var d,g,I,B,v=f.length,X=new Array(v),Q=new Array(v),de=1/0,ie=1/0,be=-1/0,fe=-1/0;for(g=0;g<v;++g)isNaN(I=+this._x.call(null,d=f[g]))||isNaN(B=+this._y.call(null,d))||(X[g]=I,Q[g]=B,I<de&&(de=I),I>be&&(be=I),B<ie&&(ie=B),B>fe&&(fe=B));if(de>be||ie>fe)return this;for(this.cover(de,ie).cover(be,fe),g=0;g<v;++g)pe(this,X[g],Q[g],f[g]);return this},ti.cover=function(f,d){if(isNaN(f=+f)||isNaN(d=+d))return this;var g=this._x0,v=this._y0,I=this._x1,B=this._y1;if(isNaN(g))I=(g=Math.floor(f))+1,B=(v=Math.floor(d))+1;else{for(var de,ie,X=I-g||1,Q=this._root;g>f||f>=I||v>d||d>=B;)switch(ie=(d<v)<<1|f<g,de=new Array(4),de[ie]=Q,Q=de,X*=2,ie){case 0:I=g+X,B=v+X;break;case 1:g=I-X,B=v+X;break;case 2:I=g+X,v=B-X;break;case 3:g=I-X,v=B-X}this._root&&this._root.length&&(this._root=Q)}return this._x0=g,this._y0=v,this._x1=I,this._y1=B,this},ti.data=function(){var f=[];return this.visit(function(d){if(!d.length)do{f.push(d.data)}while(d=d.next)}),f},ti.extent=function(f){return arguments.length?this.cover(+f[0][0],+f[0][1]).cover(+f[1][0],+f[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},ti.find=function(f,d,g){var v,X,Q,de,ie,Pe,Ye,I=this._x0,B=this._y0,be=this._x1,fe=this._y1,xe=[],Oe=this._root;for(Oe&&xe.push(new Ht(Oe,I,B,be,fe)),null==g?g=1/0:(I=f-g,B=d-g,be=f+g,fe=d+g,g*=g);Pe=xe.pop();)if(!(!(Oe=Pe.node)||(X=Pe.x0)>be||(Q=Pe.y0)>fe||(de=Pe.x1)<I||(ie=Pe.y1)<B))if(Oe.length){var $e=(X+de)/2,Ce=(Q+ie)/2;xe.push(new Ht(Oe[3],$e,Ce,de,ie),new Ht(Oe[2],X,Ce,$e,ie),new Ht(Oe[1],$e,Q,de,Ce),new Ht(Oe[0],X,Q,$e,Ce)),(Ye=(d>=Ce)<<1|f>=$e)&&(Pe=xe[xe.length-1],xe[xe.length-1]=xe[xe.length-1-Ye],xe[xe.length-1-Ye]=Pe)}else{var Et=f-+this._x.call(null,Oe.data),ht=d-+this._y.call(null,Oe.data),vt=Et*Et+ht*ht;if(vt<g){var et=Math.sqrt(g=vt);I=f-et,B=d-et,be=f+et,fe=d+et,v=Oe.data}}return v},ti.remove=function(f){if(isNaN(be=+this._x.call(null,f))||isNaN(fe=+this._y.call(null,f)))return this;var d,v,I,B,be,fe,xe,Oe,Pe,Ye,$e,Ce,g=this._root,X=this._x0,Q=this._y0,de=this._x1,ie=this._y1;if(!g)return this;if(g.length)for(;;){if((Pe=be>=(xe=(X+de)/2))?X=xe:de=xe,(Ye=fe>=(Oe=(Q+ie)/2))?Q=Oe:ie=Oe,d=g,!(g=g[$e=Ye<<1|Pe]))return this;if(!g.length)break;(d[$e+1&3]||d[$e+2&3]||d[$e+3&3])&&(v=d,Ce=$e)}for(;g.data!==f;)if(I=g,!(g=g.next))return this;return(B=g.next)&&delete g.next,I?(B?I.next=B:delete I.next,this):d?(B?d[$e]=B:delete d[$e],(g=d[0]||d[1]||d[2]||d[3])&&g===(d[3]||d[2]||d[1]||d[0])&&!g.length&&(v?v[Ce]=g:this._root=g),this):(this._root=B,this)},ti.removeAll=function(f){for(var d=0,g=f.length;d<g;++d)this.remove(f[d]);return this},ti.root=function(){return this._root},ti.size=function(){var f=0;return this.visit(function(d){if(!d.length)do{++f}while(d=d.next)}),f},ti.visit=function(f){var g,I,B,X,Q,de,d=[],v=this._root;for(v&&d.push(new Ht(v,this._x0,this._y0,this._x1,this._y1));g=d.pop();)if(!f(v=g.node,B=g.x0,X=g.y0,Q=g.x1,de=g.y1)&&v.length){var ie=(B+Q)/2,be=(X+de)/2;(I=v[3])&&d.push(new Ht(I,ie,be,Q,de)),(I=v[2])&&d.push(new Ht(I,B,be,ie,de)),(I=v[1])&&d.push(new Ht(I,ie,X,Q,be)),(I=v[0])&&d.push(new Ht(I,B,X,ie,be))}return this},ti.visitAfter=function(f){var v,d=[],g=[];for(this._root&&d.push(new Ht(this._root,this._x0,this._y0,this._x1,this._y1));v=d.pop();){var I=v.node;if(I.length){var B,X=v.x0,Q=v.y0,de=v.x1,ie=v.y1,be=(X+de)/2,fe=(Q+ie)/2;(B=I[0])&&d.push(new Ht(B,X,Q,be,fe)),(B=I[1])&&d.push(new Ht(B,be,Q,de,fe)),(B=I[2])&&d.push(new Ht(B,X,fe,be,ie)),(B=I[3])&&d.push(new Ht(B,be,fe,de,ie))}g.push(v)}for(;v=g.pop();)f(v.node,v.x0,v.y0,v.x1,v.y1);return this},ti.x=function(f){return arguments.length?(this._x=f,this):this._x},ti.y=function(f){return arguments.length?(this._y=f,this):this._y};var Di=ds.prototype=ma.prototype;function so(){var f,d,g,v,I,X,B=Dn(-30),Q=1,de=1/0,ie=.81;function be(Pe){var Ye,$e=f.length,Ce=(1===d?Pn(f,kt):2===d?Pi(f,kt,St):3===d?ds(f,kt,St,Wt):null).visitAfter(xe);for(I=Pe,Ye=0;Ye<$e;++Ye)g=f[Ye],Ce.visit(Oe)}function fe(){if(f){var Pe,$e,Ye=f.length;for(X=new Array(Ye),Pe=0;Pe<Ye;++Pe)X[($e=f[Pe]).index]=+B($e,Pe,f)}}function xe(Pe){var $e,Ce,ht,vt,et,qt,Ye=0,Et=0,yn=Pe.length;if(yn){for(ht=vt=et=qt=0;qt<yn;++qt)($e=Pe[qt])&&(Ce=Math.abs($e.value))&&(Ye+=$e.value,Et+=Ce,ht+=Ce*($e.x||0),vt+=Ce*($e.y||0),et+=Ce*($e.z||0));Ye*=Math.sqrt(4/yn),Pe.x=ht/Et,d>1&&(Pe.y=vt/Et),d>2&&(Pe.z=et/Et)}else{($e=Pe).x=$e.data.x,d>1&&($e.y=$e.data.y),d>2&&($e.z=$e.data.z);do{Ye+=X[$e.data.index]}while($e=$e.next)}Pe.value=Ye}function Oe(Pe,Ye,$e,Ce,Et){if(!Pe.value)return!0;var vt=Pe.x-g.x,et=d>1?Pe.y-g.y:0,qt=d>2?Pe.z-g.z:0,yn=[$e,Ce,Et][d-1]-Ye,Jt=vt*vt+et*et+qt*qt;if(yn*yn/ie<Jt)return Jt<de&&(0===vt&&(Jt+=(vt=Cn(v))*vt),d>1&&0===et&&(Jt+=(et=Cn(v))*et),d>2&&0===qt&&(Jt+=(qt=Cn(v))*qt),Jt<Q&&(Jt=Math.sqrt(Q*Jt)),g.vx+=vt*Pe.value*I/Jt,d>1&&(g.vy+=et*Pe.value*I/Jt),d>2&&(g.vz+=qt*Pe.value*I/Jt)),!0;if(!(Pe.length||Jt>=de)){(Pe.data!==g||Pe.next)&&(0===vt&&(Jt+=(vt=Cn(v))*vt),d>1&&0===et&&(Jt+=(et=Cn(v))*et),d>2&&0===qt&&(Jt+=(qt=Cn(v))*qt),Jt<Q&&(Jt=Math.sqrt(Q*Jt)));do{Pe.data!==g&&(g.vx+=vt*(yn=X[Pe.data.index]*I/Jt),d>1&&(g.vy+=et*yn),d>2&&(g.vz+=qt*yn))}while(Pe=Pe.next)}}return be.initialize=function(Pe,...Ye){f=Pe,v=Ye.find($e=>"function"==typeof $e)||Math.random,d=Ye.find($e=>[1,2,3].includes($e))||2,fe()},be.strength=function(Pe){return arguments.length?(B="function"==typeof Pe?Pe:Dn(+Pe),fe(),be):B},be.distanceMin=function(Pe){return arguments.length?(Q=Pe*Pe,be):Math.sqrt(Q)},be.distanceMax=function(Pe){return arguments.length?(de=Pe*Pe,be):Math.sqrt(de)},be.theta=function(Pe){return arguments.length?(ie=Pe*Pe,be):Math.sqrt(ie)},be}function oo(f,d,g){var v,I=1;function B(){var X,de,Q=v.length,ie=0,be=0,fe=0;for(X=0;X<Q;++X)ie+=(de=v[X]).x||0,be+=de.y||0,fe+=de.z||0;for(ie=(ie/Q-f)*I,be=(be/Q-d)*I,fe=(fe/Q-g)*I,X=0;X<Q;++X)de=v[X],ie&&(de.x-=ie),be&&(de.y-=be),fe&&(de.z-=fe)}return null==f&&(f=0),null==d&&(d=0),null==g&&(g=0),B.initialize=function(X){v=X},B.x=function(X){return arguments.length?(f=+X,B):f},B.y=function(X){return arguments.length?(d=+X,B):d},B.z=function(X){return arguments.length?(g=+X,B):g},B.strength=function(X){return arguments.length?(I=+X,B):I},B}Di.copy=function(){var g,v,f=new ma(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),d=this._root;if(!d)return f;if(!d.length)return f._root=Ai(d),f;for(g=[{source:d,target:f._root=new Array(8)}];d=g.pop();)for(var I=0;I<8;++I)(v=d.source[I])&&(v.length?g.push({source:v,target:d.target[I]=new Array(8)}):d.target[I]=Ai(v));return f},Di.add=function(f){var d=+this._x.call(null,f),g=+this._y.call(null,f),v=+this._z.call(null,f);return zn(this.cover(d,g,v),d,g,v,f)},Di.addAll=function(f){var d,g,I,B,X,v=f.length,Q=new Array(v),de=new Array(v),ie=new Array(v),be=1/0,fe=1/0,xe=1/0,Oe=-1/0,Pe=-1/0,Ye=-1/0;for(g=0;g<v;++g)isNaN(I=+this._x.call(null,d=f[g]))||isNaN(B=+this._y.call(null,d))||isNaN(X=+this._z.call(null,d))||(Q[g]=I,de[g]=B,ie[g]=X,I<be&&(be=I),I>Oe&&(Oe=I),B<fe&&(fe=B),B>Pe&&(Pe=B),X<xe&&(xe=X),X>Ye&&(Ye=X));if(be>Oe||fe>Pe||xe>Ye)return this;for(this.cover(be,fe,xe).cover(Oe,Pe,Ye),g=0;g<v;++g)zn(this,Q[g],de[g],ie[g],f[g]);return this},Di.cover=function(f,d,g){if(isNaN(f=+f)||isNaN(d=+d)||isNaN(g=+g))return this;var v=this._x0,I=this._y0,B=this._z0,X=this._x1,Q=this._y1,de=this._z1;if(isNaN(v))X=(v=Math.floor(f))+1,Q=(I=Math.floor(d))+1,de=(B=Math.floor(g))+1;else{for(var fe,xe,ie=X-v||1,be=this._root;v>f||f>=X||I>d||d>=Q||B>g||g>=de;)switch(xe=(g<B)<<2|(d<I)<<1|f<v,fe=new Array(8),fe[xe]=be,be=fe,ie*=2,xe){case 0:X=v+ie,Q=I+ie,de=B+ie;break;case 1:v=X-ie,Q=I+ie,de=B+ie;break;case 2:X=v+ie,I=Q-ie,de=B+ie;break;case 3:v=X-ie,I=Q-ie,de=B+ie;break;case 4:X=v+ie,Q=I+ie,B=de-ie;break;case 5:v=X-ie,Q=I+ie,B=de-ie;break;case 6:X=v+ie,I=Q-ie,B=de-ie;break;case 7:v=X-ie,I=Q-ie,B=de-ie}this._root&&this._root.length&&(this._root=be)}return this._x0=v,this._y0=I,this._z0=B,this._x1=X,this._y1=Q,this._z1=de,this},Di.data=function(){var f=[];return this.visit(function(d){if(!d.length)do{f.push(d.data)}while(d=d.next)}),f},Di.extent=function(f){return arguments.length?this.cover(+f[0][0],+f[0][1],+f[0][2]).cover(+f[1][0],+f[1][1],+f[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},Di.find=function(f,d,g,v){var I,de,ie,be,fe,xe,Oe,ht,vt,B=this._x0,X=this._y0,Q=this._z0,Pe=this._x1,Ye=this._y1,$e=this._z1,Ce=[],Et=this._root;for(Et&&Ce.push(new Xn(Et,B,X,Q,Pe,Ye,$e)),null==v?v=1/0:(B=f-v,X=d-v,Q=g-v,Pe=f+v,Ye=d+v,$e=g+v,v*=v);ht=Ce.pop();)if(!(!(Et=ht.node)||(de=ht.x0)>Pe||(ie=ht.y0)>Ye||(be=ht.z0)>$e||(fe=ht.x1)<B||(xe=ht.y1)<X||(Oe=ht.z1)<Q))if(Et.length){var et=(de+fe)/2,qt=(ie+xe)/2,yn=(be+Oe)/2;Ce.push(new Xn(Et[7],et,qt,yn,fe,xe,Oe),new Xn(Et[6],de,qt,yn,et,xe,Oe),new Xn(Et[5],et,ie,yn,fe,qt,Oe),new Xn(Et[4],de,ie,yn,et,qt,Oe),new Xn(Et[3],et,qt,be,fe,xe,yn),new Xn(Et[2],de,qt,be,et,xe,yn),new Xn(Et[1],et,ie,be,fe,qt,yn),new Xn(Et[0],de,ie,be,et,qt,yn)),(vt=(g>=yn)<<2|(d>=qt)<<1|f>=et)&&(ht=Ce[Ce.length-1],Ce[Ce.length-1]=Ce[Ce.length-1-vt],Ce[Ce.length-1-vt]=ht)}else{var Jt=f-+this._x.call(null,Et.data),yr=d-+this._y.call(null,Et.data),Gr=g-+this._z.call(null,Et.data),Ur=Jt*Jt+yr*yr+Gr*Gr;if(Ur<v){var jr=Math.sqrt(v=Ur);B=f-jr,X=d-jr,Q=g-jr,Pe=f+jr,Ye=d+jr,$e=g+jr,I=Et.data}}return I},Di.remove=function(f){if(isNaN(xe=+this._x.call(null,f))||isNaN(Oe=+this._y.call(null,f))||isNaN(Pe=+this._z.call(null,f)))return this;var d,v,I,B,xe,Oe,Pe,Ye,$e,Ce,Et,ht,vt,et,qt,g=this._root,X=this._x0,Q=this._y0,de=this._z0,ie=this._x1,be=this._y1,fe=this._z1;if(!g)return this;if(g.length)for(;;){if((Et=xe>=(Ye=(X+ie)/2))?X=Ye:ie=Ye,(ht=Oe>=($e=(Q+be)/2))?Q=$e:be=$e,(vt=Pe>=(Ce=(de+fe)/2))?de=Ce:fe=Ce,d=g,!(g=g[et=vt<<2|ht<<1|Et]))return this;if(!g.length)break;(d[et+1&7]||d[et+2&7]||d[et+3&7]||d[et+4&7]||d[et+5&7]||d[et+6&7]||d[et+7&7])&&(v=d,qt=et)}for(;g.data!==f;)if(I=g,!(g=g.next))return this;return(B=g.next)&&delete g.next,I?(B?I.next=B:delete I.next,this):d?(B?d[et]=B:delete d[et],(g=d[0]||d[1]||d[2]||d[3]||d[4]||d[5]||d[6]||d[7])&&g===(d[7]||d[6]||d[5]||d[4]||d[3]||d[2]||d[1]||d[0])&&!g.length&&(v?v[qt]=g:this._root=g),this):(this._root=B,this)},Di.removeAll=function(f){for(var d=0,g=f.length;d<g;++d)this.remove(f[d]);return this},Di.root=function(){return this._root},Di.size=function(){var f=0;return this.visit(function(d){if(!d.length)do{++f}while(d=d.next)}),f},Di.visit=function(f){var g,I,B,X,Q,de,ie,be,d=[],v=this._root;for(v&&d.push(new Xn(v,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));g=d.pop();)if(!f(v=g.node,B=g.x0,X=g.y0,Q=g.z0,de=g.x1,ie=g.y1,be=g.z1)&&v.length){var fe=(B+de)/2,xe=(X+ie)/2,Oe=(Q+be)/2;(I=v[7])&&d.push(new Xn(I,fe,xe,Oe,de,ie,be)),(I=v[6])&&d.push(new Xn(I,B,xe,Oe,fe,ie,be)),(I=v[5])&&d.push(new Xn(I,fe,X,Oe,de,xe,be)),(I=v[4])&&d.push(new Xn(I,B,X,Oe,fe,xe,be)),(I=v[3])&&d.push(new Xn(I,fe,xe,Q,de,ie,Oe)),(I=v[2])&&d.push(new Xn(I,B,xe,Q,fe,ie,Oe)),(I=v[1])&&d.push(new Xn(I,fe,X,Q,de,xe,Oe)),(I=v[0])&&d.push(new Xn(I,B,X,Q,fe,xe,Oe))}return this},Di.visitAfter=function(f){var v,d=[],g=[];for(this._root&&d.push(new Xn(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));v=d.pop();){var I=v.node;if(I.length){var B,X=v.x0,Q=v.y0,de=v.z0,ie=v.x1,be=v.y1,fe=v.z1,xe=(X+ie)/2,Oe=(Q+be)/2,Pe=(de+fe)/2;(B=I[0])&&d.push(new Xn(B,X,Q,de,xe,Oe,Pe)),(B=I[1])&&d.push(new Xn(B,xe,Q,de,ie,Oe,Pe)),(B=I[2])&&d.push(new Xn(B,X,Oe,de,xe,be,Pe)),(B=I[3])&&d.push(new Xn(B,xe,Oe,de,ie,be,Pe)),(B=I[4])&&d.push(new Xn(B,X,Q,Pe,xe,Oe,fe)),(B=I[5])&&d.push(new Xn(B,xe,Q,Pe,ie,Oe,fe)),(B=I[6])&&d.push(new Xn(B,X,Oe,Pe,xe,be,fe)),(B=I[7])&&d.push(new Xn(B,xe,Oe,Pe,ie,be,fe))}g.push(v)}for(;v=g.pop();)f(v.node,v.x0,v.y0,v.z0,v.x1,v.y1,v.z1);return this},Di.x=function(f){return arguments.length?(this._x=f,this):this._x},Di.y=function(f){return arguments.length?(this._y=f,this):this._y},Di.z=function(f){return arguments.length?(this._z=f,this):this._z};var $i=se(5401),Vs=se.n($i),is=se(5038),vo=se.n(is),To=se(4553),_s=se.n(To);function wi(f,d){return function(f){if(Array.isArray(f))return f}(f)||function(f,d){var g=f&&("undefined"!=typeof Symbol&&f[Symbol.iterator]||f["@@iterator"]);if(null!=g){var X,Q,v=[],I=!0,B=!1;try{for(g=g.call(f);!(I=(X=g.next()).done)&&(v.push(X.value),!d||v.length!==d);I=!0);}catch(de){B=!0,Q=de}finally{try{!I&&null!=g.return&&g.return()}finally{if(B)throw Q}}return v}}(f,d)||function(f,d){if(f){if("string"==typeof f)return He(f,d);var g=Object.prototype.toString.call(f).slice(8,-1);if("Object"===g&&f.constructor&&(g=f.constructor.name),"Map"===g||"Set"===g)return Array.from(f);if("Arguments"===g||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return He(f,d)}}(f,d)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function He(f,d){(null==d||d>f.length)&&(d=f.length);for(var g=0,v=new Array(d);g<d;g++)v[g]=f[g];return v}var ae=function f(d,g){var v=g.default,I=void 0===v?null:v,B=g.triggerUpdate,X=void 0===B||B,Q=g.onChange,de=void 0===Q?function(ie,be){}:Q;(function(f,d){if(!(f instanceof d))throw new TypeError("Cannot call a class as a function")})(this,f),this.name=d,this.defaultVal=I,this.triggerUpdate=X,this.onChange=de};const gt=function(f){var d=f.stateInit,g=void 0===d?function(){return{}}:d,v=f.props,I=void 0===v?{}:v,B=f.methods,X=void 0===B?{}:B,Q=f.aliases,de=void 0===Q?{}:Q,ie=f.init,be=void 0===ie?function(){}:ie,fe=f.update,xe=void 0===fe?function(){}:fe,Oe=Object.keys(I).map(function(Pe){return new ae(Pe,I[Pe])});return function(){var Pe=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},Ye=Object.assign({},g instanceof Function?g(Pe):g,{initialised:!1}),$e={};function Ce(vt){return Et(vt,Pe),ht(),Ce}var Et=function(et,qt){be.call(Ce,et,Ye,qt),Ye.initialised=!0},ht=_s()(function(){!Ye.initialised||(xe.call(Ce,Ye,$e),$e={})},1);return Oe.forEach(function(vt){var qt,yn,Jt,yr,Gr,Ur,jr,Xi;Ce[vt.name]=(yn=(qt=vt).name,yr=void 0!==(Jt=qt.triggerUpdate)&&Jt,Ur=void 0===(Gr=qt.onChange)?function($o,to){}:Gr,Xi=void 0===(jr=qt.defaultVal)?null:jr,function($o){var to=Ye[yn];if(!arguments.length)return to;var cl=void 0===$o?Xi:$o;return Ye[yn]=cl,Ur.call(Ce,cl,Ye,to),!$e.hasOwnProperty(yn)&&($e[yn]=to),yr&&ht(),Ce})}),Object.keys(X).forEach(function(vt){Ce[vt]=function(){for(var et,qt=arguments.length,yn=new Array(qt),Jt=0;Jt<qt;Jt++)yn[Jt]=arguments[Jt];return(et=X[vt]).call.apply(et,[Ce,Ye].concat(yn))}}),Object.entries(de).forEach(function(vt){var et=wi(vt,2);return Ce[et[0]]=Ce[et[1]]}),Ce.resetProps=function(){return Oe.forEach(function(vt){Ce[vt.name](vt.defaultVal)}),Ce},Ce.resetProps(),Ye._rerender=ht,Ce}},mn=function(f){return f instanceof Function?f:"string"==typeof f?function(d){return d[f]}:function(d){return f}};function In(f,d){let g;if(void 0===d)for(const v of f)null!=v&&(g>v||void 0===g&&v>=v)&&(g=v);else{let v=-1;for(let I of f)null!=(I=d(I,++v,f))&&(g>I||void 0===g&&I>=I)&&(g=I)}return g}function Ui(f,d){let g;if(void 0===d)for(const v of f)null!=v&&(g<v||void 0===g&&v>=v)&&(g=v);else{let v=-1;for(let I of f)null!=(I=d(I,++v,f))&&(g<I||void 0===g&&I>=I)&&(g=I)}return g}function Ko(f,d){if(null==f)return{};var v,I,g=function(f,d){if(null==f)return{};var I,B,g={},v=Object.keys(f);for(B=0;B<v.length;B++)!(d.indexOf(I=v[B])>=0)&&(g[I]=f[I]);return g}(f,d);if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(f);for(I=0;I<B.length;I++)!(d.indexOf(v=B[I])>=0)&&(!Object.prototype.propertyIsEnumerable.call(f,v)||(g[v]=f[v]))}return g}function Ds(f,d){return function(f){if(Array.isArray(f))return f}(f)||function(f,d){var g=f&&("undefined"!=typeof Symbol&&f[Symbol.iterator]||f["@@iterator"]);if(null!=g){var X,Q,v=[],I=!0,B=!1;try{for(g=g.call(f);!(I=(X=g.next()).done)&&(v.push(X.value),!d||v.length!==d);I=!0);}catch(de){B=!0,Q=de}finally{try{!I&&null!=g.return&&g.return()}finally{if(B)throw Q}}return v}}(f,d)||Hl(f,d)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ss(f){return function(f){if(Array.isArray(f))return Gl(f)}(f)||function(f){if("undefined"!=typeof Symbol&&null!=f[Symbol.iterator]||null!=f["@@iterator"])return Array.from(f)}(f)||Hl(f)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hl(f,d){if(f){if("string"==typeof f)return Gl(f,d);var g=Object.prototype.toString.call(f).slice(8,-1);if("Object"===g&&f.constructor&&(g=f.constructor.name),"Map"===g||"Set"===g)return Array.from(f);if("Arguments"===g||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return Gl(f,d)}}function Gl(f,d){(null==d||d>f.length)&&(d=f.length);for(var g=0,v=new Array(d);g<d;g++)v[g]=f[g];return v}function ea(f){var d=function(f,d){if("object"!=typeof f||null===f)return f;var g=f[Symbol.toPrimitive];if(void 0!==g){var v=g.call(f,d);if("object"!=typeof v)return v;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(f)}(f,"string");return"symbol"==typeof d?d:String(d)}const hi=function(){var f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],g=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],v=arguments.length>3&&void 0!==arguments[3]&&arguments[3],I=(d instanceof Array?d.length?d:[void 0]:[d]).map(function(Q){return{keyAccessor:Q,isProp:!(Q instanceof Function)}}),B=f.reduce(function(Q,de){var ie=Q,be=de;return I.forEach(function(fe,xe){var Ye,Oe=fe.keyAccessor;if(fe.isProp){var Ce=be[Oe],Et=Ko(be,[Oe].map(ea));Ye=Ce,be=Et}else Ye=Oe(be,xe);xe+1<I.length?(ie.hasOwnProperty(Ye)||(ie[Ye]={}),ie=ie[Ye]):g?(ie.hasOwnProperty(Ye)||(ie[Ye]=[]),ie[Ye].push(be)):ie[Ye]=be}),Q},{});g instanceof Function&&function Q(de){var ie=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;ie===I.length?Object.keys(de).forEach(function(be){return de[be]=g(de[be])}):Object.values(de).forEach(function(be){return Q(be,ie+1)})}(B);var X=B;return v&&(X=[],function Q(de){var ie=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];ie.length===I.length?X.push({keys:ie,vals:de}):Object.entries(de).forEach(function(be){var fe=Ds(be,2),xe=fe[0];return Q(fe[1],[].concat(ss(ie),[xe]))})}(B),d instanceof Array&&0===d.length&&1===X.length&&(X[0].keys=[])),X};function pc(f,d){var g=Object.keys(f);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(f);d&&(v=v.filter(function(I){return Object.getOwnPropertyDescriptor(f,I).enumerable})),g.push.apply(g,v)}return g}function Ks(f,d,g){return d in f?Object.defineProperty(f,d,{value:g,enumerable:!0,configurable:!0,writable:!0}):f[d]=g,f}function va(f,d){return function(f){if(Array.isArray(f))return f}(f)||function(f,d){var g=f&&("undefined"!=typeof Symbol&&f[Symbol.iterator]||f["@@iterator"]);if(null!=g){var X,Q,v=[],I=!0,B=!1;try{for(g=g.call(f);!(I=(X=g.next()).done)&&(v.push(X.value),!d||v.length!==d);I=!0);}catch(de){B=!0,Q=de}finally{try{!I&&null!=g.return&&g.return()}finally{if(B)throw Q}}return v}}(f,d)||_o(f,d)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vi(f){return function(f){if(Array.isArray(f))return Do(f)}(f)||function(f){if("undefined"!=typeof Symbol&&null!=f[Symbol.iterator]||null!=f["@@iterator"])return Array.from(f)}(f)||_o(f)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _o(f,d){if(f){if("string"==typeof f)return Do(f,d);var g=Object.prototype.toString.call(f).slice(8,-1);if("Object"===g&&f.constructor&&(g=f.constructor.name),"Map"===g||"Set"===g)return Array.from(f);if("Arguments"===g||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return Do(f,d)}}function Do(f,d){(null==d||d>f.length)&&(d=f.length);for(var g=0,v=new Array(d);g<d;g++)v[g]=f[g];return v}const xl=function(f,d,g,v,I){var B=I.createObj,X=void 0===B?function(Jt){return{}}:B,Q=I.updateObj,de=void 0===Q?function(Jt,yr){}:Q,ie=I.exitObj,be=void 0===ie?function(Jt){}:ie,fe=I.objBindAttr,xe=void 0===fe?"__obj":fe,Oe=I.dataBindAttr,Pe=void 0===Oe?"__data":Oe,Ye=function(f,d){if(null==f)return{};var v,I,g=function(f,d){if(null==f)return{};var I,B,g={},v=Object.keys(f);for(B=0;B<v.length;B++)!(d.indexOf(I=v[B])>=0)&&(g[I]=f[I]);return g}(f,d);if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(f);for(I=0;I<B.length;I++)!(d.indexOf(v=B[I])>=0)&&(!Object.prototype.propertyIsEnumerable.call(f,v)||(g[v]=f[v]))}return g}(I,["createObj","updateObj","exitObj","objBindAttr","dataBindAttr"]),$e=function(f,d,g){var v=g.objBindAttr,I=void 0===v?"__obj":v,B=g.dataBindAttr,X=void 0===B?"__data":B,Q=g.idAccessor,de=g.purge,ie=void 0!==de&&de,be=function($e){return $e.hasOwnProperty(X)},fe=d.filter(function(Ye){return!be(Ye)}),xe=d.filter(be).map(function(Ye){return Ye[X]}),Pe=ie?{enter:f,exit:xe,update:[]}:function(f,d,g){var v={enter:[],update:[],exit:[]};if(g){var X=hi(f,g,!1),Q=hi(d,g,!1),de=Object.assign({},X,Q);Object.entries(de).forEach(function(ie){var be=va(ie,2),fe=be[0],xe=be[1],Oe=X.hasOwnProperty(fe)?Q.hasOwnProperty(fe)?"update":"exit":"enter";v[Oe].push("update"===Oe?[X[fe],Q[fe]]:xe)})}else{var I=new Set(f),B=new Set(d);new Set([].concat(Vi(I),Vi(B))).forEach(function(ie){var be=I.has(ie)?B.has(ie)?"update":"exit":"enter";v[be].push("update"===be?[ie,ie]:ie)})}return v}(xe,f,Q);return Pe.update=Pe.update.map(function(Ye){var $e=va(Ye,2),Ce=$e[0],Et=$e[1];return Ce!==Et&&(Et[I]=Ce[I],Et[I][X]=Et),Et}),Pe.exit=Pe.exit.concat(fe.map(function(Ye){return Ks({},I,Ye)})),Pe}(f,d,function(f){for(var d=1;d<arguments.length;d++){var g=null!=arguments[d]?arguments[d]:{};d%2?pc(Object(g),!0).forEach(function(v){Ks(f,v,g[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(g)):pc(Object(g)).forEach(function(v){Object.defineProperty(f,v,Object.getOwnPropertyDescriptor(g,v))})}return f}({objBindAttr:xe,dataBindAttr:Pe},Ye)),Ce=$e.enter,Et=$e.update;$e.exit.forEach(function(Jt){var yr=Jt[xe];delete Jt[xe],be(yr),v(yr)});var yr,vt=(yr=[],Ce.forEach(function(Gr){var Ur=X(Gr);Ur&&(Ur[Pe]=Gr,Gr[xe]=Ur,yr.push(Ur))}),yr);[].concat(Vi(Ce),Vi(Et)).forEach(function(yr){var Gr=yr[xe];Gr&&(Gr[Pe]=yr,de(Gr,yr))}),vt.forEach(g)};var $l=se(1753);const wl=(0,se(2357).Z)("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");var _u=se(4902),Rs=se.n(_u);function Za(f,d){var g=Object.keys(f);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(f);d&&(v=v.filter(function(I){return Object.getOwnPropertyDescriptor(f,I).enumerable})),g.push.apply(g,v)}return g}function Ra(f){for(var d=1;d<arguments.length;d++){var g=null!=arguments[d]?arguments[d]:{};d%2?Za(Object(g),!0).forEach(function(v){Ia(f,v,g[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(g)):Za(Object(g)).forEach(function(v){Object.defineProperty(f,v,Object.getOwnPropertyDescriptor(g,v))})}return f}function Js(f){return(Js="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(d){return typeof d}:function(d){return d&&"function"==typeof Symbol&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d})(f)}function Io(f,d){if(!(f instanceof d))throw new TypeError("Cannot call a class as a function")}function Ia(f,d,g){return d in f?Object.defineProperty(f,d,{value:g,enumerable:!0,configurable:!0,writable:!0}):f[d]=g,f}function El(f,d){if("function"!=typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(d&&d.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),d&&ba(f,d)}function uo(f){return(uo=Object.setPrototypeOf?Object.getPrototypeOf:function(g){return g.__proto__||Object.getPrototypeOf(g)})(f)}function ba(f,d){return(ba=Object.setPrototypeOf||function(v,I){return v.__proto__=I,v})(f,d)}function hs(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}function bo(f,d,g){return(bo=hs()?Reflect.construct:function(I,B,X){var Q=[null];Q.push.apply(Q,B);var ie=new(Function.bind.apply(I,Q));return X&&ba(ie,X.prototype),ie}).apply(null,arguments)}function yc(f,d){if(null==f)return{};var v,I,g=function(f,d){if(null==f)return{};var I,B,g={},v=Object.keys(f);for(B=0;B<v.length;B++)!(d.indexOf(I=v[B])>=0)&&(g[I]=f[I]);return g}(f,d);if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(f);for(I=0;I<B.length;I++)!(d.indexOf(v=B[I])>=0)&&(!Object.prototype.propertyIsEnumerable.call(f,v)||(g[v]=f[v]))}return g}function ra(f){if(void 0===f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}function Qa(f,d){return!d||"object"!=typeof d&&"function"!=typeof d?ra(f):d}function Qu(f){var d=hs();return function(){var I,v=uo(f);if(d){var B=uo(this).constructor;I=Reflect.construct(v,arguments,B)}else I=v.apply(this,arguments);return Qa(this,I)}}function Is(f,d){return function(f){if(Array.isArray(f))return f}(f)||function(f,d){var g=null==f?null:"undefined"!=typeof Symbol&&f[Symbol.iterator]||f["@@iterator"];if(null!=g){var X,Q,v=[],I=!0,B=!1;try{for(g=g.call(f);!(I=(X=g.next()).done)&&(v.push(X.value),!d||v.length!==d);I=!0);}catch(de){B=!0,Q=de}finally{try{!I&&null!=g.return&&g.return()}finally{if(B)throw Q}}return v}}(f,d)||mt(f,d)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(f){return function(f){if(Array.isArray(f))return Vt(f)}(f)||function(f){if("undefined"!=typeof Symbol&&null!=f[Symbol.iterator]||null!=f["@@iterator"])return Array.from(f)}(f)||mt(f)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(f,d){if(f){if("string"==typeof f)return Vt(f,d);var g=Object.prototype.toString.call(f).slice(8,-1);if("Object"===g&&f.constructor&&(g=f.constructor.name),"Map"===g||"Set"===g)return Array.from(f);if("Arguments"===g||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return Vt(f,d)}}function Vt(f,d){(null==d||d>f.length)&&(d=f.length);for(var g=0,v=new Array(d);g<d;g++)v[g]=f[g];return v}var Li=function f(d){d instanceof Array?d.forEach(f):(d.map&&d.map.dispose(),d.dispose())},Jr=function f(d){d.geometry&&d.geometry.dispose(),d.material&&Li(d.material),d.texture&&d.texture.dispose(),d.children&&d.children.forEach(f)},Ar=function(d){for(;d.children.length;){var g=d.children[0];d.remove(g),Jr(g)}},Sr=["objFilter"];function Mi(f,d){var g=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},v=g.objFilter,I=void 0===v?function(){return!0}:v,B=yc(g,Sr);return xl(f,d.children.filter(I),function(X){return d.add(X)},function(X){d.remove(X),Ar(X)},Ra({objBindAttr:"__threeObj"},B))}var os=function(d){return isNaN(d)?parseInt(Rs()(d).toHex(),16):d},Ps=function(d){return isNaN(d)?Rs()(d).getAlpha():1},Gi=(0,$l.Z)(wl);function Ka(f,d,g){!d||"string"!=typeof g||f.filter(function(v){return!v[g]}).forEach(function(v){v[g]=Gi(d(v))})}var Qn=window.THREE?window.THREE:{Group:G.ZAu,Mesh:G.Kj0,MeshLambertMaterial:G.YBo,Color:G.Ilk,BufferGeometry:G.u9r,BufferAttribute:G.TlE,Matrix4:G.yGw,Vector3:G.Pa4,SphereBufferGeometry:G.Aip,CylinderBufferGeometry:G.m_w,TubeBufferGeometry:G.Lcc,ConeBufferGeometry:G._3,Line:G.x12,LineBasicMaterial:G.nls,QuadraticBezierCurve3:G.mXe,CubicBezierCurve3:G.yj7,Box3:G.ZzF},Cs={graph:Vs(),forcelayout:vo()},qi=(new Qn.BufferGeometry).setAttribute?"setAttribute":"addAttribute",Ki=(new Qn.BufferGeometry).applyMatrix4?"applyMatrix4":"applyMatrix";const Ts=function(f){var d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object,g=arguments.length>2&&void 0!==arguments[2]&&arguments[2],v=function(I){El(X,I);var B=Qu(X);function X(){var Q;Io(this,X);for(var de=arguments.length,ie=new Array(de),be=0;be<de;be++)ie[be]=arguments[be];return(Q=B.call.apply(B,[this].concat(ie))).__kapsuleInstance=f().apply(void 0,[].concat(U(g?[ra(Q)]:[]),ie)),Q}return X}(d);return Object.keys(f()).forEach(function(I){return v.prototype[I]=function(){var B,X=(B=this.__kapsuleInstance)[I].apply(B,arguments);return X===this.__kapsuleInstance?this:X}}),v}(gt({props:{jsonUrl:{onChange:function(d,g){var v=this;d&&!g.fetchingJson&&(g.fetchingJson=!0,g.onLoading(),fetch(d).then(function(I){return I.json()}).then(function(I){g.fetchingJson=!1,g.onFinishLoading(I),v.graphData(I)}))},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(d,g){g.engineRunning=!1}},numDimensions:{default:3,onChange:function(d,g){var v=g.d3ForceLayout.force("charge");function I(B,X){B.forEach(function(Q){delete Q[X],delete Q["v".concat(X)]})}v&&v.strength(d>2?-60:-30),d<3&&I(g.graphData.nodes,"z"),d<2&&I(g.graphData.nodes,"y")}},dagMode:{onChange:function(d,g){!d&&"d3"===g.forceEngine&&(g.graphData.nodes||[]).forEach(function(v){return v.fx=v.fy=v.fz=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(d){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4},nodeId:{default:"id"},nodeVal:{default:"val"},nodeResolution:{default:8},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeVisibility:{default:!0},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{},linkResolution:{default:6},linkCurvature:{default:0,triggerUpdate:!1},linkCurveRotation:{default:0,triggerUpdate:!1},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{triggerUpdate:!1},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(d,g){g.d3ForceLayout.alphaDecay(d)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(d,g){g.d3ForceLayout.alphaTarget(d)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(d,g){g.d3ForceLayout.velocityDecay(d)}},ngraphPhysics:{default:{timeStep:20,gravity:-1.2,theta:.8,springLength:30,springCoefficient:8e-4,dragCoefficient:.02}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onLoading:{default:function(){},triggerUpdate:!1},onFinishLoading:{default:function(){},triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1}},methods:{refresh:function(d){return d._flushObjects=!0,d._rerender(),this},d3Force:function(d,g,v){return void 0===v?d.d3ForceLayout.force(g):(d.d3ForceLayout.force(g,v),this)},d3ReheatSimulation:function(d){return d.d3ForceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(d){return d.cntTicks=0,d.startTickTime=new Date,d.engineRunning=!0,this},tickFrame:function(d){var X,Q,de,g="ngraph"!==d.forceEngine;return d.engineRunning&&function(){++d.cntTicks>d.cooldownTicks||new Date-d.startTickTime>d.cooldownTime||g&&d.d3AlphaMin>0&&d.d3ForceLayout.alpha()<d.d3AlphaMin?(d.engineRunning=!1,d.onEngineStop()):(d.layout[g?"tick":"step"](),d.onEngineTick()),d.graphData.nodes.forEach(function(fe){var xe=fe.__threeObj;if(xe){var Oe=g?fe:d.layout.getNodePosition(fe[d.nodeId]);xe.position.x=Oe.x,xe.position.y=Oe.y||0,xe.position.z=Oe.z||0}});var X=mn(d.linkWidth),Q=mn(d.linkCurvature),de=mn(d.linkCurveRotation),ie=mn(d.linkThreeObjectExtend);d.graphData.links.forEach(function(fe){var xe=fe.__lineObj;if(xe){var Oe=g?fe:d.layout.getLinkPosition(d.layout.graph.getLink(fe.source,fe.target).id),Pe=Oe[g?"source":"from"],Ye=Oe[g?"target":"to"];if(Pe&&Ye&&Pe.hasOwnProperty("x")&&Ye.hasOwnProperty("x")){!function(fe){var xe=g?fe:d.layout.getLinkPosition(d.layout.graph.getLink(fe.source,fe.target).id),Oe=xe[g?"source":"from"],Pe=xe[g?"target":"to"];if(Oe&&Pe&&Oe.hasOwnProperty("x")&&Pe.hasOwnProperty("x")){var Ye=Q(fe);if(Ye){var ht,$e=new Qn.Vector3(Oe.x,Oe.y||0,Oe.z||0),Ce=new Qn.Vector3(Pe.x,Pe.y||0,Pe.z||0),Et=$e.distanceTo(Ce),vt=de(fe);if(Et>0){var et=Pe.x-Oe.x,qt=Pe.y-Oe.y||0,yn=(new Qn.Vector3).subVectors(Ce,$e),Jt=yn.clone().multiplyScalar(Ye).cross(0!==et||0!==qt?new Qn.Vector3(0,0,1):new Qn.Vector3(0,1,0)).applyAxisAngle(yn.normalize(),vt).add((new Qn.Vector3).addVectors($e,Ce).divideScalar(2));ht=new Qn.QuadraticBezierCurve3($e,Jt,Ce)}else{var yr=70*Ye,Gr=-vt,Ur=Gr+Math.PI/2;ht=new Qn.CubicBezierCurve3($e,new Qn.Vector3(yr*Math.cos(Ur),yr*Math.sin(Ur),0).add($e),new Qn.Vector3(yr*Math.cos(Gr),yr*Math.sin(Gr),0).add($e),Ce)}fe.__curve=ht}else fe.__curve=null}}(fe);var $e=ie(fe);if(!d.linkPositionUpdate||!d.linkPositionUpdate($e?xe.children[1]:xe,{start:{x:Pe.x,y:Pe.y,z:Pe.z},end:{x:Ye.x,y:Ye.y,z:Ye.z}},fe)||$e){var Et=fe.__curve,ht=xe.children.length?xe.children[0]:xe;if("Line"===ht.type){if(Et)ht.geometry.setFromPoints(Et.getPoints(30));else{var vt=ht.geometry.getAttribute("position");(!vt||!vt.array||6!==vt.array.length)&&ht.geometry[qi]("position",vt=new Qn.BufferAttribute(new Float32Array(6),3)),vt.array[0]=Pe.x,vt.array[1]=Pe.y||0,vt.array[2]=Pe.z||0,vt.array[3]=Ye.x,vt.array[4]=Ye.y||0,vt.array[5]=Ye.z||0,vt.needsUpdate=!0}ht.geometry.computeBoundingSphere()}else if("Mesh"===ht.type)if(Et){ht.geometry.type.match(/^Tube(Buffer)?Geometry$/)||(ht.position.set(0,0,0),ht.rotation.set(0,0,0),ht.scale.set(1,1,1));var Ur=Math.ceil(10*X(fe))/10,Xi=new Qn.TubeBufferGeometry(Et,30,Ur/2,d.linkResolution,!1);ht.geometry.dispose(),ht.geometry=Xi}else{if(!ht.geometry.type.match(/^Cylinder(Buffer)?Geometry$/)){var qt=Math.ceil(10*X(fe))/10/2,yn=new Qn.CylinderBufferGeometry(qt,qt,1,d.linkResolution,1,!1);yn[Ki]((new Qn.Matrix4).makeTranslation(0,.5,0)),yn[Ki]((new Qn.Matrix4).makeRotationX(Math.PI/2)),ht.geometry.dispose(),ht.geometry=yn}var Jt=new Qn.Vector3(Pe.x,Pe.y||0,Pe.z||0),yr=new Qn.Vector3(Ye.x,Ye.y||0,Ye.z||0),Gr=Jt.distanceTo(yr);ht.position.x=Jt.x,ht.position.y=Jt.y,ht.position.z=Jt.z,ht.scale.z=Gr,ht.parent.localToWorld(yr),ht.lookAt(yr)}}}}})}(),X=mn(d.linkDirectionalArrowRelPos),Q=mn(d.linkDirectionalArrowLength),de=mn(d.nodeVal),d.graphData.links.forEach(function(ie){var be=ie.__arrowObj;if(be){var fe=g?ie:d.layout.getLinkPosition(d.layout.graph.getLink(ie.source,ie.target).id),xe=fe[g?"source":"from"],Oe=fe[g?"target":"to"];if(xe&&Oe&&xe.hasOwnProperty("x")&&Oe.hasOwnProperty("x")){var Pe=Math.sqrt(Math.max(0,de(xe)||1))*d.nodeRelSize,Ye=Math.sqrt(Math.max(0,de(Oe)||1))*d.nodeRelSize,$e=Q(ie),Ce=X(ie),Et=ie.__curve?function(Jt){return ie.__curve.getPoint(Jt)}:function(Jt){var yr=function(Ur,jr,Xi,$o){return jr[Ur]+(Xi[Ur]-jr[Ur])*$o||0};return{x:yr("x",xe,Oe,Jt),y:yr("y",xe,Oe,Jt),z:yr("z",xe,Oe,Jt)}},ht=ie.__curve?ie.__curve.getLength():Math.sqrt(["x","y","z"].map(function(Jt){return Math.pow((Oe[Jt]||0)-(xe[Jt]||0),2)}).reduce(function(Jt,yr){return Jt+yr},0)),vt=Pe+$e+(ht-Pe-Ye-$e)*Ce,et=Et(vt/ht),qt=Et((vt-$e)/ht);["x","y","z"].forEach(function(Jt){return be.position[Jt]=qt[Jt]});var yn=bo(Qn.Vector3,U(["x","y","z"].map(function(Jt){return et[Jt]})));be.parent.localToWorld(yn),be.lookAt(yn)}}}),function(){var X=mn(d.linkDirectionalParticleSpeed);d.graphData.links.forEach(function(Q){var de=Q.__photonsObj&&Q.__photonsObj.children,ie=Q.__singleHopPhotonsObj&&Q.__singleHopPhotonsObj.children;if(ie&&ie.length||de&&de.length){var be=g?Q:d.layout.getLinkPosition(d.layout.graph.getLink(Q.source,Q.target).id),fe=be[g?"source":"from"],xe=be[g?"target":"to"];if(fe&&xe&&fe.hasOwnProperty("x")&&xe.hasOwnProperty("x")){var Oe=X(Q),Pe=Q.__curve?function($e){return Q.__curve.getPoint($e)}:function($e){var Ce=function(ht,vt,et,qt){return vt[ht]+(et[ht]-vt[ht])*qt||0};return{x:Ce("x",fe,xe,$e),y:Ce("y",fe,xe,$e),z:Ce("z",fe,xe,$e)}};[].concat(U(de||[]),U(ie||[])).forEach(function($e,Ce){var Et="singleHopPhotons"===$e.parent.__linkThreeObjType;if($e.hasOwnProperty("__progressRatio")||($e.__progressRatio=Et?0:Ce/de.length),$e.__progressRatio+=Oe,$e.__progressRatio>=1){if(Et)return $e.parent.remove($e),void Ar($e);$e.__progressRatio=$e.__progressRatio%1}var vt=Pe($e.__progressRatio);["x","y","z"].forEach(function(et){return $e.position[et]=vt[et]})})}}})}(),this},emitParticle:function(d,g){if(g){if(!g.__singleHopPhotonsObj){var v=new Qn.Group;v.__linkThreeObjType="singleHopPhotons",g.__singleHopPhotonsObj=v,d.graphScene.add(v)}var I=mn(d.linkDirectionalParticleWidth),B=Math.ceil(10*I(g))/10/2,X=d.linkDirectionalParticleResolution,Q=new Qn.SphereBufferGeometry(B,X,X),de=mn(d.linkColor),be=mn(d.linkDirectionalParticleColor)(g)||de(g)||"#f0f0f0",fe=new Qn.Color(os(be)),Oe=new Qn.MeshLambertMaterial({color:fe,transparent:!0,opacity:3*d.linkOpacity});g.__singleHopPhotonsObj.add(new Qn.Mesh(Q,Oe))}return this},getGraphBbox:function(d){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};if(!d.initialised)return null;var v=function I(B){var X=[];if(B.geometry){B.geometry.computeBoundingBox();var Q=new Qn.Box3;Q.copy(B.geometry.boundingBox).applyMatrix4(B.matrixWorld),X.push(Q)}return X.concat.apply(X,U((B.children||[]).filter(function(de){return!de.hasOwnProperty("__graphObjType")||"node"===de.__graphObjType&&g(de.__data)}).map(I)))}(d.graphScene);return v.length?Object.assign.apply(Object,U(["x","y","z"].map(function(I){return Ia({},I,[In(v,function(B){return B.min[I]}),Ui(v,function(B){return B.max[I]})])}))):null}},stateInit:function(){return{d3ForceLayout:er().force("link",nn()).force("charge",so()).force("center",oo()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(d,g){g.graphScene=d},update:function(d,g){var v=function($n){return $n.some(function(Or){return g.hasOwnProperty(Or)})};if(d.engineRunning=!1,d.onUpdate(),null!==d.nodeAutoColorBy&&v(["nodeAutoColorBy","graphData","nodeColor"])&&Ka(d.graphData.nodes,mn(d.nodeAutoColorBy),d.nodeColor),null!==d.linkAutoColorBy&&v(["linkAutoColorBy","graphData","linkColor"])&&Ka(d.graphData.links,mn(d.linkAutoColorBy),d.linkColor),d._flushObjects||v(["graphData","nodeThreeObject","nodeThreeObjectExtend","nodeVal","nodeColor","nodeVisibility","nodeRelSize","nodeResolution","nodeOpacity"])){var I=mn(d.nodeThreeObject),B=mn(d.nodeThreeObjectExtend),X=mn(d.nodeVal),Q=mn(d.nodeColor),de=mn(d.nodeVisibility),ie={},be={};Mi(d.graphData.nodes.filter(de),d.graphScene,{purge:d._flushObjects||v(["nodeThreeObject","nodeThreeObjectExtend"]),objFilter:function($n){return"node"===$n.__graphObjType},createObj:function($n){var gn,Or=I($n),pt=B($n);return Or&&d.nodeThreeObject===Or&&(Or=Or.clone()),Or&&!pt?gn=Or:((gn=new Qn.Mesh).__graphDefaultObj=!0,Or&&pt&&gn.add(Or)),gn.__graphObjType="node",gn},updateObj:function($n,Or){if($n.__graphDefaultObj){var pt=X(Or)||1,gn=Math.cbrt(pt)*d.nodeRelSize,Sn=d.nodeResolution;(!$n.geometry.type.match(/^Sphere(Buffer)?Geometry$/)||$n.geometry.parameters.radius!==gn||$n.geometry.parameters.widthSegments!==Sn)&&(ie.hasOwnProperty(pt)||(ie[pt]=new Qn.SphereBufferGeometry(gn,Sn,Sn)),$n.geometry.dispose(),$n.geometry=ie[pt]);var Ft=Q(Or),Nr=new Qn.Color(os(Ft||"#ffffaa")),zi=d.nodeOpacity*Ps(Ft);("MeshLambertMaterial"!==$n.material.type||!$n.material.color.equals(Nr)||$n.material.opacity!==zi)&&(be.hasOwnProperty(Ft)||(be[Ft]=new Qn.MeshLambertMaterial({color:Nr,transparent:!0,opacity:zi})),$n.material.dispose(),$n.material=be[Ft])}}})}if(d._flushObjects||v(["graphData","linkThreeObject","linkThreeObjectExtend","linkMaterial","linkColor","linkWidth","linkVisibility","linkResolution","linkOpacity","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution"])){var fe=mn(d.linkThreeObject),xe=mn(d.linkThreeObjectExtend),Oe=mn(d.linkMaterial),Pe=mn(d.linkVisibility),Ye=mn(d.linkColor),$e=mn(d.linkWidth),Ce={},Et={},ht={},vt=d.graphData.links.filter(Pe);if(Mi(vt,d.graphScene,{objBindAttr:"__lineObj",purge:d._flushObjects||v(["linkThreeObject","linkThreeObjectExtend","linkWidth"]),objFilter:function($n){return"link"===$n.__graphObjType},createObj:function($n){var gn,Nr,Or=fe($n),pt=xe($n);if(Or&&d.linkThreeObject===Or&&(Or=Or.clone()),!Or||pt)if($e($n))gn=new Qn.Mesh;else{var Ft=new Qn.BufferGeometry;Ft[qi]("position",new Qn.BufferAttribute(new Float32Array(6),3)),gn=new Qn.Line(Ft)}return Or?pt?((Nr=new Qn.Group).__graphDefaultObj=!0,Nr.add(gn),Nr.add(Or)):Nr=Or:(Nr=gn).__graphDefaultObj=!0,Nr.renderOrder=10,Nr.__graphObjType="link",Nr},updateObj:function($n,Or){if($n.__graphDefaultObj){var pt=$n.children.length?$n.children[0]:$n,gn=Math.ceil(10*$e(Or))/10,Sn=!!gn;if(Sn){var Ft=gn/2,Nr=d.linkResolution;if(!pt.geometry.type.match(/^Cylinder(Buffer)?Geometry$/)||pt.geometry.parameters.radiusTop!==Ft||pt.geometry.parameters.radialSegments!==Nr){if(!Ce.hasOwnProperty(gn)){var zi=new Qn.CylinderBufferGeometry(Ft,Ft,1,Nr,1,!1);zi[Ki]((new Qn.Matrix4).makeTranslation(0,.5,0)),zi[Ki]((new Qn.Matrix4).makeRotationX(Math.PI/2)),Ce[gn]=zi}pt.geometry.dispose(),pt.geometry=Ce[gn]}}var ho=Oe(Or);if(ho)pt.material=ho;else{var ca=Ye(Or),Dc=new Qn.Color(os(ca||"#f0f0f0")),Ua=d.linkOpacity*Ps(ca),Va=Sn?"MeshLambertMaterial":"LineBasicMaterial";if(pt.material.type!==Va||!pt.material.color.equals(Dc)||pt.material.opacity!==Ua){var Ns=Sn?Et:ht;Ns.hasOwnProperty(ca)||(Ns[ca]=new Qn[Va]({color:Dc,transparent:Ua<1,opacity:Ua,depthWrite:Ua>=1})),pt.material.dispose(),pt.material=Ns[ca]}}}}}),d.linkDirectionalArrowLength||g.hasOwnProperty("linkDirectionalArrowLength")){var et=mn(d.linkDirectionalArrowLength),qt=mn(d.linkDirectionalArrowColor);Mi(vt.filter(et),d.graphScene,{objBindAttr:"__arrowObj",objFilter:function($n){return"arrow"===$n.__linkThreeObjType},createObj:function(){var $n=new Qn.Mesh(void 0,new Qn.MeshLambertMaterial({transparent:!0}));return $n.__linkThreeObjType="arrow",$n},updateObj:function($n,Or){var pt=et(Or),gn=d.linkDirectionalArrowResolution;if(!$n.geometry.type.match(/^Cone(Buffer)?Geometry$/)||$n.geometry.parameters.height!==pt||$n.geometry.parameters.radialSegments!==gn){var Sn=new Qn.ConeBufferGeometry(.25*pt,pt,gn);Sn.translate(0,pt/2,0),Sn.rotateX(Math.PI/2),$n.geometry.dispose(),$n.geometry=Sn}$n.material.color=new Qn.Color(qt(Or)||Ye(Or)||"#f0f0f0"),$n.material.opacity=3*d.linkOpacity}})}if(d.linkDirectionalParticles||g.hasOwnProperty("linkDirectionalParticles")){var yn=mn(d.linkDirectionalParticles),Jt=mn(d.linkDirectionalParticleWidth),yr=mn(d.linkDirectionalParticleColor),Gr={},Ur={};Mi(vt.filter(yn),d.graphScene,{objBindAttr:"__photonsObj",objFilter:function($n){return"photons"===$n.__linkThreeObjType},createObj:function(){var $n=new Qn.Group;return $n.__linkThreeObjType="photons",$n},updateObj:function($n,Or){var Nr,pt=Math.round(Math.abs(yn(Or))),gn=!!$n.children.length&&$n.children[0],Sn=Math.ceil(10*Jt(Or))/10/2,Ft=d.linkDirectionalParticleResolution;gn&&gn.geometry.parameters.radius===Sn&&gn.geometry.parameters.widthSegments===Ft?Nr=gn.geometry:(Ur.hasOwnProperty(Sn)||(Ur[Sn]=new Qn.SphereBufferGeometry(Sn,Ft,Ft)),Nr=Ur[Sn],gn&&gn.geometry.dispose());var Dc,zi=yr(Or)||Ye(Or)||"#f0f0f0",ho=new Qn.Color(os(zi)),ca=3*d.linkOpacity;gn&&gn.material.color.equals(ho)&&gn.material.opacity===ca?Dc=gn.material:(Gr.hasOwnProperty(zi)||(Gr[zi]=new Qn.MeshLambertMaterial({color:ho,transparent:!0,opacity:ca})),Dc=Gr[zi],gn&&gn.material.dispose()),Mi(U(new Array(pt)).map(function(Ua,Va){return{idx:Va}}),$n,{idAccessor:function(Va){return Va.idx},createObj:function(){return new Qn.Mesh(Nr,Dc)},updateObj:function(Va){Va.geometry=Nr,Va.material=Dc}})}})}}if(d._flushObjects=!1,v(["graphData","nodeId","linkSource","linkTarget","numDimensions","forceEngine","dagMode","dagNodeFilter","dagLevelDistance"])){d.engineRunning=!1,d.graphData.links.forEach(function(Lr){Lr.source=Lr[d.linkSource],Lr.target=Lr[d.linkTarget]});var Xi,jr="ngraph"!==d.forceEngine;if(jr){(Xi=d.d3ForceLayout).stop().alpha(1).numDimensions(d.numDimensions).nodes(d.graphData.nodes);var $o=d.d3ForceLayout.force("link");$o&&$o.id(function(Lr){return Lr[d.nodeId]}).links(d.graphData.links);var to=d.dagMode&&function(f,d){var v=f.links,I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},B=I.nodeFilter,X=void 0===B?function(){return!0}:B,Q=I.onLoopError,de=void 0===Q?function(Oe){throw"Invalid DAG structure! Found cycle in node path: ".concat(Oe.join(" -> "),".")}:Q,ie={};f.nodes.forEach(function(Oe){return ie[d(Oe)]={data:Oe,out:[],depth:-1,skip:!X(Oe)}}),v.forEach(function(Oe){var Ye=Oe.target,$e=vt(Oe.source),Ce=vt(Ye);if(!ie.hasOwnProperty($e))throw"Missing source node with id: ".concat($e);if(!ie.hasOwnProperty(Ce))throw"Missing target node with id: ".concat(Ce);function vt(et){return"object"===Js(et)?d(et):et}ie[$e].out.push(ie[Ce])});var be=[];return xe(Object.values(ie)),Object.assign.apply(Object,[{}].concat(U(Object.entries(ie).filter(function(Oe){return!Is(Oe,2)[1].skip}).map(function(Oe){var Pe=Is(Oe,2);return Ia({},Pe[0],Pe[1].depth)}))));function xe(Oe){for(var Pe=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],Ye=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,$e=0,Ce=Oe.length;$e<Ce;$e++){var Et=Oe[$e];-1!==Pe.indexOf(Et)&&"continue"===function(){var vt=[].concat(U(Pe.slice(Pe.indexOf(Et))),[Et]).map(function(et){return d(et.data)});return be.some(function(et){return et.length===vt.length&&et.every(function(qt,yn){return qt===vt[yn]})})||(be.push(vt),de(vt)),"continue"}()||Ye>Et.depth&&(Et.depth=Ye,xe(Et.out,[].concat(U(Pe),[Et]),Ye+(Et.skip?0:1)))}}}(d.graphData,function(Lr){return Lr[d.nodeId]},{nodeFilter:d.dagNodeFilter,onLoopError:d.onDagError||void 0}),cl=Math.max.apply(Math,U(Object.values(to||[]))),Ou=d.dagLevelDistance||d.graphData.nodes.length/(cl||1)*2*(-1!==["radialin","radialout"].indexOf(d.dagMode)?.7:1);if(d.dagMode){var tc=function($n,Or){return function(pt){return $n?(to[pt[d.nodeId]]-cl/2)*Ou*(Or?-1:1):void 0}},pd=tc(-1!==["lr","rl"].indexOf(d.dagMode),"rl"===d.dagMode),gd=tc(-1!==["td","bu"].indexOf(d.dagMode),"td"===d.dagMode),Ac=tc(-1!==["zin","zout"].indexOf(d.dagMode),"zout"===d.dagMode);d.graphData.nodes.filter(d.dagNodeFilter).forEach(function(Lr){Lr.fx=pd(Lr),Lr.fy=gd(Lr),Lr.fz=Ac(Lr)})}d.d3ForceLayout.force("dagRadial",-1!==["radialin","radialout"].indexOf(d.dagMode)?function(f,d,g,v){var I,B,Q,de,X=Dn(.1);function ie(fe){for(var xe=0,Oe=I.length;xe<Oe;++xe){var Pe=I[xe],Ye=Pe.x-d||1e-6,$e=(Pe.y||0)-g||1e-6,Ce=(Pe.z||0)-v||1e-6,Et=Math.sqrt(Ye*Ye+$e*$e+Ce*Ce),ht=(de[xe]-Et)*Q[xe]*fe/Et;Pe.vx+=Ye*ht,B>1&&(Pe.vy+=$e*ht),B>2&&(Pe.vz+=Ce*ht)}}function be(){if(I){var fe,xe=I.length;for(Q=new Array(xe),de=new Array(xe),fe=0;fe<xe;++fe)de[fe]=+f(I[fe],fe,I),Q[fe]=isNaN(de[fe])?0:+X(I[fe],fe,I)}}return"function"!=typeof f&&(f=Dn(+f)),null==d&&(d=0),null==g&&(g=0),null==v&&(v=0),ie.initialize=function(fe,...xe){I=fe,B=xe.find(Oe=>[1,2,3].includes(Oe))||2,be()},ie.strength=function(fe){return arguments.length?(X="function"==typeof fe?fe:Dn(+fe),be(),ie):X},ie.radius=function(fe){return arguments.length?(f="function"==typeof fe?fe:Dn(+fe),be(),ie):f},ie.x=function(fe){return arguments.length?(d=+fe,ie):d},ie.y=function(fe){return arguments.length?(g=+fe,ie):g},ie.z=function(fe){return arguments.length?(v=+fe,ie):v},ie}(function(Lr){var $n=to[Lr[d.nodeId]]||-1;return("radialin"===d.dagMode?cl-$n:$n)*Ou}).strength(function(Lr){return d.dagNodeFilter(Lr)?1:0}):null)}else{var Os=Cs.graph();d.graphData.nodes.forEach(function(Lr){Os.addNode(Lr[d.nodeId])}),d.graphData.links.forEach(function(Lr){Os.addLink(Lr.source,Lr.target)}),(Xi=Cs.forcelayout(Os,Ra({dimensions:d.numDimensions},d.ngraphPhysics))).graph=Os}for(var Kc=0;Kc<d.warmupTicks&&!(jr&&d.d3AlphaMin>0&&d.d3ForceLayout.alpha()<d.d3AlphaMin);Kc++)Xi[jr?"tick":"step"]();d.layout=Xi,this.resetCountdown()}d.engineRunning=!0,d.onFinishUpdate()}}),(window.THREE?window.THREE:{Group:G.ZAu}).Group,!0),ql={type:"change"},Vc={type:"start"},Ml={type:"end"};class Ja extends G.pBf{constructor(d,g){super(),void 0===g&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),g===document&&console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');const v=this;this.object=d,this.domElement=g,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:G.RsA.ROTATE,MIDDLE:G.RsA.DOLLY,RIGHT:G.RsA.PAN},this.target=new G.Pa4;const B=1e-6,X=new G.Pa4;let Q=1,de=-1,ie=-1,be=0,fe=0,xe=0;const Oe=new G.Pa4,Pe=new G.FM8,Ye=new G.FM8,$e=new G.Pa4,Ce=new G.FM8,Et=new G.FM8,ht=new G.FM8,vt=new G.FM8,et=[],qt={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const pt=v.domElement.getBoundingClientRect(),gn=v.domElement.ownerDocument.documentElement;v.screen.left=pt.left+window.pageXOffset-gn.clientLeft,v.screen.top=pt.top+window.pageYOffset-gn.clientTop,v.screen.width=pt.width,v.screen.height=pt.height};const yn=function(){const pt=new G.FM8;return function(Sn,Ft){return pt.set((Sn-v.screen.left)/v.screen.width,(Ft-v.screen.top)/v.screen.height),pt}}(),Jt=function(){const pt=new G.FM8;return function(Sn,Ft){return pt.set((Sn-.5*v.screen.width-v.screen.left)/(.5*v.screen.width),(v.screen.height+2*(v.screen.top-Ft))/v.screen.width),pt}}();function yr(pt){!1!==v.enabled&&(0===et.length&&(v.domElement.setPointerCapture(pt.pointerId),v.domElement.addEventListener("pointermove",Gr),v.domElement.addEventListener("pointerup",Ur)),function(pt){et.push(pt)}(pt),"touch"===pt.pointerType?function(pt){switch($n(pt),et.length){case 1:de=3,Ye.copy(Jt(et[0].pageX,et[0].pageY)),Pe.copy(Ye);break;default:de=4;const gn=et[0].pageX-et[1].pageX,Sn=et[0].pageY-et[1].pageY;fe=be=Math.sqrt(gn*gn+Sn*Sn),ht.copy(yn((et[0].pageX+et[1].pageX)/2,(et[0].pageY+et[1].pageY)/2)),vt.copy(ht)}v.dispatchEvent(Vc)}(pt):function(pt){if(-1===de)switch(pt.button){case v.mouseButtons.LEFT:de=0;break;case v.mouseButtons.MIDDLE:de=1;break;case v.mouseButtons.RIGHT:de=2;break;default:de=-1}const gn=-1!==ie?ie:de;0!==gn||v.noRotate?1!==gn||v.noZoom?2===gn&&!v.noPan&&(ht.copy(yn(pt.pageX,pt.pageY)),vt.copy(ht)):(Ce.copy(yn(pt.pageX,pt.pageY)),Et.copy(Ce)):(Ye.copy(Jt(pt.pageX,pt.pageY)),Pe.copy(Ye)),v.dispatchEvent(Vc)}(pt))}function Gr(pt){!1!==v.enabled&&("touch"===pt.pointerType?function(pt){switch($n(pt),et.length){case 1:Pe.copy(Ye),Ye.copy(Jt(pt.pageX,pt.pageY));break;default:const gn=function(pt){return qt[(pt.pointerId===et[0].pointerId?et[1]:et[0]).pointerId]}(pt),Sn=pt.pageX-gn.x,Ft=pt.pageY-gn.y;fe=Math.sqrt(Sn*Sn+Ft*Ft),vt.copy(yn((pt.pageX+gn.x)/2,(pt.pageY+gn.y)/2))}}(pt):function(pt){const gn=-1!==ie?ie:de;0!==gn||v.noRotate?1!==gn||v.noZoom?2===gn&&!v.noPan&&vt.copy(yn(pt.pageX,pt.pageY)):Et.copy(yn(pt.pageX,pt.pageY)):(Pe.copy(Ye),Ye.copy(Jt(pt.pageX,pt.pageY)))}(pt))}function Ur(pt){!1!==v.enabled&&("touch"===pt.pointerType?function(pt){switch(et.length){case 0:de=-1;break;case 1:de=3,Ye.copy(Jt(pt.pageX,pt.pageY)),Pe.copy(Ye);break;case 2:de=4,Ye.copy(Jt(pt.pageX-Pe.pageX,pt.pageY-Pe.pageY)),Pe.copy(Ye)}v.dispatchEvent(Ml)}(pt):(de=-1,v.dispatchEvent(Ml)),Lr(pt),0===et.length&&(v.domElement.releasePointerCapture(pt.pointerId),v.domElement.removeEventListener("pointermove",Gr),v.domElement.removeEventListener("pointerup",Ur)))}function jr(pt){Lr(pt)}function Xi(pt){!1!==v.enabled&&(window.removeEventListener("keydown",Xi),-1===ie&&(pt.code!==v.keys[0]||v.noRotate?pt.code!==v.keys[1]||v.noZoom?pt.code===v.keys[2]&&!v.noPan&&(ie=2):ie=1:ie=0))}function $o(){!1!==v.enabled&&(ie=-1,window.addEventListener("keydown",Xi))}function tc(pt){if(!1!==v.enabled&&!0!==v.noZoom){switch(pt.preventDefault(),pt.deltaMode){case 2:Ce.y-=.025*pt.deltaY;break;case 1:Ce.y-=.01*pt.deltaY;break;default:Ce.y-=25e-5*pt.deltaY}v.dispatchEvent(Vc),v.dispatchEvent(Ml)}}function Os(pt){!1!==v.enabled&&pt.preventDefault()}function Lr(pt){delete qt[pt.pointerId];for(let gn=0;gn<et.length;gn++)if(et[gn].pointerId==pt.pointerId)return void et.splice(gn,1)}function $n(pt){let gn=qt[pt.pointerId];void 0===gn&&(gn=new G.FM8,qt[pt.pointerId]=gn),gn.set(pt.pageX,pt.pageY)}this.rotateCamera=function(){const pt=new G.Pa4,gn=new G._fP,Sn=new G.Pa4,Ft=new G.Pa4,Nr=new G.Pa4,zi=new G.Pa4;return function(){zi.set(Ye.x-Pe.x,Ye.y-Pe.y,0);let ca=zi.length();ca?(Oe.copy(v.object.position).sub(v.target),Sn.copy(Oe).normalize(),Ft.copy(v.object.up).normalize(),Nr.crossVectors(Ft,Sn).normalize(),Ft.setLength(Ye.y-Pe.y),Nr.setLength(Ye.x-Pe.x),zi.copy(Ft.add(Nr)),pt.crossVectors(zi,Oe).normalize(),ca*=v.rotateSpeed,gn.setFromAxisAngle(pt,ca),Oe.applyQuaternion(gn),v.object.up.applyQuaternion(gn),$e.copy(pt),xe=ca):!v.staticMoving&&xe&&(xe*=Math.sqrt(1-v.dynamicDampingFactor),Oe.copy(v.object.position).sub(v.target),gn.setFromAxisAngle($e,xe),Oe.applyQuaternion(gn),v.object.up.applyQuaternion(gn)),Pe.copy(Ye)}}(),this.zoomCamera=function(){let pt;4===de?(pt=be/fe,be=fe,v.object.isPerspectiveCamera?Oe.multiplyScalar(pt):v.object.isOrthographicCamera?(v.object.zoom*=pt,v.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(pt=1+(Et.y-Ce.y)*v.zoomSpeed,1!==pt&&pt>0&&(v.object.isPerspectiveCamera?Oe.multiplyScalar(pt):v.object.isOrthographicCamera?(v.object.zoom/=pt,v.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),v.staticMoving?Ce.copy(Et):Ce.y+=(Et.y-Ce.y)*this.dynamicDampingFactor)},this.panCamera=function(){const pt=new G.FM8,gn=new G.Pa4,Sn=new G.Pa4;return function(){if(pt.copy(vt).sub(ht),pt.lengthSq()){if(v.object.isOrthographicCamera){const zi=(v.object.top-v.object.bottom)/v.object.zoom/v.domElement.clientWidth;pt.x*=(v.object.right-v.object.left)/v.object.zoom/v.domElement.clientWidth,pt.y*=zi}pt.multiplyScalar(Oe.length()*v.panSpeed),Sn.copy(Oe).cross(v.object.up).setLength(pt.x),Sn.add(gn.copy(v.object.up).setLength(pt.y)),v.object.position.add(Sn),v.target.add(Sn),v.staticMoving?ht.copy(vt):ht.add(pt.subVectors(vt,ht).multiplyScalar(v.dynamicDampingFactor))}}}(),this.checkDistances=function(){(!v.noZoom||!v.noPan)&&(Oe.lengthSq()>v.maxDistance*v.maxDistance&&(v.object.position.addVectors(v.target,Oe.setLength(v.maxDistance)),Ce.copy(Et)),Oe.lengthSq()<v.minDistance*v.minDistance&&(v.object.position.addVectors(v.target,Oe.setLength(v.minDistance)),Ce.copy(Et)))},this.update=function(){Oe.subVectors(v.object.position,v.target),v.noRotate||v.rotateCamera(),v.noZoom||v.zoomCamera(),v.noPan||v.panCamera(),v.object.position.addVectors(v.target,Oe),v.object.isPerspectiveCamera?(v.checkDistances(),v.object.lookAt(v.target),X.distanceToSquared(v.object.position)>B&&(v.dispatchEvent(ql),X.copy(v.object.position))):v.object.isOrthographicCamera?(v.object.lookAt(v.target),(X.distanceToSquared(v.object.position)>B||Q!==v.object.zoom)&&(v.dispatchEvent(ql),X.copy(v.object.position),Q=v.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){de=-1,ie=-1,v.target.copy(v.target0),v.object.position.copy(v.position0),v.object.up.copy(v.up0),v.object.zoom=v.zoom0,v.object.updateProjectionMatrix(),Oe.subVectors(v.object.position,v.target),v.object.lookAt(v.target),v.dispatchEvent(ql),X.copy(v.object.position),Q=v.object.zoom},this.dispose=function(){v.domElement.removeEventListener("contextmenu",Os),v.domElement.removeEventListener("pointerdown",yr),v.domElement.removeEventListener("pointercancel",jr),v.domElement.removeEventListener("wheel",tc),v.domElement.removeEventListener("pointermove",Gr),v.domElement.removeEventListener("pointerup",Ur),window.removeEventListener("keydown",Xi),window.removeEventListener("keyup",$o)},this.domElement.addEventListener("contextmenu",Os),this.domElement.addEventListener("pointerdown",yr),this.domElement.addEventListener("pointercancel",jr),this.domElement.addEventListener("wheel",tc,{passive:!1}),window.addEventListener("keydown",Xi),window.addEventListener("keyup",$o),this.handleResize(),this.update()}}const zc={type:"change"},el={type:"start"},Ot={type:"end"};class Hr extends G.pBf{constructor(d,g){super(),void 0===g&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),g===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=d,this.domElement=g,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new G.Pa4,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:G.RsA.ROTATE,MIDDLE:G.RsA.DOLLY,RIGHT:G.RsA.PAN},this.touches={ONE:G.QmN.ROTATE,TWO:G.QmN.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return Q.phi},this.getAzimuthalAngle=function(){return Q.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(it){it.addEventListener("keydown",tf),this._domElementKeyEvents=it},this.saveState=function(){v.target0.copy(v.target),v.position0.copy(v.object.position),v.zoom0=v.object.zoom},this.reset=function(){v.target.copy(v.target0),v.object.position.copy(v.position0),v.object.zoom=v.zoom0,v.object.updateProjectionMatrix(),v.dispatchEvent(zc),v.update(),B=I.NONE},this.update=function(){const it=new G.Pa4,ar=(new G._fP).setFromUnitVectors(d.up,new G.Pa4(0,1,0)),Ws=ar.clone().invert(),po=new G.Pa4,dl=new G._fP,Fu=2*Math.PI;return function(){const _d=v.object.position;it.copy(_d).sub(v.target),it.applyQuaternion(ar),Q.setFromVector3(it),v.autoRotate&&B===I.NONE&&yr(2*Math.PI/60/60*v.autoRotateSpeed),v.enableDamping?(Q.theta+=de.theta*v.dampingFactor,Q.phi+=de.phi*v.dampingFactor):(Q.theta+=de.theta,Q.phi+=de.phi);let Nl=v.minAzimuthAngle,Ha=v.maxAzimuthAngle;return isFinite(Nl)&&isFinite(Ha)&&(Nl<-Math.PI?Nl+=Fu:Nl>Math.PI&&(Nl-=Fu),Ha<-Math.PI?Ha+=Fu:Ha>Math.PI&&(Ha-=Fu),Q.theta=Nl<=Ha?Math.max(Nl,Math.min(Ha,Q.theta)):Q.theta>(Nl+Ha)/2?Math.max(Nl,Q.theta):Math.min(Ha,Q.theta)),Q.phi=Math.max(v.minPolarAngle,Math.min(v.maxPolarAngle,Q.phi)),Q.makeSafe(),Q.radius*=ie,Q.radius=Math.max(v.minDistance,Math.min(v.maxDistance,Q.radius)),!0===v.enableDamping?v.target.addScaledVector(be,v.dampingFactor):v.target.add(be),it.setFromSpherical(Q),it.applyQuaternion(Ws),_d.copy(v.target).add(it),v.object.lookAt(v.target),!0===v.enableDamping?(de.theta*=1-v.dampingFactor,de.phi*=1-v.dampingFactor,be.multiplyScalar(1-v.dampingFactor)):(de.set(0,0,0),be.set(0,0,0)),ie=1,!!(fe||po.distanceToSquared(v.object.position)>X||8*(1-dl.dot(v.object.quaternion))>X)&&(v.dispatchEvent(zc),po.copy(v.object.position),dl.copy(v.object.quaternion),fe=!1,!0)}}(),this.dispose=function(){v.domElement.removeEventListener("contextmenu",tu),v.domElement.removeEventListener("pointerdown",Ua),v.domElement.removeEventListener("pointercancel",Rc),v.domElement.removeEventListener("wheel",Jc),v.domElement.removeEventListener("pointermove",Va),v.domElement.removeEventListener("pointerup",Ns),null!==v._domElementKeyEvents&&v._domElementKeyEvents.removeEventListener("keydown",tf)};const v=this,I={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let B=I.NONE;const X=1e-6,Q=new G.$V,de=new G.$V;let ie=1;const be=new G.Pa4;let fe=!1;const xe=new G.FM8,Oe=new G.FM8,Pe=new G.FM8,Ye=new G.FM8,$e=new G.FM8,Ce=new G.FM8,Et=new G.FM8,ht=new G.FM8,vt=new G.FM8,et=[],qt={};function Jt(){return Math.pow(.95,v.zoomSpeed)}function yr(it){de.theta-=it}function Gr(it){de.phi-=it}const Ur=function(){const it=new G.Pa4;return function(Ws,po){it.setFromMatrixColumn(po,0),it.multiplyScalar(-Ws),be.add(it)}}(),jr=function(){const it=new G.Pa4;return function(Ws,po){!0===v.screenSpacePanning?it.setFromMatrixColumn(po,1):(it.setFromMatrixColumn(po,0),it.crossVectors(v.object.up,it)),it.multiplyScalar(Ws),be.add(it)}}(),Xi=function(){const it=new G.Pa4;return function(Ws,po){const dl=v.domElement;if(v.object.isPerspectiveCamera){it.copy(v.object.position).sub(v.target);let vd=it.length();vd*=Math.tan(v.object.fov/2*Math.PI/180),Ur(2*Ws*vd/dl.clientHeight,v.object.matrix),jr(2*po*vd/dl.clientHeight,v.object.matrix)}else v.object.isOrthographicCamera?(Ur(Ws*(v.object.right-v.object.left)/v.object.zoom/dl.clientWidth,v.object.matrix),jr(po*(v.object.top-v.object.bottom)/v.object.zoom/dl.clientHeight,v.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),v.enablePan=!1)}}();function $o(it){v.object.isPerspectiveCamera?ie/=it:v.object.isOrthographicCamera?(v.object.zoom=Math.max(v.minZoom,Math.min(v.maxZoom,v.object.zoom*it)),v.object.updateProjectionMatrix(),fe=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),v.enableZoom=!1)}function to(it){v.object.isPerspectiveCamera?ie*=it:v.object.isOrthographicCamera?(v.object.zoom=Math.max(v.minZoom,Math.min(v.maxZoom,v.object.zoom/it)),v.object.updateProjectionMatrix(),fe=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),v.enableZoom=!1)}function cl(it){xe.set(it.clientX,it.clientY)}function tc(it){Ye.set(it.clientX,it.clientY)}function $n(){1===et.length?xe.set(et[0].pageX,et[0].pageY):xe.set(.5*(et[0].pageX+et[1].pageX),.5*(et[0].pageY+et[1].pageY))}function Or(){1===et.length?Ye.set(et[0].pageX,et[0].pageY):Ye.set(.5*(et[0].pageX+et[1].pageX),.5*(et[0].pageY+et[1].pageY))}function pt(){const it=et[0].pageX-et[1].pageX,ar=et[0].pageY-et[1].pageY,Ws=Math.sqrt(it*it+ar*ar);Et.set(0,Ws)}function Ft(it){if(1==et.length)Oe.set(it.pageX,it.pageY);else{const Ws=Nu(it);Oe.set(.5*(it.pageX+Ws.x),.5*(it.pageY+Ws.y))}Pe.subVectors(Oe,xe).multiplyScalar(v.rotateSpeed);const ar=v.domElement;yr(2*Math.PI*Pe.x/ar.clientHeight),Gr(2*Math.PI*Pe.y/ar.clientHeight),xe.copy(Oe)}function Nr(it){if(1===et.length)$e.set(it.pageX,it.pageY);else{const ar=Nu(it);$e.set(.5*(it.pageX+ar.x),.5*(it.pageY+ar.y))}Ce.subVectors($e,Ye).multiplyScalar(v.panSpeed),Xi(Ce.x,Ce.y),Ye.copy($e)}function zi(it){const ar=Nu(it),Ws=it.pageX-ar.x,po=it.pageY-ar.y,dl=Math.sqrt(Ws*Ws+po*po);ht.set(0,dl),vt.set(0,Math.pow(ht.y/Et.y,v.zoomSpeed)),$o(vt.y),Et.copy(ht)}function Ua(it){!1!==v.enabled&&(0===et.length&&(v.domElement.setPointerCapture(it.pointerId),v.domElement.addEventListener("pointermove",Va),v.domElement.addEventListener("pointerup",Ns)),function(it){et.push(it)}(it),"touch"===it.pointerType?function(it){switch(yd(it),et.length){case 1:switch(v.touches.ONE){case G.QmN.ROTATE:if(!1===v.enableRotate)return;$n(),B=I.TOUCH_ROTATE;break;case G.QmN.PAN:if(!1===v.enablePan)return;Or(),B=I.TOUCH_PAN;break;default:B=I.NONE}break;case 2:switch(v.touches.TWO){case G.QmN.DOLLY_PAN:if(!1===v.enableZoom&&!1===v.enablePan)return;v.enableZoom&&pt(),v.enablePan&&Or(),B=I.TOUCH_DOLLY_PAN;break;case G.QmN.DOLLY_ROTATE:if(!1===v.enableZoom&&!1===v.enableRotate)return;v.enableZoom&&pt(),v.enableRotate&&$n(),B=I.TOUCH_DOLLY_ROTATE;break;default:B=I.NONE}break;default:B=I.NONE}B!==I.NONE&&v.dispatchEvent(el)}(it):function(it){let ar;switch(it.button){case 0:ar=v.mouseButtons.LEFT;break;case 1:ar=v.mouseButtons.MIDDLE;break;case 2:ar=v.mouseButtons.RIGHT;break;default:ar=-1}switch(ar){case G.RsA.DOLLY:if(!1===v.enableZoom)return;(function(it){Et.set(it.clientX,it.clientY)})(it),B=I.DOLLY;break;case G.RsA.ROTATE:if(it.ctrlKey||it.metaKey||it.shiftKey){if(!1===v.enablePan)return;tc(it),B=I.PAN}else{if(!1===v.enableRotate)return;cl(it),B=I.ROTATE}break;case G.RsA.PAN:if(it.ctrlKey||it.metaKey||it.shiftKey){if(!1===v.enableRotate)return;cl(it),B=I.ROTATE}else{if(!1===v.enablePan)return;tc(it),B=I.PAN}break;default:B=I.NONE}B!==I.NONE&&v.dispatchEvent(el)}(it))}function Va(it){!1!==v.enabled&&("touch"===it.pointerType?function(it){switch(yd(it),B){case I.TOUCH_ROTATE:if(!1===v.enableRotate)return;Ft(it),v.update();break;case I.TOUCH_PAN:if(!1===v.enablePan)return;Nr(it),v.update();break;case I.TOUCH_DOLLY_PAN:if(!1===v.enableZoom&&!1===v.enablePan)return;(function(it){v.enableZoom&&zi(it),v.enablePan&&Nr(it)})(it),v.update();break;case I.TOUCH_DOLLY_ROTATE:if(!1===v.enableZoom&&!1===v.enableRotate)return;(function(it){v.enableZoom&&zi(it),v.enableRotate&&Ft(it)})(it),v.update();break;default:B=I.NONE}}(it):function(it){if(!1!==v.enabled)switch(B){case I.ROTATE:if(!1===v.enableRotate)return;!function(it){Oe.set(it.clientX,it.clientY),Pe.subVectors(Oe,xe).multiplyScalar(v.rotateSpeed);const ar=v.domElement;yr(2*Math.PI*Pe.x/ar.clientHeight),Gr(2*Math.PI*Pe.y/ar.clientHeight),xe.copy(Oe),v.update()}(it);break;case I.DOLLY:if(!1===v.enableZoom)return;!function(it){ht.set(it.clientX,it.clientY),vt.subVectors(ht,Et),vt.y>0?$o(Jt()):vt.y<0&&to(Jt()),Et.copy(ht),v.update()}(it);break;case I.PAN:if(!1===v.enablePan)return;!function(it){$e.set(it.clientX,it.clientY),Ce.subVectors($e,Ye).multiplyScalar(v.panSpeed),Xi(Ce.x,Ce.y),Ye.copy($e),v.update()}(it)}}(it))}function Ns(it){!1!==v.enabled&&(v.dispatchEvent(Ot),B=I.NONE,Ol(it),0===et.length&&(v.domElement.releasePointerCapture(it.pointerId),v.domElement.removeEventListener("pointermove",Va),v.domElement.removeEventListener("pointerup",Ns)))}function Rc(it){Ol(it)}function Jc(it){!1===v.enabled||!1===v.enableZoom||B!==I.NONE&&B!==I.ROTATE||(it.preventDefault(),v.dispatchEvent(el),function(it){it.deltaY<0?to(Jt()):it.deltaY>0&&$o(Jt()),v.update()}(it),v.dispatchEvent(Ot))}function tf(it){!1===v.enabled||!1===v.enablePan||function(it){let ar=!1;switch(it.code){case v.keys.UP:Xi(0,v.keyPanSpeed),ar=!0;break;case v.keys.BOTTOM:Xi(0,-v.keyPanSpeed),ar=!0;break;case v.keys.LEFT:Xi(v.keyPanSpeed,0),ar=!0;break;case v.keys.RIGHT:Xi(-v.keyPanSpeed,0),ar=!0}ar&&(it.preventDefault(),v.update())}(it)}function tu(it){!1!==v.enabled&&it.preventDefault()}function Ol(it){delete qt[it.pointerId];for(let ar=0;ar<et.length;ar++)if(et[ar].pointerId==it.pointerId)return void et.splice(ar,1)}function yd(it){let ar=qt[it.pointerId];void 0===ar&&(ar=new G.FM8,qt[it.pointerId]=ar),ar.set(it.pageX,it.pageY)}function Nu(it){return qt[(it.pointerId===et[0].pointerId?et[1]:et[0]).pointerId]}v.domElement.addEventListener("contextmenu",tu),v.domElement.addEventListener("pointerdown",Ua),v.domElement.addEventListener("pointercancel",Rc),v.domElement.addEventListener("wheel",Jc,{passive:!1}),this.update()}}const ps={type:"change"};class xu extends G.pBf{constructor(d,g){super(),void 0===g&&(console.warn('THREE.FlyControls: The second parameter "domElement" is now mandatory.'),g=document),this.object=d,this.domElement=g,this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1;const v=this,I=1e-6,B=new G._fP,X=new G.Pa4;this.tmpQuaternion=new G._fP,this.mouseStatus=0,this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this.moveVector=new G.Pa4(0,0,0),this.rotationVector=new G.Pa4(0,0,0),this.keydown=function(xe){if(!xe.altKey){switch(xe.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this.moveState.forward=1;break;case"KeyS":this.moveState.back=1;break;case"KeyA":this.moveState.left=1;break;case"KeyD":this.moveState.right=1;break;case"KeyR":this.moveState.up=1;break;case"KeyF":this.moveState.down=1;break;case"ArrowUp":this.moveState.pitchUp=1;break;case"ArrowDown":this.moveState.pitchDown=1;break;case"ArrowLeft":this.moveState.yawLeft=1;break;case"ArrowRight":this.moveState.yawRight=1;break;case"KeyQ":this.moveState.rollLeft=1;break;case"KeyE":this.moveState.rollRight=1}this.updateMovementVector(),this.updateRotationVector()}},this.keyup=function(xe){switch(xe.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this.moveState.forward=0;break;case"KeyS":this.moveState.back=0;break;case"KeyA":this.moveState.left=0;break;case"KeyD":this.moveState.right=0;break;case"KeyR":this.moveState.up=0;break;case"KeyF":this.moveState.down=0;break;case"ArrowUp":this.moveState.pitchUp=0;break;case"ArrowDown":this.moveState.pitchDown=0;break;case"ArrowLeft":this.moveState.yawLeft=0;break;case"ArrowRight":this.moveState.yawRight=0;break;case"KeyQ":this.moveState.rollLeft=0;break;case"KeyE":this.moveState.rollRight=0}this.updateMovementVector(),this.updateRotationVector()},this.mousedown=function(xe){if(this.dragToLook)this.mouseStatus++;else{switch(xe.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1}this.updateMovementVector()}},this.mousemove=function(xe){if(!this.dragToLook||this.mouseStatus>0){const Oe=this.getContainerDimensions(),Pe=Oe.size[0]/2,Ye=Oe.size[1]/2;this.moveState.yawLeft=-(xe.pageX-Oe.offset[0]-Pe)/Pe,this.moveState.pitchDown=(xe.pageY-Oe.offset[1]-Ye)/Ye,this.updateRotationVector()}},this.mouseup=function(xe){if(this.dragToLook)this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(xe.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0}this.updateMovementVector()}this.updateRotationVector()},this.update=function(xe){const Oe=xe*v.movementSpeed,Pe=xe*v.rollSpeed;v.object.translateX(v.moveVector.x*Oe),v.object.translateY(v.moveVector.y*Oe),v.object.translateZ(v.moveVector.z*Oe),v.tmpQuaternion.set(v.rotationVector.x*Pe,v.rotationVector.y*Pe,v.rotationVector.z*Pe,1).normalize(),v.object.quaternion.multiply(v.tmpQuaternion),(X.distanceToSquared(v.object.position)>I||8*(1-B.dot(v.object.quaternion))>I)&&(v.dispatchEvent(ps),B.copy(v.object.quaternion),X.copy(v.object.position))},this.updateMovementVector=function(){const xe=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-xe+this.moveState.back},this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft},this.getContainerDimensions=function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}},this.dispose=function(){this.domElement.removeEventListener("contextmenu",Sl),this.domElement.removeEventListener("mousedown",de),this.domElement.removeEventListener("mousemove",Q),this.domElement.removeEventListener("mouseup",ie),window.removeEventListener("keydown",be),window.removeEventListener("keyup",fe)};const Q=this.mousemove.bind(this),de=this.mousedown.bind(this),ie=this.mouseup.bind(this),be=this.keydown.bind(this),fe=this.keyup.bind(this);this.domElement.addEventListener("contextmenu",Sl),this.domElement.addEventListener("mousemove",Q),this.domElement.addEventListener("mousedown",de),this.domElement.addEventListener("mouseup",ie),window.addEventListener("keydown",be),window.addEventListener("keyup",fe),this.updateMovementVector(),this.updateRotationVector()}}function Sl(f){f.preventDefault()}var Lo={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\t\t}"};class Cl{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const tl=new G.iKG(-1,1,1,-1,0,1),Hc=new G.u9r;Hc.setAttribute("position",new G.a$l([-1,3,0,-1,-1,0,3,-1,0],3)),Hc.setAttribute("uv",new G.a$l([0,2,0,0,2,0],2));class Gc{constructor(d){this._mesh=new G.Kj0(Hc,d)}dispose(){this._mesh.geometry.dispose()}render(d){d.render(this._mesh,tl)}get material(){return this._mesh.material}set material(d){this._mesh.material=d}}class La extends Cl{constructor(d,g){super(),this.textureID=void 0!==g?g:"tDiffuse",d instanceof G.jyz?(this.uniforms=d.uniforms,this.material=d):d&&(this.uniforms=G.rDY.clone(d.uniforms),this.material=new G.jyz({defines:Object.assign({},d.defines),uniforms:this.uniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader})),this.fsQuad=new Gc(this.material)}render(d,g,v){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=v.texture),this.fsQuad.material=this.material,this.renderToScreen?(d.setRenderTarget(null),this.fsQuad.render(d)):(d.setRenderTarget(g),this.clear&&d.clear(d.autoClearColor,d.autoClearDepth,d.autoClearStencil),this.fsQuad.render(d))}}class vc extends Cl{constructor(d,g){super(),this.scene=d,this.camera=g,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(d,g,v){const I=d.getContext(),B=d.state;let X,Q;B.buffers.color.setMask(!1),B.buffers.depth.setMask(!1),B.buffers.color.setLocked(!0),B.buffers.depth.setLocked(!0),this.inverse?(X=0,Q=1):(X=1,Q=0),B.buffers.stencil.setTest(!0),B.buffers.stencil.setOp(I.REPLACE,I.REPLACE,I.REPLACE),B.buffers.stencil.setFunc(I.ALWAYS,X,4294967295),B.buffers.stencil.setClear(Q),B.buffers.stencil.setLocked(!0),d.setRenderTarget(v),this.clear&&d.clear(),d.render(this.scene,this.camera),d.setRenderTarget(g),this.clear&&d.clear(),d.render(this.scene,this.camera),B.buffers.color.setLocked(!1),B.buffers.depth.setLocked(!1),B.buffers.stencil.setLocked(!1),B.buffers.stencil.setFunc(I.EQUAL,1,4294967295),B.buffers.stencil.setOp(I.KEEP,I.KEEP,I.KEEP),B.buffers.stencil.setLocked(!0)}}class Rt extends Cl{constructor(){super(),this.needsSwap=!1}render(d){d.state.buffers.stencil.setLocked(!1),d.state.buffers.stencil.setTest(!1)}}class ui{constructor(d,g){if(this.renderer=d,void 0===g){const v={minFilter:G.wem,magFilter:G.wem,format:G.wk1},I=d.getSize(new G.FM8);this._pixelRatio=d.getPixelRatio(),this._width=I.width,this._height=I.height,(g=new G.dd2(this._width*this._pixelRatio,this._height*this._pixelRatio,v)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=g.width,this._height=g.height;this.renderTarget1=g,this.renderTarget2=g.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===Lo&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===La&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new La(Lo),this.clock=new G.SUY}swapBuffers(){const d=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=d}addPass(d){this.passes.push(d),d.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(d,g){this.passes.splice(g,0,d),d.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(d){const g=this.passes.indexOf(d);-1!==g&&this.passes.splice(g,1)}isLastEnabledPass(d){for(let g=d+1;g<this.passes.length;g++)if(this.passes[g].enabled)return!1;return!0}render(d){void 0===d&&(d=this.clock.getDelta());const g=this.renderer.getRenderTarget();let v=!1;for(let I=0,B=this.passes.length;I<B;I++){const X=this.passes[I];if(!1!==X.enabled){if(X.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(I),X.render(this.renderer,this.writeBuffer,this.readBuffer,d,v),X.needsSwap){if(v){const Q=this.renderer.getContext(),de=this.renderer.state.buffers.stencil;de.setFunc(Q.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,d),de.setFunc(Q.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==vc&&(X instanceof vc?v=!0:X instanceof Rt&&(v=!1))}}this.renderer.setRenderTarget(g)}reset(d){if(void 0===d){const g=this.renderer.getSize(new G.FM8);this._pixelRatio=this.renderer.getPixelRatio(),this._width=g.width,this._height=g.height,(d=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=d,this.renderTarget2=d.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(d,g){this._width=d,this._height=g;const v=this._width*this._pixelRatio,I=this._height*this._pixelRatio;this.renderTarget1.setSize(v,I),this.renderTarget2.setSize(v,I);for(let B=0;B<this.passes.length;B++)this.passes[B].setSize(v,I)}setPixelRatio(d){this._pixelRatio=d,this.setSize(this._width,this._height)}}new G.iKG(-1,1,1,-1,0,1);const Oo=new G.u9r;Oo.setAttribute("position",new G.a$l([-1,3,0,-1,-1,0,3,-1,0],3)),Oo.setAttribute("uv",new G.a$l([0,2,0,0,2,0],2));class xa extends Cl{constructor(d,g,v,I,B){super(),this.scene=d,this.camera=g,this.overrideMaterial=v,this.clearColor=I,this.clearAlpha=void 0!==B?B:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new G.Ilk}render(d,g,v){const I=d.autoClear;let B,X;d.autoClear=!1,void 0!==this.overrideMaterial&&(X=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(d.getClearColor(this._oldClearColor),B=d.getClearAlpha(),d.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&d.clearDepth(),d.setRenderTarget(this.renderToScreen?null:v),this.clear&&d.clear(d.autoClearColor,d.autoClearDepth,d.autoClearStencil),d.render(this.scene,this.camera),this.clearColor&&d.setClearColor(this._oldClearColor,B),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=X),d.autoClear=I}}function di(){return(di=Object.assign||function(f){for(var d=1;d<arguments.length;d++){var g=arguments[d];for(var v in g)Object.prototype.hasOwnProperty.call(g,v)&&(f[v]=g[v])}return f}).apply(this,arguments)}function nl(f,d){return(nl=Object.setPrototypeOf||function(v,I){return v.__proto__=I,v})(f,d)}function as(f){return(as=Object.setPrototypeOf?Object.getPrototypeOf:function(g){return g.__proto__||Object.getPrototypeOf(g)})(f)}function jc(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}function Al(f,d,g){return(Al=jc()?Reflect.construct:function(I,B,X){var Q=[null];Q.push.apply(Q,B);var ie=new(Function.bind.apply(I,Q));return X&&nl(ie,X.prototype),ie}).apply(null,arguments)}function bs(f){var d="function"==typeof Map?new Map:void 0;return(bs=function(v){if(null===v||!function(f){return-1!==Function.toString.call(f).indexOf("[native code]")}(v))return v;if("function"!=typeof v)throw new TypeError("Super expression must either be null or a function");if(void 0!==d){if(d.has(v))return d.get(v);d.set(v,I)}function I(){return Al(v,arguments,as(this).constructor)}return I.prototype=Object.create(v.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),nl(I,v)})(f)}var Wn=function(f){function d(g){return function(f){if(void 0===f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(f.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+g+" for more information.")||this)}return function(f,d){f.prototype=Object.create(d.prototype),f.prototype.constructor=f,nl(f,d)}(d,f),d}(bs(Error));function vr(f){return Math.round(255*f)}function ei(f,d,g){return vr(f)+","+vr(d)+","+vr(g)}function Si(f,d,g,v){if(void 0===v&&(v=ei),0===d)return v(g,g,g);var I=(f%360+360)%360/60,B=(1-Math.abs(2*g-1))*d,X=B*(1-Math.abs(I%2-1)),Q=0,de=0,ie=0;I>=0&&I<1?(Q=B,de=X):I>=1&&I<2?(Q=X,de=B):I>=2&&I<3?(de=B,ie=X):I>=3&&I<4?(de=X,ie=B):I>=4&&I<5?(Q=X,ie=B):I>=5&&I<6&&(Q=B,ie=X);var be=g-B/2;return v(Q+be,de+be,ie+be)}var Oi={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},bi=/^#[a-fA-F0-9]{6}$/,Ji=/^#[a-fA-F0-9]{8}$/,al=/^#[a-fA-F0-9]{3}$/,es=/^#[a-fA-F0-9]{4}$/,ot=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/i,bn=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/i,It=/^hsl\(\s*(\d{0,3}[.]?[0-9]+)\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,xn=/^hsla\(\s*(\d{0,3}[.]?[0-9]+)\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/i;function rn(f){if("string"!=typeof f)throw new Wn(3);var d=function(f){if("string"!=typeof f)return f;var d=f.toLowerCase();return Oi[d]?"#"+Oi[d]:f}(f);if(d.match(bi))return{red:parseInt(""+d[1]+d[2],16),green:parseInt(""+d[3]+d[4],16),blue:parseInt(""+d[5]+d[6],16)};if(d.match(Ji)){var g=parseFloat((parseInt(""+d[7]+d[8],16)/255).toFixed(2));return{red:parseInt(""+d[1]+d[2],16),green:parseInt(""+d[3]+d[4],16),blue:parseInt(""+d[5]+d[6],16),alpha:g}}if(d.match(al))return{red:parseInt(""+d[1]+d[1],16),green:parseInt(""+d[2]+d[2],16),blue:parseInt(""+d[3]+d[3],16)};if(d.match(es)){var v=parseFloat((parseInt(""+d[4]+d[4],16)/255).toFixed(2));return{red:parseInt(""+d[1]+d[1],16),green:parseInt(""+d[2]+d[2],16),blue:parseInt(""+d[3]+d[3],16),alpha:v}}var I=ot.exec(d);if(I)return{red:parseInt(""+I[1],10),green:parseInt(""+I[2],10),blue:parseInt(""+I[3],10)};var B=bn.exec(d.substring(0,50));if(B)return{red:parseInt(""+B[1],10),green:parseInt(""+B[2],10),blue:parseInt(""+B[3],10),alpha:parseFloat(""+B[4])};var X=It.exec(d);if(X){var be="rgb("+Si(parseInt(""+X[1],10),parseInt(""+X[2],10)/100,parseInt(""+X[3],10)/100)+")",fe=ot.exec(be);if(!fe)throw new Wn(4,d,be);return{red:parseInt(""+fe[1],10),green:parseInt(""+fe[2],10),blue:parseInt(""+fe[3],10)}}var xe=xn.exec(d.substring(0,50));if(xe){var $e="rgb("+Si(parseInt(""+xe[1],10),parseInt(""+xe[2],10)/100,parseInt(""+xe[3],10)/100)+")",Ce=ot.exec($e);if(!Ce)throw new Wn(4,d,$e);return{red:parseInt(""+Ce[1],10),green:parseInt(""+Ce[2],10),blue:parseInt(""+Ce[3],10),alpha:parseFloat(""+xe[4])}}throw new Wn(5)}var jt=function(d){return 7===d.length&&d[1]===d[2]&&d[3]===d[4]&&d[5]===d[6]?"#"+d[1]+d[3]+d[5]:d};function mr(f){var d=f.toString(16);return 1===d.length?"0"+d:d}function ms(f,d,g){if("number"==typeof f&&"number"==typeof d&&"number"==typeof g)return jt("#"+mr(f)+mr(d)+mr(g));if("object"==typeof f&&void 0===d&&void 0===g)return jt("#"+mr(f.red)+mr(f.green)+mr(f.blue));throw new Wn(6)}function Ql(f,d,g){return function(){var I=g.concat(Array.prototype.slice.call(arguments));return I.length>=d?f.apply(this,I):Ql(f,d,I)}}function ll(f){return Ql(f,f.length,[])}function jo(f,d,g){return Math.max(f,Math.min(d,g))}function Rh(f,d){if("transparent"===d)return d;var g=rn(d);return function(f,d,g,v){if("string"==typeof f&&"number"==typeof d){var I=rn(f);return"rgba("+I.red+","+I.green+","+I.blue+","+d+")"}if("number"==typeof f&&"number"==typeof d&&"number"==typeof g&&"number"==typeof v)return v>=1?ms(f,d,g):"rgba("+f+","+d+","+g+","+v+")";if("object"==typeof f&&void 0===d&&void 0===g&&void 0===v)return f.alpha>=1?ms(f.red,f.green,f.blue):"rgba("+f.red+","+f.green+","+f.blue+","+f.alpha+")";throw new Wn(7)}(di({},g,{alpha:jo(0,1,(100*("number"==typeof g.alpha?g.alpha:1)+100*parseFloat(f))/100)}))}var f,ad=ll(Rh),Du={Linear:{None:function(f){return f}},Quadratic:{In:function(f){return f*f},Out:function(f){return f*(2-f)},InOut:function(f){return(f*=2)<1?.5*f*f:-.5*(--f*(f-2)-1)}},Cubic:{In:function(f){return f*f*f},Out:function(f){return--f*f*f+1},InOut:function(f){return(f*=2)<1?.5*f*f*f:.5*((f-=2)*f*f+2)}},Quartic:{In:function(f){return f*f*f*f},Out:function(f){return 1- --f*f*f*f},InOut:function(f){return(f*=2)<1?.5*f*f*f*f:-.5*((f-=2)*f*f*f-2)}},Quintic:{In:function(f){return f*f*f*f*f},Out:function(f){return--f*f*f*f*f+1},InOut:function(f){return(f*=2)<1?.5*f*f*f*f*f:.5*((f-=2)*f*f*f*f+2)}},Sinusoidal:{In:function(f){return 1-Math.cos(f*Math.PI/2)},Out:function(f){return Math.sin(f*Math.PI/2)},InOut:function(f){return.5*(1-Math.cos(Math.PI*f))}},Exponential:{In:function(f){return 0===f?0:Math.pow(1024,f-1)},Out:function(f){return 1===f?1:1-Math.pow(2,-10*f)},InOut:function(f){return 0===f?0:1===f?1:(f*=2)<1?.5*Math.pow(1024,f-1):.5*(2-Math.pow(2,-10*(f-1)))}},Circular:{In:function(f){return 1-Math.sqrt(1-f*f)},Out:function(f){return Math.sqrt(1- --f*f)},InOut:function(f){return(f*=2)<1?-.5*(Math.sqrt(1-f*f)-1):.5*(Math.sqrt(1-(f-=2)*f)+1)}},Elastic:{In:function(f){return 0===f?0:1===f?1:-Math.pow(2,10*(f-1))*Math.sin(5*(f-1.1)*Math.PI)},Out:function(f){return 0===f?0:1===f?1:Math.pow(2,-10*f)*Math.sin(5*(f-.1)*Math.PI)+1},InOut:function(f){return 0===f?0:1===f?1:(f*=2)<1?-.5*Math.pow(2,10*(f-1))*Math.sin(5*(f-1.1)*Math.PI):.5*Math.pow(2,-10*(f-1))*Math.sin(5*(f-1.1)*Math.PI)+1}},Back:{In:function(f){var d=1.70158;return f*f*((d+1)*f-d)},Out:function(f){var d=1.70158;return--f*f*((d+1)*f+d)+1},InOut:function(f){var d=2.5949095;return(f*=2)<1?f*f*((d+1)*f-d)*.5:.5*((f-=2)*f*((d+1)*f+d)+2)}},Bounce:{In:function(f){return 1-Du.Bounce.Out(1-f)},Out:function(f){return f<1/2.75?7.5625*f*f:f<2/2.75?7.5625*(f-=1.5/2.75)*f+.75:f<2.5/2.75?7.5625*(f-=2.25/2.75)*f+.9375:7.5625*(f-=2.625/2.75)*f+.984375},InOut:function(f){return f<.5?.5*Du.Bounce.In(2*f):.5*Du.Bounce.Out(2*f-1)+.5}}},Cc="undefined"==typeof self&&"undefined"!=typeof process&&process.hrtime?function(){var f=process.hrtime();return 1e3*f[0]+f[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()},Tc=function(){function f(){this._tweens={},this._tweensAddedDuringUpdate={}}return f.prototype.getAll=function(){var d=this;return Object.keys(this._tweens).map(function(g){return d._tweens[g]})},f.prototype.removeAll=function(){this._tweens={}},f.prototype.add=function(d){this._tweens[d.getId()]=d,this._tweensAddedDuringUpdate[d.getId()]=d},f.prototype.remove=function(d){delete this._tweens[d.getId()],delete this._tweensAddedDuringUpdate[d.getId()]},f.prototype.update=function(d,g){void 0===d&&(d=Cc()),void 0===g&&(g=!1);var v=Object.keys(this._tweens);if(0===v.length)return!1;for(;v.length>0;){this._tweensAddedDuringUpdate={};for(var I=0;I<v.length;I++){var B=this._tweens[v[I]];B&&!1===B.update(d,!g)&&!g&&delete this._tweens[v[I]]}v=Object.keys(this._tweensAddedDuringUpdate)}return!0},f}(),Iu={Linear:function(f,d){var g=f.length-1,v=g*d,I=Math.floor(v),B=Iu.Utils.Linear;return d<0?B(f[0],f[1],v):d>1?B(f[g],f[g-1],g-v):B(f[I],f[I+1>g?g:I+1],v-I)},Bezier:function(f,d){for(var g=0,v=f.length-1,I=Math.pow,B=Iu.Utils.Bernstein,X=0;X<=v;X++)g+=I(1-d,v-X)*I(d,X)*f[X]*B(v,X);return g},CatmullRom:function(f,d){var g=f.length-1,v=g*d,I=Math.floor(v),B=Iu.Utils.CatmullRom;return f[0]===f[g]?(d<0&&(I=Math.floor(v=g*(1+d))),B(f[(I-1+g)%g],f[I],f[(I+1)%g],f[(I+2)%g],v-I)):d<0?f[0]-(B(f[0],f[0],f[1],f[1],-v)-f[0]):d>1?f[g]-(B(f[g],f[g],f[g-1],f[g-1],v-g)-f[g]):B(f[I?I-1:0],f[I],f[g<I+1?g:I+1],f[g<I+2?g:I+2],v-I)},Utils:{Linear:function(f,d,g){return(d-f)*g+f},Bernstein:function(f,d){var g=Iu.Utils.Factorial;return g(f)/g(d)/g(f-d)},Factorial:(f=[1],function(d){var g=1;if(f[d])return f[d];for(var v=d;v>1;v--)g*=v;return f[d]=g,g}),CatmullRom:function(f,d,g,v,I){var B=.5*(g-f),X=.5*(v-d),Q=I*I;return(2*d-2*g+B+X)*(I*Q)+(-3*d+3*g-2*B-X)*Q+B*I+d}}},Bf=function(){function f(){}return f.nextId=function(){return f._nextId++},f._nextId=0,f}(),Nh=new Tc,ng=function(){function f(d,g){void 0===g&&(g=Nh),this._object=d,this._group=g,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Du.Linear.None,this._interpolationFunction=Iu.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=Bf.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return f.prototype.getId=function(){return this._id},f.prototype.isPlaying=function(){return this._isPlaying},f.prototype.isPaused=function(){return this._isPaused},f.prototype.to=function(d,g){return this._valuesEnd=Object.create(d),void 0!==g&&(this._duration=g),this},f.prototype.duration=function(d){return this._duration=d,this},f.prototype.start=function(d){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var g in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(g),this._valuesStart[g]=this._valuesStartRepeat[g];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==d?"string"==typeof d?Cc()+parseFloat(d):d:Cc(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},f.prototype._setupProperties=function(d,g,v,I){for(var B in v){var X=d[B],Q=Array.isArray(X),de=Q?"array":typeof X,ie=!Q&&Array.isArray(v[B]);if("undefined"!==de&&"function"!==de){if(ie){var be=v[B];if(0===be.length)continue;be=be.map(this._handleRelativeValue.bind(this,X)),v[B]=[X].concat(be)}if("object"!==de&&!Q||!X||ie)void 0===g[B]&&(g[B]=X),Q||(g[B]*=1),I[B]=ie?v[B].slice().reverse():g[B]||0;else{for(var fe in g[B]=Q?[]:{},X)g[B][fe]=X[fe];I[B]=Q?[]:{},this._setupProperties(X,g[B],v[B],I[B])}}}},f.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},f.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},f.prototype.pause=function(d){return void 0===d&&(d=Cc()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=d,this._group&&this._group.remove(this)),this},f.prototype.resume=function(d){return void 0===d&&(d=Cc()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=d-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},f.prototype.stopChainedTweens=function(){for(var d=0,g=this._chainedTweens.length;d<g;d++)this._chainedTweens[d].stop();return this},f.prototype.group=function(d){return this._group=d,this},f.prototype.delay=function(d){return this._delayTime=d,this},f.prototype.repeat=function(d){return this._initialRepeat=d,this._repeat=d,this},f.prototype.repeatDelay=function(d){return this._repeatDelayTime=d,this},f.prototype.yoyo=function(d){return this._yoyo=d,this},f.prototype.easing=function(d){return this._easingFunction=d,this},f.prototype.interpolation=function(d){return this._interpolationFunction=d,this},f.prototype.chain=function(){for(var d=[],g=0;g<arguments.length;g++)d[g]=arguments[g];return this._chainedTweens=d,this},f.prototype.onStart=function(d){return this._onStartCallback=d,this},f.prototype.onUpdate=function(d){return this._onUpdateCallback=d,this},f.prototype.onRepeat=function(d){return this._onRepeatCallback=d,this},f.prototype.onComplete=function(d){return this._onCompleteCallback=d,this},f.prototype.onStop=function(d){return this._onStopCallback=d,this},f.prototype.update=function(d,g){if(void 0===d&&(d=Cc()),void 0===g&&(g=!0),this._isPaused)return!0;var v,I;if(!this._goToEnd&&!this._isPlaying){if(d>this._startTime+this._duration)return!1;g&&this.start(d)}if(this._goToEnd=!1,d<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),I=(d-this._startTime)/this._duration;var X=this._easingFunction(I=0===this._duration||I>1?1:I);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,X),this._onUpdateCallback&&this._onUpdateCallback(this._object,I),1===I){if(this._repeat>0){for(v in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)!this._yoyo&&"string"==typeof this._valuesEnd[v]&&(this._valuesStartRepeat[v]=this._valuesStartRepeat[v]+parseFloat(this._valuesEnd[v])),this._yoyo&&this._swapEndStartRepeatValues(v),this._valuesStart[v]=this._valuesStartRepeat[v];return this._yoyo&&(this._reversed=!this._reversed),this._startTime=void 0!==this._repeatDelayTime?d+this._repeatDelayTime:d+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var Q=0,de=this._chainedTweens.length;Q<de;Q++)this._chainedTweens[Q].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},f.prototype._updateProperties=function(d,g,v,I){for(var B in v)if(void 0!==g[B]){var X=g[B]||0,Q=v[B],de=Array.isArray(d[B]),ie=Array.isArray(Q);!de&&ie?d[B]=this._interpolationFunction(Q,I):"object"==typeof Q&&Q?this._updateProperties(d[B],X,Q,I):"number"==typeof(Q=this._handleRelativeValue(X,Q))&&(d[B]=X+(Q-X)*I)}},f.prototype._handleRelativeValue=function(d,g){return"string"!=typeof g?g:"+"===g.charAt(0)||"-"===g.charAt(0)?d+parseFloat(g):parseFloat(g)},f.prototype._swapEndStartRepeatValues=function(d){var g=this._valuesStartRepeat[d],v=this._valuesEnd[d];this._valuesStartRepeat[d]="string"==typeof v?this._valuesStartRepeat[d]+parseFloat(v):this._valuesEnd[d],this._valuesEnd[d]=g},f}(),Jl=Bf.nextId,Wo=Nh,Fh=Wo.getAll.bind(Wo),ig=Wo.removeAll.bind(Wo),sg=Wo.add.bind(Wo),og=Wo.remove.bind(Wo),ag=Wo.update.bind(Wo);const Pu={Easing:Du,Group:Tc,Interpolation:Iu,now:Cc,Sequence:Bf,nextId:Jl,Tween:ng,VERSION:"18.6.4",getAll:Fh,removeAll:ig,add:sg,remove:og,update:ag};function dg(f,d,g){return d in f?Object.defineProperty(f,d,{value:g,enumerable:!0,configurable:!0,writable:!0}):f[d]=g,f}function fg(f,d){return function(f){if(Array.isArray(f))return f}(f)||function(f,d){var g=null==f?null:"undefined"!=typeof Symbol&&f[Symbol.iterator]||f["@@iterator"];if(null!=g){var X,Q,v=[],I=!0,B=!1;try{for(g=g.call(f);!(I=(X=g.next()).done)&&(v.push(X.value),!d||v.length!==d);I=!0);}catch(de){B=!0,Q=de}finally{try{!I&&null!=g.return&&g.return()}finally{if(B)throw Q}}return v}}(f,d)||Lu(f,d)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zd(f){return function(f){if(Array.isArray(f))return Qd(f)}(f)||function(f){if("undefined"!=typeof Symbol&&null!=f[Symbol.iterator]||null!=f["@@iterator"])return Array.from(f)}(f)||Lu(f)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lu(f,d){if(f){if("string"==typeof f)return Qd(f,d);var g=Object.prototype.toString.call(f).slice(8,-1);if("Object"===g&&f.constructor&&(g=f.constructor.name),"Map"===g||"Set"===g)return Array.from(f);if("Arguments"===g||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return Qd(f,d)}}function Qd(f,d){(null==d||d>f.length)&&(d=f.length);for(var g=0,v=new Array(d);g<d;g++)v[g]=f[g];return v}!function(f,d){void 0===d&&(d={});var g=d.insertAt;if("undefined"!=typeof document){var v=document.head||document.getElementsByTagName("head")[0],I=document.createElement("style");I.type="text/css","top"===g&&v.firstChild?v.insertBefore(I,v.firstChild):v.appendChild(I),I.styleSheet?I.styleSheet.cssText=f:I.appendChild(document.createTextNode(f))}}(".scene-nav-info {\n  bottom: 5px;\n  width: 100%;\n  text-align: center;\n  color: slategrey;\n  opacity: 0.7;\n  font-size: 10px;\n}\n\n.scene-tooltip {\n  color: lavender;\n  font-size: 15px;\n}\n\n.scene-nav-info, .scene-tooltip {\n  position: absolute;\n  font-family: sans-serif;\n  pointer-events: none;\n}\n\n.scene-container canvas:focus {\n  outline: none;\n}");var ws=window.THREE?window.THREE:{WebGLRenderer:G.CP7,Scene:G.xsS,PerspectiveCamera:G.cPb,Raycaster:G.iMs,TextureLoader:G.dpR,Vector2:G.FM8,Vector3:G.Pa4,Box3:G.ZzF,Color:G.Ilk,Mesh:G.Kj0,SphereGeometry:G.xo$,MeshBasicMaterial:G.vBJ,BackSide:G._Li,EventDispatcher:G.pBf,MOUSE:G.RsA,Quaternion:G._fP,Spherical:G.$V,Clock:G.SUY};const pg=gt({props:{width:{default:window.innerWidth,onChange:function(d,g,v){isNaN(d)&&(g.width=v)}},height:{default:window.innerHeight,onChange:function(d,g,v){isNaN(d)&&(g.height=v)}},backgroundColor:{default:"#000011"},backgroundImageUrl:{},onBackgroundImageLoaded:{},showNavInfo:{default:!0},skyRadius:{default:5e4},objects:{default:[]},enablePointerInteraction:{default:!0,onChange:function(d,g){g.hoverObj=null,g.toolTipElem&&(g.toolTipElem.innerHTML="")},triggerUpdate:!1},lineHoverPrecision:{default:1,triggerUpdate:!1},hoverOrderComparator:{default:function(){return-1},triggerUpdate:!1},hoverFilter:{default:function(){return!0},triggerUpdate:!1},tooltipContent:{triggerUpdate:!1},hoverDuringDrag:{default:!1,triggerUpdate:!1},clickAfterDrag:{default:!1,triggerUpdate:!1},onHover:{default:function(){},triggerUpdate:!1},onClick:{default:function(){},triggerUpdate:!1},onRightClick:{triggerUpdate:!1}},methods:{tick:function(d){if(d.initialised){if(d.controls.update&&d.controls.update(d.clock.getDelta()),d.postProcessingComposer?d.postProcessingComposer.render():d.renderer.render(d.scene,d.camera),d.extraRenderers.forEach(function(B){return B.render(d.scene,d.camera)}),d.enablePointerInteraction){var g=null;if(d.hoverDuringDrag||!d.isPointerDragging){var v=this.intersectingObjects(d.pointerPos.x,d.pointerPos.y).filter(function(B){return d.hoverFilter(B.object)}).sort(function(B,X){return d.hoverOrderComparator(B.object,X.object)}),I=v.length?v[0]:null;g=I?I.object:null,d.intersectionPoint=I?I.point:null}g!==d.hoverObj&&(d.onHover(g,d.hoverObj),d.toolTipElem.innerHTML=g&&mn(d.tooltipContent)(g)||"",d.hoverObj=g)}Pu.update()}return this},getPointerPos:function(d){var g=d.pointerPos;return{x:g.x,y:g.y}},cameraPosition:function(d,g,v,I){var B=d.camera;if(g&&d.initialised){var X=g,Q=v||{x:0,y:0,z:0};if(I){var de=Object.assign({},B.position),ie=xe();new Pu.Tween(de).to(X,I).easing(Pu.Easing.Quadratic.Out).onUpdate(be).start(),new Pu.Tween(ie).to(Q,I/3).easing(Pu.Easing.Quadratic.Out).onUpdate(fe).start()}else be(X),fe(Q);return this}return Object.assign({},B.position,{lookAt:xe()});function be(Oe){var Pe=Oe.x,Ye=Oe.y,$e=Oe.z;void 0!==Pe&&(B.position.x=Pe),void 0!==Ye&&(B.position.y=Ye),void 0!==$e&&(B.position.z=$e)}function fe(Oe){d.controls.target=new ws.Vector3(Oe.x,Oe.y,Oe.z)}function xe(){return Object.assign(new ws.Vector3(0,0,-1e3).applyQuaternion(B.quaternion).add(B.position))}},zoomToFit:function(d){for(var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,I=arguments.length,B=new Array(I>3?I-3:0),X=3;X<I;X++)B[X-3]=arguments[X];return this.fitToBbox(this.getBbox.apply(this,B),g,v)},fitToBbox:function(d,g){var v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,I=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,B=d.camera;if(g){var X=new ws.Vector3(0,0,0),Q=2*Math.max.apply(Math,Zd(Object.entries(g).map(function(Oe){var Pe=fg(Oe,2),Ye=Pe[0];return Math.max.apply(Math,Zd(Pe[1].map(function(Ce){return Math.abs(X[Ye]-Ce)})))}))),de=(1-2*I/d.height)*B.fov,ie=Q/Math.atan(de*Math.PI/180),be=ie/B.aspect,fe=Math.max(ie,be);if(fe>0){var xe=X.clone().sub(B.position).normalize().multiplyScalar(-fe);this.cameraPosition(xe,X,v)}}return this},getBbox:function(d){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},v=new ws.Box3(new ws.Vector3(0,0,0),new ws.Vector3(0,0,0)),I=d.objects.filter(g);return I.length?(I.forEach(function(B){return v.expandByObject(B)}),Object.assign.apply(Object,Zd(["x","y","z"].map(function(B){return dg({},B,[v.min[B],v.max[B]])})))):null},getScreenCoords:function(d,g,v,I){var B=new ws.Vector3(g,v,I);return B.project(this.camera()),{x:(B.x+1)*d.width/2,y:-(B.y-1)*d.height/2}},getSceneCoords:function(d,g,v){var I=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,B=new ws.Vector2(g/d.width*2-1,-v/d.height*2+1),X=new ws.Raycaster;return X.setFromCamera(B,d.camera),Object.assign({},X.ray.at(I,new ws.Vector3))},intersectingObjects:function(d,g,v){var I=new ws.Vector2(g/d.width*2-1,-v/d.height*2+1),B=new ws.Raycaster;return B.params.Line.threshold=d.lineHoverPrecision,B.setFromCamera(I,d.camera),B.intersectObjects(d.objects,!0)},renderer:function(d){return d.renderer},scene:function(d){return d.scene},camera:function(d){return d.camera},postProcessingComposer:function(d){return d.postProcessingComposer},controls:function(d){return d.controls},tbControls:function(d){return d.controls}},stateInit:function(){return{scene:new ws.Scene,camera:new ws.PerspectiveCamera,clock:new ws.Clock}},init:function(d,g){var v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},I=v.controlType,B=void 0===I?"trackball":I,X=v.rendererConfig,Q=void 0===X?{}:X,de=v.extraRenderers,ie=void 0===de?[]:de,be=v.waitForLoadComplete,fe=void 0===be||be;d.innerHTML="",d.appendChild(g.container=document.createElement("div")),g.container.className="scene-container",g.container.style.position="relative",g.container.appendChild(g.navInfo=document.createElement("div")),g.navInfo.className="scene-nav-info",g.navInfo.textContent={orbit:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",trackball:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",fly:"WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw"}[B]||"",g.navInfo.style.display=g.showNavInfo?null:"none",g.toolTipElem=document.createElement("div"),g.toolTipElem.classList.add("scene-tooltip"),g.container.appendChild(g.toolTipElem),g.pointerPos=new ws.Vector2,g.pointerPos.x=-2,g.pointerPos.y=-2,["pointermove","pointerdown"].forEach(function(xe){return g.container.addEventListener(xe,function(Oe){if("pointerdown"===xe&&(g.isPointerPressed=!0),!g.isPointerDragging&&"pointermove"===Oe.type&&(Oe.pressure>0||g.isPointerPressed)&&("touch"!==Oe.pointerType||void 0===Oe.movementX||[Oe.movementX,Oe.movementY].some(function($e){return Math.abs($e)>1}))&&(g.isPointerDragging=!0),g.enablePointerInteraction){var Pe=(Ce=g.container.getBoundingClientRect(),Et=window.pageXOffset||document.documentElement.scrollLeft,ht=window.pageYOffset||document.documentElement.scrollTop,{top:Ce.top+ht,left:Ce.left+Et});g.pointerPos.x=Oe.pageX-Pe.left,g.pointerPos.y=Oe.pageY-Pe.top,g.toolTipElem.style.top="".concat(g.pointerPos.y,"px"),g.toolTipElem.style.left="".concat(g.pointerPos.x,"px"),g.toolTipElem.style.transform="translate(-".concat(g.pointerPos.x/g.width*100,"%, 21px)")}var Ce,Et,ht},{passive:!0})}),g.container.addEventListener("pointerup",function(xe){g.isPointerPressed=!1,(!g.isPointerDragging||(g.isPointerDragging=!1,g.clickAfterDrag))&&requestAnimationFrame(function(){0===xe.button&&g.onClick(g.hoverObj||null,xe,g.intersectionPoint),2===xe.button&&g.onRightClick&&g.onRightClick(g.hoverObj||null,xe,g.intersectionPoint)})},{passive:!0,capture:!0}),g.container.addEventListener("contextmenu",function(xe){g.onRightClick&&xe.preventDefault()}),g.renderer=new ws.WebGLRenderer(Object.assign({antialias:!0,alpha:!0},Q)),g.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio)),g.container.appendChild(g.renderer.domElement),g.extraRenderers=ie,g.extraRenderers.forEach(function(xe){xe.domElement.style.position="absolute",xe.domElement.style.top="0px",xe.domElement.style.pointerEvents="none",g.container.appendChild(xe.domElement)}),g.postProcessingComposer=new ui(g.renderer),g.postProcessingComposer.addPass(new xa(g.scene,g.camera)),g.controls=new{trackball:Ja,orbit:Hr,fly:xu}[B](g.camera,g.renderer.domElement),"fly"===B&&(g.controls.movementSpeed=300,g.controls.rollSpeed=Math.PI/6,g.controls.dragToLook=!0),("trackball"===B||"orbit"===B)&&(g.controls.minDistance=.1,g.controls.maxDistance=g.skyRadius,g.controls.addEventListener("start",function(){g.controlsEngaged=!0}),g.controls.addEventListener("change",function(){g.controlsEngaged&&(g.controlsDragging=!0)}),g.controls.addEventListener("end",function(){g.controlsEngaged=!1,g.controlsDragging=!1})),[g.renderer,g.postProcessingComposer].concat(Zd(g.extraRenderers)).forEach(function(xe){return xe.setSize(g.width,g.height)}),g.camera.aspect=g.width/g.height,g.camera.updateProjectionMatrix(),g.camera.position.z=1e3,g.scene.add(g.skysphere=new ws.Mesh),g.skysphere.visible=!1,g.loadComplete=g.scene.visible=!fe,window.scene=g.scene},update:function(d,g){if(d.width&&d.height&&(g.hasOwnProperty("width")||g.hasOwnProperty("height"))&&(d.container.style.width=d.width,d.container.style.height=d.height,[d.renderer,d.postProcessingComposer].concat(Zd(d.extraRenderers)).forEach(function(B){return B.setSize(d.width,d.height)}),d.camera.aspect=d.width/d.height,d.camera.updateProjectionMatrix()),g.hasOwnProperty("skyRadius")&&d.skyRadius&&(d.controls.hasOwnProperty("maxDistance")&&g.skyRadius&&(d.controls.maxDistance=d.skyRadius),d.camera.far=2.5*d.skyRadius,d.camera.updateProjectionMatrix(),d.skysphere.geometry=new ws.SphereGeometry(d.skyRadius)),g.hasOwnProperty("backgroundColor")){var v=rn(d.backgroundColor).alpha;void 0===v&&(v=1),d.renderer.setClearColor(new ws.Color(ad(1,d.backgroundColor)),v)}function I(){d.loadComplete=d.scene.visible=!0}g.hasOwnProperty("backgroundImageUrl")&&(d.backgroundImageUrl?(new ws.TextureLoader).load(d.backgroundImageUrl,function(B){d.skysphere.material=new ws.MeshBasicMaterial({map:B,side:ws.BackSide}),d.skysphere.visible=!0,d.onBackgroundImageLoaded&&setTimeout(d.onBackgroundImageLoaded),!d.loadComplete&&I()}):(d.skysphere.visible=!1,d.skysphere.material.map=null,!d.loadComplete&&I())),g.hasOwnProperty("showNavInfo")&&(d.navInfo.style.display=d.showNavInfo?null:"none"),g.hasOwnProperty("objects")&&((g.objects||[]).forEach(function(B){return d.scene.remove(B)}),d.objects.forEach(function(B){return d.scene.add(B)}))}});function Kd(f,d){var g=Object.keys(f);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(f);d&&(v=v.filter(function(I){return Object.getOwnPropertyDescriptor(f,I).enumerable})),g.push.apply(g,v)}return g}function zf(f){for(var d=1;d<arguments.length;d++){var g=null!=arguments[d]?arguments[d]:{};d%2?Kd(Object(g),!0).forEach(function(v){Jd(f,v,g[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(g)):Kd(Object(g)).forEach(function(v){Object.defineProperty(f,v,Object.getOwnPropertyDescriptor(g,v))})}return f}function Jd(f,d,g){return d in f?Object.defineProperty(f,d,{value:g,enumerable:!0,configurable:!0,writable:!0}):f[d]=g,f}function fd(f){return function(f){if(Array.isArray(f))return Hf(f)}(f)||function(f){if("undefined"!=typeof Symbol&&null!=f[Symbol.iterator]||null!=f["@@iterator"])return Array.from(f)}(f)||function(f,d){if(f){if("string"==typeof f)return Hf(f,d);var g=Object.prototype.toString.call(f).slice(8,-1);if("Object"===g&&f.constructor&&(g=f.constructor.name),"Map"===g||"Set"===g)return Array.from(f);if("Arguments"===g||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return Hf(f,d)}}(f)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hf(f,d){(null==d||d>f.length)&&(d=f.length);for(var g=0,v=new Array(d);g<d;g++)v[g]=f[g];return v}function hd(f,d){var g=new d;return{linkProp:function(I){return{default:g[I](),onChange:function(X,Q){Q[f][I](X)},triggerUpdate:!1}},linkMethod:function(I){return function(B){for(var X=B[f],Q=arguments.length,de=new Array(Q>1?Q-1:0),ie=1;ie<Q;ie++)de[ie-1]=arguments[ie];var be=X[I].apply(X,de);return be===X?this:be}}}}!function(f,d){void 0===d&&(d={});var g=d.insertAt;if("undefined"!=typeof document){var v=document.head||document.getElementsByTagName("head")[0],I=document.createElement("style");I.type="text/css","top"===g&&v.firstChild?v.insertBefore(I,v.firstChild):v.appendChild(I),I.styleSheet?I.styleSheet.cssText=f:I.appendChild(document.createTextNode(f))}}(".graph-info-msg {\n  top: 50%;\n  width: 100%;\n  text-align: center;\n  color: lavender;\n  opacity: 0.7;\n  font-size: 22px;\n  position: absolute;\n  font-family: Sans-serif;\n}\n\n.scene-container .clickable {\n  cursor: pointer;\n}\n\n.scene-container .grabbable {\n  cursor: move;\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n\n.scene-container .grabbable:active {\n  cursor: grabbing;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n}");var Gf=window.THREE?window.THREE:{AmbientLight:G.Mig,DirectionalLight:G.Ox3,Vector3:G.Pa4},zh=hd("forceGraph",Ts),Es=Object.assign.apply(Object,fd(["jsonUrl","graphData","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeColor","nodeAutoColorBy","nodeOpacity","nodeVisibility","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaDecay","d3VelocityDecay","d3AlphaMin","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(f){return Jd({},f,zh.linkProp(f))}))),vg=Object.assign.apply(Object,fd(["refresh","getGraphBbox","d3Force","d3ReheatSimulation","emitParticle"].map(function(f){return Jd({},f,zh.linkMethod(f))}))),ef=hd("renderObjs",pg),Wf=Object.assign.apply(Object,fd(["width","height","backgroundColor","showNavInfo","enablePointerInteraction"].map(function(f){return Jd({},f,ef.linkProp(f))}))),Hh=Object.assign.apply(Object,fd(["cameraPosition","postProcessingComposer"].map(function(f){return Jd({},f,ef.linkMethod(f))})).concat([{graph2ScreenCoords:ef.linkMethod("getScreenCoords"),screen2GraphCoords:ef.linkMethod("getSceneCoords")}]));function ec(f){for(var d=f;d&&!d.hasOwnProperty("__graphObjType");)d=d.parent;return d}const bg=gt({props:zf(zf({nodeLabel:{default:"name",triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:1,onChange:function(d,g){return g.renderObjs.lineHoverPrecision(d)},triggerUpdate:!1},enableNavigationControls:{default:!0,onChange:function(d,g){var v=g.renderObjs.controls();v&&(v.enabled=d)},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1}},Es),Wf),methods:zf(zf({zoomToFit:function(d,g,v){for(var I,B=arguments.length,X=new Array(B>3?B-3:0),Q=3;Q<B;Q++)X[Q-3]=arguments[Q];return d.renderObjs.fitToBbox((I=d.forceGraph).getGraphBbox.apply(I,X),g,v),this},pauseAnimation:function(d){return null!==d.animationFrameRequestId&&(cancelAnimationFrame(d.animationFrameRequestId),d.animationFrameRequestId=null),this},resumeAnimation:function(d){return null===d.animationFrameRequestId&&this._animationCycle(),this},_animationCycle:function(d){d.enablePointerInteraction&&(this.renderer().domElement.style.cursor=null),d.forceGraph.tickFrame(),d.renderObjs.tick(),d.animationFrameRequestId=requestAnimationFrame(this._animationCycle)},scene:function(d){return d.renderObjs.scene()},camera:function(d){return d.renderObjs.camera()},renderer:function(d){return d.renderObjs.renderer()},controls:function(d){return d.renderObjs.controls()},tbControls:function(d){return d.renderObjs.tbControls()},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},vg),Hh),stateInit:function(d){var g=d.controlType,v=d.rendererConfig,I=d.extraRenderers;return{forceGraph:new Ts,renderObjs:pg({controlType:g,rendererConfig:v,extraRenderers:I})}},init:function(d,g){d.innerHTML="",d.appendChild(g.container=document.createElement("div")),g.container.style.position="relative";var v=document.createElement("div");g.container.appendChild(v),g.renderObjs(v);var Q,I=g.renderObjs.camera(),B=g.renderObjs.renderer(),X=g.renderObjs.controls();X.enabled=!!g.enableNavigationControls,g.lastSetCameraZ=I.position.z,g.container.appendChild(Q=document.createElement("div")),Q.className="graph-info-msg",Q.textContent="",g.forceGraph.onLoading(function(){Q.textContent="Loading..."}).onFinishLoading(function(){Q.textContent=""}).onUpdate(function(){g.graphData=g.forceGraph.graphData(),0===I.position.x&&0===I.position.y&&I.position.z===g.lastSetCameraZ&&g.graphData.nodes.length&&(I.lookAt(g.forceGraph.position),g.lastSetCameraZ=I.position.z=170*Math.cbrt(g.graphData.nodes.length))}).onFinishUpdate(function(){if(g._dragControls){var de=g.graphData.nodes.find(function(be){return be.__initialFixedPos&&!be.__disposeControlsAfterDrag});de?de.__disposeControlsAfterDrag=!0:g._dragControls.dispose(),g._dragControls=void 0}if(g.enableNodeDrag&&g.enablePointerInteraction&&"d3"===g.forceEngine){var ie=g._dragControls=new Be(g.graphData.nodes.map(function(be){return be.__threeObj}).filter(function(be){return be}),I,B.domElement);ie.addEventListener("dragstart",function(be){X.enabled=!1,be.object.__initialPos=be.object.position.clone(),be.object.__prevPos=be.object.position.clone();var fe=ec(be.object).__data;!fe.__initialFixedPos&&(fe.__initialFixedPos={fx:fe.fx,fy:fe.fy,fz:fe.fz}),!fe.__initialPos&&(fe.__initialPos={x:fe.x,y:fe.y,z:fe.z}),["x","y","z"].forEach(function(xe){return fe["f".concat(xe)]=fe[xe]}),B.domElement.classList.add("grabbable")}),ie.addEventListener("drag",function(be){var fe=ec(be.object);if(!be.object.hasOwnProperty("__graphObjType")){var xe=be.object.__initialPos,Oe=be.object.__prevPos,Pe=be.object.position;fe.position.add(Pe.clone().sub(Oe)),Oe.copy(Pe),Pe.copy(xe)}var Ye=fe.__data,$e=fe.position,Ce={x:$e.x-Ye.x,y:$e.y-Ye.y,z:$e.z-Ye.z};["x","y","z"].forEach(function(Et){return Ye["f".concat(Et)]=Ye[Et]=$e[Et]}),g.forceGraph.d3AlphaTarget(.3).resetCountdown(),Ye.__dragged=!0,g.onNodeDrag(Ye,Ce)}),ie.addEventListener("dragend",function(be){delete be.object.__initialPos,delete be.object.__prevPos;var fe=ec(be.object).__data;fe.__disposeControlsAfterDrag&&(ie.dispose(),delete fe.__disposeControlsAfterDrag);var xe=fe.__initialFixedPos,Oe=fe.__initialPos,Pe={x:Oe.x-fe.x,y:Oe.y-fe.y,z:Oe.z-fe.z};xe&&(["x","y","z"].forEach(function(Ye){var $e="f".concat(Ye);void 0===xe[$e]&&delete fe[$e]}),delete fe.__initialFixedPos,delete fe.__initialPos,fe.__dragged&&(delete fe.__dragged,g.onNodeDragEnd(fe,Pe))),g.forceGraph.d3AlphaTarget(0).resetCountdown(),g.enableNavigationControls&&(X.enabled=!0,X.domElement&&X.domElement.ownerDocument&&X.domElement.ownerDocument.dispatchEvent(new PointerEvent("pointerup",{pointerType:"touch"}))),B.domElement.classList.remove("grabbable")})}}),g.renderObjs.objects([new Gf.AmbientLight(12303291),new Gf.DirectionalLight(16777215,.6),g.forceGraph]).hoverOrderComparator(function(de,ie){var be=ec(de);if(!be)return 1;var fe=ec(ie);if(!fe)return-1;var xe=function(Pe){return"node"===Pe.__graphObjType};return xe(fe)-xe(be)}).tooltipContent(function(de){var ie=ec(de);return ie&&mn(g["".concat(ie.__graphObjType,"Label")])(ie.__data)||""}).hoverDuringDrag(!1).onHover(function(de){var ie=ec(de);if(ie!==g.hoverObj){var be=g.hoverObj?g.hoverObj.__graphObjType:null,fe=g.hoverObj?g.hoverObj.__data:null,xe=ie?ie.__graphObjType:null,Oe=ie?ie.__data:null;if(be&&be!==xe){var Pe=g["on".concat("node"===be?"Node":"Link","Hover")];Pe&&Pe(null,fe)}if(xe){var Ye=g["on".concat("node"===xe?"Node":"Link","Hover")];Ye&&Ye(Oe,be===xe?fe:null)}B.domElement.classList[ie&&g["on".concat("node"===xe?"Node":"Link","Click")]||!ie&&g.onBackgroundClick?"add":"remove"]("clickable"),g.hoverObj=ie}}).clickAfterDrag(!1).onClick(function(de,ie){var be=ec(de);if(be){var fe=g["on".concat("node"===be.__graphObjType?"Node":"Link","Click")];fe&&fe(be.__data,ie)}else g.onBackgroundClick&&g.onBackgroundClick(ie)}).onRightClick(function(de,ie){var be=ec(de);if(be){var fe=g["on".concat("node"===be.__graphObjType?"Node":"Link","RightClick")];fe&&fe(be.__data,ie)}else g.onBackgroundRightClick&&g.onBackgroundRightClick(ie)}),this._animationCycle()}})},8583:(Nt,ut,se)=>{"use strict";se.d(ut,{mr:()=>Wt,Ov:()=>ya,ez:()=>Za,K0:()=>Te,Do:()=>hn,V_:()=>J,Ye:()=>an,S$:()=>kt,mk:()=>On,sg:()=>Ui,O5:()=>Ds,PC:()=>Jo,b0:()=>zt,lw:()=>Fe,EM:()=>mc,JF:()=>Is,w_:()=>Me,bD:()=>Ra,q:()=>We,Mx:()=>gt,HT:()=>Ae});var G=se(639);let $=null;function We(){return $}function Ae(U){$||($=U)}class Me{}const Te=new G.OlP("DocumentToken");let Fe=(()=>{class U{historyGo(z){throw new Error("Not implemented")}}return U.\u0275fac=function(z){return new(z||U)},U.\u0275prov=(0,G.Yz7)({factory:Be,token:U,providedIn:"platform"}),U})();function Be(){return(0,G.LFG)(K)}const J=new G.OlP("Location Initialized");let K=(()=>{class U extends Fe{constructor(z){super(),this._doc=z,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return We().getBaseHref(this._doc)}onPopState(z){const te=We().getGlobalEventTarget(this._doc,"window");return te.addEventListener("popstate",z,!1),()=>te.removeEventListener("popstate",z)}onHashChange(z){const te=We().getGlobalEventTarget(this._doc,"window");return te.addEventListener("hashchange",z,!1),()=>te.removeEventListener("hashchange",z)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(z){this.location.pathname=z}pushState(z,te,Ne){_e()?this._history.pushState(z,te,Ne):this.location.hash=Ne}replaceState(z,te,Ne){_e()?this._history.replaceState(z,te,Ne):this.location.hash=Ne}forward(){this._history.forward()}back(){this._history.back()}historyGo(z=0){this._history.go(z)}getState(){return this._history.state}}return U.\u0275fac=function(z){return new(z||U)(G.LFG(Te))},U.\u0275prov=(0,G.Yz7)({factory:Ue,token:U,providedIn:"platform"}),U})();function _e(){return!!window.history.pushState}function Ue(){return new K((0,G.LFG)(Te))}function Ve(U,Z){if(0==U.length)return Z;if(0==Z.length)return U;let z=0;return U.endsWith("/")&&z++,Z.startsWith("/")&&z++,2==z?U+Z.substring(1):1==z?U+Z:U+"/"+Z}function at(U){const Z=U.match(/#|\?|$/),z=Z&&Z.index||U.length;return U.slice(0,z-("/"===U[z-1]?1:0))+U.slice(z)}function Xe(U){return U&&"?"!==U[0]?"?"+U:U}let kt=(()=>{class U{historyGo(z){throw new Error("Not implemented")}}return U.\u0275fac=function(z){return new(z||U)},U.\u0275prov=(0,G.Yz7)({factory:St,token:U,providedIn:"root"}),U})();function St(U){const Z=(0,G.LFG)(Te).location;return new zt((0,G.LFG)(Fe),Z&&Z.origin||"")}const Wt=new G.OlP("appBaseHref");let zt=(()=>{class U extends kt{constructor(z,te){if(super(),this._platformLocation=z,this._removeListenerFns=[],null==te&&(te=this._platformLocation.getBaseHrefFromDOM()),null==te)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=te}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(z){this._removeListenerFns.push(this._platformLocation.onPopState(z),this._platformLocation.onHashChange(z))}getBaseHref(){return this._baseHref}prepareExternalUrl(z){return Ve(this._baseHref,z)}path(z=!1){const te=this._platformLocation.pathname+Xe(this._platformLocation.search),Ne=this._platformLocation.hash;return Ne&&z?`${te}${Ne}`:te}pushState(z,te,Ne,mt){const Vt=this.prepareExternalUrl(Ne+Xe(mt));this._platformLocation.pushState(z,te,Vt)}replaceState(z,te,Ne,mt){const Vt=this.prepareExternalUrl(Ne+Xe(mt));this._platformLocation.replaceState(z,te,Vt)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(z=0){var te,Ne;null===(Ne=(te=this._platformLocation).historyGo)||void 0===Ne||Ne.call(te,z)}}return U.\u0275fac=function(z){return new(z||U)(G.LFG(Fe),G.LFG(Wt,8))},U.\u0275prov=G.Yz7({token:U,factory:U.\u0275fac}),U})(),hn=(()=>{class U extends kt{constructor(z,te){super(),this._platformLocation=z,this._baseHref="",this._removeListenerFns=[],null!=te&&(this._baseHref=te)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(z){this._removeListenerFns.push(this._platformLocation.onPopState(z),this._platformLocation.onHashChange(z))}getBaseHref(){return this._baseHref}path(z=!1){let te=this._platformLocation.hash;return null==te&&(te="#"),te.length>0?te.substring(1):te}prepareExternalUrl(z){const te=Ve(this._baseHref,z);return te.length>0?"#"+te:te}pushState(z,te,Ne,mt){let Vt=this.prepareExternalUrl(Ne+Xe(mt));0==Vt.length&&(Vt=this._platformLocation.pathname),this._platformLocation.pushState(z,te,Vt)}replaceState(z,te,Ne,mt){let Vt=this.prepareExternalUrl(Ne+Xe(mt));0==Vt.length&&(Vt=this._platformLocation.pathname),this._platformLocation.replaceState(z,te,Vt)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(z=0){var te,Ne;null===(Ne=(te=this._platformLocation).historyGo)||void 0===Ne||Ne.call(te,z)}}return U.\u0275fac=function(z){return new(z||U)(G.LFG(Fe),G.LFG(Wt,8))},U.\u0275prov=G.Yz7({token:U,factory:U.\u0275fac}),U})(),an=(()=>{class U{constructor(z,te){this._subject=new G.vpe,this._urlChangeListeners=[],this._platformStrategy=z;const Ne=this._platformStrategy.getBaseHref();this._platformLocation=te,this._baseHref=at(Cn(Ne)),this._platformStrategy.onPopState(mt=>{this._subject.emit({url:this.path(!0),pop:!0,state:mt.state,type:mt.type})})}path(z=!1){return this.normalize(this._platformStrategy.path(z))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(z,te=""){return this.path()==this.normalize(z+Xe(te))}normalize(z){return U.stripTrailingSlash(function(U,Z){return U&&Z.startsWith(U)?Z.substring(U.length):Z}(this._baseHref,Cn(z)))}prepareExternalUrl(z){return z&&"/"!==z[0]&&(z="/"+z),this._platformStrategy.prepareExternalUrl(z)}go(z,te="",Ne=null){this._platformStrategy.pushState(Ne,"",z,te),this._notifyUrlChangeListeners(this.prepareExternalUrl(z+Xe(te)),Ne)}replaceState(z,te="",Ne=null){this._platformStrategy.replaceState(Ne,"",z,te),this._notifyUrlChangeListeners(this.prepareExternalUrl(z+Xe(te)),Ne)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(z=0){var te,Ne;null===(Ne=(te=this._platformStrategy).historyGo)||void 0===Ne||Ne.call(te,z)}onUrlChange(z){this._urlChangeListeners.push(z),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(te=>{this._notifyUrlChangeListeners(te.url,te.state)}))}_notifyUrlChangeListeners(z="",te){this._urlChangeListeners.forEach(Ne=>Ne(z,te))}subscribe(z,te,Ne){return this._subject.subscribe({next:z,error:te,complete:Ne})}}return U.\u0275fac=function(z){return new(z||U)(G.LFG(kt),G.LFG(Fe))},U.normalizeQueryParams=Xe,U.joinWithSlash=Ve,U.stripTrailingSlash=at,U.\u0275prov=(0,G.Yz7)({factory:er,token:U,providedIn:"root"}),U})();function er(){return new an((0,G.LFG)(kt),(0,G.LFG)(Fe))}function Cn(U){return U.replace(/\/index.html$/,"")}var nn=(()=>((nn=nn||{})[nn.Zero=0]="Zero",nn[nn.One=1]="One",nn[nn.Two=2]="Two",nn[nn.Few=3]="Few",nn[nn.Many=4]="Many",nn[nn.Other=5]="Other",nn))();const pe=G.kL8;class He{}let ae=(()=>{class U extends He{constructor(z){super(),this.locale=z}getPluralCategory(z,te){switch(pe(te||this.locale)(z)){case nn.Zero:return"zero";case nn.One:return"one";case nn.Two:return"two";case nn.Few:return"few";case nn.Many:return"many";default:return"other"}}}return U.\u0275fac=function(z){return new(z||U)(G.LFG(G.soG))},U.\u0275prov=G.Yz7({token:U,factory:U.\u0275fac}),U})();function gt(U,Z){Z=encodeURIComponent(Z);for(const z of U.split(";")){const te=z.indexOf("="),[Ne,mt]=-1==te?[z,""]:[z.slice(0,te),z.slice(te+1)];if(Ne.trim()===Z)return decodeURIComponent(mt)}return null}let On=(()=>{class U{constructor(z,te,Ne,mt){this._iterableDiffers=z,this._keyValueDiffers=te,this._ngEl=Ne,this._renderer=mt,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(z){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof z?z.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(z){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof z?z.split(/\s+/):z,this._rawClass&&((0,G.sIi)(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const z=this._iterableDiffer.diff(this._rawClass);z&&this._applyIterableChanges(z)}else if(this._keyValueDiffer){const z=this._keyValueDiffer.diff(this._rawClass);z&&this._applyKeyValueChanges(z)}}_applyKeyValueChanges(z){z.forEachAddedItem(te=>this._toggleClass(te.key,te.currentValue)),z.forEachChangedItem(te=>this._toggleClass(te.key,te.currentValue)),z.forEachRemovedItem(te=>{te.previousValue&&this._toggleClass(te.key,!1)})}_applyIterableChanges(z){z.forEachAddedItem(te=>{if("string"!=typeof te.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${(0,G.AaK)(te.item)}`);this._toggleClass(te.item,!0)}),z.forEachRemovedItem(te=>this._toggleClass(te.item,!1))}_applyClasses(z){z&&(Array.isArray(z)||z instanceof Set?z.forEach(te=>this._toggleClass(te,!0)):Object.keys(z).forEach(te=>this._toggleClass(te,!!z[te])))}_removeClasses(z){z&&(Array.isArray(z)||z instanceof Set?z.forEach(te=>this._toggleClass(te,!1)):Object.keys(z).forEach(te=>this._toggleClass(te,!1)))}_toggleClass(z,te){(z=z.trim())&&z.split(/\s+/g).forEach(Ne=>{te?this._renderer.addClass(this._ngEl.nativeElement,Ne):this._renderer.removeClass(this._ngEl.nativeElement,Ne)})}}return U.\u0275fac=function(z){return new(z||U)(G.Y36(G.ZZ4),G.Y36(G.aQg),G.Y36(G.SBq),G.Y36(G.Qsj))},U.\u0275dir=G.lG2({type:U,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),U})();class In{constructor(Z,z,te,Ne){this.$implicit=Z,this.ngForOf=z,this.index=te,this.count=Ne}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Ui=(()=>{class U{constructor(z,te,Ne){this._viewContainer=z,this._template=te,this._differs=Ne,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(z){this._ngForOf=z,this._ngForOfDirty=!0}set ngForTrackBy(z){this._trackByFn=z}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(z){z&&(this._template=z)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const z=this._ngForOf;if(!this._differ&&z)try{this._differ=this._differs.find(z).create(this.ngForTrackBy)}catch(te){throw new Error(`Cannot find a differ supporting object '${z}' of type '${function(U){return U.name||typeof U}(z)}'. NgFor only supports binding to Iterables such as Arrays.`)}}if(this._differ){const z=this._differ.diff(this._ngForOf);z&&this._applyChanges(z)}}_applyChanges(z){const te=[];z.forEachOperation((Ne,mt,Vt)=>{if(null==Ne.previousIndex){const tr=this._viewContainer.createEmbeddedView(this._template,new In(null,this._ngForOf,-1,-1),null===Vt?void 0:Vt),Zn=new ao(Ne,tr);te.push(Zn)}else if(null==Vt)this._viewContainer.remove(null===mt?void 0:mt);else if(null!==mt){const tr=this._viewContainer.get(mt);this._viewContainer.move(tr,Vt);const Zn=new ao(Ne,tr);te.push(Zn)}});for(let Ne=0;Ne<te.length;Ne++)this._perViewChange(te[Ne].view,te[Ne].record);for(let Ne=0,mt=this._viewContainer.length;Ne<mt;Ne++){const Vt=this._viewContainer.get(Ne);Vt.context.index=Ne,Vt.context.count=mt,Vt.context.ngForOf=this._ngForOf}z.forEachIdentityChange(Ne=>{this._viewContainer.get(Ne.currentIndex).context.$implicit=Ne.item})}_perViewChange(z,te){z.context.$implicit=te.item}static ngTemplateContextGuard(z,te){return!0}}return U.\u0275fac=function(z){return new(z||U)(G.Y36(G.s_b),G.Y36(G.Rgc),G.Y36(G.ZZ4))},U.\u0275dir=G.lG2({type:U,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),U})();class ao{constructor(Z,z){this.record=Z,this.view=z}}let Ds=(()=>{class U{constructor(z,te){this._viewContainer=z,this._context=new ss,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=te}set ngIf(z){this._context.$implicit=this._context.ngIf=z,this._updateView()}set ngIfThen(z){lo("ngIfThen",z),this._thenTemplateRef=z,this._thenViewRef=null,this._updateView()}set ngIfElse(z){lo("ngIfElse",z),this._elseTemplateRef=z,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(z,te){return!0}}return U.\u0275fac=function(z){return new(z||U)(G.Y36(G.s_b),G.Y36(G.Rgc))},U.\u0275dir=G.lG2({type:U,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),U})();class ss{constructor(){this.$implicit=null,this.ngIf=null}}function lo(U,Z){if(Z&&!Z.createEmbeddedView)throw new Error(`${U} must be a TemplateRef, but received '${(0,G.AaK)(Z)}'.`)}let Jo=(()=>{class U{constructor(z,te,Ne){this._ngEl=z,this._differs=te,this._renderer=Ne,this._ngStyle=null,this._differ=null}set ngStyle(z){this._ngStyle=z,!this._differ&&z&&(this._differ=this._differs.find(z).create())}ngDoCheck(){if(this._differ){const z=this._differ.diff(this._ngStyle);z&&this._applyChanges(z)}}_setStyle(z,te){const[Ne,mt]=z.split(".");null!=(te=null!=te&&mt?`${te}${mt}`:te)?this._renderer.setStyle(this._ngEl.nativeElement,Ne,te):this._renderer.removeStyle(this._ngEl.nativeElement,Ne)}_applyChanges(z){z.forEachRemovedItem(te=>this._setStyle(te.key,null)),z.forEachAddedItem(te=>this._setStyle(te.key,te.currentValue)),z.forEachChangedItem(te=>this._setStyle(te.key,te.currentValue))}}return U.\u0275fac=function(z){return new(z||U)(G.Y36(G.SBq),G.Y36(G.aQg),G.Y36(G.Qsj))},U.\u0275dir=G.lG2({type:U,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),U})();class pc{createSubscription(Z,z){return Z.subscribe({next:z,error:te=>{throw te}})}dispose(Z){Z.unsubscribe()}onDestroy(Z){Z.unsubscribe()}}class co{createSubscription(Z,z){return Z.then(z,te=>{throw te})}dispose(Z){}onDestroy(Z){}}const Ks=new co,_l=new pc;let ya=(()=>{class U{constructor(z){this._ref=z,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(z){return this._obj?z!==this._obj?(this._dispose(),this.transform(z)):this._latestValue:(z&&this._subscribe(z),this._latestValue)}_subscribe(z){this._obj=z,this._strategy=this._selectStrategy(z),this._subscription=this._strategy.createSubscription(z,te=>this._updateLatestValue(z,te))}_selectStrategy(z){if((0,G.QGY)(z))return Ks;if((0,G.F4k)(z))return _l;throw function(U,Z){return Error(`InvalidPipeArgument: '${Z}' for pipe '${(0,G.AaK)(U)}'`)}(U,z)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(z,te){z===this._obj&&(this._latestValue=te,this._ref.markForCheck())}}return U.\u0275fac=function(z){return new(z||U)(G.Y36(G.sBO,16))},U.\u0275pipe=G.Yjl({name:"async",type:U,pure:!1}),U})(),Za=(()=>{class U{}return U.\u0275fac=function(z){return new(z||U)},U.\u0275mod=G.oAB({type:U}),U.\u0275inj=G.cJS({providers:[{provide:He,useClass:ae}]}),U})();const Ra="browser";let mc=(()=>{class U{}return U.\u0275prov=(0,G.Yz7)({token:U,providedIn:"root",factory:()=>new yc((0,G.LFG)(Te),window)}),U})();class yc{constructor(Z,z){this.document=Z,this.window=z,this.offset=()=>[0,0]}setOffset(Z){this.offset=Array.isArray(Z)?()=>Z:Z}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(Z){this.supportsScrolling()&&this.window.scrollTo(Z[0],Z[1])}scrollToAnchor(Z){if(!this.supportsScrolling())return;const z=function(U,Z){const z=U.getElementById(Z)||U.getElementsByName(Z)[0];if(z)return z;if("function"==typeof U.createTreeWalker&&U.body&&(U.body.createShadowRoot||U.body.attachShadow)){const te=U.createTreeWalker(U.body,NodeFilter.SHOW_ELEMENT);let Ne=te.currentNode;for(;Ne;){const mt=Ne.shadowRoot;if(mt){const Vt=mt.getElementById(Z)||mt.querySelector(`[name="${Z}"]`);if(Vt)return Vt}Ne=te.nextNode()}}return null}(this.document,Z);z&&(this.scrollToElement(z),this.attemptFocus(z))}setHistoryScrollRestoration(Z){if(this.supportScrollRestoration()){const z=this.window.history;z&&z.scrollRestoration&&(z.scrollRestoration=Z)}}scrollToElement(Z){const z=Z.getBoundingClientRect(),te=z.left+this.window.pageXOffset,Ne=z.top+this.window.pageYOffset,mt=this.offset();this.window.scrollTo(te-mt[0],Ne-mt[1])}attemptFocus(Z){return Z.focus(),this.document.activeElement===Z}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const Z=ra(this.window.history)||ra(Object.getPrototypeOf(this.window.history));return!(!Z||!Z.writable&&!Z.set)}catch(Z){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(Z){return!1}}}function ra(U){return Object.getOwnPropertyDescriptor(U,"scrollRestoration")}class Is{}},639:(Nt,ut,se)=>{"use strict";se.d(ut,{deG:()=>vr,tb:()=>LE,AFp:()=>RE,ip1:()=>Wb,CZH:()=>Gp,hGG:()=>tT,z2F:()=>iy,sBO:()=>WM,Sil:()=>ry,_Vd:()=>da,EJc:()=>NE,SBq:()=>Xu,qLn:()=>to,vpe:()=>Zu,gxx:()=>hl,tBr:()=>ld,XFs:()=>Vn,OlP:()=>Kt,zs3:()=>Fi,ZZ4:()=>uv,aQg:()=>dv,soG:()=>wv,YKP:()=>bw,v3s:()=>OC,h0i:()=>Mh,PXZ:()=>AC,R0b:()=>fc,FiY:()=>Sc,Lbi:()=>PE,g9A:()=>IE,Qsj:()=>RM,FYo:()=>cv,JOm:()=>Ns,Tiy:()=>_b,q3G:()=>Es,tp0:()=>Qc,EAV:()=>BC,Rgc:()=>Wm,dDg:()=>UE,DyG:()=>Gn,GfV:()=>fw,s_b:()=>pv,ifc:()=>zn,eFA:()=>WE,G48:()=>xC,_c5:()=>YC,VLi:()=>bC,c2e:()=>OE,zSh:()=>Oc,wAp:()=>r,vHH:()=>er,EiD:()=>Gf,mCW:()=>dd,qzn:()=>Wo,JVY:()=>ig,pB0:()=>lg,eBb:()=>og,L6k:()=>sg,LAX:()=>ag,cg1:()=>nv,Tjo:()=>$C,kL8:()=>pb,yhl:()=>Fh,dqk:()=>Xn,sIi:()=>hh,CqO:()=>Ap,QGY:()=>Tp,F4k:()=>V_,RDi:()=>mt,AaK:()=>Xe,z3N:()=>Jl,qOj:()=>bf,TTD:()=>hs,xp6:()=>Iy,uIk:()=>Ef,Suo:()=>aE,Xpm:()=>Zs,lG2:()=>$i,Yz7:()=>pe,cJS:()=>Ee,oAB:()=>so,Yjl:()=>Vs,Y36:()=>Cf,_UZ:()=>B_,qZA:()=>Dm,TgZ:()=>Am,EpF:()=>Im,n5z:()=>Le,Ikx:()=>tv,LFG:()=>us,$8M:()=>b,NdJ:()=>Dp,CRH:()=>lE,kcU:()=>Wn,O4$:()=>fo,oxw:()=>O0,ALo:()=>eE,lcZ:()=>tE,Dn7:()=>nE,Q6J:()=>Cm,VKq:()=>Yw,iGM:()=>sE,MAs:()=>m0,CHM:()=>bu,LSH:()=>Wf,kYT:()=>oo,YNc:()=>p0,W1O:()=>fE,_uU:()=>ks,Gf:()=>oE});var G=se(7574),$=se(4869),We=se(3282),Ze=se(6693),Me=se(9765),Te=se(5319),Fe=se(2441);var K=se(1307);function _e(){return new Me.xQ}function Ve(t){for(let n in t)if(t[n]===Ve)return n;throw Error("Could not find renamed property on target object.")}function at(t,n){for(const i in n)n.hasOwnProperty(i)&&!t.hasOwnProperty(i)&&(t[i]=n[i])}function Xe(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Xe).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const i=n.indexOf("\n");return-1===i?n:n.substring(0,i)}function kt(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const St=Ve({__forward_ref__:Ve});function Wt(t){return t.__forward_ref__=Wt,t.toString=function(){return Xe(this())},t}function zt(t){return hn(t)?t():t}function hn(t){return"function"==typeof t&&t.hasOwnProperty(St)&&t.__forward_ref__===Wt}class er extends Error{constructor(n,i){super(function(t,n){return`${t?`NG0${t}: `:""}${n}`}(n,i)),this.code=n}}function st(t){return"string"==typeof t?t:null==t?"":String(t)}function Bt(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():st(t)}function rr(t,n){const i=n?` in ${n}`:"";throw new er("201",`No provider for ${Bt(t)} found${i}`)}function Pn(t,n){null==t&&function(t,n,i,o){throw new Error(`ASSERTION ERROR: ${t}`+(null==o?"":` [Expected=> ${i} ${o} ${n} <=Actual]`))}(n,t,null,"!=")}function pe(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Ee(t){return{providers:t.providers||[],imports:t.imports||[]}}function Ut(t){return Mn(t,Mr)||Mn(t,Ti)}function Mn(t,n){return t.hasOwnProperty(n)?t[n]:null}function zr(t){return t&&(t.hasOwnProperty(Bi)||t.hasOwnProperty(Ii))?t[Bi]:null}const Mr=Ve({\u0275prov:Ve}),Bi=Ve({\u0275inj:Ve}),Ti=Ve({ngInjectableDef:Ve}),Ii=Ve({ngInjectorDef:Ve});var Vn=(()=>((Vn=Vn||{})[Vn.Default=0]="Default",Vn[Vn.Host=1]="Host",Vn[Vn.Self=2]="Self",Vn[Vn.SkipSelf=4]="SkipSelf",Vn[Vn.Optional=8]="Optional",Vn))();let ci;function Tn(t){const n=ci;return ci=t,n}function Zo(t,n,i){const o=Ut(t);return o&&"root"==o.providedIn?void 0===o.value?o.value=o.factory():o.value:i&Vn.Optional?null:void 0!==n?n:void rr(Xe(t),"Injector")}function ii(t){return{toString:t}.toString()}var rs=(()=>((rs=rs||{})[rs.OnPush=0]="OnPush",rs[rs.Default=1]="Default",rs))(),zn=(()=>((zn=zn||{})[zn.Emulated=0]="Emulated",zn[zn.None=2]="None",zn[zn.ShadowDom=3]="ShadowDom",zn))();const yl="undefined"!=typeof globalThis&&globalThis,si="undefined"!=typeof window&&window,Qo="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,ga="undefined"!=typeof global&&global,Xn=yl||ga||si||Qo,Ys={},Kr=[],ro=Ve({\u0275cmp:Ve}),Us=Ve({\u0275dir:Ve}),Xs=Ve({\u0275pipe:Ve}),xr=Ve({\u0275mod:Ve}),zl=Ve({\u0275loc:Ve}),vs=Ve({\u0275fac:Ve}),io=Ve({__NG_ELEMENT_ID__:Ve});let qa=0;function Zs(t){return ii(()=>{const i={},o={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:i,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===rs.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||Kr,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||zn.Emulated,id:"c",styles:t.styles||Kr,_:null,setInput:null,schemas:t.schemas||null,tView:null},l=t.directives,u=t.features,y=t.pipes;return o.id+=qa++,o.inputs=Da(t.inputs,i),o.outputs=Da(t.outputs),u&&u.forEach(w=>w(o)),o.directiveDefs=l?()=>("function"==typeof l?l():l).map(ma):null,o.pipeDefs=y?()=>("function"==typeof y?y():y).map(Ai):null,o})}function ma(t){return is(t)||function(t){return t[Us]||null}(t)}function Ai(t){return function(t){return t[Xs]||null}(t)}const Di={};function so(t){return ii(()=>{const n={type:t.type,bootstrap:t.bootstrap||Kr,declarations:t.declarations||Kr,imports:t.imports||Kr,exports:t.exports||Kr,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(Di[t.id]=t.type),n})}function oo(t,n){return ii(()=>{const i=_s(t,!0);i.declarations=n.declarations||Kr,i.imports=n.imports||Kr,i.exports=n.exports||Kr})}function Da(t,n){if(null==t)return Ys;const i={};for(const o in t)if(t.hasOwnProperty(o)){let l=t[o],u=l;Array.isArray(l)&&(u=l[1],l=l[0]),i[l]=o,n&&(n[l]=u)}return i}const $i=Zs;function Vs(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,onDestroy:t.type.prototype.ngOnDestroy||null}}function is(t){return t[ro]||null}function _s(t,n){const i=t[xr]||null;if(!i&&!0===n)throw new Error(`Type ${Xe(t)} does not have '\u0275mod' property.`);return i}function co(t){return Array.isArray(t)&&"object"==typeof t[1]}function Ks(t){return Array.isArray(t)&&!0===t[1]}function _l(t){return 0!=(8&t.flags)}function ya(t){return 2==(2&t.flags)}function va(t){return 1==(1&t.flags)}function Vi(t){return null!==t.template}function _a(t){return 0!=(512&t[2])}function uo(t,n){return t.hasOwnProperty(vs)?t[vs]:null}class ba{constructor(n,i,o){this.previousValue=n,this.currentValue=i,this.firstChange=o}isFirstChange(){return this.firstChange}}function hs(){return bo}function bo(t){return t.type.prototype.ngOnChanges&&(t.setInput=yc),mc}function mc(){const t=Qa(this),n=null==t?void 0:t.current;if(n){const i=t.previous;if(i===Ys)t.previous=n;else for(let o in n)i[o]=n[o];t.current=null,this.ngOnChanges(n)}}function yc(t,n,i,o){const l=Qa(t)||function(t,n){return t[ra]=n}(t,{previous:Ys,current:null}),u=l.current||(l.current={}),y=l.previous,w=this.declaredInputs[i],T=y[w];u[w]=new ba(T&&T.currentValue,n,y===Ys),t[o]=n}hs.ngInherit=!0;const ra="__ngSimpleChanges__";function Qa(t){return t[ra]||null}const z="http://www.w3.org/2000/svg";let Ne;function mt(t){Ne=t}function Zn(t){return!!t.listen}const Jr={createRenderer:(t,n)=>void 0!==Ne?Ne:"undefined"!=typeof document?document:void 0};function Sr(t){for(;Array.isArray(t);)t=t[0];return t}function Gi(t,n){return Sr(n[t.index])}function ia(t,n){return t.data[n]}function Qn(t,n){return t[n]}function Cs(t,n){const i=n[t];return co(i)?i:i[0]}function Pa(t){return 4==(4&t[2])}function qi(t){return 128==(128&t[2])}function xo(t,n){return null==n?null:t[n]}function Po(t){t[18]=0}function sa(t,n){t[5]+=n;let i=t,o=t[3];for(;null!==o&&(1===n&&1===i[5]||-1===n&&0===i[5]);)o[5]+=n,i=o,o=o[3]}const jn={lFrame:Dl(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Ja(){return jn.bindingsEnabled}function Ot(){return jn.lFrame.lView}function Hr(){return jn.lFrame.tView}function bu(t){return jn.lFrame.contextLView=t,t[8]}function ps(){let t=xu();for(;null!==t&&64===t.type;)t=t.parent;return t}function xu(){return jn.lFrame.currentTNode}function Lo(t,n){const i=jn.lFrame;i.currentTNode=t,i.isParent=n}function Cl(){return jn.lFrame.isParent}function La(){return jn.isInCheckNoChangesMode}function vc(t){jn.isInCheckNoChangesMode=t}function Rt(){const t=jn.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function zs(){return jn.lFrame.bindingIndex++}function di(t,n){const i=jn.lFrame;i.bindingIndex=i.bindingRootIndex=t,nl(n)}function nl(t){jn.lFrame.currentDirectiveIndex=t}function as(){return jn.lFrame.currentQueryIndex}function he(t){jn.lFrame.currentQueryIndex=t}function jc(t){const n=t[1];return 2===n.type?n.declTNode:1===n.type?t[6]:null}function Al(t,n,i){if(i&Vn.SkipSelf){let l=n,u=t;for(;!(l=l.parent,null!==l||i&Vn.Host||(l=jc(u),null===l||(u=u[15],10&l.type))););if(null===l)return!1;n=l,t=u}const o=jn.lFrame=wo();return o.currentTNode=n,o.lView=t,!0}function bs(t){const n=wo(),i=t[1];jn.lFrame=n,n.currentTNode=i.firstChild,n.lView=t,n.tView=i,n.contextLView=t,n.bindingIndex=i.bindingStartIndex,n.inI18n=!1}function wo(){const t=jn.lFrame,n=null===t?null:t.child;return null===n?Dl(t):n}function Dl(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function bc(){const t=jn.lFrame;return jn.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const rl=bc;function wa(){const t=bc();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function pi(){return jn.lFrame.selectedIndex}function Hs(t){jn.lFrame.selectedIndex=t}function gi(){const t=jn.lFrame;return ia(t.tView,t.selectedIndex)}function fo(){jn.lFrame.currentNamespace=z}function Wn(){jn.lFrame.currentNamespace=null}function Il(t,n){for(let i=n.directiveStart,o=n.directiveEnd;i<o;i++){const u=t.data[i].type.prototype,{ngAfterContentInit:y,ngAfterContentChecked:w,ngAfterViewInit:T,ngAfterViewChecked:N,ngOnDestroy:W}=u;y&&(t.contentHooks||(t.contentHooks=[])).push(-i,y),w&&((t.contentHooks||(t.contentHooks=[])).push(i,w),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(i,w)),T&&(t.viewHooks||(t.viewHooks=[])).push(-i,T),N&&((t.viewHooks||(t.viewHooks=[])).push(i,N),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(i,N)),null!=W&&(t.destroyHooks||(t.destroyHooks=[])).push(i,W)}}function Fo(t,n,i){Oa(t,n,3,i)}function ko(t,n,i,o){(3&t[2])===i&&Oa(t,n,i,o)}function Ls(t,n){let i=t[2];(3&i)===n&&(i&=2047,i+=1,t[2]=i)}function Oa(t,n,i,o){const u=null!=o?o:-1,y=n.length-1;let w=0;for(let T=void 0!==o?65535&t[18]:0;T<y;T++)if("number"==typeof n[T+1]){if(w=n[T],null!=o&&w>=o)break}else n[T]<0&&(t[18]+=65536),(w<u||-1==u)&&(Bo(t,i,n,T),t[18]=(4294901760&t[18])+T+2),T++}function Bo(t,n,i,o){const l=i[o]<0,u=i[o+1],w=t[l?-i[o]:i[o]];if(l){if(t[2]>>11<t[18]>>16&&(3&t[2])===n){t[2]+=2048;try{u.call(w)}finally{}}}else try{u.call(w)}finally{}}class Yi{constructor(n,i,o){this.factory=n,this.resolving=!1,this.canSeeViewProviders=i,this.injectImpl=o}}function ri(t,n,i){const o=Zn(t);let l=0;for(;l<i.length;){const u=i[l];if("number"==typeof u){if(0!==u)break;l++;const y=i[l++],w=i[l++],T=i[l++];o?t.setAttribute(n,w,T,y):n.setAttributeNS(y,w,T)}else{const y=u,w=i[++l];ji(y)?o&&t.setProperty(n,y,w):o?t.setAttribute(n,y,w):n.setAttribute(y,w),l++}}return l}function Yl(t){return 3===t||4===t||6===t}function ji(t){return 64===t.charCodeAt(0)}function Na(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let i=-1;for(let o=0;o<n.length;o++){const l=n[o];"number"==typeof l?i=l:0===i||Xl(t,i,l,null,-1===i||2===i?n[++o]:null)}}return t}function Xl(t,n,i,o,l){let u=0,y=t.length;if(-1===n)y=-1;else for(;u<t.length;){const w=t[u++];if("number"==typeof w){if(w===n){y=-1;break}if(w>n){y=u-1;break}}}for(;u<t.length;){const w=t[u];if("number"==typeof w)break;if(w===i){if(null===o)return void(null!==l&&(t[u+1]=l));if(o===t[u+1])return void(t[u+2]=l)}u++,null!==o&&u++,null!==l&&u++}-1!==y&&(t.splice(y,0,n),u=y+1),t.splice(u++,0,i),null!==o&&t.splice(u++,0,o),null!==l&&t.splice(u++,0,l)}function Vo(t){return-1!==t}function zo(t){return 32767&t}function Fa(t,n){let i=function(t){return t>>16}(t),o=n;for(;i>0;)o=o[15],i--;return o}let Pl=!0;function Eo(t){const n=Pl;return Pl=t,n}let qc=0;function eo(t,n){const i=sl(t,n);if(-1!==i)return i;const o=n[1];o.firstCreatePass&&(t.injectorIndex=n.length,Yc(o.data,t),Yc(n,null),Yc(o.blueprint,null));const l=wc(t,n),u=t.injectorIndex;if(Vo(l)){const y=zo(l),w=Fa(l,n),T=w[1].data;for(let N=0;N<8;N++)n[u+N]=w[y+N]|T[y+N]}return n[u+8]=l,u}function Yc(t,n){t.push(0,0,0,0,0,0,0,0,n)}function sl(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function wc(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let i=0,o=null,l=n;for(;null!==l;){const u=l[1],y=u.type;if(o=2===y?u.declTNode:1===y?l[6]:null,null===o)return-1;if(i++,l=l[15],-1!==o.injectorIndex)return o.injectorIndex|i<<16}return-1}function Zr(t,n,i){!function(t,n,i){let o;"string"==typeof i?o=i.charCodeAt(0)||0:i.hasOwnProperty(io)&&(o=i[io]),null==o&&(o=i[io]=qc++);const l=255&o;n.data[t+(l>>5)]|=1<<l}(t,n,i)}function Go(t,n,i){if(i&Vn.Optional)return t;rr(n,"NodeInjector")}function Ec(t,n,i,o){if(i&Vn.Optional&&void 0===o&&(o=null),0==(i&(Vn.Self|Vn.Host))){const l=t[9],u=Tn(void 0);try{return l?l.get(n,o,i&Vn.Optional):Zo(n,o,i&Vn.Optional)}finally{Tn(u)}}return Go(o,n,i)}function aa(t,n,i,o=Vn.Default,l){if(null!==t){const u=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(io)?t[io]:void 0;return"number"==typeof n?n>=0?255&n:ol:n}(i);if("function"==typeof u){if(!Al(n,t,o))return o&Vn.Host?Go(l,i,o):Ec(n,i,o,l);try{const y=u(o);if(null!=y||o&Vn.Optional)return y;rr(i)}finally{rl()}}else if("number"==typeof u){let y=null,w=sl(t,n),T=-1,N=o&Vn.Host?n[16][6]:null;for((-1===w||o&Vn.SkipSelf)&&(T=-1===w?wc(t,n):n[w+8],-1!==T&&we(o,!1)?(y=n[1],w=zo(T),n=Fa(T,n)):w=-1);-1!==w;){const W=n[1];if(le(u,w,W.data)){const ee=td(w,n,i,y,o,N);if(ee!==ka)return ee}T=n[w+8],-1!==T&&we(o,n[1].data[w+8]===N)&&le(u,w,n)?(y=W,w=zo(T),n=Fa(T,n)):w=-1}}}return Ec(n,i,o,l)}const ka={};function ol(){return new Re(ps(),Ot())}function td(t,n,i,o,l,u){const y=n[1],w=y.data[t+8],W=S(w,y,i,null==o?ya(w)&&Pl:o!=y&&0!=(3&w.type),l&Vn.Host&&u===w);return null!==W?V(n,y,W,w):ka}function S(t,n,i,o,l){const u=t.providerIndexes,y=n.data,w=1048575&u,T=t.directiveStart,W=u>>20,ce=l?w+W:t.directiveEnd;for(let De=o?w:w+W;De<ce;De++){const ze=y[De];if(De<T&&i===ze||De>=T&&ze.type===i)return De}if(l){const De=y[T];if(De&&Vi(De)&&De.type===i)return T}return null}function V(t,n,i,o){let l=t[i];const u=n.data;if(function(t){return t instanceof Yi}(l)){const y=l;y.resolving&&function(t,n){throw new er("200",`Circular dependency in DI detected for ${t}`)}(Bt(u[i]));const w=Eo(y.canSeeViewProviders);y.resolving=!0;const T=y.injectImpl?Tn(y.injectImpl):null;Al(t,o,Vn.Default);try{l=t[i]=y.factory(void 0,u,t,o),n.firstCreatePass&&i>=o.directiveStart&&function(t,n,i){const{ngOnChanges:o,ngOnInit:l,ngDoCheck:u}=n.type.prototype;if(o){const y=bo(n);(i.preOrderHooks||(i.preOrderHooks=[])).push(t,y),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(t,y)}l&&(i.preOrderHooks||(i.preOrderHooks=[])).push(0-t,l),u&&((i.preOrderHooks||(i.preOrderHooks=[])).push(t,u),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(t,u))}(i,u[i],n)}finally{null!==T&&Tn(T),Eo(w),y.resolving=!1,rl()}}return l}function le(t,n,i){return!!(i[n+(t>>5)]&1<<t)}function we(t,n){return!(t&Vn.Self||t&Vn.Host&&n)}class Re{constructor(n,i){this._tNode=n,this._lView=i}get(n,i){return aa(this._tNode,this._lView,n,void 0,i)}}function Le(t){return ii(()=>{const n=t.prototype.constructor,i=n[vs]||M(n),o=Object.prototype;let l=Object.getPrototypeOf(t.prototype).constructor;for(;l&&l!==o;){const u=l[vs]||M(l);if(u&&u!==i)return u;l=Object.getPrototypeOf(l)}return u=>new u})}function M(t){return hn(t)?()=>{const n=M(zt(t));return n&&n()}:uo(t)}function b(t){return function(t,n){if("class"===n)return t.classes;if("style"===n)return t.styles;const i=t.attrs;if(i){const o=i.length;let l=0;for(;l<o;){const u=i[l];if(Yl(u))break;if(0===u)l+=2;else if("number"==typeof u)for(l++;l<o&&"string"==typeof i[l];)l++;else{if(u===n)return i[l+1];l+=2}}}return null}(ps(),t)}const R="__parameters__";function ye(t,n,i){return ii(()=>{const o=function(t){return function(...i){if(t){const o=t(...i);for(const l in o)this[l]=o[l]}}}(n);function l(...u){if(this instanceof l)return o.apply(this,u),this;const y=new l(...u);return w.annotation=y,w;function w(T,N,W){const ee=T.hasOwnProperty(R)?T[R]:Object.defineProperty(T,R,{value:[]})[R];for(;ee.length<=W;)ee.push(null);return(ee[W]=ee[W]||[]).push(y),T}}return i&&(l.prototype=Object.create(i.prototype)),l.prototype.ngMetadataName=t,l.annotationCls=l,l})}class Kt{constructor(n,i){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof i?this.__NG_ELEMENT_ID__=i:void 0!==i&&(this.\u0275prov=pe({token:this,providedIn:i.providedIn||"root",factory:i.factory}))}toString(){return`InjectionToken ${this._desc}`}}const vr=new Kt("AnalyzeForEntryComponents"),Gn=Function;function fi(t,n){void 0===n&&(n=t);for(let i=0;i<t.length;i++){let o=t[i];Array.isArray(o)?(n===t&&(n=t.slice(0,i)),fi(o,n)):n!==t&&n.push(o)}return n}function li(t,n){t.forEach(i=>Array.isArray(i)?li(i,n):n(i))}function Ci(t,n,i){n>=t.length?t.push(i):t.splice(n,0,i)}function Ri(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}const Ba={},id="__NG_DI_FLAG__",xs="ngTempTokenPath",od=/\n/gm,Mc="__source",ad=Ve({provide:String,useValue:Ve});let Au;function Xc(t){const n=Au;return Au=t,n}function Kl(t,n=Vn.Default){if(void 0===Au)throw new Error("inject() must be called from an injection context");return null===Au?Zo(t,void 0,n):Au.get(t,n&Vn.Optional?null:void 0,n)}function us(t,n=Vn.Default){return(ci||Kl)(zt(t),n)}function Zc(t){const n=[];for(let i=0;i<t.length;i++){const o=zt(t[i]);if(Array.isArray(o)){if(0===o.length)throw new Error("Arguments array must have arguments.");let l,u=Vn.Default;for(let y=0;y<o.length;y++){const w=o[y],T=Yd(w);"number"==typeof T?-1===T?l=w.token:u|=T:l=w}n.push(us(l,u))}else n.push(us(o))}return n}function qd(t,n){return t[id]=n,t.prototype[id]=n,t}function Yd(t){return t[id]}function Xp(t,n,i,o){const l=t[xs];throw n[Mc]&&l.unshift(n[Mc]),t.message=function(t,n,i,o=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let l=Xe(n);if(Array.isArray(n))l=n.map(Xe).join(" -> ");else if("object"==typeof n){let u=[];for(let y in n)if(n.hasOwnProperty(y)){let w=n[y];u.push(y+":"+("string"==typeof w?JSON.stringify(w):Xe(w)))}l=`{${u.join(", ")}}`}return`${i}${o?"("+o+")":""}[${l}]: ${t.replace(od,"\n  ")}`}("\n"+t.message,l,i,o),t.ngTokenPath=l,t[xs]=null,t}const ld=qd(ye("Inject",t=>({token:t})),-1),Sc=qd(ye("Optional"),8),Qc=qd(ye("SkipSelf"),4);let Nf;function ud(t){var n;return(null===(n=function(){if(void 0===Nf&&(Nf=null,Xn.trustedTypes))try{Nf=Xn.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch(t){}return Nf}())||void 0===n?void 0:n.createHTML(t))||t}class Tc{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Iu extends Tc{getTypeName(){return"HTML"}}class Bf extends Tc{getTypeName(){return"Style"}}class Nh extends Tc{getTypeName(){return"Script"}}class ng extends Tc{getTypeName(){return"URL"}}class rg extends Tc{getTypeName(){return"ResourceURL"}}function Jl(t){return t instanceof Tc?t.changingThisBreaksApplicationSecurity:t}function Wo(t,n){const i=Fh(t);if(null!=i&&i!==n){if("ResourceURL"===i&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${i} (see https://g.co/ng/security#xss)`)}return i===n}function Fh(t){return t instanceof Tc&&t.getTypeName()||null}function ig(t){return new Iu(t)}function sg(t){return new Bf(t)}function og(t){return new Nh(t)}function ag(t){return new ng(t)}function lg(t){return new rg(t)}class cg{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const i=(new window.DOMParser).parseFromString(ud(n),"text/html").body;return null===i?this.inertDocumentHelper.getInertBodyElement(n):(i.removeChild(i.firstChild),i)}catch(i){return null}}}class ug{constructor(n){if(this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const i=this.inertDocument.createElement("html");this.inertDocument.appendChild(i);const o=this.inertDocument.createElement("body");i.appendChild(o)}}getInertBodyElement(n){const i=this.inertDocument.createElement("template");if("content"in i)return i.innerHTML=ud(n),i;const o=this.inertDocument.createElement("body");return o.innerHTML=ud(n),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(o),o}stripCustomNsAttrs(n){const i=n.attributes;for(let l=i.length-1;0<l;l--){const y=i.item(l).name;("xmlns:ns1"===y||0===y.indexOf("ns1:"))&&n.removeAttribute(y)}let o=n.firstChild;for(;o;)o.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(o),o=o.nextSibling}}const fg=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,hg=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function dd(t){return(t=String(t)).match(fg)||t.match(hg)?t:"unsafe:"+t}function Ll(t){const n={};for(const i of t.split(","))n[i]=!0;return n}function Lu(...t){const n={};for(const i of t)for(const o in i)i.hasOwnProperty(o)&&(n[o]=!0);return n}const Qd=Ll("area,br,col,hr,img,wbr"),Bh=Ll("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Uh=Ll("rp,rt"),Uf=Lu(Qd,Lu(Bh,Ll("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Lu(Uh,Ll("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Lu(Uh,Bh)),Vf=Ll("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Kd=Ll("srcset"),fd=Lu(Vf,Kd,Ll("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Ll("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),gg=Ll("script,style,template");class mg{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let i=n.firstChild,o=!0;for(;i;)if(i.nodeType===Node.ELEMENT_NODE?o=this.startElement(i):i.nodeType===Node.TEXT_NODE?this.chars(i.nodeValue):this.sanitizedSomething=!0,o&&i.firstChild)i=i.firstChild;else for(;i;){i.nodeType===Node.ELEMENT_NODE&&this.endElement(i);let l=this.checkClobberedElement(i,i.nextSibling);if(l){i=l;break}i=this.checkClobberedElement(i,i.parentNode)}return this.buf.join("")}startElement(n){const i=n.nodeName.toLowerCase();if(!Uf.hasOwnProperty(i))return this.sanitizedSomething=!0,!gg.hasOwnProperty(i);this.buf.push("<"),this.buf.push(i);const o=n.attributes;for(let l=0;l<o.length;l++){const u=o.item(l),y=u.name,w=y.toLowerCase();if(!fd.hasOwnProperty(w)){this.sanitizedSomething=!0;continue}let T=u.value;Vf[w]&&(T=dd(T)),Kd[w]&&(t=T,T=(t=String(t)).split(",").map(n=>dd(n.trim())).join(", ")),this.buf.push(" ",y,'="',Vh(T),'"')}var t;return this.buf.push(">"),!0}endElement(n){const i=n.nodeName.toLowerCase();Uf.hasOwnProperty(i)&&!Qd.hasOwnProperty(i)&&(this.buf.push("</"),this.buf.push(i),this.buf.push(">"))}chars(n){this.buf.push(Vh(n))}checkClobberedElement(n,i){if(i&&(n.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return i}}const yg=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Hf=/([^\#-~ |!])/g;function Vh(t){return t.replace(/&/g,"&amp;").replace(yg,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(Hf,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let hd;function Gf(t,n){let i=null;try{hd=hd||function(t){const n=new ug(t);return function(){try{return!!(new window.DOMParser).parseFromString(ud(""),"text/html")}catch(t){return!1}}()?new cg(n):n}(t);let o=n?String(n):"";i=hd.getInertBodyElement(o);let l=5,u=o;do{if(0===l)throw new Error("Failed to sanitize html because the input is unstable");l--,o=u,u=i.innerHTML,i=hd.getInertBodyElement(o)}while(o!==u);return ud((new mg).sanitizeChildren(jf(i)||i))}finally{if(i){const o=jf(i)||i;for(;o.firstChild;)o.removeChild(o.firstChild)}}}function jf(t){return"content"in t&&function(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var Es=(()=>((Es=Es||{})[Es.NONE=0]="NONE",Es[Es.HTML=1]="HTML",Es[Es.STYLE=2]="STYLE",Es[Es.SCRIPT=3]="SCRIPT",Es[Es.URL=4]="URL",Es[Es.RESOURCE_URL=5]="RESOURCE_URL",Es))();function Wf(t){const n=function(){const t=Ot();return t&&t[12]}();return n?n.sanitize(Es.URL,t)||"":Wo(t,"URL")?Jl(t):dd(st(t))}const de="__ngContext__";function ie(t,n){t[de]=n}function fe(t){const n=function(t){return t[de]||null}(t);return n?Array.isArray(n)?n:n.lView:null}function jr(t){return t.ngOriginalError}function $o(t,...n){t.error(...n)}class to{constructor(){this._console=console}handleError(n){const i=this._findOriginalError(n),o=this._findContext(n),l=(t=n)&&t.ngErrorLogger||$o;var t;l(this._console,"ERROR",n),i&&l(this._console,"ORIGINAL ERROR",i),o&&l(this._console,"ERROR CONTEXT",o)}_findContext(n){return n?n.ngDebugContext||this._findContext(jr(n)):null}_findOriginalError(n){let i=n&&jr(n);for(;i&&jr(i);)i=jr(i);return i||null}}const gn=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Xn))();function ho(t){return t instanceof Function?t():t}var Ns=(()=>((Ns=Ns||{})[Ns.Important=1]="Important",Ns[Ns.DashCase=2]="DashCase",Ns))();function Ic(t,n){return undefined(t,n)}function Jc(t){const n=t[3];return Ks(n)?n[3]:n}function za(t){return tu(t[13])}function md(t){return tu(t[4])}function tu(t){for(;null!==t&&!Ks(t);)t=t[4];return t}function Ol(t,n,i,o,l){if(null!=o){let u,y=!1;Ks(o)?u=o:co(o)&&(y=!0,o=o[0]);const w=Sr(o);0===t&&null!==i?null==l?xy(n,i,w):bd(n,i,w,l||null,!0):1===t&&null!==i?bd(n,i,w,l||null,!0):2===t?function(t,n,i){const o=Gh(t,n);o&&function(t,n,i,o){Zn(t)?t.removeChild(n,i,o):n.removeChild(i)}(t,o,n,i)}(n,w,y):3===t&&n.destroyNode(w),null!=u&&function(t,n,i,o,l){const u=i[7];u!==Sr(i)&&Ol(n,t,o,u,l);for(let w=10;w<i.length;w++){const T=i[w];Lc(T[1],T,t,n,o,u)}}(n,t,u,i,l)}}function ar(t,n,i){return Zn(t)?t.createElement(n,i):null===i?t.createElement(n):t.createElementNS(i,n)}function Nl(t,n){const i=t[9],o=i.indexOf(n),l=n[3];1024&n[2]&&(n[2]&=-1025,sa(l,-1)),i.splice(o,1)}function Ha(t,n){if(t.length<=10)return;const i=10+n,o=t[i];if(o){const l=o[17];null!==l&&l!==t&&Nl(l,o),n>0&&(t[i-1][4]=o[4]);const u=Ri(t,10+n);!function(t,n){Lc(t,n,n[11],2,null,null),n[0]=null,n[6]=null}(o[1],o);const y=u[19];null!==y&&y.detachView(u[1]),o[3]=null,o[4]=null,o[2]&=-129}return o}function wg(t,n){if(!(256&n[2])){const i=n[11];Zn(i)&&i.destroyNode&&Lc(t,n,i,3,null,null),function(t){let n=t[13];if(!n)return $f(t[1],t);for(;n;){let i=null;if(co(n))i=n[13];else{const o=n[10];o&&(i=o)}if(!i){for(;n&&!n[4]&&n!==t;)co(n)&&$f(n[1],n),n=n[3];null===n&&(n=t),co(n)&&$f(n[1],n),i=n&&n[4]}n=i}}(n)}}function $f(t,n){if(!(256&n[2])){n[2]&=-129,n[2]|=256,function(t,n){let i;if(null!=t&&null!=(i=t.destroyHooks))for(let o=0;o<i.length;o+=2){const l=n[i[o]];if(!(l instanceof Yi)){const u=i[o+1];if(Array.isArray(u))for(let y=0;y<u.length;y+=2){const w=l[u[y]],T=u[y+1];try{T.call(w)}finally{}}else try{u.call(l)}finally{}}}}(t,n),function(t,n){const i=t.cleanup,o=n[7];let l=-1;if(null!==i)for(let u=0;u<i.length-1;u+=2)if("string"==typeof i[u]){const y=i[u+1],w="function"==typeof y?y(n):Sr(n[y]),T=o[l=i[u+2]],N=i[u+3];"boolean"==typeof N?w.removeEventListener(i[u],T,N):N>=0?o[l=N]():o[l=-N].unsubscribe(),u+=2}else{const y=o[l=i[u+1]];i[u].call(y)}if(null!==o){for(let u=l+1;u<o.length;u++)o[u]();n[7]=null}}(t,n),1===n[1].type&&Zn(n[11])&&n[11].destroy();const i=n[17];if(null!==i&&Ks(n[3])){i!==n[3]&&Nl(i,n);const o=n[19];null!==o&&o.detachView(t)}}}function _y(t,n,i){return function(t,n,i){let o=n;for(;null!==o&&40&o.type;)o=(n=o).parent;if(null===o)return i[0];if(2&o.flags){const l=t.data[o.directiveStart].encapsulation;if(l===zn.None||l===zn.Emulated)return null}return Gi(o,i)}(t,n.parent,i)}function bd(t,n,i,o,l){Zn(t)?t.insertBefore(n,i,o,l):n.insertBefore(i,o,l)}function xy(t,n,i){Zn(t)?t.appendChild(n,i):n.appendChild(i)}function wy(t,n,i,o,l){null!==o?bd(t,n,i,o,l):xy(t,n,i)}function Gh(t,n){return Zn(t)?t.parentNode(n):n.parentNode}let Cg=function(t,n,i){return 40&t.type?Gi(t,i):null};function qf(t,n,i,o){const l=_y(t,o,n),u=n[11],w=function(t,n,i){return Cg(t,n,i)}(o.parent||n[6],o,n);if(null!=l)if(Array.isArray(i))for(let T=0;T<i.length;T++)wy(u,l,i[T],w,!1);else wy(u,l,i,w,!1)}function Yf(t,n){if(null!==n){const i=n.type;if(3&i)return Gi(n,t);if(4&i)return jh(-1,t[n.index]);if(8&i){const o=n.child;if(null!==o)return Yf(t,o);{const l=t[n.index];return Ks(l)?jh(-1,l):Sr(l)}}if(32&i)return Ic(n,t)()||Sr(t[n.index]);{const o=Ag(t,n);return null!==o?Array.isArray(o)?o[0]:Yf(Jc(t[16]),o):Yf(t,n.next)}}return null}function Ag(t,n){return null!==n?t[16][6].projection[n.projection]:null}function jh(t,n){const i=10+t+1;if(i<n.length){const o=n[i],l=o[1].firstChild;if(null!==l)return Yf(o,l)}return n[7]}function Wh(t,n,i,o,l,u,y){for(;null!=i;){const w=o[i.index],T=i.type;if(y&&0===n&&(w&&ie(Sr(w),o),i.flags|=4),64!=(64&i.flags))if(8&T)Wh(t,n,i.child,o,l,u,!1),Ol(n,t,l,w,u);else if(32&T){const N=Ic(i,o);let W;for(;W=N();)Ol(n,t,l,W,u);Ol(n,t,l,w,u)}else 16&T?qo(t,n,o,i,l,u):Ol(n,t,l,w,u);i=y?i.projectionNext:i.next}}function Lc(t,n,i,o,l,u){Wh(i,o,t.firstChild,n,l,u,!1)}function qo(t,n,i,o,l,u){const y=i[16],T=y[6].projection[o.projection];if(Array.isArray(T))for(let N=0;N<T.length;N++)Ol(n,t,l,T[N],u);else Wh(t,n,T,y[3],l,u,!0)}function Sy(t,n,i){Zn(t)?t.setAttribute(n,"style",i):n.style.cssText=i}function Rg(t,n,i){Zn(t)?""===i?t.removeAttribute(n,"class"):t.setAttribute(n,"class",i):n.className=i}function Cy(t,n,i){let o=t.length;for(;;){const l=t.indexOf(n,i);if(-1===l)return l;if(0===l||t.charCodeAt(l-1)<=32){const u=n.length;if(l+u===o||t.charCodeAt(l+u)<=32)return l}i=l+1}}const Ty="ng-template";function Vv(t,n,i){let o=0;for(;o<t.length;){let l=t[o++];if(i&&"class"===l){if(l=t[o],-1!==Cy(l.toLowerCase(),n,0))return!0}else if(1===l){for(;o<t.length&&"string"==typeof(l=t[o++]);)if(l.toLowerCase()===n)return!0;return!1}}return!1}function Ay(t){return 4===t.type&&t.value!==Ty}function zv(t,n,i){return n===(4!==t.type||i?t.value:Ty)}function Hv(t,n,i){let o=4;const l=t.attrs||[],u=function(t){for(let n=0;n<t.length;n++)if(Yl(t[n]))return n;return t.length}(l);let y=!1;for(let w=0;w<n.length;w++){const T=n[w];if("number"!=typeof T){if(!y)if(4&o){if(o=2|1&o,""!==T&&!zv(t,T,i)||""===T&&1===n.length){if(nc(o))return!1;y=!0}}else{const N=8&o?T:n[++w];if(8&o&&null!==t.attrs){if(!Vv(t.attrs,N,i)){if(nc(o))return!1;y=!0}continue}const ee=Gv(8&o?"class":T,l,Ay(t),i);if(-1===ee){if(nc(o))return!1;y=!0;continue}if(""!==N){let ce;ce=ee>u?"":l[ee+1].toLowerCase();const De=8&o?ce:null;if(De&&-1!==Cy(De,N,0)||2&o&&N!==ce){if(nc(o))return!1;y=!0}}}}else{if(!y&&!nc(o)&&!nc(T))return!1;if(y&&nc(T))continue;y=!1,o=T|1&o}}return nc(o)||y}function nc(t){return 0==(1&t)}function Gv(t,n,i,o){if(null===n)return-1;let l=0;if(o||!i){let u=!1;for(;l<n.length;){const y=n[l];if(y===t)return l;if(3===y||6===y)u=!0;else{if(1===y||2===y){let w=n[++l];for(;"string"==typeof w;)w=n[++l];continue}if(4===y)break;if(0===y){l+=4;continue}}l+=u?1:2}return-1}return function(t,n){let i=t.indexOf(4);if(i>-1)for(i++;i<t.length;){const o=t[i];if("number"==typeof o)return-1;if(o===n)return i;i++}return-1}(n,t)}function Dy(t,n,i=!1){for(let o=0;o<n.length;o++)if(Hv(t,n[o],i))return!0;return!1}function Ry(t,n){return t?":not("+n.trim()+")":n}function Yv(t){let n=t[0],i=1,o=2,l="",u=!1;for(;i<t.length;){let y=t[i];if("string"==typeof y)if(2&o){const w=t[++i];l+="["+y+(w.length>0?'="'+w+'"':"")+"]"}else 8&o?l+="."+y:4&o&&(l+=" "+y);else""!==l&&!nc(y)&&(n+=Ry(u,l),l=""),o=y,u=u||!nc(o);i++}return""!==l&&(n+=Ry(u,l)),n}const Fr={};function Iy(t){Py(Hr(),Ot(),pi()+t,La())}function Py(t,n,i,o){if(!o)if(3==(3&n[2])){const u=t.preOrderCheckHooks;null!==u&&Fo(n,u,i)}else{const u=t.preOrderHooks;null!==u&&ko(n,u,0,i)}Hs(i)}function zy(t,n){const i=t.contentQueries;if(null!==i)for(let o=0;o<i.length;o+=2){const l=i[o],u=i[o+1];if(-1!==u){const y=t.data[u];he(l),y.contentQueries(2,n[u],u)}}}function Zf(t,n,i,o,l,u,y,w,T,N){const W=n.blueprint.slice();return W[0]=l,W[2]=140|o,Po(W),W[3]=W[15]=t,W[8]=i,W[10]=y||t&&t[10],W[11]=w||t&&t[11],W[12]=T||t&&t[12]||null,W[9]=N||t&&t[9]||null,W[6]=u,W[16]=2==n.type?t[16]:W,W}function nf(t,n,i,o,l){let u=t.data[n];if(null===u)u=function(t,n,i,o,l){const u=xu(),y=Cl(),T=t.data[n]=function(t,n,i,o,l,u){return{type:i,index:o,insertBeforeIndex:null,injectorIndex:n?n.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:l,attrs:u,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,y?u:u&&u.parent,i,n,o,l);return null===t.firstChild&&(t.firstChild=T),null!==u&&(y?null==u.child&&null!==T.parent&&(u.child=T):null===u.next&&(u.next=T)),T}(t,n,i,o,l),jn.lFrame.inI18n&&(u.flags|=64);else if(64&u.type){u.type=i,u.value=o,u.attrs=l;const y=function(){const t=jn.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();u.injectorIndex=null===y?-1:y.injectorIndex}return Lo(u,!0),u}function rf(t,n,i,o){if(0===i)return-1;const l=n.length;for(let u=0;u<i;u++)n.push(o),t.blueprint.push(o),t.data.push(null);return l}function Qf(t,n,i){bs(n);try{const o=t.viewQuery;null!==o&&lp(1,o,i);const l=t.template;null!==l&&Wy(t,n,l,1,i),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&zy(t,n),t.staticViewQueries&&lp(2,t.viewQuery,i);const u=t.components;null!==u&&function(t,n){for(let i=0;i<n.length;i++)f_(t,n[i])}(n,u)}catch(o){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),o}finally{n[2]&=-5,wa()}}function sf(t,n,i,o){const l=n[2];if(256==(256&l))return;bs(n);const u=La();try{Po(n),function(t){jn.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==i&&Wy(t,n,i,2,o);const y=3==(3&l);if(!u)if(y){const N=t.preOrderCheckHooks;null!==N&&Fo(n,N,null)}else{const N=t.preOrderHooks;null!==N&&ko(n,N,0,null),Ls(n,0)}if(function(t){for(let n=za(t);null!==n;n=md(n)){if(!n[2])continue;const i=n[9];for(let o=0;o<i.length;o++){const l=i[o],u=l[3];0==(1024&l[2])&&sa(u,1),l[2]|=1024}}}(n),function(t){for(let n=za(t);null!==n;n=md(n))for(let i=10;i<n.length;i++){const o=n[i],l=o[1];qi(o)&&sf(l,o,l.template,o[8])}}(n),null!==t.contentQueries&&zy(t,n),!u)if(y){const N=t.contentCheckHooks;null!==N&&Fo(n,N)}else{const N=t.contentHooks;null!==N&&ko(n,N,1),Ls(n,1)}!function(t,n){const i=t.hostBindingOpCodes;if(null!==i)try{for(let o=0;o<i.length;o++){const l=i[o];if(l<0)Hs(~l);else{const u=l,y=i[++o],w=i[++o];di(y,u),w(2,n[u])}}}finally{Hs(-1)}}(t,n);const w=t.components;null!==w&&function(t,n){for(let i=0;i<n.length;i++)Qy(t,n[i])}(n,w);const T=t.viewQuery;if(null!==T&&lp(2,T,o),!u)if(y){const N=t.viewCheckHooks;null!==N&&Fo(n,N)}else{const N=t.viewHooks;null!==N&&ko(n,N,2),Ls(n,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),u||(n[2]&=-73),1024&n[2]&&(n[2]&=-1025,sa(n[3],-1))}finally{wa()}}function jy(t,n,i,o){const l=n[10],u=!La(),y=Pa(n);try{u&&!y&&l.begin&&l.begin(),y&&Qf(t,n,o),sf(t,n,i,o)}finally{u&&!y&&l.end&&l.end()}}function Wy(t,n,i,o,l){const u=pi(),y=2&o;try{Hs(-1),y&&n.length>20&&Py(t,n,20,La()),i(o,l)}finally{Hs(u)}}function Kf(t,n,i){!Ja()||(function(t,n,i,o){const l=i.directiveStart,u=i.directiveEnd;t.firstCreatePass||eo(i,n),ie(o,n);const y=i.initialInputs;for(let w=l;w<u;w++){const T=t.data[w],N=Vi(T);N&&Xy(n,i,T);const W=V(n,t,w,i);ie(W,n),null!==y&&$g(0,w-l,W,T,0,y),N&&(Cs(i.index,n)[8]=W)}}(t,n,i,Gi(i,n)),128==(128&i.flags)&&function(t,n,i){const o=i.directiveStart,l=i.directiveEnd,y=i.index,w=jn.lFrame.currentDirectiveIndex;try{Hs(y);for(let T=o;T<l;T++){const N=t.data[T],W=n[T];nl(T),(null!==N.hostBindings||0!==N.hostVars||null!==N.hostAttrs)&&xd(N,W)}}finally{Hs(-1),nl(w)}}(t,n,i))}function Hg(t,n,i=Gi){const o=n.localNames;if(null!==o){let l=n.index+1;for(let u=0;u<o.length;u+=2){const y=o[u+1],w=-1===y?i(n,t):t[y];t[l++]=w}}}function $y(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=Jf(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):n}function Jf(t,n,i,o,l,u,y,w,T,N){const W=20+o,ee=W+l,ce=function(t,n){const i=[];for(let o=0;o<n;o++)i.push(o<t?null:Fr);return i}(W,ee),De="function"==typeof N?N():N;return ce[1]={type:t,blueprint:ce,template:i,queries:null,viewQuery:w,declTNode:n,data:ce.slice().fill(null,W),bindingStartIndex:W,expandoStartIndex:ee,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof u?u():u,pipeRegistry:"function"==typeof y?y():y,firstChild:null,schemas:T,consts:De,incompleteFirstPass:!1}}function Vu(t,n,i,o){const l=Qg(n);null===i?l.push(o):(l.push(i),t.firstCreatePass&&go(t).push(o,l.length-1))}function ep(t,n,i){for(let o in t)if(t.hasOwnProperty(o)){const l=t[o];(i=null===i?{}:i).hasOwnProperty(o)?i[o].push(n,l):i[o]=[n,l]}return i}function fl(t,n,i,o,l,u,y,w){const T=Gi(n,i);let W,N=n.inputs;!w&&null!=N&&(W=N[o])?(em(t,i,W,o,l),ya(n)&&function(t,n){const i=Cs(n,t);16&i[2]||(i[2]|=64)}(i,n.index)):3&n.type&&(o=function(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(o),l=null!=y?y(l,n.value||"",o):l,Zn(u)?u.setProperty(T,o,l):ji(o)||(T.setProperty?T.setProperty(o,l):T[o]=l))}function iu(t,n,i,o){let l=!1;if(Ja()){const u=function(t,n,i){const o=t.directiveRegistry;let l=null;if(o)for(let u=0;u<o.length;u++){const y=o[u];Dy(i,y.selectors,!1)&&(l||(l=[]),Zr(eo(i,n),t,y.type),Vi(y)?(cf(t,i),l.unshift(y)):l.push(y))}return l}(t,n,i),y=null===o?null:{"":-1};if(null!==u){l=!0,uf(i,t.data.length,u.length);for(let W=0;W<u.length;W++){const ee=u[W];ee.providersResolver&&ee.providersResolver(ee)}let w=!1,T=!1,N=rf(t,n,u.length,null);for(let W=0;W<u.length;W++){const ee=u[W];i.mergedAttrs=Na(i.mergedAttrs,ee.hostAttrs),rh(t,i,n,N,ee),np(N,ee,y),null!==ee.contentQueries&&(i.flags|=8),(null!==ee.hostBindings||null!==ee.hostAttrs||0!==ee.hostVars)&&(i.flags|=128);const ce=ee.type.prototype;!w&&(ce.ngOnChanges||ce.ngOnInit||ce.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(i.index),w=!0),!T&&(ce.ngOnChanges||ce.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(i.index),T=!0),N++}!function(t,n){const o=n.directiveEnd,l=t.data,u=n.attrs,y=[];let w=null,T=null;for(let N=n.directiveStart;N<o;N++){const W=l[N],ee=W.inputs,ce=null===u||Ay(n)?null:ip(ee,u);y.push(ce),w=ep(ee,N,w),T=ep(W.outputs,N,T)}null!==w&&(w.hasOwnProperty("class")&&(n.flags|=16),w.hasOwnProperty("style")&&(n.flags|=32)),n.initialInputs=y,n.inputs=w,n.outputs=T}(t,i)}y&&function(t,n,i){if(n){const o=t.localNames=[];for(let l=0;l<n.length;l+=2){const u=i[n[l+1]];if(null==u)throw new er("301",`Export of name '${n[l+1]}' not found!`);o.push(n[l],u)}}}(i,o,y)}return i.mergedAttrs=Na(i.mergedAttrs,i.attrs),l}function tp(t,n,i,o,l,u){const y=u.hostBindings;if(y){let w=t.hostBindingOpCodes;null===w&&(w=t.hostBindingOpCodes=[]);const T=~n.index;(function(t){let n=t.length;for(;n>0;){const i=t[--n];if("number"==typeof i&&i<0)return i}return 0})(w)!=T&&w.push(T),w.push(o,l,y)}}function xd(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function cf(t,n){n.flags|=2,(t.components||(t.components=[])).push(n.index)}function np(t,n,i){if(i){if(n.exportAs)for(let o=0;o<n.exportAs.length;o++)i[n.exportAs[o]]=t;Vi(n)&&(i[""]=t)}}function uf(t,n,i){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+i,t.providerIndexes=n}function rh(t,n,i,o,l){t.data[o]=l;const u=l.factory||(l.factory=uo(l.type)),y=new Yi(u,Vi(l),null);t.blueprint[o]=y,i[o]=y,tp(t,n,0,o,rf(t,i,l.hostVars,Fr),l)}function Xy(t,n,i){const o=Gi(n,t),l=$y(i),u=t[10],y=df(t,Zf(t,l,null,i.onPush?64:16,o,n,u,u.createRenderer(o,i),null,null));t[n.index]=y}function Fl(t,n,i,o,l,u){const y=Gi(t,n);!function(t,n,i,o,l,u,y){if(null==u)Zn(t)?t.removeAttribute(n,l,i):n.removeAttribute(l);else{const w=null==y?st(u):y(u,o||"",l);Zn(t)?t.setAttribute(n,l,w,i):i?n.setAttributeNS(i,l,w):n.setAttribute(l,w)}}(n[11],y,u,t.value,i,o,l)}function $g(t,n,i,o,l,u){const y=u[n];if(null!==y){const w=o.setInput;for(let T=0;T<y.length;){const N=y[T++],W=y[T++],ee=y[T++];null!==w?o.setInput(i,ee,N,W):i[W]=ee}}}function ip(t,n){let i=null,o=0;for(;o<n.length;){const l=n[o];if(0!==l)if(5!==l){if("number"==typeof l)break;t.hasOwnProperty(l)&&(null===i&&(i=[]),i.push(l,t[l],n[o+1])),o+=2}else o+=2;else o+=4}return i}function Yg(t,n,i,o){return new Array(t,!0,!1,n,null,0,o,i,null,null)}function Qy(t,n){const i=Cs(n,t);if(qi(i)){const o=i[1];80&i[2]?sf(o,i,o.template,i[8]):i[5]>0&&sp(i)}}function sp(t){for(let o=za(t);null!==o;o=md(o))for(let l=10;l<o.length;l++){const u=o[l];if(1024&u[2]){const y=u[1];sf(y,u,y.template,u[8])}else u[5]>0&&sp(u)}const i=t[1].components;if(null!==i)for(let o=0;o<i.length;o++){const l=Cs(i[o],t);qi(l)&&l[5]>0&&sp(l)}}function f_(t,n){const i=Cs(n,t),o=i[1];(function(t,n){for(let i=n.length;i<t.blueprint.length;i++)n.push(t.blueprint[i])})(o,i),Qf(o,i,i[8])}function df(t,n){return t[13]?t[14][4]=n:t[13]=n,t[14]=n,n}function ih(t){for(;t;){t[2]|=64;const n=Jc(t);if(_a(t)&&!n)return t;t=n}return null}function Xg(t,n,i){const o=n[10];o.begin&&o.begin();try{sf(t,n,t.template,i)}catch(l){throw Jg(n,l),l}finally{o.end&&o.end()}}function ap(t){!function(t){for(let n=0;n<t.components.length;n++){const i=t.components[n],o=fe(i),l=o[1];jy(l,o,l.template,i)}}(t[8])}function lp(t,n,i){he(0),n(t,i)}const sh=(()=>Promise.resolve(null))();function Qg(t){return t[7]||(t[7]=[])}function go(t){return t.cleanup||(t.cleanup=[])}function Jg(t,n){const i=t[9],o=i?i.get(to,null):null;o&&o.handleError(n)}function em(t,n,i,o,l){for(let u=0;u<i.length;){const y=i[u++],w=i[u++],T=n[y],N=t.data[y];null!==N.setInput?N.setInput(T,l,o,w):T[w]=l}}function wd(t,n,i){let o=i?t.styles:null,l=i?t.classes:null,u=0;if(null!==n)for(let y=0;y<n.length;y++){const w=n[y];"number"==typeof w?u=w:1==u?l=kt(l,w):2==u&&(o=kt(o,w+": "+n[++y]+";"))}i?t.styles=o:t.stylesWithoutHost=o,i?t.classes=l:t.classesWithoutHost=l}const hl=new Kt("INJECTOR",-1);class tm{get(n,i=Ba){if(i===Ba){const o=new Error(`NullInjectorError: No provider for ${Xe(n)}!`);throw o.name="NullInjectorError",o}return i}}const Oc=new Kt("Set Injector scope."),pf={},nm={};let gf;function oh(){return void 0===gf&&(gf=new tm),gf}function rm(t,n=null,i=null,o){return new p_(t,i,n||oh(),o)}class p_{constructor(n,i,o,l=null){this.parent=o,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const u=[];i&&li(i,w=>this.processProvider(w,n,i)),li([n],w=>this.processInjectorType(w,[],u)),this.records.set(hl,kl(void 0,this));const y=this.records.get(Oc);this.scope=null!=y?y.value:null,this.source=l||("object"==typeof n?null:Xe(n))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(n=>n.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(n,i=Ba,o=Vn.Default){this.assertNotDestroyed();const l=Xc(this),u=Tn(void 0);try{if(!(o&Vn.SkipSelf)){let w=this.records.get(n);if(void 0===w){const T=("function"==typeof(t=n)||"object"==typeof t&&t instanceof Kt)&&Ut(n);w=T&&this.injectableDefInScope(T)?kl(up(n),pf):null,this.records.set(n,w)}if(null!=w)return this.hydrate(n,w)}return(o&Vn.Self?oh():this.parent).get(n,i=o&Vn.Optional&&i===Ba?null:i)}catch(y){if("NullInjectorError"===y.name){if((y[xs]=y[xs]||[]).unshift(Xe(n)),l)throw y;return Xp(y,n,"R3InjectorError",this.source)}throw y}finally{Tn(u),Xc(l)}var t}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(n=>this.get(n))}toString(){const n=[];return this.records.forEach((o,l)=>n.push(Xe(l))),`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(n,i,o){if(!(n=zt(n)))return!1;let l=zr(n);const u=null==l&&n.ngModule||void 0,y=void 0===u?n:u,w=-1!==o.indexOf(y);if(void 0!==u&&(l=zr(u)),null==l)return!1;if(null!=l.imports&&!w){let W;o.push(y);try{li(l.imports,ee=>{this.processInjectorType(ee,i,o)&&(void 0===W&&(W=[]),W.push(ee))})}finally{}if(void 0!==W)for(let ee=0;ee<W.length;ee++){const{ngModule:ce,providers:De}=W[ee];li(De,ze=>this.processProvider(ze,ce,De||Kr))}}this.injectorDefTypes.add(y);const T=uo(y)||(()=>new y);this.records.set(y,kl(T,pf));const N=l.providers;if(null!=N&&!w){const W=n;li(N,ee=>this.processProvider(ee,W,N))}return void 0!==u&&void 0!==n.providers}processProvider(n,i,o){let l=su(n=zt(n))?n:zt(n&&n.provide);const u=mf(t=n)?kl(void 0,t.useValue):kl(function(t,n,i){let o;if(su(t)){const l=zt(t);return uo(l)||up(l)}if(mf(t))o=()=>zt(t.useValue);else if(function(t){return!(!t||!t.useFactory)}(t))o=()=>t.useFactory(...Zc(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))o=()=>us(zt(t.useExisting));else{const l=zt(t&&(t.useClass||t.provide));if(!function(t){return!!t.deps}(t))return uo(l)||up(l);o=()=>new l(...Zc(t.deps))}return o}(t),pf);var t;if(su(n)||!0!==n.multi)this.records.get(l);else{let y=this.records.get(l);y||(y=kl(void 0,pf,!0),y.factory=()=>Zc(y.multi),this.records.set(l,y)),l=n,y.multi.push(n)}this.records.set(l,u)}hydrate(n,i){return i.value===pf&&(i.value=nm,i.value=i.factory()),"object"==typeof i.value&&i.value&&null!==(t=i.value)&&"object"==typeof t&&"function"==typeof t.ngOnDestroy&&this.onDestroy.add(i.value),i.value;var t}injectableDefInScope(n){if(!n.providedIn)return!1;const i=zt(n.providedIn);return"string"==typeof i?"any"===i||i===this.scope:this.injectorDefTypes.has(i)}}function up(t){const n=Ut(t),i=null!==n?n.factory:uo(t);if(null!==i)return i;if(t instanceof Kt)throw new Error(`Token ${Xe(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const n=t.length;if(n>0){const o=function(t,n){const i=[];for(let o=0;o<t;o++)i.push(n);return i}(n,"?");throw new Error(`Can't resolve all parameters for ${Xe(t)}: (${o.join(", ")}).`)}const i=function(t){const n=t&&(t[Mr]||t[Ti]);if(n){const i=function(t){if(t.hasOwnProperty("name"))return t.name;const n=(""+t).match(/^function\s*([^\s(]+)/);return null===n?"":n[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${i}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${i}" class.`),n}return null}(t);return null!==i?()=>i.factory(t):()=>new t}(t);throw new Error("unreachable")}function kl(t,n,i=!1){return{factory:t,value:n,multi:i?[]:void 0}}function mf(t){return null!==t&&"object"==typeof t&&ad in t}function su(t){return"function"==typeof t}const sm=function(t,n,i){return function(t,n=null,i=null,o){const l=rm(t,n,i,o);return l._resolveInjectorDefTypes(),l}({name:i},n,t,i)};class Fi{static create(n,i){return Array.isArray(n)?sm(n,i,""):sm(n.providers,n.parent,n.name||"")}}function vp(t,n){Il(fe(t)[1],ps())}function bf(t){let n=function(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),i=!0;const o=[t];for(;n;){let l;if(Vi(t))l=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new Error("Directives cannot inherit Components");l=n.\u0275dir}if(l){if(i){o.push(l);const y=t;y.inputs=Sd(t.inputs),y.declaredInputs=Sd(t.declaredInputs),y.outputs=Sd(t.outputs);const w=l.hostBindings;w&&f0(t,w);const T=l.viewQuery,N=l.contentQueries;if(T&&A_(t,T),N&&d0(t,N),at(t.inputs,l.inputs),at(t.declaredInputs,l.declaredInputs),at(t.outputs,l.outputs),Vi(l)&&l.data.animation){const W=t.data;W.animation=(W.animation||[]).concat(l.data.animation)}}const u=l.features;if(u)for(let y=0;y<u.length;y++){const w=u[y];w&&w.ngInherit&&w(t),w===bf&&(i=!1)}}n=Object.getPrototypeOf(n)}!function(t){let n=0,i=null;for(let o=t.length-1;o>=0;o--){const l=t[o];l.hostVars=n+=l.hostVars,l.hostAttrs=Na(l.hostAttrs,i=Na(i,l.hostAttrs))}}(o)}function Sd(t){return t===Ys?{}:t===Kr?[]:t}function A_(t,n){const i=t.viewQuery;t.viewQuery=i?(o,l)=>{n(o,l),i(o,l)}:n}function d0(t,n){const i=t.contentQueries;t.contentQueries=i?(o,l,u)=>{n(o,l,u),i(o,l,u)}:n}function f0(t,n){const i=t.hostBindings;t.hostBindings=i?(o,l)=>{n(o,l),i(o,l)}:n}Fi.THROW_IF_NOT_FOUND=Ba,Fi.NULL=new tm,Fi.\u0275prov=pe({token:Fi,providedIn:"any",factory:()=>us(hl)}),Fi.__NG_ELEMENT_ID__=-1;let Bl=null;function Cd(){if(!Bl){const t=Xn.Symbol;if(t&&t.iterator)Bl=t.iterator;else{const n=Object.getOwnPropertyNames(Map.prototype);for(let i=0;i<n.length;++i){const o=n[i];"entries"!==o&&"size"!==o&&Map.prototype[o]===Map.prototype.entries&&(Bl=o)}}}return Bl}class mo{constructor(n){this.wrapped=n}static wrap(n){return new mo(n)}static unwrap(n){return mo.isWrapped(n)?n.wrapped:n}static isWrapped(n){return n instanceof mo}}function hh(t){return!!xf(t)&&(Array.isArray(t)||!(t instanceof Map)&&Cd()in t)}function xf(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Ga(t,n,i){return t[n]=i}function yo(t,n,i){return!Object.is(t[n],i)&&(t[n]=i,!0)}function bp(t,n,i,o,l){const u=function(t,n,i,o){const l=yo(t,n,i);return yo(t,n+1,o)||l}(t,n,i,o);return yo(t,n+2,l)||u}function Ef(t,n,i,o){const l=Ot();return yo(l,zs(),n)&&(Hr(),Fl(gi(),l,t,n,i,o)),Ef}function p0(t,n,i,o,l,u,y,w){const T=Ot(),N=Hr(),W=t+20,ee=N.firstCreatePass?function(t,n,i,o,l,u,y,w,T){const N=n.consts,W=nf(n,t,4,y||null,xo(N,w));iu(n,i,W,xo(N,T)),Il(n,W);const ee=W.tViews=Jf(2,W,o,l,u,n.directiveRegistry,n.pipeRegistry,null,n.schemas,N);return null!==n.queries&&(n.queries.template(n,W),ee.queries=n.queries.embeddedTView(W)),W}(W,N,T,n,i,o,l,u,y):N.data[W];Lo(ee,!1);const ce=T[11].createComment("");qf(N,T,ce,ee),ie(ce,T),df(T,T[W]=Yg(ce,T,ce,ee)),va(ee)&&Kf(N,T,ee),null!=y&&Hg(T,ee,w)}function m0(t){return Qn(jn.lFrame.contextLView,20+t)}function Cf(t,n=Vn.Default){const i=Ot();return null===i?us(t,n):aa(ps(),i,zt(t),n)}function Cm(t,n,i){const o=Ot();return yo(o,zs(),n)&&fl(Hr(),gi(),o,t,n,o[11],i,!1),Cm}function Tm(t,n,i,o,l){const y=l?"class":"style";em(t,i,n.inputs[y],y,o)}function Am(t,n,i,o){const l=Ot(),u=Hr(),y=20+t,w=l[11],T=l[y]=ar(w,n,jn.lFrame.currentNamespace),N=u.firstCreatePass?function(t,n,i,o,l,u,y){const w=n.consts,N=nf(n,t,2,l,xo(w,u));return iu(n,i,N,xo(w,y)),null!==N.attrs&&wd(N,N.attrs,!1),null!==N.mergedAttrs&&wd(N,N.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,N),N}(y,u,l,0,n,i,o):u.data[y];Lo(N,!0);const W=N.mergedAttrs;null!==W&&ri(w,T,W);const ee=N.classes;null!==ee&&Rg(w,T,ee);const ce=N.styles;null!==ce&&Sy(w,T,ce),64!=(64&N.flags)&&qf(u,l,T,N),0===jn.lFrame.elementDepthCount&&ie(T,l),jn.lFrame.elementDepthCount++,va(N)&&(Kf(u,l,N),function(t,n,i){if(_l(n)){const l=n.directiveEnd;for(let u=n.directiveStart;u<l;u++){const y=t.data[u];y.contentQueries&&y.contentQueries(1,i[u],u)}}}(u,N,l)),null!==o&&Hg(l,N)}function Dm(){let t=ps();Cl()?jn.lFrame.isParent=!1:(t=t.parent,Lo(t,!1));const n=t;jn.lFrame.elementDepthCount--;const i=Hr();i.firstCreatePass&&(Il(i,t),_l(t)&&i.queries.elementEnd(t)),null!=n.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(n)&&Tm(i,n,Ot(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(n)&&Tm(i,n,Ot(),n.stylesWithoutHost,!1)}function B_(t,n,i,o){Am(t,n,i,o),Dm()}function Im(){return Ot()}function Tp(t){return!!t&&"function"==typeof t.then}function V_(t){return!!t&&"function"==typeof t.subscribe}const Ap=V_;function Dp(t,n,i,o){const l=Ot(),u=Hr(),y=ps();return function(t,n,i,o,l,u,y,w){const T=va(o),W=t.firstCreatePass&&go(t),ee=n[8],ce=Qg(n);let De=!0;if(3&o.type||w){const tt=Gi(o,n),Qt=w?w(tt):tt,Tt=ce.length,ur=w?Tr=>w(Sr(Tr[o.index])):o.index;if(Zn(i)){let Tr=null;if(!w&&T&&(Tr=function(t,n,i,o){const l=t.cleanup;if(null!=l)for(let u=0;u<l.length-1;u+=2){const y=l[u];if(y===i&&l[u+1]===o){const w=n[7],T=l[u+2];return w.length>T?w[T]:null}"string"==typeof y&&(u+=2)}return null}(t,n,l,o.index)),null!==Tr)(Tr.__ngLastListenerFn__||Tr).__ngNextListenerFn__=u,Tr.__ngLastListenerFn__=u,De=!1;else{u=L0(o,n,ee,u,!1);const vi=i.listen(Qt,l,u);ce.push(u,vi),W&&W.push(l,ur,Tt,Tt+1)}}else u=L0(o,n,ee,u,!0),Qt.addEventListener(l,u,y),ce.push(u),W&&W.push(l,ur,Tt,y)}else u=L0(o,n,ee,u,!1);const ze=o.outputs;let ft;if(De&&null!==ze&&(ft=ze[l])){const tt=ft.length;if(tt)for(let Qt=0;Qt<tt;Qt+=2){const Xo=n[ft[Qt]][ft[Qt+1]].subscribe(u),Uc=ce.length;ce.push(u,Xo),W&&W.push(l,o.index,Uc,-(Uc+1))}}}(u,l,l[11],y,t,n,!!i,o),Dp}function $u(t,n,i,o){try{return!1!==i(o)}catch(l){return Jg(t,l),!1}}function L0(t,n,i,o,l){return function u(y){if(y===Function)return o;const w=2&t.flags?Cs(t.index,n):n;0==(32&n[2])&&ih(w);let T=$u(n,0,o,y),N=u.__ngNextListenerFn__;for(;N;)T=$u(n,0,N,y)&&T,N=N.__ngNextListenerFn__;return l&&!1===T&&(y.preventDefault(),y.returnValue=!1),T}}function O0(t=1){return function(t){return(jn.lFrame.contextLView=function(t,n){for(;t>0;)n=n[15],t--;return n}(t,jn.lFrame.contextLView))[8]}(t)}function ks(t,n=""){const i=Ot(),o=Hr(),l=t+20,u=o.firstCreatePass?nf(o,l,1,n,null):o.data[l],y=i[l]=function(t,n){return Zn(t)?t.createText(n):t.createTextNode(n)}(i[11],n);qf(o,i,y,u),Lo(u,!1)}function tv(t,n,i){const o=Ot();return yo(o,zs(),n)&&fl(Hr(),gi(),o,t,n,o[11],i,!0),tv}const Af=void 0;var uw=["en",[["a","p"],["AM","PM"],Af],[["AM","PM"],Af,Af],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Af,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Af,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Af,"{1} 'at' {0}",Af],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){const n=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===n&&0===i?1:5}];let Eh={};function nv(t){const n=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let i=h(n);if(i)return i;const o=n.split("-")[0];if(i=h(o),i)return i;if("en"===o)return uw;throw new Error(`Missing locale data for the locale "${t}".`)}function pb(t){return nv(t)[r.PluralCase]}function h(t){return t in Eh||(Eh[t]=Xn.ng&&Xn.ng.common&&Xn.ng.common.locales&&Xn.ng.common.locales[t]),Eh[t]}var r=(()=>((r=r||{})[r.LocaleId=0]="LocaleId",r[r.DayPeriodsFormat=1]="DayPeriodsFormat",r[r.DayPeriodsStandalone=2]="DayPeriodsStandalone",r[r.DaysFormat=3]="DaysFormat",r[r.DaysStandalone=4]="DaysStandalone",r[r.MonthsFormat=5]="MonthsFormat",r[r.MonthsStandalone=6]="MonthsStandalone",r[r.Eras=7]="Eras",r[r.FirstDayOfWeek=8]="FirstDayOfWeek",r[r.WeekendRange=9]="WeekendRange",r[r.DateFormat=10]="DateFormat",r[r.TimeFormat=11]="TimeFormat",r[r.DateTimeFormat=12]="DateTimeFormat",r[r.NumberSymbols=13]="NumberSymbols",r[r.NumberFormats=14]="NumberFormats",r[r.CurrencyCode=15]="CurrencyCode",r[r.CurrencySymbol=16]="CurrencySymbol",r[r.CurrencyName=17]="CurrencyName",r[r.Currencies=18]="Currencies",r[r.Directionality=19]="Directionality",r[r.PluralCase=20]="PluralCase",r[r.ExtraData=21]="ExtraData",r))();const p="en-US";let A=p;function P(t){Pn(t,"Expected localeId to be defined"),"string"==typeof t&&(A=t.toLowerCase().replace(/_/g,"-"))}class hu{}const Yu="ngComponent";class Co{resolveComponentFactory(n){throw function(t){const n=Error(`No component factory found for ${Xe(t)}. Did you add it to @NgModule.entryComponents?`);return n[Yu]=t,n}(n)}}class da{}function lv(...t){}function Fp(t,n){return new Xu(Gi(t,n))}da.NULL=new Co;const DM=function(){return Fp(ps(),Ot())};let Xu=(()=>{class t{constructor(i){this.nativeElement=i}}return t.__NG_ELEMENT_ID__=DM,t})();function dw(t){return t instanceof Xu?t.nativeElement:t}class cv{}let RM=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>PM(),t})();const PM=function(){const t=Ot(),i=Cs(ps().index,t);return function(t){return t[11]}(co(i)?i:t)};let _b=(()=>{class t{}return t.\u0275prov=pe({token:t,providedIn:"root",factory:()=>null}),t})();class fw{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const hw=new fw("12.2.3");class pw{constructor(){}supports(n){return hh(n)}create(n){return new FM(n)}}const NM=(t,n)=>n;class FM{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||NM}forEachItem(n){let i;for(i=this._itHead;null!==i;i=i._next)n(i)}forEachOperation(n){let i=this._itHead,o=this._removalsHead,l=0,u=null;for(;i||o;){const y=!o||i&&i.currentIndex<mw(o,l,u)?i:o,w=mw(y,l,u),T=y.currentIndex;if(y===o)l--,o=o._nextRemoved;else if(i=i._next,null==y.previousIndex)l++;else{u||(u=[]);const N=w-l,W=T-l;if(N!=W){for(let ce=0;ce<N;ce++){const De=ce<u.length?u[ce]:u[ce]=0,ze=De+ce;W<=ze&&ze<N&&(u[ce]=De+1)}u[y.previousIndex]=W-N}}w!==T&&n(y,w,T)}}forEachPreviousItem(n){let i;for(i=this._previousItHead;null!==i;i=i._nextPrevious)n(i)}forEachAddedItem(n){let i;for(i=this._additionsHead;null!==i;i=i._nextAdded)n(i)}forEachMovedItem(n){let i;for(i=this._movesHead;null!==i;i=i._nextMoved)n(i)}forEachRemovedItem(n){let i;for(i=this._removalsHead;null!==i;i=i._nextRemoved)n(i)}forEachIdentityChange(n){let i;for(i=this._identityChangesHead;null!==i;i=i._nextIdentityChange)n(i)}diff(n){if(null==n&&(n=[]),!hh(n))throw new Error(`Error trying to diff '${Xe(n)}'. Only arrays and iterables are allowed`);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let l,u,y,i=this._itHead,o=!1;if(Array.isArray(n)){this.length=n.length;for(let w=0;w<this.length;w++)u=n[w],y=this._trackByFn(w,u),null!==i&&Object.is(i.trackById,y)?(o&&(i=this._verifyReinsertion(i,u,y,w)),Object.is(i.item,u)||this._addIdentityChange(i,u)):(i=this._mismatch(i,u,y,w),o=!0),i=i._next}else l=0,function(t,n){if(Array.isArray(t))for(let i=0;i<t.length;i++)n(t[i]);else{const i=t[Cd()]();let o;for(;!(o=i.next()).done;)n(o.value)}}(n,w=>{y=this._trackByFn(l,w),null!==i&&Object.is(i.trackById,y)?(o&&(i=this._verifyReinsertion(i,w,y,l)),Object.is(i.item,w)||this._addIdentityChange(i,w)):(i=this._mismatch(i,w,y,l),o=!0),i=i._next,l++}),this.length=l;return this._truncate(i),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,i,o,l){let u;return null===n?u=this._itTail:(u=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(o,null))?(Object.is(n.item,i)||this._addIdentityChange(n,i),this._reinsertAfter(n,u,l)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(o,l))?(Object.is(n.item,i)||this._addIdentityChange(n,i),this._moveAfter(n,u,l)):n=this._addAfter(new kM(i,o),u,l),n}_verifyReinsertion(n,i,o,l){let u=null===this._unlinkedRecords?null:this._unlinkedRecords.get(o,null);return null!==u?n=this._reinsertAfter(u,n._prev,l):n.currentIndex!=l&&(n.currentIndex=l,this._addToMoves(n,l)),n}_truncate(n){for(;null!==n;){const i=n._next;this._addToRemovals(this._unlink(n)),n=i}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,i,o){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const l=n._prevRemoved,u=n._nextRemoved;return null===l?this._removalsHead=u:l._nextRemoved=u,null===u?this._removalsTail=l:u._prevRemoved=l,this._insertAfter(n,i,o),this._addToMoves(n,o),n}_moveAfter(n,i,o){return this._unlink(n),this._insertAfter(n,i,o),this._addToMoves(n,o),n}_addAfter(n,i,o){return this._insertAfter(n,i,o),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,i,o){const l=null===i?this._itHead:i._next;return n._next=l,n._prev=i,null===l?this._itTail=n:l._prev=n,null===i?this._itHead=n:i._next=n,null===this._linkedRecords&&(this._linkedRecords=new gw),this._linkedRecords.put(n),n.currentIndex=o,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const i=n._prev,o=n._next;return null===i?this._itHead=o:i._next=o,null===o?this._itTail=i:o._prev=i,n}_addToMoves(n,i){return n.previousIndex===i||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new gw),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,i){return n.item=i,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class kM{constructor(n,i){this.item=n,this.trackById=i,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class BM{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,i){let o;for(o=this._head;null!==o;o=o._nextDup)if((null===i||i<=o.currentIndex)&&Object.is(o.trackById,n))return o;return null}remove(n){const i=n._prevDup,o=n._nextDup;return null===i?this._head=o:i._nextDup=o,null===o?this._tail=i:o._prevDup=i,null===this._head}}class gw{constructor(){this.map=new Map}put(n){const i=n.trackById;let o=this.map.get(i);o||(o=new BM,this.map.set(i,o)),o.add(n)}get(n,i){const l=this.map.get(n);return l?l.get(n,i):null}remove(n){const i=n.trackById;return this.map.get(i).remove(n)&&this.map.delete(i),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function mw(t,n,i){const o=t.previousIndex;if(null===o)return o;let l=0;return i&&o<i.length&&(l=i[o]),o+n+l}class yw{constructor(){}supports(n){return n instanceof Map||xf(n)}create(){return new UM}}class UM{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let i;for(i=this._mapHead;null!==i;i=i._next)n(i)}forEachPreviousItem(n){let i;for(i=this._previousMapHead;null!==i;i=i._nextPrevious)n(i)}forEachChangedItem(n){let i;for(i=this._changesHead;null!==i;i=i._nextChanged)n(i)}forEachAddedItem(n){let i;for(i=this._additionsHead;null!==i;i=i._nextAdded)n(i)}forEachRemovedItem(n){let i;for(i=this._removalsHead;null!==i;i=i._nextRemoved)n(i)}diff(n){if(n){if(!(n instanceof Map||xf(n)))throw new Error(`Error trying to diff '${Xe(n)}'. Only maps and objects are allowed`)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let i=this._mapHead;if(this._appendAfter=null,this._forEach(n,(o,l)=>{if(i&&i.key===l)this._maybeAddToChanges(i,o),this._appendAfter=i,i=i._next;else{const u=this._getOrCreateRecordForKey(l,o);i=this._insertBeforeOrAppend(i,u)}}),i){i._prev&&(i._prev._next=null),this._removalsHead=i;for(let o=i;null!==o;o=o._nextRemoved)o===this._mapHead&&(this._mapHead=null),this._records.delete(o.key),o._nextRemoved=o._next,o.previousValue=o.currentValue,o.currentValue=null,o._prev=null,o._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,i){if(n){const o=n._prev;return i._next=n,i._prev=o,n._prev=i,o&&(o._next=i),n===this._mapHead&&(this._mapHead=i),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=i,i._prev=this._appendAfter):this._mapHead=i,this._appendAfter=i,null}_getOrCreateRecordForKey(n,i){if(this._records.has(n)){const l=this._records.get(n);this._maybeAddToChanges(l,i);const u=l._prev,y=l._next;return u&&(u._next=y),y&&(y._prev=u),l._next=null,l._prev=null,l}const o=new VM(n);return this._records.set(n,o),o.currentValue=i,this._addToAdditions(o),o}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,i){Object.is(i,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=i,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,i){n instanceof Map?n.forEach(i):Object.keys(n).forEach(o=>i(n[o],o))}}class VM{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function vw(){return new uv([new pw])}let uv=(()=>{class t{constructor(i){this.factories=i}static create(i,o){if(null!=o){const l=o.factories.slice();i=i.concat(l)}return new t(i)}static extend(i){return{provide:t,useFactory:o=>t.create(i,o||vw()),deps:[[t,new Qc,new Sc]]}}find(i){const o=this.factories.find(l=>l.supports(i));if(null!=o)return o;throw new Error(`Cannot find a differ supporting object '${i}' of type '${function(t){return t.name||typeof t}(i)}'`)}}return t.\u0275prov=pe({token:t,providedIn:"root",factory:vw}),t})();function _w(){return new dv([new yw])}let dv=(()=>{class t{constructor(i){this.factories=i}static create(i,o){if(o){const l=o.factories.slice();i=i.concat(l)}return new t(i)}static extend(i){return{provide:t,useFactory:o=>t.create(i,o||_w()),deps:[[t,new Qc,new Sc]]}}find(i){const o=this.factories.find(l=>l.supports(i));if(o)return o;throw new Error(`Cannot find a differ supporting object '${i}'`)}}return t.\u0275prov=pe({token:t,providedIn:"root",factory:_w}),t})();function fv(t,n,i,o,l=!1){for(;null!==i;){const u=n[i.index];if(null!==u&&o.push(Sr(u)),Ks(u))for(let w=10;w<u.length;w++){const T=u[w],N=T[1].firstChild;null!==N&&fv(T[1],T,N,o)}const y=i.type;if(8&y)fv(t,n,i.child,o);else if(32&y){const w=Ic(i,n);let T;for(;T=w();)o.push(T)}else if(16&y){const w=Ag(n,i);if(Array.isArray(w))o.push(...w);else{const T=Jc(n[16]);fv(T[1],T,w,o,!0)}}i=l?i.projectionNext:i.next}return o}class jm{constructor(n,i){this._lView=n,this._cdRefInjectingView=i,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const n=this._lView,i=n[1];return fv(i,n,i.firstChild,[])}get context(){return this._lView[8]}set context(n){this._lView[8]=n}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[3];if(Ks(n)){const i=n[8],o=i?i.indexOf(this):-1;o>-1&&(Ha(n,o),Ri(i,o))}this._attachedToViewContainer=!1}wg(this._lView[1],this._lView)}onDestroy(n){Vu(this._lView[1],this._lView,null,n)}markForCheck(){ih(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Xg(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,n,i){vc(!0);try{Xg(t,n,i)}finally{vc(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var n;this._appRef=null,Lc(this._lView[1],n=this._lView,n[11],2,null,null)}attachToAppRef(n){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=n}}class HM extends jm{constructor(n){super(n),this._view=n}detectChanges(){ap(this._view)}checkNoChanges(){!function(t){vc(!0);try{ap(t)}finally{vc(!1)}}(this._view)}get context(){return null}}const jM=function(t){return function(t,n,i){if(ya(t)&&!i){const o=Cs(t.index,n);return new jm(o,o)}return 47&t.type?new jm(n[16],n):null}(ps(),Ot(),16==(16&t))};let WM=(()=>{class t{}return t.__NG_ELEMENT_ID__=jM,t})();const YM=[new yw],ZM=new uv([new pw]),QM=new dv(YM),JM=function(){return hv(ps(),Ot())};let Wm=(()=>{class t{}return t.__NG_ELEMENT_ID__=JM,t})();const e1=Wm,t1=class extends e1{constructor(n,i,o){super(),this._declarationLView=n,this._declarationTContainer=i,this.elementRef=o}createEmbeddedView(n){const i=this._declarationTContainer.tViews,o=Zf(this._declarationLView,i,n,16,null,i.declTNode,null,null,null,null);o[17]=this._declarationLView[this._declarationTContainer.index];const u=this._declarationLView[19];return null!==u&&(o[19]=u.createEmbeddedView(i)),Qf(i,o,n),new jm(o)}};function hv(t,n){return 4&t.type?new t1(n,t,Fp(t,n)):null}class Mh{}class bw{}const i1=function(){return Ew(ps(),Ot())};let pv=(()=>{class t{}return t.__NG_ELEMENT_ID__=i1,t})();const o1=pv,xw=class extends o1{constructor(n,i,o){super(),this._lContainer=n,this._hostTNode=i,this._hostLView=o}get element(){return Fp(this._hostTNode,this._hostLView)}get injector(){return new Re(this._hostTNode,this._hostLView)}get parentInjector(){const n=wc(this._hostTNode,this._hostLView);if(Vo(n)){const i=Fa(n,this._hostLView),o=zo(n);return new Re(i[1].data[o+8],i)}return new Re(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const i=ww(this._lContainer);return null!==i&&i[n]||null}get length(){return this._lContainer.length-10}createEmbeddedView(n,i,o){const l=n.createEmbeddedView(i||{});return this.insert(l,o),l}createComponent(n,i,o,l,u){const y=o||this.parentInjector;if(!u&&null==n.ngModule&&y){const T=y.get(Mh,null);T&&(u=T)}const w=n.create(y,l,void 0,u);return this.insert(w.hostView,i),w}insert(n,i){const o=n._lView,l=o[1];if(Ks(o[3])){const W=this.indexOf(n);if(-1!==W)this.detach(W);else{const ee=o[3],ce=new xw(ee,ee[6],ee[3]);ce.detach(ce.indexOf(n))}}const u=this._adjustIndex(i),y=this._lContainer;!function(t,n,i,o){const l=10+o,u=i.length;o>0&&(i[l-1][4]=n),o<u-10?(n[4]=i[l],Ci(i,10+o,n)):(i.push(n),n[4]=null),n[3]=i;const y=n[17];null!==y&&i!==y&&function(t,n){const i=t[9];n[16]!==n[3][3][16]&&(t[2]=!0),null===i?t[9]=[n]:i.push(n)}(y,n);const w=n[19];null!==w&&w.insertView(t),n[2]|=128}(l,o,y,u);const w=jh(u,y),T=o[11],N=Gh(T,y[7]);return null!==N&&function(t,n,i,o,l,u){o[0]=l,o[6]=n,Lc(t,o,i,1,l,u)}(l,y[6],T,o,N,w),n.attachToViewContainerRef(),Ci(bb(y),u,n),n}move(n,i){return this.insert(n,i)}indexOf(n){const i=ww(this._lContainer);return null!==i?i.indexOf(n):-1}remove(n){const i=this._adjustIndex(n,-1),o=Ha(this._lContainer,i);o&&(Ri(bb(this._lContainer),i),wg(o[1],o))}detach(n){const i=this._adjustIndex(n,-1),o=Ha(this._lContainer,i);return o&&null!=Ri(bb(this._lContainer),i)?new jm(o):null}_adjustIndex(n,i=0){return null==n?this.length+i:n}};function ww(t){return t[8]}function bb(t){return t[8]||(t[8]=[])}function Ew(t,n){let i;const o=n[t.index];if(Ks(o))i=o;else{let l;if(8&t.type)l=Sr(o);else{const u=n[11];l=u.createComment("");const y=Gi(t,n);bd(u,Gh(u,y),l,function(t,n){return Zn(t)?t.nextSibling(n):n.nextSibling}(u,y),!1)}n[t.index]=i=Yg(o,n,l,t),df(n,i)}return new xw(i,t,n)}const Vp={};class Gw extends da{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const i=is(n);return new Ww(i,this.ngModule)}}function jw(t){const n=[];for(let i in t)t.hasOwnProperty(i)&&n.push({propName:t[i],templateName:i});return n}const nS=new Kt("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>gn});class Ww extends hu{constructor(n,i){super(),this.componentDef=n,this.ngModule=i,this.componentType=n.type,this.selector=n.selectors.map(Yv).join(","),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!i}get inputs(){return jw(this.componentDef.inputs)}get outputs(){return jw(this.componentDef.outputs)}create(n,i,o,l){const u=(l=l||this.ngModule)?function(t,n){return{get:(i,o,l)=>{const u=t.get(i,Vp,l);return u!==Vp||o===Vp?u:n.get(i,o,l)}}}(n,l.injector):n,y=u.get(cv,Jr),w=u.get(_b,null),T=y.createRenderer(null,this.componentDef),N=this.componentDef.selectors[0][0]||"div",W=o?function(t,n,i){if(Zn(t))return t.selectRootElement(n,i===zn.ShadowDom);let o="string"==typeof n?t.querySelector(n):n;return o.textContent="",o}(T,o,this.componentDef.encapsulation):ar(y.createRenderer(null,this.componentDef),N,function(t){const n=t.toLowerCase();return"svg"===n?z:"math"===n?"http://www.w3.org/1998/MathML/":null}(N)),ee=this.componentDef.onPush?576:528,ce=function(t,n){return{components:[],scheduler:t||gn,clean:sh,playerHandler:n||null,flags:0}}(),De=Jf(0,null,null,1,0,null,null,null,null,null),ze=Zf(null,De,ce,ee,null,null,y,T,w,u);let ft,tt;bs(ze);try{const Qt=function(t,n,i,o,l,u){const y=i[1];i[20]=t;const T=nf(y,20,2,"#host",null),N=T.mergedAttrs=n.hostAttrs;null!==N&&(wd(T,N,!0),null!==t&&(ri(l,t,N),null!==T.classes&&Rg(l,t,T.classes),null!==T.styles&&Sy(l,t,T.styles)));const W=o.createRenderer(t,n),ee=Zf(i,$y(n),null,n.onPush?64:16,i[20],T,o,W,u||null,null);return y.firstCreatePass&&(Zr(eo(T,i),y,n.type),cf(y,T),uf(T,i.length,1)),df(i,ee),i[20]=ee}(W,this.componentDef,ze,y,T);if(W)if(o)ri(T,W,["ng-version",hw.full]);else{const{attrs:Tt,classes:ur}=function(t){const n=[],i=[];let o=1,l=2;for(;o<t.length;){let u=t[o];if("string"==typeof u)2===l?""!==u&&n.push(u,t[++o]):8===l&&i.push(u);else{if(!nc(l))break;l=u}o++}return{attrs:n,classes:i}}(this.componentDef.selectors[0]);Tt&&ri(T,W,Tt),ur&&ur.length>0&&Rg(T,W,ur.join(" "))}if(tt=ia(De,20),void 0!==i){const Tt=tt.projection=[];for(let ur=0;ur<this.ngContentSelectors.length;ur++){const Tr=i[ur];Tt.push(null!=Tr?Array.from(Tr):null)}}ft=function(t,n,i,o,l){const u=i[1],y=function(t,n,i){const o=ps();t.firstCreatePass&&(i.providersResolver&&i.providersResolver(i),rh(t,o,n,rf(t,n,1,null),i));const l=V(n,t,o.directiveStart,o);ie(l,n);const u=Gi(o,n);return u&&ie(u,n),l}(u,i,n);if(o.components.push(y),t[8]=y,l&&l.forEach(T=>T(y,n)),n.contentQueries){const T=ps();n.contentQueries(1,y,T.directiveStart)}const w=ps();return!u.firstCreatePass||null===n.hostBindings&&null===n.hostAttrs||(Hs(w.index),tp(i[1],w,0,w.directiveStart,w.directiveEnd,n),xd(n,y)),y}(Qt,this.componentDef,ze,ce,[vp]),Qf(De,ze,null)}finally{wa()}return new sS(this.componentType,ft,Fp(tt,ze),ze,tt)}}class sS extends class{}{constructor(n,i,o,l,u){super(),this.location=o,this._rootLView=l,this._tNode=u,this.instance=i,this.hostView=this.changeDetectorRef=new HM(l),this.componentType=n}get injector(){return new Re(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}const zp=new Map;class lS extends Mh{constructor(n,i){super(),this._parent=i,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Gw(this);const o=_s(n),l=n[zl]||null;l&&P(l),this._bootstrapComponents=ho(o.bootstrap),this._r3Injector=rm(n,i,[{provide:Mh,useValue:this},{provide:da,useValue:this.componentFactoryResolver}],Xe(n)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(n)}get(n,i=Fi.THROW_IF_NOT_FOUND,o=Vn.Default){return n===Fi||n===Mh||n===hl?this:this._r3Injector.get(n,i,o)}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(i=>i()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class Lb extends bw{constructor(n){super(),this.moduleType=n,null!==_s(n)&&function(t){const n=new Set;!function i(o){const l=_s(o,!0),u=l.id;null!==u&&(function(t,n,i){if(n&&n!==i)throw new Error(`Duplicate module registered for ${t} - ${Xe(n)} vs ${Xe(n.name)}`)}(u,zp.get(u),o),zp.set(u,o));const y=ho(l.imports);for(const w of y)n.has(w)||(n.add(w),i(w))}(t)}(n)}create(n){return new lS(this.moduleType,n)}}function Yw(t,n,i,o){return Xw(Ot(),Rt(),t,n,i,o)}function Jm(t,n){const i=t[n];return i===Fr?void 0:i}function Xw(t,n,i,o,l,u){const y=n+i;return yo(t,y,l)?Ga(t,y+1,u?o.call(u,l):o(l)):Jm(t,y+1)}function eE(t,n){const i=Hr();let o;const l=t+20;i.firstCreatePass?(o=function(t,n){if(n)for(let i=n.length-1;i>=0;i--){const o=n[i];if(t===o.name)return o}throw new er("302",`The pipe '${t}' could not be found!`)}(n,i.pipeRegistry),i.data[l]=o,o.onDestroy&&(i.destroyHooks||(i.destroyHooks=[])).push(l,o.onDestroy)):o=i.data[l];const u=o.factory||(o.factory=uo(o.type)),y=Tn(Cf);try{const w=Eo(!1),T=u();return Eo(w),function(t,n,i,o){i>=t.data.length&&(t.data[i]=null,t.blueprint[i]=null),n[i]=o}(i,Ot(),l,T),T}finally{Tn(y)}}function tE(t,n,i){const o=t+20,l=Ot(),u=Qn(l,o);return ty(l,ey(l,o)?Xw(l,Rt(),n,u.transform,i,u):u.transform(i))}function nE(t,n,i,o,l){const u=t+20,y=Ot(),w=Qn(y,u);return ty(y,ey(y,u)?function(t,n,i,o,l,u,y,w){const T=n+i;return bp(t,T,l,u,y)?Ga(t,T+3,w?o.call(w,l,u,y):o(l,u,y)):Jm(t,T+3)}(y,Rt(),n,w.transform,i,o,l,w):w.transform(i,o,l))}function ey(t,n){return t[1].data[n].pure}function ty(t,n){return mo.isWrapped(n)&&(n=mo.unwrap(n),t[jn.lFrame.bindingIndex]=Fr),n}function Ob(t){return n=>{setTimeout(t,void 0,n)}}const Zu=class extends Me.xQ{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,i,o){var l,u,y;let w=n,T=i||(()=>null),N=o;if(n&&"object"==typeof n){const ee=n;w=null===(l=ee.next)||void 0===l?void 0:l.bind(ee),T=null===(u=ee.error)||void 0===u?void 0:u.bind(ee),N=null===(y=ee.complete)||void 0===y?void 0:y.bind(ee)}this.__isAsync&&(T=Ob(T),w&&(w=Ob(w)),N&&(N=Ob(N)));const W=super.subscribe({next:w,error:T,complete:N});return n instanceof Te.w&&n.add(W),W}};function ES(){return this._results[Cd()]()}class _v{constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const i=Cd(),o=_v.prototype;o[i]||(o[i]=ES)}get changes(){return this._changes||(this._changes=new Zu)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,i){return this._results.reduce(n,i)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,i){const o=this;o.dirty=!1;const l=fi(n);(this._changesDetected=!function(t,n,i){if(t.length!==n.length)return!1;for(let o=0;o<t.length;o++){let l=t[o],u=n[o];if(i&&(l=i(l),u=i(u)),u!==l)return!1}return!0}(o._results,l,i))&&(o._results=l,o.length=l.length,o.last=l[this.length-1],o.first=l[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class Nb{constructor(n){this.queryList=n,this.matches=null}clone(){return new Nb(this.queryList)}setDirty(){this.queryList.setDirty()}}class Fb{constructor(n=[]){this.queries=n}createEmbeddedView(n){const i=n.queries;if(null!==i){const o=null!==n.contentQueries?n.contentQueries[0]:i.length,l=[];for(let u=0;u<o;u++){const y=i.getByIndex(u);l.push(this.queries[y.indexInDeclarationView].clone())}return new Fb(l)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let i=0;i<this.queries.length;i++)null!==dE(n,i).matches&&this.queries[i].setDirty()}}class rE{constructor(n,i,o=null){this.predicate=n,this.flags=i,this.read=o}}class kb{constructor(n=[]){this.queries=n}elementStart(n,i){for(let o=0;o<this.queries.length;o++)this.queries[o].elementStart(n,i)}elementEnd(n){for(let i=0;i<this.queries.length;i++)this.queries[i].elementEnd(n)}embeddedTView(n){let i=null;for(let o=0;o<this.length;o++){const l=null!==i?i.length:0,u=this.getByIndex(o).embeddedTView(n,l);u&&(u.indexInDeclarationView=o,null!==i?i.push(u):i=[u])}return null!==i?new kb(i):null}template(n,i){for(let o=0;o<this.queries.length;o++)this.queries[o].template(n,i)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class Bb{constructor(n,i=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=i}elementStart(n,i){this.isApplyingToNode(i)&&this.matchTNode(n,i)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,i){this.elementStart(n,i)}embeddedTView(n,i){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,i),new Bb(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const i=this._declarationNodeIndex;let o=n.parent;for(;null!==o&&8&o.type&&o.index!==i;)o=o.parent;return i===(null!==o?o.index:-1)}return this._appliesToNextNode}matchTNode(n,i){const o=this.metadata.predicate;if(Array.isArray(o))for(let l=0;l<o.length;l++){const u=o[l];this.matchTNodeWithReadOption(n,i,CS(i,u)),this.matchTNodeWithReadOption(n,i,S(i,n,u,!1,!1))}else o===Wm?4&i.type&&this.matchTNodeWithReadOption(n,i,-1):this.matchTNodeWithReadOption(n,i,S(i,n,o,!1,!1))}matchTNodeWithReadOption(n,i,o){if(null!==o){const l=this.metadata.read;if(null!==l)if(l===Xu||l===pv||l===Wm&&4&i.type)this.addMatch(i.index,-2);else{const u=S(i,n,l,!1,!1);null!==u&&this.addMatch(i.index,u)}else this.addMatch(i.index,o)}}addMatch(n,i){null===this.matches?this.matches=[n,i]:this.matches.push(n,i)}}function CS(t,n){const i=t.localNames;if(null!==i)for(let o=0;o<i.length;o+=2)if(i[o]===n)return i[o+1];return null}function AS(t,n,i,o){return-1===i?function(t,n){return 11&t.type?Fp(t,n):4&t.type?hv(t,n):null}(n,t):-2===i?function(t,n,i){return i===Xu?Fp(n,t):i===Wm?hv(n,t):i===pv?Ew(n,t):void 0}(t,n,o):V(t,t[1],i,n)}function iE(t,n,i,o){const l=n[19].queries[o];if(null===l.matches){const u=t.data,y=i.matches,w=[];for(let T=0;T<y.length;T+=2){const N=y[T];w.push(N<0?null:AS(n,u[N],y[T+1],i.metadata.read))}l.matches=w}return l.matches}function Ub(t,n,i,o){const l=t.queries.getByIndex(i),u=l.matches;if(null!==u){const y=iE(t,n,l,i);for(let w=0;w<u.length;w+=2){const T=u[w];if(T>0)o.push(y[w/2]);else{const N=u[w+1],W=n[-T];for(let ee=10;ee<W.length;ee++){const ce=W[ee];ce[17]===ce[3]&&Ub(ce[1],ce,N,o)}if(null!==W[9]){const ee=W[9];for(let ce=0;ce<ee.length;ce++){const De=ee[ce];Ub(De[1],De,N,o)}}}}}return o}function sE(t){const n=Ot(),i=Hr(),o=as();he(o+1);const l=dE(i,o);if(t.dirty&&Pa(n)===(2==(2&l.metadata.flags))){if(null===l.matches)t.reset([]);else{const u=l.crossesNgTemplate?Ub(i,n,o,[]):iE(i,n,l,o);t.reset(u,dw),t.notifyOnChanges()}return!0}return!1}function oE(t,n,i){const o=Hr();o.firstCreatePass&&(uE(o,new rE(t,n,i),-1),2==(2&n)&&(o.staticViewQueries=!0)),cE(o,Ot(),n)}function aE(t,n,i,o){const l=Hr();if(l.firstCreatePass){const u=ps();uE(l,new rE(n,i,o),u.index),function(t,n){const i=t.contentQueries||(t.contentQueries=[]);n!==(i.length?i[i.length-1]:-1)&&i.push(t.queries.length-1,n)}(l,t),2==(2&i)&&(l.staticContentQueries=!0)}cE(l,Ot(),i)}function lE(){return t=Ot(),n=as(),t[19].queries[n].queryList;var t,n}function cE(t,n,i){const o=new _v(4==(4&i));Vu(t,n,o,o.destroy),null===n[19]&&(n[19]=new Fb),n[19].queries.push(new Nb(o))}function uE(t,n,i){null===t.queries&&(t.queries=new kb),t.queries.track(new Bb(n,i))}function dE(t,n){return t.queries.getByIndex(n)}function fE(t,n){return hv(t,n)}const Wb=new Kt("Application Initializer");let Gp=(()=>{class t{constructor(i){this.appInits=i,this.resolve=lv,this.reject=lv,this.initialized=!1,this.done=!1,this.donePromise=new Promise((o,l)=>{this.resolve=o,this.reject=l})}runInitializers(){if(this.initialized)return;const i=[],o=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let l=0;l<this.appInits.length;l++){const u=this.appInits[l]();if(Tp(u))i.push(u);else if(Ap(u)){const y=new Promise((w,T)=>{u.subscribe({complete:w,error:T})});i.push(y)}}Promise.all(i).then(()=>{o()}).catch(l=>{this.reject(l)}),0===i.length&&o(),this.initialized=!0}}return t.\u0275fac=function(i){return new(i||t)(us(Wb,8))},t.\u0275prov=pe({token:t,factory:t.\u0275fac}),t})();const RE=new Kt("AppId"),iC={provide:RE,useFactory:function(){return`${$b()}${$b()}${$b()}`},deps:[]};function $b(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const IE=new Kt("Platform Initializer"),PE=new Kt("Platform ID"),LE=new Kt("appBootstrapListener");let OE=(()=>{class t{log(i){console.log(i)}warn(i){console.warn(i)}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=pe({token:t,factory:t.\u0275fac}),t})();const wv=new Kt("LocaleId"),NE=new Kt("DefaultCurrencyCode");class oC{constructor(n,i){this.ngModuleFactory=n,this.componentFactories=i}}const qb=function(t){return new Lb(t)},aC=qb,lC=function(t){return Promise.resolve(qb(t))},FE=function(t){const n=qb(t),o=ho(_s(t).declarations).reduce((l,u)=>{const y=is(u);return y&&l.push(new Ww(y)),l},[]);return new oC(n,o)},cC=FE,uC=function(t){return Promise.resolve(FE(t))};let ry=(()=>{class t{constructor(){this.compileModuleSync=aC,this.compileModuleAsync=lC,this.compileModuleAndAllComponentsSync=cC,this.compileModuleAndAllComponentsAsync=uC}clearCache(){}clearCacheFor(i){}getModuleId(i){}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=pe({token:t,factory:t.\u0275fac}),t})();const hC=(()=>Promise.resolve(0))();function Yb(t){"undefined"==typeof Zone?hC.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class fc{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:o=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Zu(!1),this.onMicrotaskEmpty=new Zu(!1),this.onStable=new Zu(!1),this.onError=new Zu(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const l=this;l._nesting=0,l._outer=l._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(l._inner=l._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(l._inner=l._inner.fork(Zone.longStackTraceZoneSpec)),l.shouldCoalesceEventChangeDetection=!o&&i,l.shouldCoalesceRunChangeDetection=o,l.lastRequestAnimationFrameId=-1,l.nativeRequestAnimationFrame=function(){let t=Xn.requestAnimationFrame,n=Xn.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&n){const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i);const o=n[Zone.__symbol__("OriginalDelegate")];o&&(n=o)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function(t){const n=()=>{!function(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Xn,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Zb(t),t.isCheckStableRunning=!0,Xb(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Zb(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(i,o,l,u,y,w)=>{try{return kE(t),i.invokeTask(l,u,y,w)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===u.type||t.shouldCoalesceRunChangeDetection)&&n(),BE(t)}},onInvoke:(i,o,l,u,y,w,T)=>{try{return kE(t),i.invoke(l,u,y,w,T)}finally{t.shouldCoalesceRunChangeDetection&&n(),BE(t)}},onHasTask:(i,o,l,u)=>{i.hasTask(l,u),o===l&&("microTask"==u.change?(t._hasPendingMicrotasks=u.microTask,Zb(t),Xb(t)):"macroTask"==u.change&&(t.hasPendingMacrotasks=u.macroTask))},onHandleError:(i,o,l,u)=>(i.handleError(l,u),t.runOutsideAngular(()=>t.onError.emit(u)),!1)})}(l)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!fc.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(fc.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(n,i,o){return this._inner.run(n,i,o)}runTask(n,i,o,l){const u=this._inner,y=u.scheduleEventTask("NgZoneEvent: "+l,n,gC,lv,lv);try{return u.runTask(y,i,o)}finally{u.cancelTask(y)}}runGuarded(n,i,o){return this._inner.runGuarded(n,i,o)}runOutsideAngular(n){return this._outer.run(n)}}const gC={};function Xb(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Zb(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function kE(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function BE(t){t._nesting--,Xb(t)}class vC{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Zu,this.onMicrotaskEmpty=new Zu,this.onStable=new Zu,this.onError=new Zu}run(n,i,o){return n.apply(i,o)}runGuarded(n,i,o){return n.apply(i,o)}runOutsideAngular(n){return n()}runTask(n,i,o,l){return n.apply(i,o)}}let UE=(()=>{class t{constructor(i){this._ngZone=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),i.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{fc.assertNotInAngularZone(),Yb(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Yb(()=>{for(;0!==this._callbacks.length;){let i=this._callbacks.pop();clearTimeout(i.timeoutId),i.doneCb(this._didWork)}this._didWork=!1});else{let i=this.getPendingTasks();this._callbacks=this._callbacks.filter(o=>!o.updateCb||!o.updateCb(i)||(clearTimeout(o.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(i=>({source:i.source,creationLocation:i.creationLocation,data:i.data})):[]}addCallback(i,o,l){let u=-1;o&&o>0&&(u=setTimeout(()=>{this._callbacks=this._callbacks.filter(y=>y.timeoutId!==u),i(this._didWork,this.getPendingTasks())},o)),this._callbacks.push({doneCb:i,timeoutId:u,updateCb:l})}whenStable(i,o,l){if(l&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(i,o,l),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(i,o,l){return[]}}return t.\u0275fac=function(i){return new(i||t)(us(fc))},t.\u0275prov=pe({token:t,factory:t.\u0275fac}),t})(),VE=(()=>{class t{constructor(){this._applications=new Map,Qb.addToWindow(this)}registerApplication(i,o){this._applications.set(i,o)}unregisterApplication(i){this._applications.delete(i)}unregisterAllApplications(){this._applications.clear()}getTestability(i){return this._applications.get(i)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(i,o=!0){return Qb.findTestabilityInTree(this,i,o)}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=pe({token:t,factory:t.\u0275fac}),t})();class _C{addToWindow(n){}findTestabilityInTree(n,i,o){return null}}function bC(t){Qb=t}let Qb=new _C,zE=!0,HE=!1;function xC(){if(HE)throw new Error("Cannot enable prod mode after platform setup.");zE=!1}let mu;const jE=new Kt("AllowMultipleToken");class AC{constructor(n,i){this.name=n,this.token=i}}function WE(t,n,i=[]){const o=`Platform: ${n}`,l=new Kt(o);return(u=[])=>{let y=$E();if(!y||y.injector.get(jE,!1))if(t)t(i.concat(u).concat({provide:l,useValue:!0}));else{const w=i.concat(u).concat({provide:l,useValue:!0},{provide:Oc,useValue:"platform"});!function(t){if(mu&&!mu.destroyed&&!mu.injector.get(jE,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");mu=t.get(qE);const n=t.get(IE,null);n&&n.forEach(i=>i())}(Fi.create({providers:w,name:o}))}return function(t){const n=$E();if(!n)throw new Error("No platform exists!");if(!n.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return n}(l)}}function $E(){return mu&&!mu.destroyed?mu:null}let qE=(()=>{class t{constructor(i){this._injector=i,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(i,o){const w=function(t,n){let i;return i="noop"===t?new vC:("zone.js"===t?void 0:t)||new fc({enableLongStackTrace:(HE=!0,zE),shouldCoalesceEventChangeDetection:!!(null==n?void 0:n.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==n?void 0:n.ngZoneRunCoalescing)}),i}(o?o.ngZone:void 0,{ngZoneEventCoalescing:o&&o.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:o&&o.ngZoneRunCoalescing||!1}),T=[{provide:fc,useValue:w}];return w.run(()=>{const N=Fi.create({providers:T,parent:this.injector,name:i.moduleType.name}),W=i.create(N),ee=W.injector.get(to,null);if(!ee)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return w.runOutsideAngular(()=>{const ce=w.onError.subscribe({next:De=>{ee.handleError(De)}});W.onDestroy(()=>{Kb(this._modules,W),ce.unsubscribe()})}),function(t,n,i){try{const o=i();return Tp(o)?o.catch(l=>{throw n.runOutsideAngular(()=>t.handleError(l)),l}):o}catch(o){throw n.runOutsideAngular(()=>t.handleError(o)),o}}(ee,w,()=>{const ce=W.injector.get(Gp);return ce.runInitializers(),ce.donePromise.then(()=>(P(W.injector.get(wv,p)||p),this._moduleDoBootstrap(W),W))})})}bootstrapModule(i,o=[]){const l=YE({},o);return function(t,n,i){const o=new Lb(i);return Promise.resolve(o)}(0,0,i).then(u=>this.bootstrapModuleFactory(u,l))}_moduleDoBootstrap(i){const o=i.injector.get(iy);if(i._bootstrapComponents.length>0)i._bootstrapComponents.forEach(l=>o.bootstrap(l));else{if(!i.instance.ngDoBootstrap)throw new Error(`The module ${Xe(i.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);i.instance.ngDoBootstrap(o)}this._modules.push(i)}onDestroy(i){this._destroyListeners.push(i)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(i){return new(i||t)(us(Fi))},t.\u0275prov=pe({token:t,factory:t.\u0275fac}),t})();function YE(t,n){return Array.isArray(n)?n.reduce(YE,t):Object.assign(Object.assign({},t),n)}let iy=(()=>{class t{constructor(i,o,l,u,y){this._zone=i,this._injector=o,this._exceptionHandler=l,this._componentFactoryResolver=u,this._initStatus=y,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const w=new G.y(N=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{N.next(this._stable),N.complete()})}),T=new G.y(N=>{let W;this._zone.runOutsideAngular(()=>{W=this._zone.onStable.subscribe(()=>{fc.assertNotInAngularZone(),Yb(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,N.next(!0))})})});const ee=this._zone.onUnstable.subscribe(()=>{fc.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{N.next(!1)}))});return()=>{W.unsubscribe(),ee.unsubscribe()}});this.isStable=function(...t){let n=Number.POSITIVE_INFINITY,i=null,o=t[t.length-1];return(0,$.K)(o)?(i=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(n=t.pop())):"number"==typeof o&&(n=t.pop()),null===i&&1===t.length&&t[0]instanceof G.y?t[0]:(0,We.J)(n)((0,Ze.n)(t,i))}(w,T.pipe(t=>(0,K.x)()(function(t,n){return function(o){let l;l="function"==typeof t?t:function(){return t};const u=Object.create(o,Fe.N);return u.source=o,u.subjectFactory=l,u}}(_e)(t))))}bootstrap(i,o){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let l;l=i instanceof hu?i:this._componentFactoryResolver.resolveComponentFactory(i),this.componentTypes.push(l.componentType);const u=function(t){return t.isBoundToModule}(l)?void 0:this._injector.get(Mh),w=l.create(Fi.NULL,[],o||l.selector,u),T=w.location.nativeElement,N=w.injector.get(UE,null),W=N&&w.injector.get(VE);return N&&W&&W.registerApplication(T,N),w.onDestroy(()=>{this.detachView(w.hostView),Kb(this.components,w),W&&W.unregisterApplication(T)}),this._loadComponent(w),w}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let i of this._views)i.detectChanges()}catch(i){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(i))}finally{this._runningTick=!1}}attachView(i){const o=i;this._views.push(o),o.attachToAppRef(this)}detachView(i){const o=i;Kb(this._views,o),o.detachFromAppRef()}_loadComponent(i){this.attachView(i.hostView),this.tick(),this.components.push(i),this._injector.get(LE,[]).concat(this._bootstrapListeners).forEach(l=>l(i))}ngOnDestroy(){this._views.slice().forEach(i=>i.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(i){return new(i||t)(us(fc),us(Fi),us(to),us(da),us(Gp))},t.\u0275prov=pe({token:t,factory:t.\u0275fac}),t})();function Kb(t,n){const i=t.indexOf(n);i>-1&&t.splice(i,1)}class OC{}class FC{}const kC={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let BC=(()=>{class t{constructor(i,o){this._compiler=i,this._config=o||kC}load(i){return this.loadAndCompile(i)}loadAndCompile(i){let[o,l]=i.split("#");return void 0===l&&(l="default"),se(8255)(o).then(u=>u[l]).then(u=>KE(u,o,l)).then(u=>this._compiler.compileModuleAsync(u))}loadFactory(i){let[o,l]=i.split("#"),u="NgFactory";return void 0===l&&(l="default",u=""),se(8255)(this._config.factoryPathPrefix+o+this._config.factoryPathSuffix).then(y=>y[l+u]).then(y=>KE(y,o,l))}}return t.\u0275fac=function(i){return new(i||t)(us(ry),us(FC,8))},t.\u0275prov=pe({token:t,factory:t.\u0275fac}),t})();function KE(t,n,i){if(!t)throw new Error(`Cannot find '${i}' in '${n}'`);return t}const $C=function(t){return null},YC=WE(null,"core",[{provide:PE,useValue:"unknown"},{provide:qE,deps:[Fi]},{provide:VE,deps:[]},{provide:OE,deps:[]}]),JC=[{provide:iy,useClass:iy,deps:[fc,Fi,to,da,Gp]},{provide:nS,deps:[fc],useFactory:function(t){let n=[];return t.onStable.subscribe(()=>{for(;n.length;)n.pop()()}),function(i){n.push(i)}}},{provide:Gp,useClass:Gp,deps:[[new Sc,Wb]]},{provide:ry,useClass:ry,deps:[]},iC,{provide:uv,useFactory:function(){return ZM},deps:[]},{provide:dv,useFactory:function(){return QM},deps:[]},{provide:wv,useFactory:function(t){return P(t=t||"undefined"!=typeof $localize&&$localize.locale||p),t},deps:[[new ld(wv),new Sc,new Qc]]},{provide:NE,useValue:"USD"}];let tT=(()=>{class t{constructor(i){}}return t.\u0275fac=function(i){return new(i||t)(us(iy))},t.\u0275mod=so({type:t}),t.\u0275inj=Ee({providers:JC}),t})()},9075:(Nt,ut,se)=>{"use strict";se.d(ut,{b2:()=>vs,q6:()=>xr});var G=se(8583),$=se(639);class We extends G.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Ze extends We{static makeCurrent(){(0,G.HT)(new Ze)}onAndCancel(ke,ae,Qe){return ke.addEventListener(ae,Qe,!1),()=>{ke.removeEventListener(ae,Qe,!1)}}dispatchEvent(ke,ae){ke.dispatchEvent(ae)}remove(ke){ke.parentNode&&ke.parentNode.removeChild(ke)}createElement(ke,ae){return(ae=ae||this.getDefaultDocument()).createElement(ke)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(ke){return ke.nodeType===Node.ELEMENT_NODE}isShadowRoot(ke){return ke instanceof DocumentFragment}getGlobalEventTarget(ke,ae){return"window"===ae?window:"document"===ae?ke:"body"===ae?ke.body:null}getBaseHref(ke){const ae=(Ae=Ae||document.querySelector("base"),Ae?Ae.getAttribute("href"):null);return null==ae?null:function(He){Te=Te||document.createElement("a"),Te.setAttribute("href",He);const ke=Te.pathname;return"/"===ke.charAt(0)?ke:`/${ke}`}(ae)}resetBaseElement(){Ae=null}getUserAgent(){return window.navigator.userAgent}getCookie(ke){return(0,G.Mx)(document.cookie,ke)}}let Te,Ae=null;const Be=new $.OlP("TRANSITION_ID"),K=[{provide:$.ip1,useFactory:function(He,ke,ae){return()=>{ae.get($.CZH).donePromise.then(()=>{const Qe=(0,G.q)(),gt=ke.querySelectorAll(`style[ng-transition="${He}"]`);for(let On=0;On<gt.length;On++)Qe.remove(gt[On])})}},deps:[Be,G.K0,$.zs3],multi:!0}];class _e{static init(){(0,$.VLi)(new _e)}addToWindow(ke){$.dqk.getAngularTestability=(Qe,gt=!0)=>{const On=ke.findTestabilityInTree(Qe,gt);if(null==On)throw new Error("Could not find testability for element.");return On},$.dqk.getAllAngularTestabilities=()=>ke.getAllTestabilities(),$.dqk.getAllAngularRootElements=()=>ke.getAllRootElements(),$.dqk.frameworkStabilizers||($.dqk.frameworkStabilizers=[]),$.dqk.frameworkStabilizers.push(Qe=>{const gt=$.dqk.getAllAngularTestabilities();let On=gt.length,mn=!1;const In=function(Ui){mn=mn||Ui,On--,0==On&&Qe(mn)};gt.forEach(function(Ui){Ui.whenStable(In)})})}findTestabilityInTree(ke,ae,Qe){if(null==ae)return null;const gt=ke.getTestability(ae);return null!=gt?gt:Qe?(0,G.q)().isShadowRoot(ae)?this.findTestabilityInTree(ke,ae.host,!0):this.findTestabilityInTree(ke,ae.parentElement,!0):null}}let Ue=(()=>{class He{build(){return new XMLHttpRequest}}return He.\u0275fac=function(ae){return new(ae||He)},He.\u0275prov=$.Yz7({token:He,factory:He.\u0275fac}),He})();const nr=new $.OlP("EventManagerPlugins");let Rn=(()=>{class He{constructor(ae,Qe){this._zone=Qe,this._eventNameToPlugin=new Map,ae.forEach(gt=>gt.manager=this),this._plugins=ae.slice().reverse()}addEventListener(ae,Qe,gt){return this._findPluginFor(Qe).addEventListener(ae,Qe,gt)}addGlobalEventListener(ae,Qe,gt){return this._findPluginFor(Qe).addGlobalEventListener(ae,Qe,gt)}getZone(){return this._zone}_findPluginFor(ae){const Qe=this._eventNameToPlugin.get(ae);if(Qe)return Qe;const gt=this._plugins;for(let On=0;On<gt.length;On++){const mn=gt[On];if(mn.supports(ae))return this._eventNameToPlugin.set(ae,mn),mn}throw new Error(`No event manager plugin found for event ${ae}`)}}return He.\u0275fac=function(ae){return new(ae||He)($.LFG(nr),$.LFG($.R0b))},He.\u0275prov=$.Yz7({token:He,factory:He.\u0275fac}),He})();class rr{constructor(ke){this._doc=ke}addGlobalEventListener(ke,ae,Qe){const gt=(0,G.q)().getGlobalEventTarget(this._doc,ke);if(!gt)throw new Error(`Unsupported event target ${gt} for event ${ae}`);return this.addEventListener(gt,ae,Qe)}}let Zt=(()=>{class He{constructor(){this._stylesSet=new Set}addStyles(ae){const Qe=new Set;ae.forEach(gt=>{this._stylesSet.has(gt)||(this._stylesSet.add(gt),Qe.add(gt))}),this.onStylesAdded(Qe)}onStylesAdded(ae){}getAllStyles(){return Array.from(this._stylesSet)}}return He.\u0275fac=function(ae){return new(ae||He)},He.\u0275prov=$.Yz7({token:He,factory:He.\u0275fac}),He})(),ki=(()=>{class He extends Zt{constructor(ae){super(),this._doc=ae,this._hostNodes=new Map,this._hostNodes.set(ae.head,[])}_addStylesToHost(ae,Qe,gt){ae.forEach(On=>{const mn=this._doc.createElement("style");mn.textContent=On,gt.push(Qe.appendChild(mn))})}addHost(ae){const Qe=[];this._addStylesToHost(this._stylesSet,ae,Qe),this._hostNodes.set(ae,Qe)}removeHost(ae){const Qe=this._hostNodes.get(ae);Qe&&Qe.forEach($t),this._hostNodes.delete(ae)}onStylesAdded(ae){this._hostNodes.forEach((Qe,gt)=>{this._addStylesToHost(ae,gt,Qe)})}ngOnDestroy(){this._hostNodes.forEach(ae=>ae.forEach($t))}}return He.\u0275fac=function(ae){return new(ae||He)($.LFG(G.K0))},He.\u0275prov=$.Yz7({token:He,factory:He.\u0275fac}),He})();function $t(He){(0,G.q)().remove(He)}const vn={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Un=/%COMP%/g;function Lt(He,ke,ae){for(let Qe=0;Qe<ke.length;Qe++){let gt=ke[Qe];Array.isArray(gt)?Lt(He,gt,ae):(gt=gt.replace(Un,He),ae.push(gt))}return ae}function ln(He){return ke=>{if("__ngUnwrap__"===ke)return He;!1===He(ke)&&(ke.preventDefault(),ke.returnValue=!1)}}let cn=(()=>{class He{constructor(ae,Qe,gt){this.eventManager=ae,this.sharedStylesHost=Qe,this.appId=gt,this.rendererByCompId=new Map,this.defaultRenderer=new Qr(ae)}createRenderer(ae,Qe){if(!ae||!Qe)return this.defaultRenderer;switch(Qe.encapsulation){case $.ifc.Emulated:{let gt=this.rendererByCompId.get(Qe.id);return gt||(gt=new qe(this.eventManager,this.sharedStylesHost,Qe,this.appId),this.rendererByCompId.set(Qe.id,gt)),gt.applyToHost(ae),gt}case 1:case $.ifc.ShadowDom:return new Ee(this.eventManager,this.sharedStylesHost,ae,Qe);default:if(!this.rendererByCompId.has(Qe.id)){const gt=Lt(Qe.id,Qe.styles,[]);this.sharedStylesHost.addStyles(gt),this.rendererByCompId.set(Qe.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return He.\u0275fac=function(ae){return new(ae||He)($.LFG(Rn),$.LFG(ki),$.LFG($.AFp))},He.\u0275prov=$.Yz7({token:He,factory:He.\u0275fac}),He})();class Qr{constructor(ke){this.eventManager=ke,this.data=Object.create(null)}destroy(){}createElement(ke,ae){return ae?document.createElementNS(vn[ae]||ae,ke):document.createElement(ke)}createComment(ke){return document.createComment(ke)}createText(ke){return document.createTextNode(ke)}appendChild(ke,ae){ke.appendChild(ae)}insertBefore(ke,ae,Qe){ke&&ke.insertBefore(ae,Qe)}removeChild(ke,ae){ke&&ke.removeChild(ae)}selectRootElement(ke,ae){let Qe="string"==typeof ke?document.querySelector(ke):ke;if(!Qe)throw new Error(`The selector "${ke}" did not match any elements`);return ae||(Qe.textContent=""),Qe}parentNode(ke){return ke.parentNode}nextSibling(ke){return ke.nextSibling}setAttribute(ke,ae,Qe,gt){if(gt){ae=gt+":"+ae;const On=vn[gt];On?ke.setAttributeNS(On,ae,Qe):ke.setAttribute(ae,Qe)}else ke.setAttribute(ae,Qe)}removeAttribute(ke,ae,Qe){if(Qe){const gt=vn[Qe];gt?ke.removeAttributeNS(gt,ae):ke.removeAttribute(`${Qe}:${ae}`)}else ke.removeAttribute(ae)}addClass(ke,ae){ke.classList.add(ae)}removeClass(ke,ae){ke.classList.remove(ae)}setStyle(ke,ae,Qe,gt){gt&($.JOm.DashCase|$.JOm.Important)?ke.style.setProperty(ae,Qe,gt&$.JOm.Important?"important":""):ke.style[ae]=Qe}removeStyle(ke,ae,Qe){Qe&$.JOm.DashCase?ke.style.removeProperty(ae):ke.style[ae]=""}setProperty(ke,ae,Qe){ke[ae]=Qe}setValue(ke,ae){ke.nodeValue=ae}listen(ke,ae,Qe){return"string"==typeof ke?this.eventManager.addGlobalEventListener(ke,ae,ln(Qe)):this.eventManager.addEventListener(ke,ae,ln(Qe))}}class qe extends Qr{constructor(ke,ae,Qe,gt){super(ke),this.component=Qe;const On=Lt(gt+"-"+Qe.id,Qe.styles,[]);ae.addStyles(On),this.contentAttr="_ngcontent-%COMP%".replace(Un,gt+"-"+Qe.id),this.hostAttr="_nghost-%COMP%".replace(Un,gt+"-"+Qe.id)}applyToHost(ke){super.setAttribute(ke,this.hostAttr,"")}createElement(ke,ae){const Qe=super.createElement(ke,ae);return super.setAttribute(Qe,this.contentAttr,""),Qe}}class Ee extends Qr{constructor(ke,ae,Qe,gt){super(ke),this.sharedStylesHost=ae,this.hostEl=Qe,this.shadowRoot=Qe.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const On=Lt(gt.id,gt.styles,[]);for(let mn=0;mn<On.length;mn++){const In=document.createElement("style");In.textContent=On[mn],this.shadowRoot.appendChild(In)}}nodeOrShadowRoot(ke){return ke===this.hostEl?this.shadowRoot:ke}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(ke,ae){return super.appendChild(this.nodeOrShadowRoot(ke),ae)}insertBefore(ke,ae,Qe){return super.insertBefore(this.nodeOrShadowRoot(ke),ae,Qe)}removeChild(ke,ae){return super.removeChild(this.nodeOrShadowRoot(ke),ae)}parentNode(ke){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(ke)))}}let Ut=(()=>{class He extends rr{constructor(ae){super(ae)}supports(ae){return!0}addEventListener(ae,Qe,gt){return ae.addEventListener(Qe,gt,!1),()=>this.removeEventListener(ae,Qe,gt)}removeEventListener(ae,Qe,gt){return ae.removeEventListener(Qe,gt)}}return He.\u0275fac=function(ae){return new(ae||He)($.LFG(G.K0))},He.\u0275prov=$.Yz7({token:He,factory:He.\u0275fac}),He})();const ci=["alt","control","meta","shift"],Tn={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Zo={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},hc={alt:He=>He.altKey,control:He=>He.ctrlKey,meta:He=>He.metaKey,shift:He=>He.shiftKey};let zn=(()=>{class He extends rr{constructor(ae){super(ae)}supports(ae){return null!=He.parseEventName(ae)}addEventListener(ae,Qe,gt){const On=He.parseEventName(Qe),mn=He.eventCallback(On.fullKey,gt,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,G.q)().onAndCancel(ae,On.domEventName,mn))}static parseEventName(ae){const Qe=ae.toLowerCase().split("."),gt=Qe.shift();if(0===Qe.length||"keydown"!==gt&&"keyup"!==gt)return null;const On=He._normalizeKey(Qe.pop());let mn="";if(ci.forEach(Ui=>{const ao=Qe.indexOf(Ui);ao>-1&&(Qe.splice(ao,1),mn+=Ui+".")}),mn+=On,0!=Qe.length||0===On.length)return null;const In={};return In.domEventName=gt,In.fullKey=mn,In}static getEventFullKey(ae){let Qe="",gt=function(He){let ke=He.key;if(null==ke){if(ke=He.keyIdentifier,null==ke)return"Unidentified";ke.startsWith("U+")&&(ke=String.fromCharCode(parseInt(ke.substring(2),16)),3===He.location&&Zo.hasOwnProperty(ke)&&(ke=Zo[ke]))}return Tn[ke]||ke}(ae);return gt=gt.toLowerCase()," "===gt?gt="space":"."===gt&&(gt="dot"),ci.forEach(On=>{On!=gt&&hc[On](ae)&&(Qe+=On+".")}),Qe+=gt,Qe}static eventCallback(ae,Qe,gt){return On=>{He.getEventFullKey(On)===ae&&gt.runGuarded(()=>Qe(On))}}static _normalizeKey(ae){switch(ae){case"esc":return"escape";default:return ae}}}return He.\u0275fac=function(ae){return new(ae||He)($.LFG(G.K0))},He.\u0275prov=$.Yz7({token:He,factory:He.\u0275fac}),He})();const xr=(0,$.eFA)($._c5,"browser",[{provide:$.Lbi,useValue:G.bD},{provide:$.g9A,useValue:function(){Ze.makeCurrent(),_e.init()},multi:!0},{provide:G.K0,useFactory:function(){return(0,$.RDi)(document),document},deps:[]}]),zl=[[],{provide:$.zSh,useValue:"root"},{provide:$.qLn,useFactory:function(){return new $.qLn},deps:[]},{provide:nr,useClass:Ut,multi:!0,deps:[G.K0,$.R0b,$.Lbi]},{provide:nr,useClass:zn,multi:!0,deps:[G.K0]},[],{provide:cn,useClass:cn,deps:[Rn,ki,$.AFp]},{provide:$.FYo,useExisting:cn},{provide:Zt,useExisting:ki},{provide:ki,useClass:ki,deps:[G.K0]},{provide:$.dDg,useClass:$.dDg,deps:[$.R0b]},{provide:Rn,useClass:Rn,deps:[nr,$.R0b]},{provide:G.JF,useClass:Ue,deps:[]},[]];let vs=(()=>{class He{constructor(ae){if(ae)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(ae){return{ngModule:He,providers:[{provide:$.AFp,useValue:ae.appId},{provide:Be,useExisting:$.AFp},K]}}}return He.\u0275fac=function(ae){return new(ae||He)($.LFG(He,12))},He.\u0275mod=$.oAB({type:He}),He.\u0275inj=$.cJS({providers:zl,imports:[G.ez,$.hGG]}),He})();"undefined"!=typeof window&&window},931:(Nt,ut,se)=>{"use strict";se.d(ut,{rH:()=>Na,yS:()=>Xl,Bz:()=>Ho,lC:()=>Fa});var G=se(8583),$=se(639),We=se(4869),Ze=se(9796),Ae=se(7393);class Me extends Ae.L{notifyNext(b,_,R,F,j){this.destination.next(_)}notifyError(b,_){this.destination.error(b)}notifyComplete(b){this.destination.complete()}}class Te extends Ae.L{constructor(b,_,R){super(),this.parent=b,this.outerValue=_,this.outerIndex=R,this.index=0}_next(b){this.parent.notifyNext(this.outerValue,b,this.outerIndex,this.index++,this)}_error(b){this.parent.notifyError(b,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}var Fe=se(7444),Be=se(7574);function J(M,b,_,R,F=new Te(M,_,R)){if(!F.closed)return b instanceof Be.y?b.subscribe(F):(0,Fe.s)(b)(F)}var K=se(6693);const _e={};class Ve{constructor(b){this.resultSelector=b}call(b,_){return _.subscribe(new at(b,this.resultSelector))}}class at extends Me{constructor(b,_){super(b),this.resultSelector=_,this.active=0,this.values=[],this.observables=[]}_next(b){this.values.push(_e),this.observables.push(b)}_complete(){const b=this.observables,_=b.length;if(0===_)this.destination.complete();else{this.active=_,this.toRespond=_;for(let R=0;R<_;R++)this.add(J(this,b[R],void 0,R))}}notifyComplete(b){0==(this.active-=1)&&this.destination.complete()}notifyNext(b,_,R){const F=this.values,oe=this.toRespond?F[R]===_e?--this.toRespond:this.toRespond:0;F[R]=_,0===oe&&(this.resultSelector?this._tryResultSelector(F):this.destination.next(F.slice()))}_tryResultSelector(b){let _;try{_=this.resultSelector.apply(this,b)}catch(R){return void this.destination.error(R)}this.destination.next(_)}}const kt=(()=>{function M(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return M.prototype=Object.create(Error.prototype),M})();var St=se(5917),Wt=se(3282);function hn(...M){return(0,Wt.J)(1)((0,St.of)(...M))}var an=se(4402),er=se(9193);function Dn(M){return new Be.y(b=>{let _;try{_=M()}catch(F){return void b.error(F)}return(_?(0,an.D)(_):(0,er.c)()).subscribe(b)})}var Cn=se(6215),st=se(2441),Bt=se(9765),nn=se(8002),nr=se(5345);function Rn(M,b){return"function"==typeof b?_=>_.pipe(Rn((R,F)=>(0,an.D)(M(R,F)).pipe((0,nn.U)((j,oe)=>b(R,j,F,oe))))):_=>_.lift(new rr(M))}class rr{constructor(b){this.project=b}call(b,_){return _.subscribe(new Zt(b,this.project))}}class Zt extends nr.Ds{constructor(b,_){super(b),this.project=_,this.index=0}_next(b){let _;const R=this.index++;try{_=this.project(b,R)}catch(F){return void this.destination.error(F)}this._innerSub(_)}_innerSub(b){const _=this.innerSubscription;_&&_.unsubscribe();const R=new nr.IY(this),F=this.destination;F.add(R),this.innerSubscription=(0,nr.ft)(b,R),this.innerSubscription!==R&&F.add(this.innerSubscription)}_complete(){const{innerSubscription:b}=this;(!b||b.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(b){this.destination.next(b)}}function $t(M,b){let _=!1;return arguments.length>=2&&(_=!0),function(F){return F.lift(new vn(M,b,_))}}class vn{constructor(b,_,R=!1){this.accumulator=b,this.seed=_,this.hasSeed=R}call(b,_){return _.subscribe(new Un(b,this.accumulator,this.seed,this.hasSeed))}}class Un extends Ae.L{constructor(b,_,R,F){super(b),this.accumulator=_,this._seed=R,this.hasSeed=F,this.index=0}get seed(){return this._seed}set seed(b){this.hasSeed=!0,this._seed=b}_next(b){if(this.hasSeed)return this._tryNext(b);this.seed=b,this.destination.next(b)}_tryNext(b){const _=this.index++;let R;try{R=this.accumulator(this.seed,b,_)}catch(F){this.destination.error(F)}this.seed=R,this.destination.next(R)}}function Hn(M){return function(_){const R=new ts(M),F=_.lift(R);return R.caught=F}}class ts{constructor(b){this.selector=b}call(b,_){return _.subscribe(new _i(b,this.selector,this.caught))}}class _i extends nr.Ds{constructor(b,_,R){super(b),this.selector=_,this.caught=R}error(b){if(!this.isStopped){let _;try{_=this.selector(b,this.caught)}catch(j){return void super.error(j)}this._unsubscribeAndRecycle();const R=new nr.IY(this);this.add(R);const F=(0,nr.ft)(_,R);F!==R&&this.add(F)}}}var Hi=se(9773);function ns(M,b){return(0,Hi.zg)(M,b,1)}var _n=se(5435),Lt=se(7108);function ln(M){return function(_){return 0===M?(0,er.c)():_.lift(new Pn(M))}}class Pn{constructor(b){if(this.total=b,this.total<0)throw new Lt.W}call(b,_){return _.subscribe(new cn(b,this.total))}}class cn extends Ae.L{constructor(b,_){super(b),this.total=_,this.ring=new Array,this.count=0}_next(b){const _=this.ring,R=this.total,F=this.count++;_.length<R?_.push(b):_[F%R]=b}_complete(){const b=this.destination;let _=this.count;if(_>0){const R=this.count>=this.total?this.total:this.count,F=this.ring;for(let j=0;j<R;j++){const oe=_++%R;b.next(F[oe])}}b.complete()}}function Qr(M=pe){return b=>b.lift(new Br(M))}class Br{constructor(b){this.errorFactory=b}call(b,_){return _.subscribe(new Ta(b,this.errorFactory))}}class Ta extends Ae.L{constructor(b,_){super(b),this.errorFactory=_,this.hasValue=!1}_next(b){this.hasValue=!0,this.destination.next(b)}_complete(){if(this.hasValue)return this.destination.complete();{let b;try{b=this.errorFactory()}catch(_){b=_}this.destination.error(b)}}}function pe(){return new kt}function qe(M=null){return b=>b.lift(new Ee(M))}class Ee{constructor(b){this.defaultValue=b}call(b,_){return _.subscribe(new Ut(b,this.defaultValue))}}class Ut extends Ae.L{constructor(b,_){super(b),this.defaultValue=_,this.isEmpty=!0}_next(b){this.isEmpty=!1,this.destination.next(b)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}var Mn=se(4487),pr=se(5257);function zr(M,b){const _=arguments.length>=2;return R=>R.pipe(M?(0,_n.h)((F,j)=>M(F,j,R)):Mn.y,(0,pr.q)(1),_?qe(b):Qr(()=>new kt))}function Mr(){}var Bi=se(9105);function Ti(M,b,_){return function(F){return F.lift(new Ii(M,b,_))}}class Ii{constructor(b,_,R){this.nextOrObserver=b,this.error=_,this.complete=R}call(b,_){return _.subscribe(new Vn(b,this.nextOrObserver,this.error,this.complete))}}class Vn extends Ae.L{constructor(b,_,R,F){super(b),this._tapNext=Mr,this._tapError=Mr,this._tapComplete=Mr,this._tapError=R||Mr,this._tapComplete=F||Mr,(0,Bi.m)(_)?(this._context=this,this._tapNext=_):_&&(this._context=_,this._tapNext=_.next||Mr,this._tapError=_.error||Mr,this._tapComplete=_.complete||Mr)}_next(b){try{this._tapNext.call(this._context,b)}catch(_){return void this.destination.error(_)}this.destination.next(b)}_error(b){try{this._tapError.call(this._context,b)}catch(_){return void this.destination.error(_)}this.destination.error(b)}_complete(){try{this._tapComplete.call(this._context)}catch(b){return void this.destination.error(b)}return this.destination.complete()}}var ci=se(5319);class Tn{constructor(b){this.callback=b}call(b,_){return _.subscribe(new Zo(b,this.callback))}}class Zo extends Ae.L{constructor(b,_){super(b),this.add(new ci.w(_))}}var Pi=se(1307);class ii{constructor(b,_){this.id=b,this.url=_}}class rs extends ii{constructor(b,_,R="imperative",F=null){super(b,_),this.navigationTrigger=R,this.restoredState=F}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class ti extends ii{constructor(b,_,R){super(b,_),this.urlAfterRedirects=R}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class hc extends ii{constructor(b,_,R){super(b,_),this.reason=R}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class zn extends ii{constructor(b,_,R){super(b,_),this.error=R}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class yl extends ii{constructor(b,_,R,F){super(b,_),this.urlAfterRedirects=R,this.state=F}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class si extends ii{constructor(b,_,R,F){super(b,_),this.urlAfterRedirects=R,this.state=F}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Qo extends ii{constructor(b,_,R,F,j){super(b,_),this.urlAfterRedirects=R,this.state=F,this.shouldActivate=j}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ga extends ii{constructor(b,_,R,F){super(b,_),this.urlAfterRedirects=R,this.state=F}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Xn extends ii{constructor(b,_,R,F){super(b,_),this.urlAfterRedirects=R,this.state=F}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Aa{constructor(b){this.route=b}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Vl{constructor(b){this.route=b}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Ys{constructor(b){this.snapshot=b}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Kr{constructor(b){this.snapshot=b}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ro{constructor(b){this.snapshot=b}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Us{constructor(b){this.snapshot=b}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Xs{constructor(b,_,R){this.routerEvent=b,this.position=_,this.anchor=R}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const xr="primary";class zl{constructor(b){this.params=b||{}}has(b){return Object.prototype.hasOwnProperty.call(this.params,b)}get(b){if(this.has(b)){const _=this.params[b];return Array.isArray(_)?_[0]:_}return null}getAll(b){if(this.has(b)){const _=this.params[b];return Array.isArray(_)?_:[_]}return[]}get keys(){return Object.keys(this.params)}}function vs(M){return new zl(M)}const io="ngNavigationCancelingError";function qa(M){const b=Error("NavigationCancelingError: "+M);return b[io]=!0,b}function ds(M,b,_){const R=_.path.split("/");if(R.length>M.length||"full"===_.pathMatch&&(b.hasChildren()||R.length<M.length))return null;const F={};for(let j=0;j<R.length;j++){const oe=R[j],ye=M[j];if(oe.startsWith(":"))F[oe.substring(1)]=ye;else if(oe!==ye.path)return null}return{consumed:M.slice(0,R.length),posParams:F}}function Ai(M,b){const _=M?Object.keys(M):void 0,R=b?Object.keys(b):void 0;if(!_||!R||_.length!=R.length)return!1;let F;for(let j=0;j<_.length;j++)if(F=_[j],!Di(M[F],b[F]))return!1;return!0}function Di(M,b){if(Array.isArray(M)&&Array.isArray(b)){if(M.length!==b.length)return!1;const _=[...M].sort(),R=[...b].sort();return _.every((F,j)=>R[j]===F)}return M===b}function so(M){return Array.prototype.concat.apply([],M)}function oo(M){return M.length>0?M[M.length-1]:null}function $i(M,b){for(const _ in M)M.hasOwnProperty(_)&&b(M[_],_)}function Vs(M){return(0,$.CqO)(M)?M:(0,$.QGY)(M)?(0,an.D)(Promise.resolve(M)):(0,St.of)(M)}const vo={exact:function wi(M,b,_){if(!On(M.segments,b.segments)||!He(M.segments,b.segments,_)||M.numberOfChildren!==b.numberOfChildren)return!1;for(const R in b.children)if(!M.children[R]||!wi(M.children[R],b.children[R],_))return!1;return!0},subset:wr},To={exact:function(M,b){return Ai(M,b)},subset:function(M,b){return Object.keys(b).length<=Object.keys(M).length&&Object.keys(b).every(_=>Di(M[_],b[_]))},ignored:()=>!0};function _s(M,b,_){return vo[_.paths](M.root,b.root,_.matrixParams)&&To[_.queryParams](M.queryParams,b.queryParams)&&!("exact"===_.fragment&&M.fragment!==b.fragment)}function wr(M,b,_){return Xr(M,b,b.segments,_)}function Xr(M,b,_,R){if(M.segments.length>_.length){const F=M.segments.slice(0,_.length);return!(!On(F,_)||b.hasChildren()||!He(F,_,R))}if(M.segments.length===_.length){if(!On(M.segments,_)||!He(M.segments,_,R))return!1;for(const F in b.children)if(!M.children[F]||!wr(M.children[F],b.children[F],R))return!1;return!0}{const F=_.slice(0,M.segments.length),j=_.slice(M.segments.length);return!!(On(M.segments,F)&&He(M.segments,F,R)&&M.children[xr])&&Xr(M.children[xr],b,j,R)}}function He(M,b,_){return b.every((R,F)=>To[_](M[F].parameters,R.parameters))}class ke{constructor(b,_,R){this.root=b,this.queryParams=_,this.fragment=R}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=vs(this.queryParams)),this._queryParamMap}toString(){return ao.serialize(this)}}class ae{constructor(b,_){this.segments=b,this.children=_,this.parent=null,$i(_,(R,F)=>R.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ko(this)}}class Qe{constructor(b,_){this.path=b,this.parameters=_}get parameterMap(){return this._parameterMap||(this._parameterMap=vs(this.parameters)),this._parameterMap}toString(){return Gl(this)}}function On(M,b){return M.length===b.length&&M.every((_,R)=>_.path===b[R].path)}class In{}class Ui{parse(b){const _=new Ks(b);return new ke(_.parseRootSegment(),_.parseQueryParams(),_.parseFragment())}serialize(b){var M;return`${`/${Ds(b.root,!0)}`}${function(M){const b=Object.keys(M).map(_=>{const R=M[_];return Array.isArray(R)?R.map(F=>`${lo(_)}=${lo(F)}`).join("&"):`${lo(_)}=${lo(R)}`}).filter(_=>!!_);return b.length?`?${b.join("&")}`:""}(b.queryParams)}${"string"==typeof b.fragment?`#${M=b.fragment,encodeURI(M)}`:""}`}}const ao=new Ui;function Ko(M){return M.segments.map(b=>Gl(b)).join("/")}function Ds(M,b){if(!M.hasChildren())return Ko(M);if(b){const _=M.children[xr]?Ds(M.children[xr],!1):"",R=[];return $i(M.children,(F,j)=>{j!==xr&&R.push(`${j}:${Ds(F,!1)}`)}),R.length>0?`${_}(${R.join("//")})`:_}{const _=function(M,b){let _=[];return $i(M.children,(R,F)=>{F===xr&&(_=_.concat(b(R,F)))}),$i(M.children,(R,F)=>{F!==xr&&(_=_.concat(b(R,F)))}),_}(M,(R,F)=>F===xr?[Ds(M.children[xr],!1)]:[`${F}:${Ds(R,!1)}`]);return 1===Object.keys(M.children).length&&null!=M.children[xr]?`${Ko(M)}/${_[0]}`:`${Ko(M)}/(${_.join("//")})`}}function ss(M){return encodeURIComponent(M).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function lo(M){return ss(M).replace(/%3B/gi,";")}function Ei(M){return ss(M).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function oi(M){return decodeURIComponent(M)}function Hl(M){return oi(M.replace(/\+/g,"%20"))}function Gl(M){return`${Ei(M.path)}${function(M){return Object.keys(M).map(b=>`;${Ei(b)}=${Ei(M[b])}`).join("")}(M.parameters)}`}const Jo=/^[^\/()?;=#]+/;function ea(M){const b=M.match(Jo);return b?b[0]:""}const Ao=/^[^=?&#]+/,pc=/^[^?&#]+/;class Ks{constructor(b){this.url=b,this.remaining=b}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new ae([],{}):new ae([],this.parseChildren())}parseQueryParams(){const b={};if(this.consumeOptional("?"))do{this.parseQueryParam(b)}while(this.consumeOptional("&"));return b}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const b=[];for(this.peekStartsWith("(")||b.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),b.push(this.parseSegment());let _={};this.peekStartsWith("/(")&&(this.capture("/"),_=this.parseParens(!0));let R={};return this.peekStartsWith("(")&&(R=this.parseParens(!1)),(b.length>0||Object.keys(_).length>0)&&(R[xr]=new ae(b,_)),R}parseSegment(){const b=ea(this.remaining);if(""===b&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(b),new Qe(oi(b),this.parseMatrixParams())}parseMatrixParams(){const b={};for(;this.consumeOptional(";");)this.parseParam(b);return b}parseParam(b){const _=ea(this.remaining);if(!_)return;this.capture(_);let R="";if(this.consumeOptional("=")){const F=ea(this.remaining);F&&(R=F,this.capture(R))}b[oi(_)]=oi(R)}parseQueryParam(b){const _=function(M){const b=M.match(Ao);return b?b[0]:""}(this.remaining);if(!_)return;this.capture(_);let R="";if(this.consumeOptional("=")){const oe=function(M){const b=M.match(pc);return b?b[0]:""}(this.remaining);oe&&(R=oe,this.capture(R))}const F=Hl(_),j=Hl(R);if(b.hasOwnProperty(F)){let oe=b[F];Array.isArray(oe)||(oe=[oe],b[F]=oe),oe.push(j)}else b[F]=j}parseParens(b){const _={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const R=ea(this.remaining),F=this.remaining[R.length];if("/"!==F&&")"!==F&&";"!==F)throw new Error(`Cannot parse url '${this.url}'`);let j;R.indexOf(":")>-1?(j=R.substr(0,R.indexOf(":")),this.capture(j),this.capture(":")):b&&(j=xr);const oe=this.parseChildren();_[j]=1===Object.keys(oe).length?oe[xr]:new ae([],oe),this.consumeOptional("//")}return _}peekStartsWith(b){return this.remaining.startsWith(b)}consumeOptional(b){return!!this.peekStartsWith(b)&&(this.remaining=this.remaining.substring(b.length),!0)}capture(b){if(!this.consumeOptional(b))throw new Error(`Expected "${b}".`)}}class _l{constructor(b){this._root=b}get root(){return this._root.value}parent(b){const _=this.pathFromRoot(b);return _.length>1?_[_.length-2]:null}children(b){const _=ya(b,this._root);return _?_.children.map(R=>R.value):[]}firstChild(b){const _=ya(b,this._root);return _&&_.children.length>0?_.children[0].value:null}siblings(b){const _=va(b,this._root);return _.length<2?[]:_[_.length-2].children.map(F=>F.value).filter(F=>F!==b)}pathFromRoot(b){return va(b,this._root).map(_=>_.value)}}function ya(M,b){if(M===b.value)return b;for(const _ of b.children){const R=ya(M,_);if(R)return R}return null}function va(M,b){if(M===b.value)return[b];for(const _ of b.children){const R=va(M,_);if(R.length)return R.unshift(b),R}return[]}class Vi{constructor(b,_){this.value=b,this.children=_}toString(){return`TreeNode(${this.value})`}}function _a(M){const b={};return M&&M.children.forEach(_=>b[_.value.outlet]=_),b}class jl extends _l{constructor(b,_){super(b),this.snapshot=_,na(this,b)}toString(){return this.snapshot.toString()}}function Wl(M,b){const _=function(M,b){const oe=new Ro([],{},{},"",{},xr,b,null,M.root,-1,{});return new Ss("",new Vi(oe,[]))}(M,b),R=new Cn.X([new Qe("",{})]),F=new Cn.X({}),j=new Cn.X({}),oe=new Cn.X({}),ye=new Cn.X(""),lt=new _o(R,F,oe,ye,j,xr,b,_.root);return lt.snapshot=_.root,new jl(new Vi(lt,[]),_)}class _o{constructor(b,_,R,F,j,oe,ye,lt){this.url=b,this.params=_,this.queryParams=R,this.fragment=F,this.data=j,this.outlet=oe,this.component=ye,this._futureSnapshot=lt}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,nn.U)(b=>vs(b)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,nn.U)(b=>vs(b)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Do(M,b="emptyOnly"){const _=M.pathFromRoot;let R=0;if("always"!==b)for(R=_.length-1;R>=1;){const F=_[R],j=_[R-1];if(F.routeConfig&&""===F.routeConfig.path)R--;else{if(j.component)break;R--}}return function(M){return M.reduce((b,_)=>({params:Object.assign(Object.assign({},b.params),_.params),data:Object.assign(Object.assign({},b.data),_.data),resolve:Object.assign(Object.assign({},b.resolve),_._resolvedData)}),{params:{},data:{},resolve:{}})}(_.slice(R))}class Ro{constructor(b,_,R,F,j,oe,ye,lt,Ke,dt,on){this.url=b,this.params=_,this.queryParams=R,this.fragment=F,this.data=j,this.outlet=oe,this.component=ye,this.routeConfig=lt,this._urlSegment=Ke,this._lastPathIndex=dt,this._resolve=on}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=vs(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=vs(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(R=>R.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Ss extends _l{constructor(b,_){super(_),this.url=b,na(this,_)}toString(){return bl(this._root)}}function na(M,b){b.value._routerState=M,b.children.forEach(_=>na(M,_))}function bl(M){const b=M.children.length>0?` { ${M.children.map(bl).join(", ")} } `:"";return`${M.value}${b}`}function xl(M){if(M.snapshot){const b=M.snapshot,_=M._futureSnapshot;M.snapshot=_,Ai(b.queryParams,_.queryParams)||M.queryParams.next(_.queryParams),b.fragment!==_.fragment&&M.fragment.next(_.fragment),Ai(b.params,_.params)||M.params.next(_.params),function(M,b){if(M.length!==b.length)return!1;for(let _=0;_<M.length;++_)if(!Ai(M[_],b[_]))return!1;return!0}(b.url,_.url)||M.url.next(_.url),Ai(b.data,_.data)||M.data.next(_.data)}else M.snapshot=M._futureSnapshot,M.data.next(M._futureSnapshot.data)}function $l(M,b){return Ai(M.params,b.params)&&function(M,b){return On(M,b)&&M.every((_,R)=>Ai(_.parameters,b[R].parameters))}(M.url,b.url)&&!(!M.parent!=!b.parent)&&(!M.parent||$l(M.parent,b.parent))}function wl(M,b,_){if(_&&M.shouldReuseRoute(b.value,_.value.snapshot)){const R=_.value;R._futureSnapshot=b.value;const F=function(M,b,_){return b.children.map(R=>{for(const F of _.children)if(M.shouldReuseRoute(R.value,F.value.snapshot))return wl(M,R,F);return wl(M,R)})}(M,b,_);return new Vi(R,F)}{if(M.shouldAttach(b.value)){const j=M.retrieve(b.value);if(null!==j){const oe=j.route;return _u(b,oe),oe}}const R=function(M){return new _o(new Cn.X(M.url),new Cn.X(M.params),new Cn.X(M.queryParams),new Cn.X(M.fragment),new Cn.X(M.data),M.outlet,M.component,M)}(b.value),F=b.children.map(j=>wl(M,j));return new Vi(R,F)}}function _u(M,b){if(M.value.routeConfig!==b.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(M.children.length!==b.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");b.value._futureSnapshot=M.value;for(let _=0;_<M.children.length;++_)_u(M.children[_],b.children[_])}function Js(M){return"object"==typeof M&&null!=M&&!M.outlets&&!M.segmentPath}function Io(M){return"object"==typeof M&&null!=M&&M.outlets}function Ia(M,b,_,R,F){let j={};return R&&$i(R,(oe,ye)=>{j[ye]=Array.isArray(oe)?oe.map(lt=>`${lt}`):`${oe}`}),new ke(_.root===M?b:El(_.root,M,b),j,F)}function El(M,b,_){const R={};return $i(M.children,(F,j)=>{R[j]=F===b?_:El(F,b,_)}),new ae(M.segments,R)}class uo{constructor(b,_,R){if(this.isAbsolute=b,this.numberOfDoubleDots=_,this.commands=R,b&&R.length>0&&Js(R[0]))throw new Error("Root segment cannot have matrix parameters");const F=R.find(Io);if(F&&F!==oo(R))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class hs{constructor(b,_,R){this.segmentGroup=b,this.processChildren=_,this.index=R}}function ra(M,b,_){if(M||(M=new ae([],{})),0===M.segments.length&&M.hasChildren())return Qa(M,b,_);const R=function(M,b,_){let R=0,F=b;const j={match:!1,pathIndex:0,commandIndex:0};for(;F<M.segments.length;){if(R>=_.length)return j;const oe=M.segments[F],ye=_[R];if(Io(ye))break;const lt=`${ye}`,Ke=R<_.length-1?_[R+1]:null;if(F>0&&void 0===lt)break;if(lt&&Ke&&"object"==typeof Ke&&void 0===Ke.outlets){if(!z(lt,Ke,oe))return j;R+=2}else{if(!z(lt,{},oe))return j;R++}F++}return{match:!0,pathIndex:F,commandIndex:R}}(M,b,_),F=_.slice(R.commandIndex);if(R.match&&R.pathIndex<M.segments.length){const j=new ae(M.segments.slice(0,R.pathIndex),{});return j.children[xr]=new ae(M.segments.slice(R.pathIndex),M.children),Qa(j,0,F)}return R.match&&0===F.length?new ae(M.segments,{}):R.match&&!M.hasChildren()?Is(M,b,_):R.match?Qa(M,0,F):Is(M,b,_)}function Qa(M,b,_){if(0===_.length)return new ae(M.segments,{});{const R=function(M){return Io(M[0])?M[0].outlets:{[xr]:M}}(_),F={};return $i(R,(j,oe)=>{"string"==typeof j&&(j=[j]),null!==j&&(F[oe]=ra(M.children[oe],b,j))}),$i(M.children,(j,oe)=>{void 0===R[oe]&&(F[oe]=j)}),new ae(M.segments,F)}}function Is(M,b,_){const R=M.segments.slice(0,b);let F=0;for(;F<_.length;){const j=_[F];if(Io(j)){const lt=U(j.outlets);return new ae(R,lt)}if(0===F&&Js(_[0])){R.push(new Qe(M.segments[b].path,Z(_[0]))),F++;continue}const oe=Io(j)?j.outlets[xr]:`${j}`,ye=F<_.length-1?_[F+1]:null;oe&&ye&&Js(ye)?(R.push(new Qe(oe,Z(ye))),F+=2):(R.push(new Qe(oe,{})),F++)}return new ae(R,{})}function U(M){const b={};return $i(M,(_,R)=>{"string"==typeof _&&(_=[_]),null!==_&&(b[R]=Is(new ae([],{}),0,_))}),b}function Z(M){const b={};return $i(M,(_,R)=>b[R]=`${_}`),b}function z(M,b,_){return M==_.path&&Ai(b,_.parameters)}class Ne{constructor(b,_,R,F){this.routeReuseStrategy=b,this.futureState=_,this.currState=R,this.forwardEvent=F}activate(b){const _=this.futureState._root,R=this.currState?this.currState._root:null;this.deactivateChildRoutes(_,R,b),xl(this.futureState.root),this.activateChildRoutes(_,R,b)}deactivateChildRoutes(b,_,R){const F=_a(_);b.children.forEach(j=>{const oe=j.value.outlet;this.deactivateRoutes(j,F[oe],R),delete F[oe]}),$i(F,(j,oe)=>{this.deactivateRouteAndItsChildren(j,R)})}deactivateRoutes(b,_,R){const F=b.value,j=_?_.value:null;if(F===j)if(F.component){const oe=R.getContext(F.outlet);oe&&this.deactivateChildRoutes(b,_,oe.children)}else this.deactivateChildRoutes(b,_,R);else j&&this.deactivateRouteAndItsChildren(_,R)}deactivateRouteAndItsChildren(b,_){this.routeReuseStrategy.shouldDetach(b.value.snapshot)?this.detachAndStoreRouteSubtree(b,_):this.deactivateRouteAndOutlet(b,_)}detachAndStoreRouteSubtree(b,_){const R=_.getContext(b.value.outlet);if(R&&R.outlet){const F=R.outlet.detach(),j=R.children.onOutletDeactivated();this.routeReuseStrategy.store(b.value.snapshot,{componentRef:F,route:b,contexts:j})}}deactivateRouteAndOutlet(b,_){const R=_.getContext(b.value.outlet),F=R&&b.value.component?R.children:_,j=_a(b);for(const oe of Object.keys(j))this.deactivateRouteAndItsChildren(j[oe],F);R&&R.outlet&&(R.outlet.deactivate(),R.children.onOutletDeactivated(),R.attachRef=null,R.resolver=null,R.route=null)}activateChildRoutes(b,_,R){const F=_a(_);b.children.forEach(j=>{this.activateRoutes(j,F[j.value.outlet],R),this.forwardEvent(new Us(j.value.snapshot))}),b.children.length&&this.forwardEvent(new Kr(b.value.snapshot))}activateRoutes(b,_,R){const F=b.value,j=_?_.value:null;if(xl(F),F===j)if(F.component){const oe=R.getOrCreateContext(F.outlet);this.activateChildRoutes(b,_,oe.children)}else this.activateChildRoutes(b,_,R);else if(F.component){const oe=R.getOrCreateContext(F.outlet);if(this.routeReuseStrategy.shouldAttach(F.snapshot)){const ye=this.routeReuseStrategy.retrieve(F.snapshot);this.routeReuseStrategy.store(F.snapshot,null),oe.children.onOutletReAttached(ye.contexts),oe.attachRef=ye.componentRef,oe.route=ye.route.value,oe.outlet&&oe.outlet.attach(ye.componentRef,ye.route.value),mt(ye.route)}else{const ye=function(M){for(let b=M.parent;b;b=b.parent){const _=b.routeConfig;if(_&&_._loadedConfig)return _._loadedConfig;if(_&&_.component)return null}return null}(F.snapshot),lt=ye?ye.module.componentFactoryResolver:null;oe.attachRef=null,oe.route=F,oe.resolver=lt,oe.outlet&&oe.outlet.activateWith(F,lt),this.activateChildRoutes(b,null,oe.children)}}else this.activateChildRoutes(b,null,R)}}function mt(M){xl(M.value),M.children.forEach(mt)}class tr{constructor(b,_){this.routes=b,this.module=_}}function Zn(M){return"function"==typeof M}function Jr(M){return M instanceof ke}const Ps=Symbol("INITIAL_VALUE");function Gi(){return Rn(M=>function(...M){let b,_;return(0,We.K)(M[M.length-1])&&(_=M.pop()),"function"==typeof M[M.length-1]&&(b=M.pop()),1===M.length&&(0,Ze.k)(M[0])&&(M=M[0]),(0,K.n)(M,_).lift(new Ve(b))}(M.map(b=>b.pipe((0,pr.q)(1),function(...M){const b=M[M.length-1];return(0,We.K)(b)?(M.pop(),_=>hn(M,_,b)):_=>hn(M,_)}(Ps)))).pipe($t((b,_)=>{let R=!1;return _.reduce((F,j,oe)=>F!==Ps?F:(j===Ps&&(R=!0),R||!1!==j&&oe!==_.length-1&&!Jr(j)?F:j),b)},Ps),(0,_n.h)(b=>b!==Ps),(0,nn.U)(b=>Jr(b)?b:!0===b),(0,pr.q)(1)))}let Ka=(()=>{class M{}return M.\u0275fac=function(_){return new(_||M)},M.\u0275cmp=$.Xpm({type:M,selectors:[["ng-component"]],decls:1,vars:0,template:function(_,R){1&_&&$._UZ(0,"router-outlet")},directives:function(){return[Fa]},encapsulation:2}),M})();function ia(M,b=""){for(let _=0;_<M.length;_++){const R=M[_];Qn(R,Cs(b,R))}}function Qn(M,b){M.children&&ia(M.children,b)}function Cs(M,b){return b?M||b.path?M&&!b.path?`${M}/`:!M&&b.path?b.path:`${M}/${b.path}`:"":M}function Pa(M){const b=M.children&&M.children.map(Pa),_=b?Object.assign(Object.assign({},M),{children:b}):Object.assign({},M);return!_.component&&(b||_.loadChildren)&&_.outlet&&_.outlet!==xr&&(_.component=Ka),_}function qi(M){return M.outlet||xr}function Ki(M,b){const _=M.filter(R=>qi(R)===b);return _.push(...M.filter(R=>qi(R)!==b)),_}const xo={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function Po(M,b,_){var R;if(""===b.path)return"full"===b.pathMatch&&(M.hasChildren()||_.length>0)?Object.assign({},xo):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const j=(b.matcher||ds)(_,M,b);if(!j)return Object.assign({},xo);const oe={};$i(j.posParams,(lt,Ke)=>{oe[Ke]=lt.path});const ye=j.consumed.length>0?Object.assign(Object.assign({},oe),j.consumed[j.consumed.length-1].parameters):oe;return{matched:!0,consumedSegments:j.consumed,lastChild:j.consumed.length,parameters:ye,positionalParamSegments:null!==(R=j.posParams)&&void 0!==R?R:{}}}function sa(M,b,_,R,F="corrected"){if(_.length>0&&function(M,b,_){return _.some(R=>Ml(M,b,R)&&qi(R)!==xr)}(M,_,R)){const oe=new ae(b,function(M,b,_,R){const F={};F[xr]=R,R._sourceSegment=M,R._segmentIndexShift=b.length;for(const j of _)if(""===j.path&&qi(j)!==xr){const oe=new ae([],{});oe._sourceSegment=M,oe._segmentIndexShift=b.length,F[qi(j)]=oe}return F}(M,b,R,new ae(_,M.children)));return oe._sourceSegment=M,oe._segmentIndexShift=b.length,{segmentGroup:oe,slicedSegments:[]}}if(0===_.length&&function(M,b,_){return _.some(R=>Ml(M,b,R))}(M,_,R)){const oe=new ae(M.segments,function(M,b,_,R,F,j){const oe={};for(const ye of R)if(Ml(M,_,ye)&&!F[qi(ye)]){const lt=new ae([],{});lt._sourceSegment=M,lt._segmentIndexShift="legacy"===j?M.segments.length:b.length,oe[qi(ye)]=lt}return Object.assign(Object.assign({},F),oe)}(M,b,_,R,M.children,F));return oe._sourceSegment=M,oe._segmentIndexShift=b.length,{segmentGroup:oe,slicedSegments:_}}const j=new ae(M.segments,M.children);return j._sourceSegment=M,j._segmentIndexShift=b.length,{segmentGroup:j,slicedSegments:_}}function Ml(M,b,_){return(!(M.hasChildren()||b.length>0)||"full"!==_.pathMatch)&&""===_.path}function Ja(M,b,_,R){return!!(qi(M)===R||R!==xr&&Ml(b,_,M))&&("**"===M.path||Po(b,M,_).matched)}function zc(M,b,_){return 0===b.length&&!M.children[_]}class el{constructor(b){this.segmentGroup=b||null}}class Ot{constructor(b){this.urlTree=b}}function Hr(M){return new Be.y(b=>b.error(new el(M)))}function bu(M){return new Be.y(b=>b.error(new Ot(M)))}function ps(M){return new Be.y(b=>b.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${M}'`)))}class Lo{constructor(b,_,R,F,j){this.configLoader=_,this.urlSerializer=R,this.urlTree=F,this.config=j,this.allowRedirects=!0,this.ngModule=b.get($.h0i)}apply(){const b=sa(this.urlTree.root,[],[],this.config).segmentGroup,_=new ae(b.segments,b.children);return this.expandSegmentGroup(this.ngModule,this.config,_,xr).pipe((0,nn.U)(j=>this.createUrlTree(tl(j),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Hn(j=>{if(j instanceof Ot)return this.allowRedirects=!1,this.match(j.urlTree);throw j instanceof el?this.noMatchError(j):j}))}match(b){return this.expandSegmentGroup(this.ngModule,this.config,b.root,xr).pipe((0,nn.U)(F=>this.createUrlTree(tl(F),b.queryParams,b.fragment))).pipe(Hn(F=>{throw F instanceof el?this.noMatchError(F):F}))}noMatchError(b){return new Error(`Cannot match any routes. URL Segment: '${b.segmentGroup}'`)}createUrlTree(b,_,R){const F=b.segments.length>0?new ae([],{[xr]:b}):b;return new ke(F,_,R)}expandSegmentGroup(b,_,R,F){return 0===R.segments.length&&R.hasChildren()?this.expandChildren(b,_,R).pipe((0,nn.U)(j=>new ae([],j))):this.expandSegment(b,R,_,R.segments,F,!0)}expandChildren(b,_,R){const F=[];for(const j of Object.keys(R.children))"primary"===j?F.unshift(j):F.push(j);return(0,an.D)(F).pipe(ns(j=>{const oe=R.children[j],ye=Ki(_,j);return this.expandSegmentGroup(b,ye,oe,j).pipe((0,nn.U)(lt=>({segment:lt,outlet:j})))}),$t((j,oe)=>(j[oe.outlet]=oe.segment,j),{}),function(M,b){const _=arguments.length>=2;return R=>R.pipe(M?(0,_n.h)((F,j)=>M(F,j,R)):Mn.y,ln(1),_?qe(b):Qr(()=>new kt))}())}expandSegment(b,_,R,F,j,oe){return(0,an.D)(R).pipe(ns(ye=>this.expandSegmentAgainstRoute(b,_,R,ye,F,j,oe).pipe(Hn(Ke=>{if(Ke instanceof el)return(0,St.of)(null);throw Ke}))),zr(ye=>!!ye),Hn((ye,lt)=>{if(ye instanceof kt||"EmptyError"===ye.name){if(zc(_,F,j))return(0,St.of)(new ae([],{}));throw new el(_)}throw ye}))}expandSegmentAgainstRoute(b,_,R,F,j,oe,ye){return Ja(F,_,j,oe)?void 0===F.redirectTo?this.matchSegmentAgainstRoute(b,_,F,j,oe):ye&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(b,_,R,F,j,oe):Hr(_):Hr(_)}expandSegmentAgainstRouteUsingRedirect(b,_,R,F,j,oe){return"**"===F.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(b,R,F,oe):this.expandRegularSegmentAgainstRouteUsingRedirect(b,_,R,F,j,oe)}expandWildCardWithParamsAgainstRouteUsingRedirect(b,_,R,F){const j=this.applyRedirectCommands([],R.redirectTo,{});return R.redirectTo.startsWith("/")?bu(j):this.lineralizeSegments(R,j).pipe((0,Hi.zg)(oe=>{const ye=new ae(oe,{});return this.expandSegment(b,ye,_,oe,F,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(b,_,R,F,j,oe){const{matched:ye,consumedSegments:lt,lastChild:Ke,positionalParamSegments:dt}=Po(_,F,j);if(!ye)return Hr(_);const on=this.applyRedirectCommands(lt,F.redirectTo,dt);return F.redirectTo.startsWith("/")?bu(on):this.lineralizeSegments(F,on).pipe((0,Hi.zg)(un=>this.expandSegment(b,_,R,un.concat(j.slice(Ke)),oe,!1)))}matchSegmentAgainstRoute(b,_,R,F,j){if("**"===R.path)return R.loadChildren?(R._loadedConfig?(0,St.of)(R._loadedConfig):this.configLoader.load(b.injector,R)).pipe((0,nn.U)(un=>(R._loadedConfig=un,new ae(F,{})))):(0,St.of)(new ae(F,{}));const{matched:oe,consumedSegments:ye,lastChild:lt}=Po(_,R,F);if(!oe)return Hr(_);const Ke=F.slice(lt);return this.getChildConfig(b,R,F).pipe((0,Hi.zg)(on=>{const un=on.module,Kt=on.routes,{segmentGroup:vr,slicedSegments:ei}=sa(_,ye,Ke,Kt),Si=new ae(vr.segments,vr.children);if(0===ei.length&&Si.hasChildren())return this.expandChildren(un,Kt,Si).pipe((0,nn.U)(Ji=>new ae(ye,Ji)));if(0===Kt.length&&0===ei.length)return(0,St.of)(new ae(ye,{}));const Oi=qi(R)===j;return this.expandSegment(un,Si,Kt,ei,Oi?xr:j,!0).pipe((0,nn.U)(bi=>new ae(ye.concat(bi.segments),bi.children)))}))}getChildConfig(b,_,R){return _.children?(0,St.of)(new tr(_.children,b)):_.loadChildren?void 0!==_._loadedConfig?(0,St.of)(_._loadedConfig):this.runCanLoadGuards(b.injector,_,R).pipe((0,Hi.zg)(F=>{return F?this.configLoader.load(b.injector,_).pipe((0,nn.U)(j=>(_._loadedConfig=j,j))):(M=_,new Be.y(b=>b.error(qa(`Cannot load children because the guard of the route "path: '${M.path}'" returned false`))));var M})):(0,St.of)(new tr([],b))}runCanLoadGuards(b,_,R){const F=_.canLoad;if(!F||0===F.length)return(0,St.of)(!0);const j=F.map(oe=>{const ye=b.get(oe);let lt;if((M=ye)&&Zn(M.canLoad))lt=ye.canLoad(_,R);else{if(!Zn(ye))throw new Error("Invalid CanLoad guard");lt=ye(_,R)}var M;return Vs(lt)});return(0,St.of)(j).pipe(Gi(),Ti(oe=>{if(!Jr(oe))return;const ye=qa(`Redirecting to "${this.urlSerializer.serialize(oe)}"`);throw ye.url=oe,ye}),(0,nn.U)(oe=>!0===oe))}lineralizeSegments(b,_){let R=[],F=_.root;for(;;){if(R=R.concat(F.segments),0===F.numberOfChildren)return(0,St.of)(R);if(F.numberOfChildren>1||!F.children[xr])return ps(b.redirectTo);F=F.children[xr]}}applyRedirectCommands(b,_,R){return this.applyRedirectCreatreUrlTree(_,this.urlSerializer.parse(_),b,R)}applyRedirectCreatreUrlTree(b,_,R,F){const j=this.createSegmentGroup(b,_.root,R,F);return new ke(j,this.createQueryParams(_.queryParams,this.urlTree.queryParams),_.fragment)}createQueryParams(b,_){const R={};return $i(b,(F,j)=>{if("string"==typeof F&&F.startsWith(":")){const ye=F.substring(1);R[j]=_[ye]}else R[j]=F}),R}createSegmentGroup(b,_,R,F){const j=this.createSegments(b,_.segments,R,F);let oe={};return $i(_.children,(ye,lt)=>{oe[lt]=this.createSegmentGroup(b,ye,R,F)}),new ae(j,oe)}createSegments(b,_,R,F){return _.map(j=>j.path.startsWith(":")?this.findPosParam(b,j,F):this.findOrReturn(j,R))}findPosParam(b,_,R){const F=R[_.path.substring(1)];if(!F)throw new Error(`Cannot redirect to '${b}'. Cannot find '${_.path}'.`);return F}findOrReturn(b,_){let R=0;for(const F of _){if(F.path===b.path)return _.splice(R),F;R++}return b}}function tl(M){const b={};for(const R of Object.keys(M.children)){const j=tl(M.children[R]);(j.segments.length>0||j.hasChildren())&&(b[R]=j)}return function(M){if(1===M.numberOfChildren&&M.children[xr]){const b=M.children[xr];return new ae(M.segments.concat(b.segments),b.children)}return M}(new ae(M.segments,b))}class Gc{constructor(b){this.path=b,this.route=this.path[this.path.length-1]}}class La{constructor(b,_){this.component=b,this.route=_}}function vc(M,b,_){const R=M._root;return zs(R,b?b._root:null,_,[R.value])}function ui(M,b,_){const R=function(M){if(!M)return null;for(let b=M.parent;b;b=b.parent){const _=b.routeConfig;if(_&&_._loadedConfig)return _._loadedConfig}return null}(b);return(R?R.module.injector:_).get(M)}function zs(M,b,_,R,F={canDeactivateChecks:[],canActivateChecks:[]}){const j=_a(b);return M.children.forEach(oe=>{(function(M,b,_,R,F={canDeactivateChecks:[],canActivateChecks:[]}){const j=M.value,oe=b?b.value:null,ye=_?_.getContext(M.value.outlet):null;if(oe&&j.routeConfig===oe.routeConfig){const lt=function(M,b,_){if("function"==typeof _)return _(M,b);switch(_){case"pathParamsChange":return!On(M.url,b.url);case"pathParamsOrQueryParamsChange":return!On(M.url,b.url)||!Ai(M.queryParams,b.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!$l(M,b)||!Ai(M.queryParams,b.queryParams);case"paramsChange":default:return!$l(M,b)}}(oe,j,j.routeConfig.runGuardsAndResolvers);lt?F.canActivateChecks.push(new Gc(R)):(j.data=oe.data,j._resolvedData=oe._resolvedData),zs(M,b,j.component?ye?ye.children:null:_,R,F),lt&&ye&&ye.outlet&&ye.outlet.isActivated&&F.canDeactivateChecks.push(new La(ye.outlet.component,oe))}else oe&&xa(b,ye,F),F.canActivateChecks.push(new Gc(R)),zs(M,null,j.component?ye?ye.children:null:_,R,F)})(oe,j[oe.value.outlet],_,R.concat([oe.value]),F),delete j[oe.value.outlet]}),$i(j,(oe,ye)=>xa(oe,_.getContext(ye),F)),F}function xa(M,b,_){const R=_a(M),F=M.value;$i(R,(j,oe)=>{xa(j,F.component?b?b.children.getContext(oe):null:b,_)}),_.canDeactivateChecks.push(new La(F.component&&b&&b.outlet&&b.outlet.isActivated?b.outlet.component:null,F))}class bs{}function wo(M){return new Be.y(b=>b.error(M))}class bc{constructor(b,_,R,F,j,oe){this.rootComponentType=b,this.config=_,this.urlTree=R,this.url=F,this.paramsInheritanceStrategy=j,this.relativeLinkResolution=oe}recognize(){const b=sa(this.urlTree.root,[],[],this.config.filter(oe=>void 0===oe.redirectTo),this.relativeLinkResolution).segmentGroup,_=this.processSegmentGroup(this.config,b,xr);if(null===_)return null;const R=new Ro([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},xr,this.rootComponentType,null,this.urlTree.root,-1,{}),F=new Vi(R,_),j=new Ss(this.url,F);return this.inheritParamsAndData(j._root),j}inheritParamsAndData(b){const _=b.value,R=Do(_,this.paramsInheritanceStrategy);_.params=Object.freeze(R.params),_.data=Object.freeze(R.data),b.children.forEach(F=>this.inheritParamsAndData(F))}processSegmentGroup(b,_,R){return 0===_.segments.length&&_.hasChildren()?this.processChildren(b,_):this.processSegment(b,_,_.segments,R)}processChildren(b,_){const R=[];for(const j of Object.keys(_.children)){const oe=_.children[j],ye=Ki(b,j),lt=this.processSegmentGroup(ye,oe,j);if(null===lt)return null;R.push(...lt)}const F=Ea(R);return F.sort((b,_)=>b.value.outlet===xr?-1:_.value.outlet===xr?1:b.value.outlet.localeCompare(_.value.outlet)),F}processSegment(b,_,R,F){for(const j of b){const oe=this.processSegmentAgainstRoute(j,_,R,F);if(null!==oe)return oe}return zc(_,R,F)?[]:null}processSegmentAgainstRoute(b,_,R,F){if(b.redirectTo||!Ja(b,_,R,F))return null;let j,oe=[],ye=[];if("**"===b.path){const Kt=R.length>0?oo(R).parameters:{};j=new Ro(R,Kt,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,fo(b),qi(b),b.component,b,Hs(_),gi(_)+R.length,Wc(b))}else{const Kt=Po(_,b,R);if(!Kt.matched)return null;oe=Kt.consumedSegments,ye=R.slice(Kt.lastChild),j=new Ro(oe,Kt.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,fo(b),qi(b),b.component,b,Hs(_),gi(_)+oe.length,Wc(b))}const lt=(M=b).children?M.children:M.loadChildren?M._loadedConfig.routes:[],{segmentGroup:Ke,slicedSegments:dt}=sa(_,oe,ye,lt.filter(Kt=>void 0===Kt.redirectTo),this.relativeLinkResolution);var M;if(0===dt.length&&Ke.hasChildren()){const Kt=this.processChildren(lt,Ke);return null===Kt?null:[new Vi(j,Kt)]}if(0===lt.length&&0===dt.length)return[new Vi(j,[])];const on=qi(b)===F,un=this.processSegment(lt,Ke,dt,on?xr:F);return null===un?null:[new Vi(j,un)]}}function Rl(M){const b=M.value.routeConfig;return b&&""===b.path&&void 0===b.redirectTo}function Ea(M){const b=[],_=new Set;for(const R of M){if(!Rl(R)){b.push(R);continue}const F=b.find(j=>R.value.routeConfig===j.value.routeConfig);void 0!==F?(F.children.push(...R.children),_.add(F)):b.push(R)}for(const R of _){const F=Ea(R.children);b.push(new Vi(R.value,F))}return b.filter(R=>!_.has(R))}function Hs(M){let b=M;for(;b._sourceSegment;)b=b._sourceSegment;return b}function gi(M){let b=M,_=b._segmentIndexShift?b._segmentIndexShift:0;for(;b._sourceSegment;)b=b._sourceSegment,_+=b._segmentIndexShift?b._segmentIndexShift:0;return _-1}function fo(M){return M.data||{}}function Wc(M){return M.resolve||{}}function Fo(M){return Rn(b=>{const _=M(b);return _?(0,an.D)(_).pipe((0,nn.U)(()=>b)):(0,St.of)(b)})}class Oa extends class{shouldDetach(b){return!1}store(b,_){}shouldAttach(b){return!1}retrieve(b){return null}shouldReuseRoute(b,_){return b.routeConfig===_.routeConfig}}{}const Bo=new $.OlP("ROUTES");class ai{constructor(b,_,R,F){this.loader=b,this.compiler=_,this.onLoadStartListener=R,this.onLoadEndListener=F}load(b,_){if(_._loader$)return _._loader$;this.onLoadStartListener&&this.onLoadStartListener(_);const F=this.loadModuleFactory(_.loadChildren).pipe((0,nn.U)(j=>{this.onLoadEndListener&&this.onLoadEndListener(_);const oe=j.create(b);return new tr(so(oe.injector.get(Bo,void 0,$.XFs.Self|$.XFs.Optional)).map(Pa),oe)}),Hn(j=>{throw _._loader$=void 0,j}));return _._loader$=new st.c(F,()=>new Bt.xQ).pipe((0,Pi.x)()),_._loader$}loadModuleFactory(b){return"string"==typeof b?(0,an.D)(this.loader.load(b)):Vs(b()).pipe((0,Hi.zg)(_=>_ instanceof $.YKP?(0,St.of)(_):(0,an.D)(this.compiler.compileModuleAsync(_))))}}class Yi{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new oa,this.attachRef=null}}class oa{constructor(){this.contexts=new Map}onChildOutletCreated(b,_){const R=this.getOrCreateContext(b);R.outlet=_,this.contexts.set(b,R)}onChildOutletDestroyed(b){const _=this.getContext(b);_&&(_.outlet=null)}onOutletDeactivated(){const b=this.contexts;return this.contexts=new Map,b}onOutletReAttached(b){this.contexts=b}getOrCreateContext(b){let _=this.getContext(b);return _||(_=new Yi,this.contexts.set(b,_)),_}getContext(b){return this.contexts.get(b)||null}}class Gs{shouldProcessUrl(b){return!0}extract(b){return b}merge(b,_){return b}}function Nn(M){throw M}function il(M,b,_){return b.parse("/")}function gs(M,b){return(0,St.of)(null)}const jd={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Ju={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ri=(()=>{class M{constructor(_,R,F,j,oe,ye,lt,Ke){this.rootComponentType=_,this.urlSerializer=R,this.rootContexts=F,this.location=j,this.config=Ke,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Bt.xQ,this.errorHandler=Nn,this.malformedUriErrorHandler=il,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:gs,afterPreactivation:gs},this.urlHandlingStrategy=new Gs,this.routeReuseStrategy=new Oa,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=oe.get($.h0i),this.console=oe.get($.c2e);const un=oe.get($.R0b);this.isNgZoneEnabled=un instanceof $.R0b&&$.R0b.isInAngularZone(),this.resetConfig(Ke),this.currentUrlTree=new ke(new ae([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new ai(ye,lt,Kt=>this.triggerEvent(new Aa(Kt)),Kt=>this.triggerEvent(new Vl(Kt))),this.routerState=Wl(this.currentUrlTree,this.rootComponentType),this.transitions=new Cn.X({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var _;return null===(_=this.location.getState())||void 0===_?void 0:_.\u0275routerPageId}setupNavigations(_){const R=this.events;return _.pipe((0,_n.h)(F=>0!==F.id),(0,nn.U)(F=>Object.assign(Object.assign({},F),{extractedUrl:this.urlHandlingStrategy.extract(F.rawUrl)})),Rn(F=>{let j=!1,oe=!1;return(0,St.of)(F).pipe(Ti(ye=>{this.currentNavigation={id:ye.id,initialUrl:ye.currentRawUrl,extractedUrl:ye.extractedUrl,trigger:ye.source,extras:ye.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Rn(ye=>{const lt=!this.navigated||ye.extractedUrl.toString()!==this.browserUrlTree.toString(),Ke=("reload"===this.onSameUrlNavigation||lt)&&this.urlHandlingStrategy.shouldProcessUrl(ye.rawUrl);if(ji(ye.source)&&(this.browserUrlTree=ye.rawUrl),Ke)return(0,St.of)(ye).pipe(Rn(dt=>{const on=this.transitions.getValue();return R.next(new rs(dt.id,this.serializeUrl(dt.extractedUrl),dt.source,dt.restoredState)),on!==this.transitions.getValue()?er.E:Promise.resolve(dt)}),function(M,b,_,R){return Rn(F=>function(M,b,_,R,F){return new Lo(M,b,_,R,F).apply()}(M,b,_,F.extractedUrl,R).pipe((0,nn.U)(j=>Object.assign(Object.assign({},F),{urlAfterRedirects:j}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Ti(dt=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:dt.urlAfterRedirects})}),function(M,b,_,R,F){return(0,Hi.zg)(j=>function(M,b,_,R,F="emptyOnly",j="legacy"){try{const oe=new bc(M,b,_,R,F,j).recognize();return null===oe?wo(new bs):(0,St.of)(oe)}catch(oe){return wo(oe)}}(M,b,j.urlAfterRedirects,_(j.urlAfterRedirects),R,F).pipe((0,nn.U)(oe=>Object.assign(Object.assign({},j),{targetSnapshot:oe}))))}(this.rootComponentType,this.config,dt=>this.serializeUrl(dt),this.paramsInheritanceStrategy,this.relativeLinkResolution),Ti(dt=>{"eager"===this.urlUpdateStrategy&&(dt.extras.skipLocationChange||this.setBrowserUrl(dt.urlAfterRedirects,dt),this.browserUrlTree=dt.urlAfterRedirects);const on=new yl(dt.id,this.serializeUrl(dt.extractedUrl),this.serializeUrl(dt.urlAfterRedirects),dt.targetSnapshot);R.next(on)}));if(lt&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:on,extractedUrl:un,source:Kt,restoredState:vr,extras:ei}=ye,Si=new rs(on,this.serializeUrl(un),Kt,vr);R.next(Si);const Oi=Wl(un,this.rootComponentType).snapshot;return(0,St.of)(Object.assign(Object.assign({},ye),{targetSnapshot:Oi,urlAfterRedirects:un,extras:Object.assign(Object.assign({},ei),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=ye.rawUrl,this.browserUrlTree=ye.urlAfterRedirects,ye.resolve(null),er.E}),Fo(ye=>{const{targetSnapshot:lt,id:Ke,extractedUrl:dt,rawUrl:on,extras:{skipLocationChange:un,replaceUrl:Kt}}=ye;return this.hooks.beforePreactivation(lt,{navigationId:Ke,appliedUrlTree:dt,rawUrlTree:on,skipLocationChange:!!un,replaceUrl:!!Kt})}),Ti(ye=>{const lt=new si(ye.id,this.serializeUrl(ye.extractedUrl),this.serializeUrl(ye.urlAfterRedirects),ye.targetSnapshot);this.triggerEvent(lt)}),(0,nn.U)(ye=>Object.assign(Object.assign({},ye),{guards:vc(ye.targetSnapshot,ye.currentSnapshot,this.rootContexts)})),function(M,b){return(0,Hi.zg)(_=>{const{targetSnapshot:R,currentSnapshot:F,guards:{canActivateChecks:j,canDeactivateChecks:oe}}=_;return 0===oe.length&&0===j.length?(0,St.of)(Object.assign(Object.assign({},_),{guardsResult:!0})):function(M,b,_,R){return(0,an.D)(M).pipe((0,Hi.zg)(F=>function(M,b,_,R,F){const j=b&&b.routeConfig?b.routeConfig.canDeactivate:null;if(!j||0===j.length)return(0,St.of)(!0);const oe=j.map(ye=>{const lt=ui(ye,b,F);let Ke;if(function(M){return M&&Zn(M.canDeactivate)}(lt))Ke=Vs(lt.canDeactivate(M,b,_,R));else{if(!Zn(lt))throw new Error("Invalid CanDeactivate guard");Ke=Vs(lt(M,b,_,R))}return Ke.pipe(zr())});return(0,St.of)(oe).pipe(Gi())}(F.component,F.route,_,b,R)),zr(F=>!0!==F,!0))}(oe,R,F,M).pipe((0,Hi.zg)(ye=>ye&&function(M){return"boolean"==typeof M}(ye)?function(M,b,_,R){return(0,an.D)(b).pipe(ns(F=>hn(function(M,b){return null!==M&&b&&b(new Ys(M)),(0,St.of)(!0)}(F.route.parent,R),function(M,b){return null!==M&&b&&b(new ro(M)),(0,St.of)(!0)}(F.route,R),function(M,b,_){const R=b[b.length-1],j=b.slice(0,b.length-1).reverse().map(oe=>function(M){const b=M.routeConfig?M.routeConfig.canActivateChild:null;return b&&0!==b.length?{node:M,guards:b}:null}(oe)).filter(oe=>null!==oe).map(oe=>Dn(()=>{const ye=oe.guards.map(lt=>{const Ke=ui(lt,oe.node,_);let dt;if(function(M){return M&&Zn(M.canActivateChild)}(Ke))dt=Vs(Ke.canActivateChild(R,M));else{if(!Zn(Ke))throw new Error("Invalid CanActivateChild guard");dt=Vs(Ke(R,M))}return dt.pipe(zr())});return(0,St.of)(ye).pipe(Gi())}));return(0,St.of)(j).pipe(Gi())}(M,F.path,_),function(M,b,_){const R=b.routeConfig?b.routeConfig.canActivate:null;if(!R||0===R.length)return(0,St.of)(!0);const F=R.map(j=>Dn(()=>{const oe=ui(j,b,_);let ye;if(function(M){return M&&Zn(M.canActivate)}(oe))ye=Vs(oe.canActivate(b,M));else{if(!Zn(oe))throw new Error("Invalid CanActivate guard");ye=Vs(oe(b,M))}return ye.pipe(zr())}));return(0,St.of)(F).pipe(Gi())}(M,F.route,_))),zr(F=>!0!==F,!0))}(R,j,M,b):(0,St.of)(ye)),(0,nn.U)(ye=>Object.assign(Object.assign({},_),{guardsResult:ye})))})}(this.ngModule.injector,ye=>this.triggerEvent(ye)),Ti(ye=>{if(Jr(ye.guardsResult)){const Ke=qa(`Redirecting to "${this.serializeUrl(ye.guardsResult)}"`);throw Ke.url=ye.guardsResult,Ke}const lt=new Qo(ye.id,this.serializeUrl(ye.extractedUrl),this.serializeUrl(ye.urlAfterRedirects),ye.targetSnapshot,!!ye.guardsResult);this.triggerEvent(lt)}),(0,_n.h)(ye=>!!ye.guardsResult||(this.restoreHistory(ye),this.cancelNavigationTransition(ye,""),!1)),Fo(ye=>{if(ye.guards.canActivateChecks.length)return(0,St.of)(ye).pipe(Ti(lt=>{const Ke=new ga(lt.id,this.serializeUrl(lt.extractedUrl),this.serializeUrl(lt.urlAfterRedirects),lt.targetSnapshot);this.triggerEvent(Ke)}),Rn(lt=>{let Ke=!1;return(0,St.of)(lt).pipe(function(M,b){return(0,Hi.zg)(_=>{const{targetSnapshot:R,guards:{canActivateChecks:F}}=_;if(!F.length)return(0,St.of)(_);let j=0;return(0,an.D)(F).pipe(ns(oe=>function(M,b,_,R){return function(M,b,_,R){const F=Object.keys(M);if(0===F.length)return(0,St.of)({});const j={};return(0,an.D)(F).pipe((0,Hi.zg)(oe=>function(M,b,_,R){const F=ui(M,b,R);return Vs(F.resolve?F.resolve(b,_):F(b,_))}(M[oe],b,_,R).pipe(Ti(ye=>{j[oe]=ye}))),ln(1),(0,Hi.zg)(()=>Object.keys(j).length===F.length?(0,St.of)(j):er.E))}(M._resolve,M,b,R).pipe((0,nn.U)(j=>(M._resolvedData=j,M.data=Object.assign(Object.assign({},M.data),Do(M,_).resolve),null)))}(oe.route,R,M,b)),Ti(()=>j++),ln(1),(0,Hi.zg)(oe=>j===F.length?(0,St.of)(_):er.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Ti({next:()=>Ke=!0,complete:()=>{Ke||(this.restoreHistory(lt),this.cancelNavigationTransition(lt,"At least one route resolver didn't emit any value."))}}))}),Ti(lt=>{const Ke=new Xn(lt.id,this.serializeUrl(lt.extractedUrl),this.serializeUrl(lt.urlAfterRedirects),lt.targetSnapshot);this.triggerEvent(Ke)}))}),Fo(ye=>{const{targetSnapshot:lt,id:Ke,extractedUrl:dt,rawUrl:on,extras:{skipLocationChange:un,replaceUrl:Kt}}=ye;return this.hooks.afterPreactivation(lt,{navigationId:Ke,appliedUrlTree:dt,rawUrlTree:on,skipLocationChange:!!un,replaceUrl:!!Kt})}),(0,nn.U)(ye=>{const lt=function(M,b,_){const R=wl(M,b._root,_?_._root:void 0);return new jl(R,b)}(this.routeReuseStrategy,ye.targetSnapshot,ye.currentRouterState);return Object.assign(Object.assign({},ye),{targetRouterState:lt})}),Ti(ye=>{this.currentUrlTree=ye.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,ye.rawUrl),this.routerState=ye.targetRouterState,"deferred"===this.urlUpdateStrategy&&(ye.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,ye),this.browserUrlTree=ye.urlAfterRedirects)}),((M,b,_)=>(0,nn.U)(R=>(new Ne(b,R.targetRouterState,R.currentRouterState,_).activate(M),R)))(this.rootContexts,this.routeReuseStrategy,ye=>this.triggerEvent(ye)),Ti({next(){j=!0},complete(){j=!0}}),function(M){return b=>b.lift(new Tn(M))}(()=>{if(!j&&!oe){const ye=`Navigation ID ${F.id} is not equal to the current navigation id ${this.navigationId}`;"replace"===this.canceledNavigationResolution?(this.restoreHistory(F),this.cancelNavigationTransition(F,ye)):this.cancelNavigationTransition(F,ye)}this.currentNavigation=null}),Hn(ye=>{if(oe=!0,function(M){return M&&M[io]}(ye)){const lt=Jr(ye.url);lt||(this.navigated=!0,this.restoreHistory(F,!0));const Ke=new hc(F.id,this.serializeUrl(F.extractedUrl),ye.message);R.next(Ke),lt?setTimeout(()=>{const dt=this.urlHandlingStrategy.merge(ye.url,this.rawUrlTree),on={skipLocationChange:F.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||ji(F.source)};this.scheduleNavigation(dt,"imperative",null,on,{resolve:F.resolve,reject:F.reject,promise:F.promise})},0):F.resolve(!1)}else{this.restoreHistory(F,!0);const lt=new zn(F.id,this.serializeUrl(F.extractedUrl),ye);R.next(lt);try{F.resolve(this.errorHandler(ye))}catch(Ke){F.reject(Ke)}}return er.E}))}))}resetRootComponentType(_){this.rootComponentType=_,this.routerState.root.component=this.rootComponentType}getTransition(){const _=this.transitions.value;return _.urlAfterRedirects=this.browserUrlTree,_}setTransition(_){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),_))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(_=>{const R=this.extractLocationChangeInfoFromEvent(_);this.shouldScheduleNavigation(this.lastLocationChangeInfo,R)&&setTimeout(()=>{const{source:F,state:j,urlTree:oe}=R,ye={replaceUrl:!0};if(j){const lt=Object.assign({},j);delete lt.navigationId,delete lt.\u0275routerPageId,0!==Object.keys(lt).length&&(ye.state=lt)}this.scheduleNavigation(oe,F,j,ye)},0),this.lastLocationChangeInfo=R}))}extractLocationChangeInfoFromEvent(_){var R;return{source:"popstate"===_.type?"popstate":"hashchange",urlTree:this.parseUrl(_.url),state:(null===(R=_.state)||void 0===R?void 0:R.navigationId)?_.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(_,R){if(!_)return!0;const F=R.urlTree.toString()===_.urlTree.toString();return R.transitionId!==_.transitionId||!F||!("hashchange"===R.source&&"popstate"===_.source||"popstate"===R.source&&"hashchange"===_.source)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(_){this.events.next(_)}resetConfig(_){ia(_),this.config=_.map(Pa),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(_,R={}){const{relativeTo:F,queryParams:j,fragment:oe,queryParamsHandling:ye,preserveFragment:lt}=R,Ke=F||this.routerState.root,dt=lt?this.currentUrlTree.fragment:oe;let on=null;switch(ye){case"merge":on=Object.assign(Object.assign({},this.currentUrlTree.queryParams),j);break;case"preserve":on=this.currentUrlTree.queryParams;break;default:on=j||null}return null!==on&&(on=this.removeEmptyProps(on)),function(M,b,_,R,F){if(0===_.length)return Ia(b.root,b.root,b,R,F);const j=function(M){if("string"==typeof M[0]&&1===M.length&&"/"===M[0])return new uo(!0,0,M);let b=0,_=!1;const R=M.reduce((F,j,oe)=>{if("object"==typeof j&&null!=j){if(j.outlets){const ye={};return $i(j.outlets,(lt,Ke)=>{ye[Ke]="string"==typeof lt?lt.split("/"):lt}),[...F,{outlets:ye}]}if(j.segmentPath)return[...F,j.segmentPath]}return"string"!=typeof j?[...F,j]:0===oe?(j.split("/").forEach((ye,lt)=>{0==lt&&"."===ye||(0==lt&&""===ye?_=!0:".."===ye?b++:""!=ye&&F.push(ye))}),F):[...F,j]},[]);return new uo(_,b,R)}(_);if(j.toRoot())return Ia(b.root,new ae([],{}),b,R,F);const oe=function(M,b,_){if(M.isAbsolute)return new hs(b.root,!0,0);if(-1===_.snapshot._lastPathIndex){const j=_.snapshot._urlSegment;return new hs(j,j===b.root,0)}const R=Js(M.commands[0])?0:1;return function(M,b,_){let R=M,F=b,j=_;for(;j>F;){if(j-=F,R=R.parent,!R)throw new Error("Invalid number of '../'");F=R.segments.length}return new hs(R,!1,F-j)}(_.snapshot._urlSegment,_.snapshot._lastPathIndex+R,M.numberOfDoubleDots)}(j,b,M),ye=oe.processChildren?Qa(oe.segmentGroup,oe.index,j.commands):ra(oe.segmentGroup,oe.index,j.commands);return Ia(oe.segmentGroup,ye,b,R,F)}(Ke,this.currentUrlTree,_,on,null!=dt?dt:null)}navigateByUrl(_,R={skipLocationChange:!1}){const F=Jr(_)?_:this.parseUrl(_),j=this.urlHandlingStrategy.merge(F,this.rawUrlTree);return this.scheduleNavigation(j,"imperative",null,R)}navigate(_,R={skipLocationChange:!1}){return function(M){for(let b=0;b<M.length;b++){const _=M[b];if(null==_)throw new Error(`The requested path contains ${_} segment at index ${b}`)}}(_),this.navigateByUrl(this.createUrlTree(_,R),R)}serializeUrl(_){return this.urlSerializer.serialize(_)}parseUrl(_){let R;try{R=this.urlSerializer.parse(_)}catch(F){R=this.malformedUriErrorHandler(F,this.urlSerializer,_)}return R}isActive(_,R){let F;if(F=!0===R?Object.assign({},jd):!1===R?Object.assign({},Ju):R,Jr(_))return _s(this.currentUrlTree,_,F);const j=this.parseUrl(_);return _s(this.currentUrlTree,j,F)}removeEmptyProps(_){return Object.keys(_).reduce((R,F)=>{const j=_[F];return null!=j&&(R[F]=j),R},{})}processNavigations(){this.navigations.subscribe(_=>{this.navigated=!0,this.lastSuccessfulId=_.id,this.currentPageId=_.targetPageId,this.events.next(new ti(_.id,this.serializeUrl(_.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,_.resolve(!0)},_=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(_,R,F,j,oe){var ye,lt;if(this.disposed)return Promise.resolve(!1);const Ke=this.getTransition(),dt=ji(R)&&Ke&&!ji(Ke.source),Kt=(this.lastSuccessfulId===Ke.id||this.currentNavigation?Ke.rawUrl:Ke.urlAfterRedirects).toString()===_.toString();if(dt&&Kt)return Promise.resolve(!0);let vr,ei,Si;oe?(vr=oe.resolve,ei=oe.reject,Si=oe.promise):Si=new Promise((bi,Ji)=>{vr=bi,ei=Ji});const Oi=++this.navigationId;let dn;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(F=this.location.getState()),dn=F&&F.\u0275routerPageId?F.\u0275routerPageId:j.replaceUrl||j.skipLocationChange?null!==(ye=this.browserPageId)&&void 0!==ye?ye:0:(null!==(lt=this.browserPageId)&&void 0!==lt?lt:0)+1):dn=0,this.setTransition({id:Oi,targetPageId:dn,source:R,restoredState:F,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:_,extras:j,resolve:vr,reject:ei,promise:Si,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Si.catch(bi=>Promise.reject(bi))}setBrowserUrl(_,R){const F=this.urlSerializer.serialize(_),j=Object.assign(Object.assign({},R.extras.state),this.generateNgRouterState(R.id,R.targetPageId));this.location.isCurrentPathEqualTo(F)||R.extras.replaceUrl?this.location.replaceState(F,"",j):this.location.go(F,"",j)}restoreHistory(_,R=!1){var F,j;if("computed"===this.canceledNavigationResolution){const oe=this.currentPageId-_.targetPageId;"popstate"!==_.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(F=this.currentNavigation)||void 0===F?void 0:F.finalUrl)||0===oe?this.currentUrlTree===(null===(j=this.currentNavigation)||void 0===j?void 0:j.finalUrl)&&0===oe&&(this.resetState(_),this.browserUrlTree=_.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(oe)}else"replace"===this.canceledNavigationResolution&&(R&&this.resetState(_),this.resetUrlToCurrentUrlTree())}resetState(_){this.routerState=_.currentRouterState,this.currentUrlTree=_.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,_.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(_,R){const F=new hc(_.id,this.serializeUrl(_.extractedUrl),R);this.triggerEvent(F),_.resolve(!1)}generateNgRouterState(_,R){return"computed"===this.canceledNavigationResolution?{navigationId:_,\u0275routerPageId:R}:{navigationId:_}}}return M.\u0275fac=function(_){return new(_||M)($.LFG($.DyG),$.LFG(In),$.LFG(oa),$.LFG(G.Ye),$.LFG($.zs3),$.LFG($.v3s),$.LFG($.Sil),$.LFG(void 0))},M.\u0275prov=$.Yz7({token:M,factory:M.\u0275fac}),M})();function ji(M){return"imperative"!==M}let Na=(()=>{class M{constructor(_,R,F,j,oe){this.router=_,this.route=R,this.commands=[],this.onChanges=new Bt.xQ,null==F&&j.setAttribute(oe.nativeElement,"tabindex","0")}ngOnChanges(_){this.onChanges.next(this)}set routerLink(_){this.commands=null!=_?Array.isArray(_)?_:[_]:[]}onClick(){const _={skipLocationChange:Vo(this.skipLocationChange),replaceUrl:Vo(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,_),!0}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:Vo(this.preserveFragment)})}}return M.\u0275fac=function(_){return new(_||M)($.Y36(ri),$.Y36(_o),$.$8M("tabindex"),$.Y36($.Qsj),$.Y36($.SBq))},M.\u0275dir=$.lG2({type:M,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(_,R){1&_&&$.NdJ("click",function(){return R.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[$.TTD]}),M})(),Xl=(()=>{class M{constructor(_,R,F){this.router=_,this.route=R,this.locationStrategy=F,this.commands=[],this.onChanges=new Bt.xQ,this.subscription=_.events.subscribe(j=>{j instanceof ti&&this.updateTargetUrlAndHref()})}set routerLink(_){this.commands=null!=_?Array.isArray(_)?_:[_]:[]}ngOnChanges(_){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(_,R,F,j,oe){if(0!==_||R||F||j||oe||"string"==typeof this.target&&"_self"!=this.target)return!0;const ye={skipLocationChange:Vo(this.skipLocationChange),replaceUrl:Vo(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,ye),!1}updateTargetUrlAndHref(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:Vo(this.preserveFragment)})}}return M.\u0275fac=function(_){return new(_||M)($.Y36(ri),$.Y36(_o),$.Y36(G.S$))},M.\u0275dir=$.lG2({type:M,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(_,R){1&_&&$.NdJ("click",function(j){return R.onClick(j.button,j.ctrlKey,j.shiftKey,j.altKey,j.metaKey)}),2&_&&($.Ikx("href",R.href,$.LSH),$.uIk("target",R.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[$.TTD]}),M})();function Vo(M){return""===M||!!M}let Fa=(()=>{class M{constructor(_,R,F,j,oe){this.parentContexts=_,this.location=R,this.resolver=F,this.changeDetector=oe,this.activated=null,this._activatedRoute=null,this.activateEvents=new $.vpe,this.deactivateEvents=new $.vpe,this.name=j||xr,_.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const _=this.parentContexts.getContext(this.name);_&&_.route&&(_.attachRef?this.attach(_.attachRef,_.route):this.activateWith(_.route,_.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const _=this.activated;return this.activated=null,this._activatedRoute=null,_}attach(_,R){this.activated=_,this._activatedRoute=R,this.location.insert(_.hostView)}deactivate(){if(this.activated){const _=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(_)}}activateWith(_,R){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=_;const oe=(R=R||this.resolver).resolveComponentFactory(_._futureSnapshot.routeConfig.component),ye=this.parentContexts.getOrCreateContext(this.name).children,lt=new Pl(_,ye,this.location.injector);this.activated=this.location.createComponent(oe,this.location.length,lt),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return M.\u0275fac=function(_){return new(_||M)($.Y36(oa),$.Y36($.s_b),$.Y36($._Vd),$.$8M("name"),$.Y36($.sBO))},M.\u0275dir=$.lG2({type:M,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),M})();class Pl{constructor(b,_,R){this.route=b,this.childContexts=_,this.parent=R}get(b,_){return b===_o?this.route:b===oa?this.childContexts:this.parent.get(b,_)}}class Eo{}class Ma{preload(b,_){return(0,St.of)(null)}}let Eu=(()=>{class M{constructor(_,R,F,j,oe){this.router=_,this.injector=j,this.preloadingStrategy=oe,this.loader=new ai(R,F,Ke=>_.triggerEvent(new Aa(Ke)),Ke=>_.triggerEvent(new Vl(Ke)))}setUpPreloading(){this.subscription=this.router.events.pipe((0,_n.h)(_=>_ instanceof ti),ns(()=>this.preload())).subscribe(()=>{})}preload(){const _=this.injector.get($.h0i);return this.processRoutes(_,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(_,R){const F=[];for(const j of R)if(j.loadChildren&&!j.canLoad&&j._loadedConfig){const oe=j._loadedConfig;F.push(this.processRoutes(oe.module,oe.routes))}else j.loadChildren&&!j.canLoad?F.push(this.preloadConfig(_,j)):j.children&&F.push(this.processRoutes(_,j.children));return(0,an.D)(F).pipe((0,Wt.J)(),(0,nn.U)(j=>{}))}preloadConfig(_,R){return this.preloadingStrategy.preload(R,()=>(R._loadedConfig?(0,St.of)(R._loadedConfig):this.loader.load(_.injector,R)).pipe((0,Hi.zg)(j=>(R._loadedConfig=j,this.processRoutes(j.module,j.routes)))))}}return M.\u0275fac=function(_){return new(_||M)($.LFG(ri),$.LFG($.v3s),$.LFG($.Sil),$.LFG($.zs3),$.LFG(Eo))},M.\u0275prov=$.Yz7({token:M,factory:M.\u0275fac}),M})(),qc=(()=>{class M{constructor(_,R,F={}){this.router=_,this.viewportScroller=R,this.options=F,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},F.scrollPositionRestoration=F.scrollPositionRestoration||"disabled",F.anchorScrolling=F.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(_=>{_ instanceof rs?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=_.navigationTrigger,this.restoredId=_.restoredState?_.restoredState.navigationId:0):_ instanceof ti&&(this.lastId=_.id,this.scheduleScrollEvent(_,this.router.parseUrl(_.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(_=>{_ instanceof Xs&&(_.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(_.position):_.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(_.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(_,R){this.router.triggerEvent(new Xs(_,"popstate"===this.lastSource?this.store[this.restoredId]:null,R))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return M.\u0275fac=function(_){return new(_||M)($.LFG(ri),$.LFG(G.EM),$.LFG(void 0))},M.\u0275prov=$.Yz7({token:M,factory:M.\u0275fac}),M})();const eo=new $.OlP("ROUTER_CONFIGURATION"),Yc=new $.OlP("ROUTER_FORROOT_GUARD"),wc=[G.Ye,{provide:In,useClass:Ui},{provide:ri,useFactory:function(M,b,_,R,F,j,oe,ye={},lt,Ke){const dt=new ri(null,M,b,_,R,F,j,so(oe));return lt&&(dt.urlHandlingStrategy=lt),Ke&&(dt.routeReuseStrategy=Ke),function(M,b){M.errorHandler&&(b.errorHandler=M.errorHandler),M.malformedUriErrorHandler&&(b.malformedUriErrorHandler=M.malformedUriErrorHandler),M.onSameUrlNavigation&&(b.onSameUrlNavigation=M.onSameUrlNavigation),M.paramsInheritanceStrategy&&(b.paramsInheritanceStrategy=M.paramsInheritanceStrategy),M.relativeLinkResolution&&(b.relativeLinkResolution=M.relativeLinkResolution),M.urlUpdateStrategy&&(b.urlUpdateStrategy=M.urlUpdateStrategy)}(ye,dt),ye.enableTracing&&dt.events.subscribe(on=>{var un,Kt;null===(un=console.group)||void 0===un||un.call(console,`Router Event: ${on.constructor.name}`),console.log(on.toString()),console.log(on),null===(Kt=console.groupEnd)||void 0===Kt||Kt.call(console)}),dt},deps:[In,oa,G.Ye,$.zs3,$.v3s,$.Sil,Bo,eo,[class{},new $.FiY],[class{},new $.FiY]]},oa,{provide:_o,useFactory:function(M){return M.routerState.root},deps:[ri]},{provide:$.v3s,useClass:$.EAV},Eu,Ma,class{preload(b,_){return _().pipe(Hn(()=>(0,St.of)(null)))}},{provide:eo,useValue:{enableTracing:!1}}];function Zr(){return new $.PXZ("Router",ri)}let Ho=(()=>{class M{constructor(_,R){}static forRoot(_,R){return{ngModule:M,providers:[wc,ka(_),{provide:Yc,useFactory:aa,deps:[[ri,new $.FiY,new $.tp0]]},{provide:eo,useValue:R||{}},{provide:G.S$,useFactory:Ec,deps:[G.lw,[new $.tBr(G.mr),new $.FiY],eo]},{provide:qc,useFactory:Go,deps:[ri,G.EM,eo]},{provide:Eo,useExisting:R&&R.preloadingStrategy?R.preloadingStrategy:Ma},{provide:$.PXZ,multi:!0,useFactory:Zr},[V,{provide:$.ip1,multi:!0,useFactory:Y,deps:[V]},{provide:we,useFactory:le,deps:[V]},{provide:$.tb,multi:!0,useExisting:we}]]}}static forChild(_){return{ngModule:M,providers:[ka(_)]}}}return M.\u0275fac=function(_){return new(_||M)($.LFG(Yc,8),$.LFG(ri,8))},M.\u0275mod=$.oAB({type:M}),M.\u0275inj=$.cJS({}),M})();function Go(M,b,_){return _.scrollOffset&&b.setOffset(_.scrollOffset),new qc(M,b,_)}function Ec(M,b,_={}){return _.useHash?new G.Do(M,b):new G.b0(M,b)}function aa(M){return"guarded"}function ka(M){return[{provide:$.deG,multi:!0,useValue:M},{provide:Bo,multi:!0,useValue:M}]}let V=(()=>{class M{constructor(_){this.injector=_,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Bt.xQ}appInitializer(){return this.injector.get(G.V_,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let R=null;const F=new Promise(ye=>R=ye),j=this.injector.get(ri),oe=this.injector.get(eo);return"disabled"===oe.initialNavigation?(j.setUpLocationChangeListener(),R(!0)):"enabled"===oe.initialNavigation||"enabledBlocking"===oe.initialNavigation?(j.hooks.afterPreactivation=()=>this.initNavigation?(0,St.of)(null):(this.initNavigation=!0,R(!0),this.resultOfPreactivationDone),j.initialNavigation()):R(!0),F})}bootstrapListener(_){const R=this.injector.get(eo),F=this.injector.get(Eu),j=this.injector.get(qc),oe=this.injector.get(ri),ye=this.injector.get($.z2F);_===ye.components[0]&&(("enabledNonBlocking"===R.initialNavigation||void 0===R.initialNavigation)&&oe.initialNavigation(),F.setUpPreloading(),j.init(),oe.resetRootComponentType(ye.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return M.\u0275fac=function(_){return new(_||M)($.LFG($.zs3))},M.\u0275prov=$.Yz7({token:M,factory:M.\u0275fac}),M})();function Y(M){return M.appInitializer.bind(M)}function le(M){return M.bootstrapListener.bind(M)}const we=new $.OlP("Router Initializer")},4553:Nt=>{function ut(se,G,$){var We,Ze,Ae,Me,Te;function Fe(){var J=Date.now()-Me;J<G&&J>=0?We=setTimeout(Fe,G-J):(We=null,$||(Te=se.apply(Ae,Ze),Ae=Ze=null))}null==G&&(G=100);var Be=function(){Ae=this,Ze=arguments,Me=Date.now();var J=$&&!We;return We||(We=setTimeout(Fe,G)),J&&(Te=se.apply(Ae,Ze),Ae=Ze=null),Te};return Be.clear=function(){We&&(clearTimeout(We),We=null)},Be.flush=function(){We&&(Te=se.apply(Ae,Ze),Ae=Ze=null,clearTimeout(We),We=null)},Be}ut.debounce=ut,Nt.exports=ut},7691:Nt=>{Nt.exports=function($){!function(G){if(!G)throw new Error("Eventify cannot use falsy object as events subject");for(var $=["on","fire","off"],We=0;We<$.length;++We)if(G.hasOwnProperty($[We]))throw new Error("Subject cannot be eventified, since it already has property '"+$[We]+"'")}($);var We=function(G){var $=Object.create(null);return{on:function(We,Ze,Ae){if("function"!=typeof Ze)throw new Error("callback is expected to be a function");var Me=$[We];return Me||(Me=$[We]=[]),Me.push({callback:Ze,ctx:Ae}),G},off:function(We,Ze){if(void 0===We)return $=Object.create(null),G;if($[We])if("function"!=typeof Ze)delete $[We];else for(var Te=$[We],Fe=0;Fe<Te.length;++Fe)Te[Fe].callback===Ze&&Te.splice(Fe,1);return G},fire:function(We){var Ae,Ze=$[We];if(!Ze)return G;arguments.length>1&&(Ae=Array.prototype.splice.call(arguments,1));for(var Me=0;Me<Ze.length;++Me){var Te=Ze[Me];Te.callback.apply(Te.ctx,Ae)}return G}}}($);return $.on=We.on,$.off=We.off,$.fire=We.fire,$}},5038:(Nt,ut,se)=>{Nt.exports=function(Ze,Ae){if(!Ze)throw new Error("Graph structure cannot be undefined");var Te=(Ae&&Ae.createSimulator||se(2637))(Ae);if(Array.isArray(Ae))throw new Error("Physics settings is expected to be an object");var Fe=Ze.version>19?function($t){var vn=Ze.getLinks($t);return vn?1+vn.size/3:1}:function($t){var vn=Ze.getLinks($t);return vn?1+vn.length/3:1};Ae&&"function"==typeof Ae.nodeMass&&(Fe=Ae.nodeMass);var Be=new Map,J={},K=0,_e=Te.settings.springTransform||We;K=0,Ze.forEachNode(function($t){Dn($t.id),K+=1}),Ze.forEachLink(st),Ze.on("changed",an);var Ue=!1,Ve={step:function(){if(0===K)return at(!0),!0;var $t=Te.step();Ve.lastMove=$t,Ve.fire("step");var Un=$t/K<=.01;return at(Un),Un},getNodePosition:function($t){return rr($t).pos},setNodePosition:function($t){var vn=rr($t);vn.setPosition.apply(vn,Array.prototype.slice.call(arguments,1))},getLinkPosition:function($t){var vn=J[$t];if(vn)return{from:vn.from.pos,to:vn.to.pos}},getGraphRect:function(){return Te.getBBox()},forEachBody:Xe,pinNode:function($t,vn){rr($t.id).isPinned=!!vn},isNodePinned:function($t){return rr($t.id).isPinned},dispose:function(){Ze.off("changed",an),Ve.fire("disposed")},getBody:function($t){return Be.get($t)},getSpring:function($t,vn){var Un;if(void 0===vn)Un="object"!=typeof $t?$t:$t.id;else{var Hn=Ze.hasLink($t,vn);if(!Hn)return;Un=Hn.id}return J[Un]},getForceVectorLength:function(){var $t=0,vn=0;return Xe(function(Un){$t+=Math.abs(Un.force.x),vn+=Math.abs(Un.force.y)}),Math.sqrt($t*$t+vn*vn)},simulator:Te,graph:Ze,lastMove:0};return G(Ve),Ve;function at($t){Ue!==$t&&(Ue=$t,function($t){Ve.fire("stable",$t)}($t))}function Xe($t){Be.forEach($t)}function an($t){for(var vn=0;vn<$t.length;++vn){var Un=$t[vn];"add"===Un.changeType?(Un.node&&Dn(Un.node.id),Un.link&&st(Un.link)):"remove"===Un.changeType&&(Un.node&&Cn(Un.node),Un.link&&Bt(Un.link))}K=Ze.getNodesCount()}function Dn($t){var vn=Be.get($t);if(!vn){var Un=Ze.getNode($t);if(!Un)throw new Error("initBody() was called with unknown node id");var Hn=Un.position;if(!Hn){var ts=function($t){var vn=[];if(!$t.links)return vn;for(var Un=Math.min($t.links.length,2),Hn=0;Hn<Un;++Hn){var ts=$t.links[Hn],_i=Be.get(ts.fromId!==$t.id?ts.fromId:ts.toId);_i&&_i.pos&&vn.push(_i)}return vn}(Un);Hn=Te.getBestNewBodyPosition(ts)}(vn=Te.addBodyAt(Hn)).id=$t,Be.set($t,vn),nr($t),function($t){return $t&&($t.isPinned||$t.data&&$t.data.isPinned)}(Un)&&(vn.isPinned=!0)}}function Cn($t){var vn=$t.id,Un=Be.get(vn);Un&&(Be.delete(vn),Te.removeBody(Un))}function st($t){nr($t.fromId),nr($t.toId);var vn=Be.get($t.fromId),Un=Be.get($t.toId),Hn=Te.addSpring(vn,Un,$t.length);_e($t,Hn),J[$t.id]=Hn}function Bt($t){var vn=J[$t.id];if(vn){var Un=Ze.getNode($t.fromId),Hn=Ze.getNode($t.toId);Un&&nr(Un.id),Hn&&nr(Hn.id),delete J[$t.id],Te.removeSpring(vn)}}function nr($t){var vn=Be.get($t);if(vn.mass=Fe($t),Number.isNaN(vn.mass))throw new Error("Node mass should be a number")}function rr($t){var vn=Be.get($t);return vn||(Dn($t),vn=Be.get($t)),vn}},Nt.exports.simulator=se(2637);var G=se(7691);function We(){}},829:(Nt,ut,se)=>{const G=se(1497);Nt.exports=function(We){return function(Ae,Me){let Fe=Me&&void 0!==Me.join?Me.join:"\n",Be=Array((Me&&Me.indent||0)+1).join(" "),J=[];for(let K=0;K<We;++K){let _e=G(K);J.push((0===K?"":Be)+Ae.replace(/{var}/g,_e))}return J.join(Fe)}}},9243:(Nt,ut,se)=>{Nt.exports=function(Ze){let Ae=We(Ze);return new Function("bodies","settings","random",Ae)},Nt.exports.generateFunctionBody=We;const G=se(829);function We(Ze){let Ae=G(Ze);return`\n  var boundingBox = {\n    ${Ae("min_{var}: 0, max_{var}: 0,",{indent:4})}\n  };\n\n  return {\n    box: boundingBox,\n\n    update: updateBoundingBox,\n\n    reset: resetBoundingBox,\n\n    getBestNewPosition: function (neighbors) {\n      var ${Ae("base_{var} = 0",{join:", "})};\n\n      if (neighbors.length) {\n        for (var i = 0; i < neighbors.length; ++i) {\n          let neighborPos = neighbors[i].pos;\n          ${Ae("base_{var} += neighborPos.{var};",{indent:10})}\n        }\n\n        ${Ae("base_{var} /= neighbors.length;",{indent:8})}\n      } else {\n        ${Ae("base_{var} = (boundingBox.min_{var} + boundingBox.max_{var}) / 2;",{indent:8})}\n      }\n\n      var springLength = settings.springLength;\n      return {\n        ${Ae("{var}: base_{var} + (random.nextDouble() - 0.5) * springLength,",{indent:8})}\n      };\n    }\n  };\n\n  function updateBoundingBox() {\n    var i = bodies.length;\n    if (i === 0) return; // No bodies - no borders.\n\n    ${Ae("var max_{var} = -Infinity;",{indent:4})}\n    ${Ae("var min_{var} = Infinity;",{indent:4})}\n\n    while(i--) {\n      // this is O(n), it could be done faster with quadtree, if we check the root node bounds\n      var bodyPos = bodies[i].pos;\n      ${Ae("if (bodyPos.{var} < min_{var}) min_{var} = bodyPos.{var};",{indent:6})}\n      ${Ae("if (bodyPos.{var} > max_{var}) max_{var} = bodyPos.{var};",{indent:6})}\n    }\n\n    ${Ae("boundingBox.min_{var} = min_{var};",{indent:4})}\n    ${Ae("boundingBox.max_{var} = max_{var};",{indent:4})}\n  }\n\n  function resetBoundingBox() {\n    ${Ae("boundingBox.min_{var} = boundingBox.max_{var} = 0;",{indent:4})}\n  }\n`}},9237:(Nt,ut,se)=>{const G=se(829);function We(Me,Te){return`\n${Ae(Me,Te)}\n${Ze(Me)}\nreturn {Body: Body, Vector: Vector};\n`}function Ze(Me){let Te=G(Me),Fe=Te("{var}",{join:", "});return`\nfunction Body(${Fe}) {\n  this.isPinned = false;\n  this.pos = new Vector(${Fe});\n  this.force = new Vector();\n  this.velocity = new Vector();\n  this.mass = 1;\n\n  this.springCount = 0;\n  this.springLength = 0;\n}\n\nBody.prototype.reset = function() {\n  this.force.reset();\n  this.springCount = 0;\n  this.springLength = 0;\n}\n\nBody.prototype.setPosition = function (${Fe}) {\n  ${Te("this.pos.{var} = {var} || 0;",{indent:2})}\n};`}function Ae(Me,Te){let Fe=G(Me),Be="";return Te&&(Be=`${Fe("\n   var v{var};\nObject.defineProperty(this, '{var}', {\n  set: function(v) { \n    if (!Number.isFinite(v)) throw new Error('Cannot set non-numbers to {var}');\n    v{var} = v; \n  },\n  get: function() { return v{var}; }\n});")}`),`function Vector(${Fe("{var}",{join:", "})}) {\n  ${Be}\n    if (typeof arguments[0] === 'object') {\n      // could be another vector\n      let v = arguments[0];\n      ${Fe('if (!Number.isFinite(v.{var})) throw new Error("Expected value is not a finite number at Vector constructor ({var})");',{indent:4})}\n      ${Fe("this.{var} = v.{var};",{indent:4})}\n    } else {\n      ${Fe('this.{var} = typeof {var} === "number" ? {var} : 0;',{indent:4})}\n    }\n  }\n  \n  Vector.prototype.reset = function () {\n    ${Fe("this.{var} = ",{join:""})}0;\n  };`}Nt.exports=function(Me,Te){let Fe=We(Me,Te),{Body:Be}=new Function(Fe)();return Be},Nt.exports.generateCreateBodyFunctionBody=We,Nt.exports.getVectorCode=Ae,Nt.exports.getBodyCode=Ze},8803:(Nt,ut,se)=>{const G=se(829);function We(Ze){return`\n  if (!Number.isFinite(options.dragCoefficient)) throw new Error('dragCoefficient is not a finite number');\n\n  return {\n    update: function(body) {\n      ${G(Ze)("body.force.{var} -= options.dragCoefficient * body.velocity.{var};",{indent:6})}\n    }\n  };\n`}Nt.exports=function(Ze){let Ae=We(Ze);return new Function("options",Ae)},Nt.exports.generateCreateDragForceFunctionBody=We},1914:(Nt,ut,se)=>{const G=se(829);function We(Ze){let Ae=G(Ze);return`\n  if (!Number.isFinite(options.springCoefficient)) throw new Error('Spring coefficient is not a number');\n  if (!Number.isFinite(options.springLength)) throw new Error('Spring length is not a number');\n\n  return {\n    /**\n     * Updates forces acting on a spring\n     */\n    update: function (spring) {\n      var body1 = spring.from;\n      var body2 = spring.to;\n      var length = spring.length < 0 ? options.springLength : spring.length;\n      ${Ae("var d{var} = body2.pos.{var} - body1.pos.{var};",{indent:6})}\n      var r = Math.sqrt(${Ae("d{var} * d{var}",{join:" + "})});\n\n      if (r === 0) {\n        ${Ae("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:8})}\n        r = Math.sqrt(${Ae("d{var} * d{var}",{join:" + "})});\n      }\n\n      var d = r - length;\n      var coefficient = ((spring.coefficient > 0) ? spring.coefficient : options.springCoefficient) * d / r;\n\n      ${Ae("body1.force.{var} += coefficient * d{var}",{indent:6})};\n      body1.springCount += 1;\n      body1.springLength += r;\n\n      ${Ae("body2.force.{var} -= coefficient * d{var}",{indent:6})};\n      body2.springCount += 1;\n      body2.springLength += r;\n    }\n  };\n`}Nt.exports=function(Ze){let Ae=We(Ze);return new Function("options","random",Ae)},Nt.exports.generateCreateSpringForceFunctionBody=We},2225:(Nt,ut,se)=>{const G=se(829);function We(Ze){let Ae=G(Ze);return`\n  var length = bodies.length;\n  if (length === 0) return 0;\n\n  ${Ae("var d{var} = 0, t{var} = 0;",{indent:2})}\n\n  for (var i = 0; i < length; ++i) {\n    var body = bodies[i];\n    if (body.isPinned) continue;\n\n    if (adaptiveTimeStepWeight && body.springCount) {\n      timeStep = (adaptiveTimeStepWeight * body.springLength/body.springCount);\n    }\n\n    var coeff = timeStep / body.mass;\n\n    ${Ae("body.velocity.{var} += coeff * body.force.{var};",{indent:4})}\n    ${Ae("var v{var} = body.velocity.{var};",{indent:4})}\n    var v = Math.sqrt(${Ae("v{var} * v{var}",{join:" + "})});\n\n    if (v > 1) {\n      // We normalize it so that we move within timeStep range. \n      // for the case when v <= 1 - we let velocity to fade out.\n      ${Ae("body.velocity.{var} = v{var} / v;",{indent:6})}\n    }\n\n    ${Ae("d{var} = timeStep * body.velocity.{var};",{indent:4})}\n\n    ${Ae("body.pos.{var} += d{var};",{indent:4})}\n\n    ${Ae("t{var} += Math.abs(d{var});",{indent:4})}\n  }\n\n  return (${Ae("t{var} * t{var}",{join:" + "})})/length;\n`}Nt.exports=function(Ze){let Ae=We(Ze);return new Function("bodies","timeStep","adaptiveTimeStepWeight",Ae)},Nt.exports.generateIntegratorFunctionBody=We},2389:(Nt,ut,se)=>{const G=se(829),$=se(1497);function Ze(J){let K=G(J),_e=Math.pow(2,J);return`\n\n/**\n * Our implementation of QuadTree is non-recursive to avoid GC hit\n * This data structure represent stack of elements\n * which we are trying to insert into quad tree.\n */\nfunction InsertStack () {\n    this.stack = [];\n    this.popIdx = 0;\n}\n\nInsertStack.prototype = {\n    isEmpty: function() {\n        return this.popIdx === 0;\n    },\n    push: function (node, body) {\n        var item = this.stack[this.popIdx];\n        if (!item) {\n            // we are trying to avoid memory pressure: create new element\n            // only when absolutely necessary\n            this.stack[this.popIdx] = new InsertStackElement(node, body);\n        } else {\n            item.node = node;\n            item.body = body;\n        }\n        ++this.popIdx;\n    },\n    pop: function () {\n        if (this.popIdx > 0) {\n            return this.stack[--this.popIdx];\n        }\n    },\n    reset: function () {\n        this.popIdx = 0;\n    }\n};\n\nfunction InsertStackElement(node, body) {\n    this.node = node; // QuadTree node\n    this.body = body; // physical body which needs to be inserted to node\n}\n\n${Fe(J)}\n${Ae(J)}\n${Te(J)}\n${Me(J)}\n\nfunction createQuadTree(options, random) {\n  options = options || {};\n  options.gravity = typeof options.gravity === 'number' ? options.gravity : -1;\n  options.theta = typeof options.theta === 'number' ? options.theta : 0.8;\n\n  var gravity = options.gravity;\n  var updateQueue = [];\n  var insertStack = new InsertStack();\n  var theta = options.theta;\n\n  var nodesCache = [];\n  var currentInCache = 0;\n  var root = newNode();\n\n  return {\n    insertBodies: insertBodies,\n\n    /**\n     * Gets root node if it is present\n     */\n    getRoot: function() {\n      return root;\n    },\n\n    updateBodyForce: update,\n\n    options: function(newOptions) {\n      if (newOptions) {\n        if (typeof newOptions.gravity === 'number') {\n          gravity = newOptions.gravity;\n        }\n        if (typeof newOptions.theta === 'number') {\n          theta = newOptions.theta;\n        }\n\n        return this;\n      }\n\n      return {\n        gravity: gravity,\n        theta: theta\n      };\n    }\n  };\n\n  function newNode() {\n    // To avoid pressure on GC we reuse nodes.\n    var node = nodesCache[currentInCache];\n    if (node) {\n${function(kt){let St=[];for(let Wt=0;Wt<_e;++Wt)St.push(`      node.quad${Wt} = null;`);return St.join("\n")}()}\n      node.body = null;\n      node.mass = ${K("node.mass_{var} = ",{join:""})}0;\n      ${K("node.min_{var} = node.max_{var} = ",{join:""})}0;\n    } else {\n      node = new QuadNode();\n      nodesCache[currentInCache] = node;\n    }\n\n    ++currentInCache;\n    return node;\n  }\n\n  function update(sourceBody) {\n    var queue = updateQueue;\n    var v;\n    ${K("var d{var};",{indent:4})}\n    var r; \n    ${K("var f{var} = 0;",{indent:4})}\n    var queueLength = 1;\n    var shiftIdx = 0;\n    var pushIdx = 1;\n\n    queue[0] = root;\n\n    while (queueLength) {\n      var node = queue[shiftIdx];\n      var body = node.body;\n\n      queueLength -= 1;\n      shiftIdx += 1;\n      var differentBody = (body !== sourceBody);\n      if (body && differentBody) {\n        // If the current node is a leaf node (and it is not source body),\n        // calculate the force exerted by the current node on body, and add this\n        // amount to body's net force.\n        ${K("d{var} = body.pos.{var} - sourceBody.pos.{var};",{indent:8})}\n        r = Math.sqrt(${K("d{var} * d{var}",{join:" + "})});\n\n        if (r === 0) {\n          // Poor man's protection against zero distance.\n          ${K("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}\n          r = Math.sqrt(${K("d{var} * d{var}",{join:" + "})});\n        }\n\n        // This is standard gravitation force calculation but we divide\n        // by r^3 to save two operations when normalizing force vector.\n        v = gravity * body.mass * sourceBody.mass / (r * r * r);\n        ${K("f{var} += v * d{var};",{indent:8})}\n      } else if (differentBody) {\n        // Otherwise, calculate the ratio s / r,  where s is the width of the region\n        // represented by the internal node, and r is the distance between the body\n        // and the node's center-of-mass\n        ${K("d{var} = node.mass_{var} / node.mass - sourceBody.pos.{var};",{indent:8})}\n        r = Math.sqrt(${K("d{var} * d{var}",{join:" + "})});\n\n        if (r === 0) {\n          // Sorry about code duplication. I don't want to create many functions\n          // right away. Just want to see performance first.\n          ${K("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}\n          r = Math.sqrt(${K("d{var} * d{var}",{join:" + "})});\n        }\n        // If s / r < \u03b8, treat this internal node as a single body, and calculate the\n        // force it exerts on sourceBody, and add this amount to sourceBody's net force.\n        if ((node.max_${$(0)} - node.min_${$(0)}) / r < theta) {\n          // in the if statement above we consider node's width only\n          // because the region was made into square during tree creation.\n          // Thus there is no difference between using width or height.\n          v = gravity * node.mass * sourceBody.mass / (r * r * r);\n          ${K("f{var} += v * d{var};",{indent:10})}\n        } else {\n          // Otherwise, run the procedure recursively on each of the current node's children.\n\n          // I intentionally unfolded this loop, to save several CPU cycles.\n${function(){let kt=Array(11).join(" "),St=[];for(let Wt=0;Wt<_e;++Wt)St.push(kt+`if (node.quad${Wt}) {`),St.push(kt+`  queue[pushIdx] = node.quad${Wt};`),St.push(kt+"  queueLength += 1;"),St.push(kt+"  pushIdx += 1;"),St.push(kt+"}");return St.join("\n")}()}\n        }\n      }\n    }\n\n    ${K("sourceBody.force.{var} += f{var};",{indent:4})}\n  }\n\n  function insertBodies(bodies) {\n    ${K("var {var}min = Number.MAX_VALUE;",{indent:4})}\n    ${K("var {var}max = Number.MIN_VALUE;",{indent:4})}\n    var i = bodies.length;\n\n    // To reduce quad tree depth we are looking for exact bounding box of all particles.\n    while (i--) {\n      var pos = bodies[i].pos;\n      ${K("if (pos.{var} < {var}min) {var}min = pos.{var};",{indent:6})}\n      ${K("if (pos.{var} > {var}max) {var}max = pos.{var};",{indent:6})}\n    }\n\n    // Makes the bounds square.\n    var maxSideLength = -Infinity;\n    ${K("if ({var}max - {var}min > maxSideLength) maxSideLength = {var}max - {var}min ;",{indent:4})}\n\n    currentInCache = 0;\n    root = newNode();\n    ${K("root.min_{var} = {var}min;",{indent:4})}\n    ${K("root.max_{var} = {var}min + maxSideLength;",{indent:4})}\n\n    i = bodies.length - 1;\n    if (i >= 0) {\n      root.body = bodies[i];\n    }\n    while (i--) {\n      insert(bodies[i], root);\n    }\n  }\n\n  function insert(newBody) {\n    insertStack.reset();\n    insertStack.push(root, newBody);\n\n    while (!insertStack.isEmpty()) {\n      var stackItem = insertStack.pop();\n      var node = stackItem.node;\n      var body = stackItem.body;\n\n      if (!node.body) {\n        // This is internal node. Update the total mass of the node and center-of-mass.\n        ${K("var {var} = body.pos.{var};",{indent:8})}\n        node.mass += body.mass;\n        ${K("node.mass_{var} += body.mass * {var};",{indent:8})}\n\n        // Recursively insert the body in the appropriate quadrant.\n        // But first find the appropriate quadrant.\n        var quadIdx = 0; // Assume we are in the 0's quad.\n        ${K("var min_{var} = node.min_{var};",{indent:8})}\n        ${K("var max_{var} = (min_{var} + node.max_{var}) / 2;",{indent:8})}\n\n${function(kt){let St=[],Wt=Array(9).join(" ");for(let zt=0;zt<J;++zt)St.push(Wt+`if (${$(zt)} > max_${$(zt)}) {`),St.push(Wt+`  quadIdx = quadIdx + ${Math.pow(2,zt)};`),St.push(Wt+`  min_${$(zt)} = max_${$(zt)};`),St.push(Wt+`  max_${$(zt)} = node.max_${$(zt)};`),St.push(Wt+"}");return St.join("\n")}()}\n\n        var child = getChild(node, quadIdx);\n\n        if (!child) {\n          // The node is internal but this quadrant is not taken. Add\n          // subnode to it.\n          child = newNode();\n          ${K("child.min_{var} = min_{var};",{indent:10})}\n          ${K("child.max_{var} = max_{var};",{indent:10})}\n          child.body = body;\n\n          setChild(node, quadIdx, child);\n        } else {\n          // continue searching in this quadrant.\n          insertStack.push(child, body);\n        }\n      } else {\n        // We are trying to add to the leaf node.\n        // We have to convert current leaf into internal node\n        // and continue adding two nodes.\n        var oldBody = node.body;\n        node.body = null; // internal nodes do not cary bodies\n\n        if (isSamePosition(oldBody.pos, body.pos)) {\n          // Prevent infinite subdivision by bumping one node\n          // anywhere in this quadrant\n          var retriesCount = 3;\n          do {\n            var offset = random.nextDouble();\n            ${K("var d{var} = (node.max_{var} - node.min_{var}) * offset;",{indent:12})}\n\n            ${K("oldBody.pos.{var} = node.min_{var} + d{var};",{indent:12})}\n            retriesCount -= 1;\n            // Make sure we don't bump it out of the box. If we do, next iteration should fix it\n          } while (retriesCount > 0 && isSamePosition(oldBody.pos, body.pos));\n\n          if (retriesCount === 0 && isSamePosition(oldBody.pos, body.pos)) {\n            // This is very bad, we ran out of precision.\n            // if we do not return from the method we'll get into\n            // infinite loop here. So we sacrifice correctness of layout, and keep the app running\n            // Next layout iteration should get larger bounding box in the first step and fix this\n            return;\n          }\n        }\n        // Next iteration should subdivide node further.\n        insertStack.push(node, oldBody);\n        insertStack.push(node, body);\n      }\n    }\n  }\n}\nreturn createQuadTree;\n\n`}function Ae(J){let K=G(J);return`\n  function isSamePosition(point1, point2) {\n    ${K("var d{var} = Math.abs(point1.{var} - point2.{var});",{indent:2})}\n  \n    return ${K("d{var} < 1e-8",{join:" && "})};\n  }  \n`}function Me(J){var K=Math.pow(2,J);return`\nfunction setChild(node, idx, child) {\n  ${function(){let Ue=[];for(let Ve=0;Ve<K;++Ve)Ue.push(`${0===Ve?"  ":"  else "}if (idx === ${Ve}) node.quad${Ve} = child;`);return Ue.join("\n")}()}\n}`}function Te(J){return`function getChild(node, idx) {\n${function(){let _e=[],Ue=Math.pow(2,J);for(let Ve=0;Ve<Ue;++Ve)_e.push(`  if (idx === ${Ve}) return node.quad${Ve};`);return _e.join("\n")}()}\n  return null;\n}`}function Fe(J){let K=G(J),_e=Math.pow(2,J);return`\nfunction QuadNode() {\n  // body stored inside this node. In quad tree only leaf nodes (by construction)\n  // contain bodies:\n  this.body = null;\n\n  // Child nodes are stored in quads. Each quad is presented by number:\n  // 0 | 1\n  // -----\n  // 2 | 3\n${function(at){let Xe=[];for(let kt=0;kt<_e;++kt)Xe.push(`  this.quad${kt} = null;`);return Xe.join("\n")}()}\n\n  // Total mass of current node\n  this.mass = 0;\n\n  // Center of mass coordinates\n  ${K("this.mass_{var} = 0;",{indent:2})}\n\n  // bounding box coordinates\n  ${K("this.min_{var} = 0;",{indent:2})}\n  ${K("this.max_{var} = 0;",{indent:2})}\n}\n`}function Be(){return"\n/**\n * Our implementation of QuadTree is non-recursive to avoid GC hit\n * This data structure represent stack of elements\n * which we are trying to insert into quad tree.\n */\nfunction InsertStack () {\n    this.stack = [];\n    this.popIdx = 0;\n}\n\nInsertStack.prototype = {\n    isEmpty: function() {\n        return this.popIdx === 0;\n    },\n    push: function (node, body) {\n        var item = this.stack[this.popIdx];\n        if (!item) {\n            // we are trying to avoid memory pressure: create new element\n            // only when absolutely necessary\n            this.stack[this.popIdx] = new InsertStackElement(node, body);\n        } else {\n            item.node = node;\n            item.body = body;\n        }\n        ++this.popIdx;\n    },\n    pop: function () {\n        if (this.popIdx > 0) {\n            return this.stack[--this.popIdx];\n        }\n    },\n    reset: function () {\n        this.popIdx = 0;\n    }\n};\n\nfunction InsertStackElement(node, body) {\n    this.node = node; // QuadTree node\n    this.body = body; // physical body which needs to be inserted to node\n}\n"}Nt.exports=function(J){let K=Ze(J);return new Function(K)()},Nt.exports.generateQuadTreeFunctionBody=Ze,Nt.exports.getInsertStackCode=Be,Nt.exports.getQuadNodeCode=Fe,Nt.exports.isSamePosition=Ae,Nt.exports.getChildBodyCode=Te,Nt.exports.setChildBodyCode=Me},1497:Nt=>{Nt.exports=function(se){return 0===se?"x":1===se?"y":2===se?"z":"c"+(se+1)}},2637:(Nt,ut,se)=>{Nt.exports=function(K){var _e=se(8018),Ue=se(5513),Ve=se(7691);if(K){if(void 0!==K.springCoeff)throw new Error("springCoeff was renamed to springCoefficient");if(void 0!==K.dragCoeff)throw new Error("dragCoeff was renamed to dragCoefficient")}K=Ue(K,{springLength:10,springCoefficient:.8,gravity:-12,theta:.8,dragCoefficient:.9,timeStep:.5,adaptiveTimeStepWeight:0,dimensions:2,debug:!1});var at=Te[K.dimensions];if(!at){var Xe=K.dimensions;at={Body:G(Xe,K.debug),createQuadTree:$(Xe),createBounds:We(Xe),createDragForce:Ze(Xe),createSpringForce:Ae(Xe),integrate:Me(Xe)},Te[Xe]=at}var kt=at.Body,St=at.createQuadTree,Wt=at.createBounds,zt=at.createDragForce,hn=at.createSpringForce,an=at.integrate,Dn=se(100).random(42),Cn=[],st=[],Bt=St(K,Dn),nn=Wt(Cn,K,Dn),nr=hn(K,Dn),Rn=zt(K),Zt=[],ki=new Map,$t=0;Hn("nbody",function(){if(0!==Cn.length){Bt.insertBodies(Cn);for(var _n=Cn.length;_n--;){var Lt=Cn[_n];Lt.isPinned||(Lt.reset(),Bt.updateBodyForce(Lt),Rn.update(Lt))}}}),Hn("spring",function(){for(var _n=st.length;_n--;)nr.update(st[_n])});var vn={bodies:Cn,quadTree:Bt,springs:st,settings:K,addForce:Hn,removeForce:function(_n){var Lt=Zt.indexOf(ki.get(_n));Lt<0||(Zt.splice(Lt,1),ki.delete(_n))},getForces:function(){return ki},step:function(){for(var _n=0;_n<Zt.length;++_n)Zt[_n]($t);var Lt=an(Cn,K.timeStep,K.adaptiveTimeStepWeight);return $t+=1,Lt},addBody:function(_n){if(!_n)throw new Error("Body is required");return Cn.push(_n),_n},addBodyAt:function(_n){if(!_n)throw new Error("Body position is required");var Lt=(_n=>new kt(_n))(_n);return Cn.push(Lt),Lt},removeBody:function(_n){if(_n){var Lt=Cn.indexOf(_n);if(!(Lt<0))return Cn.splice(Lt,1),0===Cn.length&&nn.reset(),!0}},addSpring:function(_n,Lt,ln,Pn){if(!_n||!Lt)throw new Error("Cannot add null spring to force simulator");"number"!=typeof ln&&(ln=-1);var cn=new _e(_n,Lt,ln,Pn>=0?Pn:-1);return st.push(cn),cn},getTotalMovement:function(){return 0},removeSpring:function(_n){if(_n){var Lt=st.indexOf(_n);if(Lt>-1)return st.splice(Lt,1),!0}},getBestNewBodyPosition:function(_n){return nn.getBestNewPosition(_n)},getBBox:Un,getBoundingBox:Un,invalidateBBox:function(){console.warn("invalidateBBox() is deprecated, bounds always recomputed on `getBBox()` call")},gravity:function(_n){return void 0!==_n?(K.gravity=_n,Bt.options({gravity:_n}),this):K.gravity},theta:function(_n){return void 0!==_n?(K.theta=_n,Bt.options({theta:_n}),this):K.theta},random:Dn};return function(K,_e){for(var Ue in K)J(K,_e,Ue)}(K,vn),Ve(vn),vn;function Un(){return nn.update(),nn.box}function Hn(_n,Lt){if(ki.has(_n))throw new Error("Force "+_n+" is already added");ki.set(_n,Lt),Zt.push(Lt)}};var G=se(9237),$=se(2389),We=se(9243),Ze=se(8803),Ae=se(1914),Me=se(2225),Te={};function J(K,_e,Ue){if(K.hasOwnProperty(Ue)&&"function"!=typeof _e[Ue]){var Ve=Number.isFinite(K[Ue]);_e[Ue]=Ve?function(at){if(void 0!==at){if(!Number.isFinite(at))throw new Error("Value of "+Ue+" should be a valid number.");return K[Ue]=at,_e}return K[Ue]}:function(at){return void 0!==at?(K[Ue]=at,_e):K[Ue]}}}},8018:Nt=>{Nt.exports=function(se,G,$,We){this.from=se,this.to=G,this.length=$,this.coefficient=We}},5401:(Nt,ut,se)=>{Nt.exports=function(Fe){if("uniqueLinkId"in(Fe=Fe||{})&&(console.warn("ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\nUse `multigraph` option instead\n","\n","Note: there is also change in default behavior: From now on each graph\nis considered to be not a multigraph by default (each edge is unique)."),Fe.multigraph=Fe.uniqueLinkId),void 0===Fe.multigraph&&(Fe.multigraph=!1),"function"!=typeof Map)throw new Error("ngraph.graph requires `Map` to be defined. Please polyfill it before using ngraph");var Lt,Be=new Map,J=[],K={},_e=0,Ue=Fe.multigraph?function(Lt,ln,Pn){var cn=Te(Lt,ln),Qr=K.hasOwnProperty(cn);if(Qr||ki(Lt,ln)){Qr||(K[cn]=0);var Br="@"+ ++K[cn];cn=Te(Lt+Br,ln+Br)}return new Me(Lt,ln,Pn,cn)}:function(Lt,ln,Pn){return new Me(Lt,ln,Pn,Te(Lt,ln))},Ve=[],at=_i,Xe=_i,kt=_i,St=_i,Wt={addNode:er,addLink:function(Lt,ln,Pn){kt();var cn=Dn(Lt)||er(Lt),Qr=Dn(ln)||er(ln),Br=Ue(Lt,ln,Pn);return J.push(Br),Ae(cn,Br),Lt!==ln&&Ae(Qr,Br),at(Br,"add"),St(),Br},removeLink:Zt,removeNode:Cn,getNode:Dn,getNodeCount:nr,getLinkCount:Rn,getLinksCount:Rn,getNodesCount:nr,getLinks:function(Lt){var ln=Dn(Lt);return ln?ln.links:null},forEachNode:_n,forEachLinkedNode:function(Lt,ln,Pn){var cn=Dn(Lt);if(cn&&cn.links&&"function"==typeof ln)return Pn?function(Lt,ln,Pn){for(var Qr=0;Qr<Lt.length;++Qr){var Br=Lt[Qr];if(Br.fromId===ln&&Pn(Be.get(Br.toId),Br))return!0}}(cn.links,Lt,ln):function(Lt,ln,Pn){for(var Qr=0;Qr<Lt.length;++Qr){var Br=Lt[Qr];if(Pn(Be.get(Br.fromId===ln?Br.toId:Br.fromId),Br))return!0}}(cn.links,Lt,ln)},forEachLink:function(Lt){var ln,Pn;if("function"==typeof Lt)for(ln=0,Pn=J.length;ln<Pn;++ln)Lt(J[ln])},beginUpdate:kt,endUpdate:St,clear:function(){kt(),_n(function(Lt){Cn(Lt.id)}),St()},hasLink:ki,hasNode:Dn,getLink:ki};return G(Wt),Lt=Wt.on,Wt.on=function(){return Wt.beginUpdate=kt=Hi,Wt.endUpdate=St=ns,at=hn,Xe=an,Wt.on=Lt,Lt.apply(Wt,arguments)},Wt;function hn(Lt,ln){Ve.push({link:Lt,changeType:ln})}function an(Lt,ln){Ve.push({node:Lt,changeType:ln})}function er(Lt,ln){if(void 0===Lt)throw new Error("Invalid node identifier");kt();var Pn=Dn(Lt);return Pn?(Pn.data=ln,Xe(Pn,"update")):(Pn=new Ze(Lt,ln),Xe(Pn,"add")),Be.set(Lt,Pn),St(),Pn}function Dn(Lt){return Be.get(Lt)}function Cn(Lt){var ln=Dn(Lt);if(!ln)return!1;kt();var Pn=ln.links;if(Pn){ln.links=null;for(var cn=0;cn<Pn.length;++cn)Zt(Pn[cn])}return Be.delete(Lt),Xe(ln,"remove"),St(),!0}function nr(){return Be.size}function Rn(){return J.length}function Zt(Lt){if(!Lt)return!1;var ln=We(Lt,J);if(ln<0)return!1;kt(),J.splice(ln,1);var Pn=Dn(Lt.fromId),cn=Dn(Lt.toId);return Pn&&(ln=We(Lt,Pn.links))>=0&&Pn.links.splice(ln,1),cn&&(ln=We(Lt,cn.links))>=0&&cn.links.splice(ln,1),at(Lt,"remove"),St(),!0}function ki(Lt,ln){var cn,Pn=Dn(Lt);if(!Pn||!Pn.links)return null;for(cn=0;cn<Pn.links.length;++cn){var Qr=Pn.links[cn];if(Qr.fromId===Lt&&Qr.toId===ln)return Qr}return null}function _i(){}function Hi(){_e+=1}function ns(){0==(_e-=1)&&Ve.length>0&&(Wt.fire("changed",Ve),Ve.length=0)}function _n(Lt){if("function"!=typeof Lt)throw new Error("Function is expected to iterate over graph nodes. You passed "+Lt);for(var ln=Be.values(),Pn=ln.next();!Pn.done;){if(Lt(Pn.value))return!0;Pn=ln.next()}}};var G=se(7691);function We(Fe,Be){if(!Be)return-1;if(Be.indexOf)return Be.indexOf(Fe);var K,J=Be.length;for(K=0;K<J;K+=1)if(Be[K]===Fe)return K;return-1}function Ze(Fe,Be){this.id=Fe,this.links=null,this.data=Be}function Ae(Fe,Be){Fe.links?Fe.links.push(Be):Fe.links=[Be]}function Me(Fe,Be,J,K){this.fromId=Fe,this.toId=Be,this.data=J,this.id=K}function Te(Fe,Be){return Fe.toString()+"\u{1f449} "+Be.toString()}},5513:Nt=>{Nt.exports=function ut(se,G){var $;if(se||(se={}),G)for($ in G)if(G.hasOwnProperty($)){var We=se.hasOwnProperty($),Ze=typeof G[$];We&&typeof se[$]===Ze?"object"===Ze&&(se[$]=ut(se[$],G[$])):se[$]=G[$]}return se}},100:Nt=>{function ut(Te){return new se("number"==typeof Te?Te:+new Date)}function se(Te){this.seed=Te}function We(Te){return Math.sqrt(2*Math.PI/Te)*Math.pow(1/Math.E*(Te+1/(12*Te-1/(10*Te))),Te)}function Ze(){var Te=this.seed;return this.seed=Te=4294967295&(3042594569^(Te=4251993797+(Te=4294967295&(3550635116+(Te=374761393+(Te=4294967295&(3345072700^(Te=Te+2127912214+(Te<<12)&4294967295)^Te>>>19))+(Te<<5)&4294967295)^Te<<9))+(Te<<3)&4294967295)^Te>>>16),(268435455&Te)/268435456}Nt.exports=ut,Nt.exports.random=ut,Nt.exports.randomIterator=function(Te,Fe){var Be=Fe||ut();if("function"!=typeof Be.next)throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:function(_e){var Ue,Ve,at;for(Ue=Te.length-1;Ue>0;--Ue)Ve=Be.next(Ue+1),at=Te[Ve],Te[Ve]=Te[Ue],Te[Ue]=at,_e(at);Te.length&&_e(Te[0])},shuffle:function(){var _e,Ue,Ve;for(_e=Te.length-1;_e>0;--_e)Ue=Be.next(_e+1),Ve=Te[Ue],Te[Ue]=Te[_e],Te[_e]=Ve;return Te}}},se.prototype.next=function(Te){return Math.floor(this.nextDouble()*Te)},se.prototype.nextDouble=Ze,se.prototype.uniform=Ze,se.prototype.gaussian=function(){var Te,Fe,Be;do{Te=(Fe=2*this.nextDouble()-1)*Fe+(Be=2*this.nextDouble()-1)*Be}while(Te>=1||0===Te);return Fe*Math.sqrt(-2*Math.log(Te)/Te)},se.prototype.levy=function(){var Fe=Math.pow(We(2.5)*Math.sin(1.5*Math.PI/2)/(1.5*We(1.25)*Math.pow(2,.25)),1/1.5);return this.gaussian()*Fe/Math.pow(Math.abs(this.gaussian()),1/1.5)}},6215:(Nt,ut,se)=>{"use strict";se.d(ut,{X:()=>We});var G=se(9765),$=se(7971);class We extends G.xQ{constructor(Ae){super(),this._value=Ae}get value(){return this.getValue()}_subscribe(Ae){const Me=super._subscribe(Ae);return Me&&!Me.closed&&Ae.next(this._value),Me}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new $.N;return this._value}next(Ae){super.next(this._value=Ae)}}},7574:(Nt,ut,se)=>{"use strict";se.d(ut,{y:()=>K});var G=se(7393),We=se(9181),Ze=se(6490),Me=se(6554),Te=se(4487);var J=se(2494);let K=(()=>{class Ue{constructor(at){this._isScalar=!1,at&&(this._subscribe=at)}lift(at){const Xe=new Ue;return Xe.source=this,Xe.operator=at,Xe}subscribe(at,Xe,kt){const{operator:St}=this,Wt=function(Ue,Ve,at){if(Ue){if(Ue instanceof G.L)return Ue;if(Ue[We.b])return Ue[We.b]()}return Ue||Ve||at?new G.L(Ue,Ve,at):new G.L(Ze.c)}(at,Xe,kt);if(Wt.add(St?St.call(Wt,this.source):this.source||J.v.useDeprecatedSynchronousErrorHandling&&!Wt.syncErrorThrowable?this._subscribe(Wt):this._trySubscribe(Wt)),J.v.useDeprecatedSynchronousErrorHandling&&Wt.syncErrorThrowable&&(Wt.syncErrorThrowable=!1,Wt.syncErrorThrown))throw Wt.syncErrorValue;return Wt}_trySubscribe(at){try{return this._subscribe(at)}catch(Xe){J.v.useDeprecatedSynchronousErrorHandling&&(at.syncErrorThrown=!0,at.syncErrorValue=Xe),function(Ue){for(;Ue;){const{closed:Ve,destination:at,isStopped:Xe}=Ue;if(Ve||Xe)return!1;Ue=at&&at instanceof G.L?at:null}return!0}(at)?at.error(Xe):console.warn(Xe)}}forEach(at,Xe){return new(Xe=_e(Xe))((kt,St)=>{let Wt;Wt=this.subscribe(zt=>{try{at(zt)}catch(hn){St(hn),Wt&&Wt.unsubscribe()}},St,kt)})}_subscribe(at){const{source:Xe}=this;return Xe&&Xe.subscribe(at)}[Me.L](){return this}pipe(...at){return 0===at.length?this:function(Ue){return 0===Ue.length?Te.y:1===Ue.length?Ue[0]:function(at){return Ue.reduce((Xe,kt)=>kt(Xe),at)}}(at)(this)}toPromise(at){return new(at=_e(at))((Xe,kt)=>{let St;this.subscribe(Wt=>St=Wt,Wt=>kt(Wt),()=>Xe(St))})}}return Ue.create=Ve=>new Ue(Ve),Ue})();function _e(Ue){if(Ue||(Ue=J.v.Promise||Promise),!Ue)throw new Error("no Promise impl found");return Ue}},6490:(Nt,ut,se)=>{"use strict";se.d(ut,{c:()=>We});var G=se(2494),$=se(4449);const We={closed:!0,next(Ze){},error(Ze){if(G.v.useDeprecatedSynchronousErrorHandling)throw Ze;(0,$.z)(Ze)},complete(){}}},1929:(Nt,ut,se)=>{"use strict";se.d(ut,{t:()=>er});var G=se(9765),$=se(6465),Ze=se(6102);const Te=new class extends Ze.v{}(class extends $.o{constructor(st,Bt){super(st,Bt),this.scheduler=st,this.work=Bt}schedule(st,Bt=0){return Bt>0?super.schedule(st,Bt):(this.delay=Bt,this.state=st,this.scheduler.flush(this),this)}execute(st,Bt){return Bt>0||this.closed?super.execute(st,Bt):this._execute(st,Bt)}requestAsyncId(st,Bt,nn=0){return null!==nn&&nn>0||null===nn&&this.delay>0?super.requestAsyncId(st,Bt,nn):st.flush(this)}});var Fe=se(5319),Be=se(7393),J=se(9193),K=se(5917),_e=se(7574);class Xe{constructor(st,Bt,nn){this.kind=st,this.value=Bt,this.error=nn,this.hasValue="N"===st}observe(st){switch(this.kind){case"N":return st.next&&st.next(this.value);case"E":return st.error&&st.error(this.error);case"C":return st.complete&&st.complete()}}do(st,Bt,nn){switch(this.kind){case"N":return st&&st(this.value);case"E":return Bt&&Bt(this.error);case"C":return nn&&nn()}}accept(st,Bt,nn){return st&&"function"==typeof st.next?this.observe(st):this.do(st,Bt,nn)}toObservable(){switch(this.kind){case"N":return(0,K.of)(this.value);case"E":return Cn=this.error,new _e.y(Bt=>Bt.error(Cn));case"C":return(0,J.c)()}var Cn;throw new Error("unexpected notification kind value")}static createNext(st){return void 0!==st?new Xe("N",st):Xe.undefinedValueNotification}static createError(st){return new Xe("E",void 0,st)}static createComplete(){return Xe.completeNotification}}Xe.completeNotification=new Xe("C"),Xe.undefinedValueNotification=new Xe("N",void 0);class Wt extends Be.L{constructor(st,Bt,nn=0){super(st),this.scheduler=Bt,this.delay=nn}static dispatch(st){const{notification:Bt,destination:nn}=st;Bt.observe(nn),this.unsubscribe()}scheduleMessage(st){this.destination.add(this.scheduler.schedule(Wt.dispatch,this.delay,new zt(st,this.destination)))}_next(st){this.scheduleMessage(Xe.createNext(st))}_error(st){this.scheduleMessage(Xe.createError(st)),this.unsubscribe()}_complete(){this.scheduleMessage(Xe.createComplete()),this.unsubscribe()}}class zt{constructor(st,Bt){this.notification=st,this.destination=Bt}}var hn=se(7971),an=se(8858);class er extends G.xQ{constructor(st=Number.POSITIVE_INFINITY,Bt=Number.POSITIVE_INFINITY,nn){super(),this.scheduler=nn,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=st<1?1:st,this._windowTime=Bt<1?1:Bt,Bt===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(st){if(!this.isStopped){const Bt=this._events;Bt.push(st),Bt.length>this._bufferSize&&Bt.shift()}super.next(st)}nextTimeWindow(st){this.isStopped||(this._events.push(new Dn(this._getNow(),st)),this._trimBufferThenGetEvents()),super.next(st)}_subscribe(st){const Bt=this._infiniteTimeWindow,nn=Bt?this._events:this._trimBufferThenGetEvents(),nr=this.scheduler,Rn=nn.length;let rr;if(this.closed)throw new hn.N;if(this.isStopped||this.hasError?rr=Fe.w.EMPTY:(this.observers.push(st),rr=new an.W(this,st)),nr&&st.add(st=new Wt(st,nr)),Bt)for(let Zt=0;Zt<Rn&&!st.closed;Zt++)st.next(nn[Zt]);else for(let Zt=0;Zt<Rn&&!st.closed;Zt++)st.next(nn[Zt].value);return this.hasError?st.error(this.thrownError):this.isStopped&&st.complete(),rr}_getNow(){return(this.scheduler||Te).now()}_trimBufferThenGetEvents(){const st=this._getNow(),Bt=this._bufferSize,nn=this._windowTime,nr=this._events,Rn=nr.length;let rr=0;for(;rr<Rn&&!(st-nr[rr].time<nn);)rr++;return Rn>Bt&&(rr=Math.max(rr,Rn-Bt)),rr>0&&nr.splice(0,rr),nr}}class Dn{constructor(st,Bt){this.time=st,this.value=Bt}}},9765:(Nt,ut,se)=>{"use strict";se.d(ut,{Yc:()=>Te,xQ:()=>Fe});var G=se(7574),$=se(7393),We=se(5319),Ze=se(7971),Ae=se(8858),Me=se(9181);class Te extends $.L{constructor(K){super(K),this.destination=K}}let Fe=(()=>{class J extends G.y{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[Me.b](){return new Te(this)}lift(_e){const Ue=new Be(this,this);return Ue.operator=_e,Ue}next(_e){if(this.closed)throw new Ze.N;if(!this.isStopped){const{observers:Ue}=this,Ve=Ue.length,at=Ue.slice();for(let Xe=0;Xe<Ve;Xe++)at[Xe].next(_e)}}error(_e){if(this.closed)throw new Ze.N;this.hasError=!0,this.thrownError=_e,this.isStopped=!0;const{observers:Ue}=this,Ve=Ue.length,at=Ue.slice();for(let Xe=0;Xe<Ve;Xe++)at[Xe].error(_e);this.observers.length=0}complete(){if(this.closed)throw new Ze.N;this.isStopped=!0;const{observers:_e}=this,Ue=_e.length,Ve=_e.slice();for(let at=0;at<Ue;at++)Ve[at].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(_e){if(this.closed)throw new Ze.N;return super._trySubscribe(_e)}_subscribe(_e){if(this.closed)throw new Ze.N;return this.hasError?(_e.error(this.thrownError),We.w.EMPTY):this.isStopped?(_e.complete(),We.w.EMPTY):(this.observers.push(_e),new Ae.W(this,_e))}asObservable(){const _e=new G.y;return _e.source=this,_e}}return J.create=(K,_e)=>new Be(K,_e),J})();class Be extends Fe{constructor(K,_e){super(),this.destination=K,this.source=_e}next(K){const{destination:_e}=this;_e&&_e.next&&_e.next(K)}error(K){const{destination:_e}=this;_e&&_e.error&&this.destination.error(K)}complete(){const{destination:K}=this;K&&K.complete&&this.destination.complete()}_subscribe(K){const{source:_e}=this;return _e?this.source.subscribe(K):We.w.EMPTY}}},8858:(Nt,ut,se)=>{"use strict";se.d(ut,{W:()=>$});var G=se(5319);class $ extends G.w{constructor(Ze,Ae){super(),this.subject=Ze,this.subscriber=Ae,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const Ze=this.subject,Ae=Ze.observers;if(this.subject=null,!Ae||0===Ae.length||Ze.isStopped||Ze.closed)return;const Me=Ae.indexOf(this.subscriber);-1!==Me&&Ae.splice(Me,1)}}},7393:(Nt,ut,se)=>{"use strict";se.d(ut,{L:()=>Te});var G=se(9105),$=se(6490),We=se(5319),Ze=se(9181),Ae=se(2494),Me=se(4449);class Te extends We.w{constructor(J,K,_e){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=$.c;break;case 1:if(!J){this.destination=$.c;break}if("object"==typeof J){J instanceof Te?(this.syncErrorThrowable=J.syncErrorThrowable,this.destination=J,J.add(this)):(this.syncErrorThrowable=!0,this.destination=new Fe(this,J));break}default:this.syncErrorThrowable=!0,this.destination=new Fe(this,J,K,_e)}}[Ze.b](){return this}static create(J,K,_e){const Ue=new Te(J,K,_e);return Ue.syncErrorThrowable=!1,Ue}next(J){this.isStopped||this._next(J)}error(J){this.isStopped||(this.isStopped=!0,this._error(J))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(J){this.destination.next(J)}_error(J){this.destination.error(J),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:J}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=J,this}}class Fe extends Te{constructor(J,K,_e,Ue){super(),this._parentSubscriber=J;let Ve,at=this;(0,G.m)(K)?Ve=K:K&&(Ve=K.next,_e=K.error,Ue=K.complete,K!==$.c&&(at=Object.create(K),(0,G.m)(at.unsubscribe)&&this.add(at.unsubscribe.bind(at)),at.unsubscribe=this.unsubscribe.bind(this))),this._context=at,this._next=Ve,this._error=_e,this._complete=Ue}next(J){if(!this.isStopped&&this._next){const{_parentSubscriber:K}=this;Ae.v.useDeprecatedSynchronousErrorHandling&&K.syncErrorThrowable?this.__tryOrSetError(K,this._next,J)&&this.unsubscribe():this.__tryOrUnsub(this._next,J)}}error(J){if(!this.isStopped){const{_parentSubscriber:K}=this,{useDeprecatedSynchronousErrorHandling:_e}=Ae.v;if(this._error)_e&&K.syncErrorThrowable?(this.__tryOrSetError(K,this._error,J),this.unsubscribe()):(this.__tryOrUnsub(this._error,J),this.unsubscribe());else if(K.syncErrorThrowable)_e?(K.syncErrorValue=J,K.syncErrorThrown=!0):(0,Me.z)(J),this.unsubscribe();else{if(this.unsubscribe(),_e)throw J;(0,Me.z)(J)}}}complete(){if(!this.isStopped){const{_parentSubscriber:J}=this;if(this._complete){const K=()=>this._complete.call(this._context);Ae.v.useDeprecatedSynchronousErrorHandling&&J.syncErrorThrowable?(this.__tryOrSetError(J,K),this.unsubscribe()):(this.__tryOrUnsub(K),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(J,K){try{J.call(this._context,K)}catch(_e){if(this.unsubscribe(),Ae.v.useDeprecatedSynchronousErrorHandling)throw _e;(0,Me.z)(_e)}}__tryOrSetError(J,K,_e){if(!Ae.v.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{K.call(this._context,_e)}catch(Ue){return Ae.v.useDeprecatedSynchronousErrorHandling?(J.syncErrorValue=Ue,J.syncErrorThrown=!0,!0):((0,Me.z)(Ue),!0)}return!1}_unsubscribe(){const{_parentSubscriber:J}=this;this._context=null,this._parentSubscriber=null,J.unsubscribe()}}},5319:(Nt,ut,se)=>{"use strict";se.d(ut,{w:()=>Me});var G=se(9796),$=se(1555),We=se(9105);const Ae=(()=>{function Fe(Be){return Error.call(this),this.message=Be?`${Be.length} errors occurred during unsubscription:\n${Be.map((J,K)=>`${K+1}) ${J.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Be,this}return Fe.prototype=Object.create(Error.prototype),Fe})();class Me{constructor(Be){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,Be&&(this._ctorUnsubscribe=!0,this._unsubscribe=Be)}unsubscribe(){let Be;if(this.closed)return;let{_parentOrParents:J,_ctorUnsubscribe:K,_unsubscribe:_e,_subscriptions:Ue}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,J instanceof Me)J.remove(this);else if(null!==J)for(let Ve=0;Ve<J.length;++Ve)J[Ve].remove(this);if((0,We.m)(_e)){K&&(this._unsubscribe=void 0);try{_e.call(this)}catch(Ve){Be=Ve instanceof Ae?Te(Ve.errors):[Ve]}}if((0,G.k)(Ue)){let Ve=-1,at=Ue.length;for(;++Ve<at;){const Xe=Ue[Ve];if((0,$.K)(Xe))try{Xe.unsubscribe()}catch(kt){Be=Be||[],kt instanceof Ae?Be=Be.concat(Te(kt.errors)):Be.push(kt)}}}if(Be)throw new Ae(Be)}add(Be){let J=Be;if(!Be)return Me.EMPTY;switch(typeof Be){case"function":J=new Me(Be);case"object":if(J===this||J.closed||"function"!=typeof J.unsubscribe)return J;if(this.closed)return J.unsubscribe(),J;if(!(J instanceof Me)){const Ue=J;J=new Me,J._subscriptions=[Ue]}break;default:throw new Error("unrecognized teardown "+Be+" added to Subscription.")}let{_parentOrParents:K}=J;if(null===K)J._parentOrParents=this;else if(K instanceof Me){if(K===this)return J;J._parentOrParents=[K,this]}else{if(-1!==K.indexOf(this))return J;K.push(this)}const _e=this._subscriptions;return null===_e?this._subscriptions=[J]:_e.push(J),J}remove(Be){const J=this._subscriptions;if(J){const K=J.indexOf(Be);-1!==K&&J.splice(K,1)}}}var Fe;function Te(Fe){return Fe.reduce((Be,J)=>Be.concat(J instanceof Ae?J.errors:J),[])}Me.EMPTY=((Fe=new Me).closed=!0,Fe)},2494:(Nt,ut,se)=>{"use strict";se.d(ut,{v:()=>$});let G=!1;const $={Promise:void 0,set useDeprecatedSynchronousErrorHandling(We){if(We){const Ze=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+Ze.stack)}else G&&console.log("RxJS: Back to a better error behavior. Thank you. <3");G=We},get useDeprecatedSynchronousErrorHandling(){return G}}},5345:(Nt,ut,se)=>{"use strict";se.d(ut,{IY:()=>Ze,Ds:()=>Me,ft:()=>Fe});var G=se(7393),$=se(7574),We=se(7444);class Ze extends G.L{constructor(J){super(),this.parent=J}_next(J){this.parent.notifyNext(J)}_error(J){this.parent.notifyError(J),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class Me extends G.L{notifyNext(J){this.destination.next(J)}notifyError(J){this.destination.error(J)}notifyComplete(){this.destination.complete()}}function Fe(Be,J){if(J.closed)return;if(Be instanceof $.y)return Be.subscribe(J);let K;try{K=(0,We.s)(Be)(J)}catch(_e){J.error(_e)}return K}},2441:(Nt,ut,se)=>{"use strict";se.d(ut,{c:()=>Ae,N:()=>Me});var G=se(9765),$=se(7574),We=se(5319),Ze=se(1307);class Ae extends $.y{constructor(K,_e){super(),this.source=K,this.subjectFactory=_e,this._refCount=0,this._isComplete=!1}_subscribe(K){return this.getSubject().subscribe(K)}getSubject(){const K=this._subject;return(!K||K.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let K=this._connection;return K||(this._isComplete=!1,K=this._connection=new We.w,K.add(this.source.subscribe(new Te(this.getSubject(),this))),K.closed&&(this._connection=null,K=We.w.EMPTY)),K}refCount(){return(0,Ze.x)()(this)}}const Me=(()=>{const J=Ae.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:J._subscribe},_isComplete:{value:J._isComplete,writable:!0},getSubject:{value:J.getSubject},connect:{value:J.connect},refCount:{value:J.refCount}}})();class Te extends G.Yc{constructor(K,_e){super(K),this.connectable=_e}_error(K){this._unsubscribe(),super._error(K)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const K=this.connectable;if(K){this.connectable=null;const _e=K._connection;K._refCount=0,K._subject=null,K._connection=null,_e&&_e.unsubscribe()}}}},9193:(Nt,ut,se)=>{"use strict";se.d(ut,{E:()=>$,c:()=>We});var G=se(7574);const $=new G.y(Ae=>Ae.complete());function We(Ae){return Ae?function(Ae){return new G.y(Me=>Ae.schedule(()=>Me.complete()))}(Ae):$}},4402:(Nt,ut,se)=>{"use strict";se.d(ut,{D:()=>at});var G=se(7574),$=se(7444),We=se(5319),Ze=se(6554),Te=se(4087),Fe=se(377),K=se(4072),_e=se(9489);function at(Xe,kt){return kt?function(Xe,kt){if(null!=Xe){if(function(Xe){return Xe&&"function"==typeof Xe[Ze.L]}(Xe))return function(Xe,kt){return new G.y(St=>{const Wt=new We.w;return Wt.add(kt.schedule(()=>{const zt=Xe[Ze.L]();Wt.add(zt.subscribe({next(hn){Wt.add(kt.schedule(()=>St.next(hn)))},error(hn){Wt.add(kt.schedule(()=>St.error(hn)))},complete(){Wt.add(kt.schedule(()=>St.complete()))}}))})),Wt})}(Xe,kt);if((0,K.t)(Xe))return function(Xe,kt){return new G.y(St=>{const Wt=new We.w;return Wt.add(kt.schedule(()=>Xe.then(zt=>{Wt.add(kt.schedule(()=>{St.next(zt),Wt.add(kt.schedule(()=>St.complete()))}))},zt=>{Wt.add(kt.schedule(()=>St.error(zt)))}))),Wt})}(Xe,kt);if((0,_e.z)(Xe))return(0,Te.r)(Xe,kt);if(function(Xe){return Xe&&"function"==typeof Xe[Fe.hZ]}(Xe)||"string"==typeof Xe)return function(Xe,kt){if(!Xe)throw new Error("Iterable cannot be null");return new G.y(St=>{const Wt=new We.w;let zt;return Wt.add(()=>{zt&&"function"==typeof zt.return&&zt.return()}),Wt.add(kt.schedule(()=>{zt=Xe[Fe.hZ](),Wt.add(kt.schedule(function(){if(St.closed)return;let hn,an;try{const er=zt.next();hn=er.value,an=er.done}catch(er){return void St.error(er)}an?St.complete():(St.next(hn),this.schedule())}))})),Wt})}(Xe,kt)}throw new TypeError((null!==Xe&&typeof Xe||Xe)+" is not observable")}(Xe,kt):Xe instanceof G.y?Xe:new G.y((0,$.s)(Xe))}},6693:(Nt,ut,se)=>{"use strict";se.d(ut,{n:()=>Ze});var G=se(7574),$=se(5015),We=se(4087);function Ze(Ae,Me){return Me?(0,We.r)(Ae,Me):new G.y((0,$.V)(Ae))}},2759:(Nt,ut,se)=>{"use strict";se.d(ut,{R:()=>Me});var G=se(7574),$=se(9796),We=se(9105),Ze=se(8002);function Me(K,_e,Ue,Ve){return(0,We.m)(Ue)&&(Ve=Ue,Ue=void 0),Ve?Me(K,_e,Ue).pipe((0,Ze.U)(at=>(0,$.k)(at)?Ve(...at):Ve(at))):new G.y(at=>{Te(K,_e,function(kt){at.next(arguments.length>1?Array.prototype.slice.call(arguments):kt)},at,Ue)})}function Te(K,_e,Ue,Ve,at){let Xe;if(function(K){return K&&"function"==typeof K.addEventListener&&"function"==typeof K.removeEventListener}(K)){const kt=K;K.addEventListener(_e,Ue,at),Xe=()=>kt.removeEventListener(_e,Ue,at)}else if(function(K){return K&&"function"==typeof K.on&&"function"==typeof K.off}(K)){const kt=K;K.on(_e,Ue),Xe=()=>kt.off(_e,Ue)}else if(function(K){return K&&"function"==typeof K.addListener&&"function"==typeof K.removeListener}(K)){const kt=K;K.addListener(_e,Ue),Xe=()=>kt.removeListener(_e,Ue)}else{if(!K||!K.length)throw new TypeError("Invalid event target");for(let kt=0,St=K.length;kt<St;kt++)Te(K[kt],_e,Ue,Ve,at)}Ve.add(Xe)}},1824:(Nt,ut,se)=>{"use strict";se.d(ut,{F:()=>Fe});var G=se(7574),$=se(6465);const Ae=new(se(6102).v)($.o);var Me=se(9796);function Fe(J=0,K=Ae){return(!function(J){return!(0,Me.k)(J)&&J-parseFloat(J)+1>=0}(J)||J<0)&&(J=0),(!K||"function"!=typeof K.schedule)&&(K=Ae),new G.y(_e=>(_e.add(K.schedule(Be,J,{subscriber:_e,counter:0,period:J})),_e))}function Be(J){const{subscriber:K,counter:_e,period:Ue}=J;K.next(_e),this.schedule({subscriber:K,counter:_e+1,period:Ue},Ue)}},5917:(Nt,ut,se)=>{"use strict";se.d(ut,{of:()=>Ze});var G=se(4869),$=se(6693),We=se(4087);function Ze(...Ae){let Me=Ae[Ae.length-1];return(0,G.K)(Me)?(Ae.pop(),(0,We.r)(Ae,Me)):(0,$.n)(Ae)}},5435:(Nt,ut,se)=>{"use strict";se.d(ut,{h:()=>$});var G=se(7393);function $(Ae,Me){return function(Fe){return Fe.lift(new We(Ae,Me))}}class We{constructor(Me,Te){this.predicate=Me,this.thisArg=Te}call(Me,Te){return Te.subscribe(new Ze(Me,this.predicate,this.thisArg))}}class Ze extends G.L{constructor(Me,Te,Fe){super(Me),this.predicate=Te,this.thisArg=Fe,this.count=0}_next(Me){let Te;try{Te=this.predicate.call(this.thisArg,Me,this.count++)}catch(Fe){return void this.destination.error(Fe)}Te&&this.destination.next(Me)}}},8002:(Nt,ut,se)=>{"use strict";se.d(ut,{U:()=>$});var G=se(7393);function $(Ae,Me){return function(Fe){if("function"!=typeof Ae)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return Fe.lift(new We(Ae,Me))}}class We{constructor(Me,Te){this.project=Me,this.thisArg=Te}call(Me,Te){return Te.subscribe(new Ze(Me,this.project,this.thisArg))}}class Ze extends G.L{constructor(Me,Te,Fe){super(Me),this.project=Te,this.count=0,this.thisArg=Fe||this}_next(Me){let Te;try{Te=this.project.call(this.thisArg,Me,this.count++)}catch(Fe){return void this.destination.error(Fe)}this.destination.next(Te)}}},3282:(Nt,ut,se)=>{"use strict";se.d(ut,{J:()=>We});var G=se(9773),$=se(4487);function We(Ze=Number.POSITIVE_INFINITY){return(0,G.zg)($.y,Ze)}},9773:(Nt,ut,se)=>{"use strict";se.d(ut,{zg:()=>Ze});var G=se(8002),$=se(4402),We=se(5345);function Ze(Fe,Be,J=Number.POSITIVE_INFINITY){return"function"==typeof Be?K=>K.pipe(Ze((_e,Ue)=>(0,$.D)(Fe(_e,Ue)).pipe((0,G.U)((Ve,at)=>Be(_e,Ve,Ue,at))),J)):("number"==typeof Be&&(J=Be),K=>K.lift(new Ae(Fe,J)))}class Ae{constructor(Be,J=Number.POSITIVE_INFINITY){this.project=Be,this.concurrent=J}call(Be,J){return J.subscribe(new Me(Be,this.project,this.concurrent))}}class Me extends We.Ds{constructor(Be,J,K=Number.POSITIVE_INFINITY){super(Be),this.project=J,this.concurrent=K,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(Be){this.active<this.concurrent?this._tryNext(Be):this.buffer.push(Be)}_tryNext(Be){let J;const K=this.index++;try{J=this.project(Be,K)}catch(_e){return void this.destination.error(_e)}this.active++,this._innerSub(J)}_innerSub(Be){const J=new We.IY(this),K=this.destination;K.add(J);const _e=(0,We.ft)(Be,J);_e!==J&&K.add(_e)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(Be){this.destination.next(Be)}notifyComplete(){const Be=this.buffer;this.active--,Be.length>0?this._next(Be.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}},1307:(Nt,ut,se)=>{"use strict";se.d(ut,{x:()=>$});var G=se(7393);function $(){return function(Me){return Me.lift(new We(Me))}}class We{constructor(Me){this.connectable=Me}call(Me,Te){const{connectable:Fe}=this;Fe._refCount++;const Be=new Ze(Me,Fe),J=Te.subscribe(Be);return Be.closed||(Be.connection=Fe.connect()),J}}class Ze extends G.L{constructor(Me,Te){super(Me),this.connectable=Te}_unsubscribe(){const{connectable:Me}=this;if(!Me)return void(this.connection=null);this.connectable=null;const Te=Me._refCount;if(Te<=0)return void(this.connection=null);if(Me._refCount=Te-1,Te>1)return void(this.connection=null);const{connection:Fe}=this,Be=Me._connection;this.connection=null,Be&&(!Fe||Be===Fe)&&Be.unsubscribe()}}},5257:(Nt,ut,se)=>{"use strict";se.d(ut,{q:()=>Ze});var G=se(7393),$=se(7108),We=se(9193);function Ze(Te){return Fe=>0===Te?(0,We.c)():Fe.lift(new Ae(Te))}class Ae{constructor(Fe){if(this.total=Fe,this.total<0)throw new $.W}call(Fe,Be){return Be.subscribe(new Me(Fe,this.total))}}class Me extends G.L{constructor(Fe,Be){super(Fe),this.total=Be,this.count=0}_next(Fe){const Be=this.total,J=++this.count;J<=Be&&(this.destination.next(Fe),J===Be&&(this.destination.complete(),this.unsubscribe()))}}},4087:(Nt,ut,se)=>{"use strict";se.d(ut,{r:()=>We});var G=se(7574),$=se(5319);function We(Ze,Ae){return new G.y(Me=>{const Te=new $.w;let Fe=0;return Te.add(Ae.schedule(function(){Fe!==Ze.length?(Me.next(Ze[Fe++]),Me.closed||Te.add(this.schedule())):Me.complete()})),Te})}},6465:(Nt,ut,se)=>{"use strict";se.d(ut,{o:()=>We});var G=se(5319);class $ extends G.w{constructor(Ae,Me){super()}schedule(Ae,Me=0){return this}}class We extends ${constructor(Ae,Me){super(Ae,Me),this.scheduler=Ae,this.work=Me,this.pending=!1}schedule(Ae,Me=0){if(this.closed)return this;this.state=Ae;const Te=this.id,Fe=this.scheduler;return null!=Te&&(this.id=this.recycleAsyncId(Fe,Te,Me)),this.pending=!0,this.delay=Me,this.id=this.id||this.requestAsyncId(Fe,this.id,Me),this}requestAsyncId(Ae,Me,Te=0){return setInterval(Ae.flush.bind(Ae,this),Te)}recycleAsyncId(Ae,Me,Te=0){if(null!==Te&&this.delay===Te&&!1===this.pending)return Me;clearInterval(Me)}execute(Ae,Me){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const Te=this._execute(Ae,Me);if(Te)return Te;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(Ae,Me){let Fe,Te=!1;try{this.work(Ae)}catch(Be){Te=!0,Fe=!!Be&&Be||new Error(Be)}if(Te)return this.unsubscribe(),Fe}_unsubscribe(){const Ae=this.id,Me=this.scheduler,Te=Me.actions,Fe=Te.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==Fe&&Te.splice(Fe,1),null!=Ae&&(this.id=this.recycleAsyncId(Me,Ae,null)),this.delay=null}}},6102:(Nt,ut,se)=>{"use strict";se.d(ut,{v:()=>$});let G=(()=>{class We{constructor(Ae,Me=We.now){this.SchedulerAction=Ae,this.now=Me}schedule(Ae,Me=0,Te){return new this.SchedulerAction(this,Ae).schedule(Te,Me)}}return We.now=()=>Date.now(),We})();class $ extends G{constructor(Ze,Ae=G.now){super(Ze,()=>$.delegate&&$.delegate!==this?$.delegate.now():Ae()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(Ze,Ae=0,Me){return $.delegate&&$.delegate!==this?$.delegate.schedule(Ze,Ae,Me):super.schedule(Ze,Ae,Me)}flush(Ze){const{actions:Ae}=this;if(this.active)return void Ae.push(Ze);let Me;this.active=!0;do{if(Me=Ze.execute(Ze.state,Ze.delay))break}while(Ze=Ae.shift());if(this.active=!1,Me){for(;Ze=Ae.shift();)Ze.unsubscribe();throw Me}}}},377:(Nt,ut,se)=>{"use strict";se.d(ut,{hZ:()=>$});const $="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"},6554:(Nt,ut,se)=>{"use strict";se.d(ut,{L:()=>G});const G="function"==typeof Symbol&&Symbol.observable||"@@observable"},9181:(Nt,ut,se)=>{"use strict";se.d(ut,{b:()=>G});const G="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()},7108:(Nt,ut,se)=>{"use strict";se.d(ut,{W:()=>$});const $=(()=>{function We(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return We.prototype=Object.create(Error.prototype),We})()},7971:(Nt,ut,se)=>{"use strict";se.d(ut,{N:()=>$});const $=(()=>{function We(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return We.prototype=Object.create(Error.prototype),We})()},4449:(Nt,ut,se)=>{"use strict";function G($){setTimeout(()=>{throw $},0)}se.d(ut,{z:()=>G})},4487:(Nt,ut,se)=>{"use strict";function G($){return $}se.d(ut,{y:()=>G})},9796:(Nt,ut,se)=>{"use strict";se.d(ut,{k:()=>G});const G=Array.isArray||($=>$&&"number"==typeof $.length)},9489:(Nt,ut,se)=>{"use strict";se.d(ut,{z:()=>G});const G=$=>$&&"number"==typeof $.length&&"function"!=typeof $},9105:(Nt,ut,se)=>{"use strict";function G($){return"function"==typeof $}se.d(ut,{m:()=>G})},1555:(Nt,ut,se)=>{"use strict";function G($){return null!==$&&"object"==typeof $}se.d(ut,{K:()=>G})},4072:(Nt,ut,se)=>{"use strict";function G($){return!!$&&"function"!=typeof $.subscribe&&"function"==typeof $.then}se.d(ut,{t:()=>G})},4869:(Nt,ut,se)=>{"use strict";function G($){return $&&"function"==typeof $.schedule}se.d(ut,{K:()=>G})},7444:(Nt,ut,se)=>{"use strict";se.d(ut,{s:()=>K});var G=se(5015),$=se(4449),Ze=se(377),Me=se(6554),Fe=se(9489),Be=se(4072),J=se(1555);const K=_e=>{if(_e&&"function"==typeof _e[Me.L])return(_e=>Ue=>{const Ve=_e[Me.L]();if("function"!=typeof Ve.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return Ve.subscribe(Ue)})(_e);if((0,Fe.z)(_e))return(0,G.V)(_e);if((0,Be.t)(_e))return(_e=>Ue=>(_e.then(Ve=>{Ue.closed||(Ue.next(Ve),Ue.complete())},Ve=>Ue.error(Ve)).then(null,$.z),Ue))(_e);if(_e&&"function"==typeof _e[Ze.hZ])return(_e=>Ue=>{const Ve=_e[Ze.hZ]();for(;;){let at;try{at=Ve.next()}catch(Xe){return Ue.error(Xe),Ue}if(at.done){Ue.complete();break}if(Ue.next(at.value),Ue.closed)break}return"function"==typeof Ve.return&&Ue.add(()=>{Ve.return&&Ve.return()}),Ue})(_e);{const Ve=`You provided ${(0,J.K)(_e)?"an invalid object":`'${_e}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(Ve)}}},5015:(Nt,ut,se)=>{"use strict";se.d(ut,{V:()=>G});const G=$=>We=>{for(let Ze=0,Ae=$.length;Ze<Ae&&!We.closed;Ze++)We.next($[Ze]);We.complete()}},7758:(Nt,ut,se)=>{"use strict";se.d(ut,{Mig:()=>Em,_Li:()=>Ve,ZzF:()=>bs,TlE:()=>Ke,u9r:()=>jt,SUY:()=>Ap,Ilk:()=>j,_3:()=>mf,yj7:()=>mp,m_w:()=>kl,Ox3:()=>wm,pBf:()=>qi,a$l:()=>dn,ZAu:()=>Vu,x12:()=>zu,nls:()=>go,wem:()=>zn,RsA:()=>We,yGw:()=>Nn,Kj0:()=>cs,vBJ:()=>oe,YBo:()=>xp,Tme:()=>Zr,iKG:()=>Ns,cPb:()=>xs,JOQ:()=>Kl,mXe:()=>om,_fP:()=>as,wk1:()=>ds,iMs:()=>$0,xsS:()=>eh,jyz:()=>Ba,Aip:()=>Mo,xo$:()=>Mo,$V:()=>Y_,QmN:()=>Ze,dpR:()=>N_,Lcc:()=>Nc,rDY:()=>Tu,FM8:()=>Rt,Pa4:()=>he,dd2:()=>No,CP7:()=>Zi});var G=se(8239);const We={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Ze={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Ve=1,Tn=1001,Pi=1003,zn=1006,Xn=1009,Us=1015,Xs=1016,io=1020,Zs=1022,ds=1023,Di=ds,so=1026,oo=1027,Ss=2400,na=2401,Rs=3e3,Ar=35044,Sr=35048;class qi{addEventListener(e,r){void 0===this._listeners&&(this._listeners={});const s=this._listeners;void 0===s[e]&&(s[e]=[]),-1===s[e].indexOf(r)&&s[e].push(r)}hasEventListener(e,r){if(void 0===this._listeners)return!1;const s=this._listeners;return void 0!==s[e]&&-1!==s[e].indexOf(r)}removeEventListener(e,r){if(void 0===this._listeners)return;const a=this._listeners[e];if(void 0!==a){const c=a.indexOf(r);-1!==c&&a.splice(c,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const s=this._listeners[e.type];if(void 0!==s){e.target=this;const a=s.slice(0);for(let c=0,p=a.length;c<p;c++)a[c].call(this,e);e.target=null}}}const Ki=[];for(let h=0;h<256;h++)Ki[h]=(h<16?"0":"")+h.toString(16);const Po=Math.PI/180,sa=180/Math.PI;function jn(){const h=4294967295*Math.random()|0,e=4294967295*Math.random()|0,r=4294967295*Math.random()|0,s=4294967295*Math.random()|0;return(Ki[255&h]+Ki[h>>8&255]+Ki[h>>16&255]+Ki[h>>24&255]+"-"+Ki[255&e]+Ki[e>>8&255]+"-"+Ki[e>>16&15|64]+Ki[e>>24&255]+"-"+Ki[63&r|128]+Ki[r>>8&255]+"-"+Ki[r>>16&255]+Ki[r>>24&255]+Ki[255&s]+Ki[s>>8&255]+Ki[s>>16&255]+Ki[s>>24&255]).toUpperCase()}function Ts(h,e,r){return Math.max(e,Math.min(r,h))}function Ja(h,e,r){return(1-r)*h+r*e}function tl(h){return 0==(h&h-1)&&0!==h}function Gc(h){return Math.pow(2,Math.floor(Math.log(h)/Math.LN2))}class Rt{constructor(e=0,r=0){this.x=e,this.y=r}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,r){return this.x=e,this.y=r,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,r){switch(e){case 0:this.x=r;break;case 1:this.y=r;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,r){return void 0!==r?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,r)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,r){return this.x=e.x+r.x,this.y=e.y+r.y,this}addScaledVector(e,r){return this.x+=e.x*r,this.y+=e.y*r,this}sub(e,r){return void 0!==r?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,r)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,r){return this.x=e.x-r.x,this.y=e.y-r.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const r=this.x,s=this.y,a=e.elements;return this.x=a[0]*r+a[3]*s+a[6],this.y=a[1]*r+a[4]*s+a[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,r){return this.x=Math.max(e.x,Math.min(r.x,this.x)),this.y=Math.max(e.y,Math.min(r.y,this.y)),this}clampScalar(e,r){return this.x=Math.max(e,Math.min(r,this.x)),this.y=Math.max(e,Math.min(r,this.y)),this}clampLength(e,r){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(e,Math.min(r,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const r=this.x-e.x,s=this.y-e.y;return r*r+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,r){return this.x+=(e.x-this.x)*r,this.y+=(e.y-this.y)*r,this}lerpVectors(e,r,s){return this.x=e.x+(r.x-e.x)*s,this.y=e.y+(r.y-e.y)*s,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,r=0){return this.x=e[r],this.y=e[r+1],this}toArray(e=[],r=0){return e[r]=this.x,e[r+1]=this.y,e}fromBufferAttribute(e,r,s){return void 0!==s&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(r),this.y=e.getY(r),this}rotateAround(e,r){const s=Math.cos(r),a=Math.sin(r),c=this.x-e.x,p=this.y-e.y;return this.x=c*s-p*a+e.x,this.y=c*a+p*s+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}Rt.prototype.isVector2=!0;class ui{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,r,s,a,c,p,m,x,E){const C=this.elements;return C[0]=e,C[1]=a,C[2]=m,C[3]=r,C[4]=c,C[5]=x,C[6]=s,C[7]=p,C[8]=E,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const r=this.elements,s=e.elements;return r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=s[3],r[4]=s[4],r[5]=s[5],r[6]=s[6],r[7]=s[7],r[8]=s[8],this}extractBasis(e,r,s){return e.setFromMatrix3Column(this,0),r.setFromMatrix3Column(this,1),s.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const r=e.elements;return this.set(r[0],r[4],r[8],r[1],r[5],r[9],r[2],r[6],r[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,r){const s=e.elements,a=r.elements,c=this.elements,p=s[0],m=s[3],x=s[6],E=s[1],C=s[4],D=s[7],A=s[2],P=s[5],L=s[8],H=a[0],q=a[3],k=a[6],O=a[1],re=a[4],ne=a[7],ve=a[2],Ie=a[5],ue=a[8];return c[0]=p*H+m*O+x*ve,c[3]=p*q+m*re+x*Ie,c[6]=p*k+m*ne+x*ue,c[1]=E*H+C*O+D*ve,c[4]=E*q+C*re+D*Ie,c[7]=E*k+C*ne+D*ue,c[2]=A*H+P*O+L*ve,c[5]=A*q+P*re+L*Ie,c[8]=A*k+P*ne+L*ue,this}multiplyScalar(e){const r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=e,r[4]*=e,r[7]*=e,r[2]*=e,r[5]*=e,r[8]*=e,this}determinant(){const e=this.elements,r=e[0],s=e[1],a=e[2],c=e[3],p=e[4],m=e[5],x=e[6],E=e[7],C=e[8];return r*p*C-r*m*E-s*c*C+s*m*x+a*c*E-a*p*x}invert(){const e=this.elements,r=e[0],s=e[1],a=e[2],c=e[3],p=e[4],m=e[5],x=e[6],E=e[7],C=e[8],D=C*p-m*E,A=m*x-C*c,P=E*c-p*x,L=r*D+s*A+a*P;if(0===L)return this.set(0,0,0,0,0,0,0,0,0);const H=1/L;return e[0]=D*H,e[1]=(a*E-C*s)*H,e[2]=(m*s-a*p)*H,e[3]=A*H,e[4]=(C*r-a*x)*H,e[5]=(a*c-m*r)*H,e[6]=P*H,e[7]=(s*x-E*r)*H,e[8]=(p*r-s*c)*H,this}transpose(){let e;const r=this.elements;return e=r[1],r[1]=r[3],r[3]=e,e=r[2],r[2]=r[6],r[6]=e,e=r[5],r[5]=r[7],r[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const r=this.elements;return e[0]=r[0],e[1]=r[3],e[2]=r[6],e[3]=r[1],e[4]=r[4],e[5]=r[7],e[6]=r[2],e[7]=r[5],e[8]=r[8],this}setUvTransform(e,r,s,a,c,p,m){const x=Math.cos(c),E=Math.sin(c);return this.set(s*x,s*E,-s*(x*p+E*m)+p+e,-a*E,a*x,-a*(-E*p+x*m)+m+r,0,0,1),this}scale(e,r){const s=this.elements;return s[0]*=e,s[3]*=e,s[6]*=e,s[1]*=r,s[4]*=r,s[7]*=r,this}rotate(e){const r=Math.cos(e),s=Math.sin(e),a=this.elements,c=a[0],p=a[3],m=a[6],x=a[1],E=a[4],C=a[7];return a[0]=r*c+s*x,a[3]=r*p+s*E,a[6]=r*m+s*C,a[1]=-s*c+r*x,a[4]=-s*p+r*E,a[7]=-s*m+r*C,this}translate(e,r){const s=this.elements;return s[0]+=e*s[2],s[3]+=e*s[5],s[6]+=e*s[8],s[1]+=r*s[2],s[4]+=r*s[5],s[7]+=r*s[8],this}equals(e){const r=this.elements,s=e.elements;for(let a=0;a<9;a++)if(r[a]!==s[a])return!1;return!0}fromArray(e,r=0){for(let s=0;s<9;s++)this.elements[s]=e[s+r];return this}toArray(e=[],r=0){const s=this.elements;return e[r]=s[0],e[r+1]=s[1],e[r+2]=s[2],e[r+3]=s[3],e[r+4]=s[4],e[r+5]=s[5],e[r+6]=s[6],e[r+7]=s[7],e[r+8]=s[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}let Tl;ui.prototype.isMatrix3=!0;class zs{static getDataURL(e){if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;let r;if(e instanceof HTMLCanvasElement)r=e;else{void 0===Tl&&(Tl=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Tl.width=e.width,Tl.height=e.height;const s=Tl.getContext("2d");e instanceof ImageData?s.putImageData(e,0,0):s.drawImage(e,0,0,e.width,e.height),r=Tl}return r.width>2048||r.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),r.toDataURL("image/jpeg",.6)):r.toDataURL("image/png")}}let Oo=0;class As extends qi{constructor(e=As.DEFAULT_IMAGE,r=As.DEFAULT_MAPPING,s=Tn,a=Tn,c=zn,p=1008,m=ds,x=Xn,E=1,C=Rs){super(),Object.defineProperty(this,"id",{value:Oo++}),this.uuid=jn(),this.name="",this.image=e,this.mipmaps=[],this.mapping=r,this.wrapS=s,this.wrapT=a,this.magFilter=c,this.minFilter=p,this.anisotropy=E,this.format=m,this.internalFormat=null,this.type=x,this.offset=new Rt(0,0),this.repeat=new Rt(1,1),this.center=new Rt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ui,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=C,this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this}toJSON(e){const r=void 0===e||"string"==typeof e;if(!r&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const s={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const a=this.image;if(void 0===a.uuid&&(a.uuid=jn()),!r&&void 0===e.images[a.uuid]){let c;if(Array.isArray(a)){c=[];for(let p=0,m=a.length;p<m;p++)c.push(xa(a[p].isDataTexture?a[p].image:a[p]))}else c=xa(a);e.images[a.uuid]={uuid:a.uuid,url:c}}s.image=a.uuid}return r||(e.textures[this.uuid]=s),s}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case 1e3:e.x=e.x-Math.floor(e.x);break;case Tn:e.x=e.x<0?0:1;break;case 1002:e.x=1===Math.abs(Math.floor(e.x)%2)?Math.ceil(e.x)-e.x:e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case 1e3:e.y=e.y-Math.floor(e.y);break;case Tn:e.y=e.y<0?0:1;break;case 1002:e.y=1===Math.abs(Math.floor(e.y)%2)?Math.ceil(e.y)-e.y:e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&this.version++}}function xa(h){return"undefined"!=typeof HTMLImageElement&&h instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&h instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&h instanceof ImageBitmap?zs.getDataURL(h):h.data?{data:Array.prototype.slice.call(h.data),width:h.width,height:h.height,type:h.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}As.DEFAULT_IMAGE=void 0,As.DEFAULT_MAPPING=300,As.prototype.isTexture=!0;class di{constructor(e=0,r=0,s=0,a=1){this.x=e,this.y=r,this.z=s,this.w=a}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,r,s,a){return this.x=e,this.y=r,this.z=s,this.w=a,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,r){switch(e){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;case 3:this.w=r;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,r){return void 0!==r?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,r)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,r){return this.x=e.x+r.x,this.y=e.y+r.y,this.z=e.z+r.z,this.w=e.w+r.w,this}addScaledVector(e,r){return this.x+=e.x*r,this.y+=e.y*r,this.z+=e.z*r,this.w+=e.w*r,this}sub(e,r){return void 0!==r?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,r)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,r){return this.x=e.x-r.x,this.y=e.y-r.y,this.z=e.z-r.z,this.w=e.w-r.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const r=this.x,s=this.y,a=this.z,c=this.w,p=e.elements;return this.x=p[0]*r+p[4]*s+p[8]*a+p[12]*c,this.y=p[1]*r+p[5]*s+p[9]*a+p[13]*c,this.z=p[2]*r+p[6]*s+p[10]*a+p[14]*c,this.w=p[3]*r+p[7]*s+p[11]*a+p[15]*c,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const r=Math.sqrt(1-e.w*e.w);return r<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/r,this.y=e.y/r,this.z=e.z/r),this}setAxisAngleFromRotationMatrix(e){let r,s,a,c;const p=.01,m=.1,x=e.elements,E=x[0],C=x[4],D=x[8],A=x[1],P=x[5],L=x[9],H=x[2],q=x[6],k=x[10];if(Math.abs(C-A)<p&&Math.abs(D-H)<p&&Math.abs(L-q)<p){if(Math.abs(C+A)<m&&Math.abs(D+H)<m&&Math.abs(L+q)<m&&Math.abs(E+P+k-3)<m)return this.set(1,0,0,0),this;r=Math.PI;const re=(E+1)/2,ne=(P+1)/2,ve=(k+1)/2,Ie=(C+A)/4,ue=(D+H)/4,je=(L+q)/4;return re>ne&&re>ve?re<p?(s=0,a=.707106781,c=.707106781):(s=Math.sqrt(re),a=Ie/s,c=ue/s):ne>ve?ne<p?(s=.707106781,a=0,c=.707106781):(a=Math.sqrt(ne),s=Ie/a,c=je/a):ve<p?(s=.707106781,a=.707106781,c=0):(c=Math.sqrt(ve),s=ue/c,a=je/c),this.set(s,a,c,r),this}let O=Math.sqrt((q-L)*(q-L)+(D-H)*(D-H)+(A-C)*(A-C));return Math.abs(O)<.001&&(O=1),this.x=(q-L)/O,this.y=(D-H)/O,this.z=(A-C)/O,this.w=Math.acos((E+P+k-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,r){return this.x=Math.max(e.x,Math.min(r.x,this.x)),this.y=Math.max(e.y,Math.min(r.y,this.y)),this.z=Math.max(e.z,Math.min(r.z,this.z)),this.w=Math.max(e.w,Math.min(r.w,this.w)),this}clampScalar(e,r){return this.x=Math.max(e,Math.min(r,this.x)),this.y=Math.max(e,Math.min(r,this.y)),this.z=Math.max(e,Math.min(r,this.z)),this.w=Math.max(e,Math.min(r,this.w)),this}clampLength(e,r){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(e,Math.min(r,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,r){return this.x+=(e.x-this.x)*r,this.y+=(e.y-this.y)*r,this.z+=(e.z-this.z)*r,this.w+=(e.w-this.w)*r,this}lerpVectors(e,r,s){return this.x=e.x+(r.x-e.x)*s,this.y=e.y+(r.y-e.y)*s,this.z=e.z+(r.z-e.z)*s,this.w=e.w+(r.w-e.w)*s,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,r=0){return this.x=e[r],this.y=e[r+1],this.z=e[r+2],this.w=e[r+3],this}toArray(e=[],r=0){return e[r]=this.x,e[r+1]=this.y,e[r+2]=this.z,e[r+3]=this.w,e}fromBufferAttribute(e,r,s){return void 0!==s&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(r),this.y=e.getY(r),this.z=e.getZ(r),this.w=e.getW(r),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}di.prototype.isVector4=!0;class No extends qi{constructor(e,r,s={}){super(),this.width=e,this.height=r,this.depth=1,this.scissor=new di(0,0,e,r),this.scissorTest=!1,this.viewport=new di(0,0,e,r),this.texture=new As(void 0,s.mapping,s.wrapS,s.wrapT,s.magFilter,s.minFilter,s.format,s.type,s.anisotropy,s.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:e,height:r,depth:1},this.texture.generateMipmaps=void 0!==s.generateMipmaps&&s.generateMipmaps,this.texture.internalFormat=void 0!==s.internalFormat?s.internalFormat:null,this.texture.minFilter=void 0!==s.minFilter?s.minFilter:zn,this.depthBuffer=void 0===s.depthBuffer||s.depthBuffer,this.stencilBuffer=void 0!==s.stencilBuffer&&s.stencilBuffer,this.depthTexture=void 0!==s.depthTexture?s.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,r,s=1){(this.width!==e||this.height!==r||this.depth!==s)&&(this.width=e,this.height=r,this.depth=s,this.texture.image.width=e,this.texture.image.height=r,this.texture.image.depth=s,this.dispose()),this.viewport.set(0,0,e,r),this.scissor.set(0,0,e,r)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=MM({},this.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}No.prototype.isWebGLRenderTarget=!0,class extends No{constructor(e,r,s){super(e,r);const a=this.texture;this.texture=[];for(let c=0;c<s;c++)this.texture[c]=a.clone()}setSize(e,r,s=1){if(this.width!==e||this.height!==r||this.depth!==s){this.width=e,this.height=r,this.depth=s;for(let a=0,c=this.texture.length;a<c;a++)this.texture[a].image.width=e,this.texture[a].image.height=r,this.texture[a].image.depth=s;this.dispose()}return this.viewport.set(0,0,e,r),this.scissor.set(0,0,e,r),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let r=0,s=e.texture.length;r<s;r++)this.texture[r]=e.texture[r].clone();return this}}.prototype.isWebGLMultipleRenderTargets=!0;class _c extends No{constructor(e,r,s){super(e,r,s),this.samples=4}copy(e){return super.copy.call(this,e),this.samples=e.samples,this}}_c.prototype.isWebGLMultisampleRenderTarget=!0;class as{constructor(e=0,r=0,s=0,a=1){this._x=e,this._y=r,this._z=s,this._w=a}static slerp(e,r,s,a){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),s.slerpQuaternions(e,r,a)}static slerpFlat(e,r,s,a,c,p,m){let x=s[a+0],E=s[a+1],C=s[a+2],D=s[a+3];const A=c[p+0],P=c[p+1],L=c[p+2],H=c[p+3];if(0===m)return e[r+0]=x,e[r+1]=E,e[r+2]=C,void(e[r+3]=D);if(1===m)return e[r+0]=A,e[r+1]=P,e[r+2]=L,void(e[r+3]=H);if(D!==H||x!==A||E!==P||C!==L){let q=1-m;const k=x*A+E*P+C*L+D*H,O=k>=0?1:-1,re=1-k*k;if(re>Number.EPSILON){const ve=Math.sqrt(re),Ie=Math.atan2(ve,k*O);q=Math.sin(q*Ie)/ve,m=Math.sin(m*Ie)/ve}const ne=m*O;if(x=x*q+A*ne,E=E*q+P*ne,C=C*q+L*ne,D=D*q+H*ne,q===1-m){const ve=1/Math.sqrt(x*x+E*E+C*C+D*D);x*=ve,E*=ve,C*=ve,D*=ve}}e[r]=x,e[r+1]=E,e[r+2]=C,e[r+3]=D}static multiplyQuaternionsFlat(e,r,s,a,c,p){const m=s[a],x=s[a+1],E=s[a+2],C=s[a+3],D=c[p],A=c[p+1],P=c[p+2],L=c[p+3];return e[r]=m*L+C*D+x*P-E*A,e[r+1]=x*L+C*A+E*D-m*P,e[r+2]=E*L+C*P+m*A-x*D,e[r+3]=C*L-m*D-x*A-E*P,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,r,s,a){return this._x=e,this._y=r,this._z=s,this._w=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,r){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const s=e._x,a=e._y,c=e._z,p=e._order,m=Math.cos,x=Math.sin,E=m(s/2),C=m(a/2),D=m(c/2),A=x(s/2),P=x(a/2),L=x(c/2);switch(p){case"XYZ":this._x=A*C*D+E*P*L,this._y=E*P*D-A*C*L,this._z=E*C*L+A*P*D,this._w=E*C*D-A*P*L;break;case"YXZ":this._x=A*C*D+E*P*L,this._y=E*P*D-A*C*L,this._z=E*C*L-A*P*D,this._w=E*C*D+A*P*L;break;case"ZXY":this._x=A*C*D-E*P*L,this._y=E*P*D+A*C*L,this._z=E*C*L+A*P*D,this._w=E*C*D-A*P*L;break;case"ZYX":this._x=A*C*D-E*P*L,this._y=E*P*D+A*C*L,this._z=E*C*L-A*P*D,this._w=E*C*D+A*P*L;break;case"YZX":this._x=A*C*D+E*P*L,this._y=E*P*D+A*C*L,this._z=E*C*L-A*P*D,this._w=E*C*D-A*P*L;break;case"XZY":this._x=A*C*D-E*P*L,this._y=E*P*D-A*C*L,this._z=E*C*L+A*P*D,this._w=E*C*D+A*P*L;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+p)}return!1!==r&&this._onChangeCallback(),this}setFromAxisAngle(e,r){const s=r/2,a=Math.sin(s);return this._x=e.x*a,this._y=e.y*a,this._z=e.z*a,this._w=Math.cos(s),this._onChangeCallback(),this}setFromRotationMatrix(e){const r=e.elements,s=r[0],a=r[4],c=r[8],p=r[1],m=r[5],x=r[9],E=r[2],C=r[6],D=r[10],A=s+m+D;if(A>0){const P=.5/Math.sqrt(A+1);this._w=.25/P,this._x=(C-x)*P,this._y=(c-E)*P,this._z=(p-a)*P}else if(s>m&&s>D){const P=2*Math.sqrt(1+s-m-D);this._w=(C-x)/P,this._x=.25*P,this._y=(a+p)/P,this._z=(c+E)/P}else if(m>D){const P=2*Math.sqrt(1+m-s-D);this._w=(c-E)/P,this._x=(a+p)/P,this._y=.25*P,this._z=(x+C)/P}else{const P=2*Math.sqrt(1+D-s-m);this._w=(p-a)/P,this._x=(c+E)/P,this._y=(x+C)/P,this._z=.25*P}return this._onChangeCallback(),this}setFromUnitVectors(e,r){let s=e.dot(r)+1;return s<Number.EPSILON?(s=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=s):(this._x=0,this._y=-e.z,this._z=e.y,this._w=s)):(this._x=e.y*r.z-e.z*r.y,this._y=e.z*r.x-e.x*r.z,this._z=e.x*r.y-e.y*r.x,this._w=s),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ts(this.dot(e),-1,1)))}rotateTowards(e,r){const s=this.angleTo(e);if(0===s)return this;const a=Math.min(1,r/s);return this.slerp(e,a),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,r){return void 0!==r?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,r)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,r){const s=e._x,a=e._y,c=e._z,p=e._w,m=r._x,x=r._y,E=r._z,C=r._w;return this._x=s*C+p*m+a*E-c*x,this._y=a*C+p*x+c*m-s*E,this._z=c*C+p*E+s*x-a*m,this._w=p*C-s*m-a*x-c*E,this._onChangeCallback(),this}slerp(e,r){if(0===r)return this;if(1===r)return this.copy(e);const s=this._x,a=this._y,c=this._z,p=this._w;let m=p*e._w+s*e._x+a*e._y+c*e._z;if(m<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,m=-m):this.copy(e),m>=1)return this._w=p,this._x=s,this._y=a,this._z=c,this;const x=1-m*m;if(x<=Number.EPSILON){const P=1-r;return this._w=P*p+r*this._w,this._x=P*s+r*this._x,this._y=P*a+r*this._y,this._z=P*c+r*this._z,this.normalize(),this._onChangeCallback(),this}const E=Math.sqrt(x),C=Math.atan2(E,m),D=Math.sin((1-r)*C)/E,A=Math.sin(r*C)/E;return this._w=p*D+this._w*A,this._x=s*D+this._x*A,this._y=a*D+this._y*A,this._z=c*D+this._z*A,this._onChangeCallback(),this}slerpQuaternions(e,r,s){this.copy(e).slerp(r,s)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,r=0){return this._x=e[r],this._y=e[r+1],this._z=e[r+2],this._w=e[r+3],this._onChangeCallback(),this}toArray(e=[],r=0){return e[r]=this._x,e[r+1]=this._y,e[r+2]=this._z,e[r+3]=this._w,e}fromBufferAttribute(e,r){return this._x=e.getX(r),this._y=e.getY(r),this._z=e.getZ(r),this._w=e.getW(r),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}as.prototype.isQuaternion=!0;class he{constructor(e=0,r=0,s=0){this.x=e,this.y=r,this.z=s}set(e,r,s){return void 0===s&&(s=this.z),this.x=e,this.y=r,this.z=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,r){switch(e){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,r){return void 0!==r?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,r)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,r){return this.x=e.x+r.x,this.y=e.y+r.y,this.z=e.z+r.z,this}addScaledVector(e,r){return this.x+=e.x*r,this.y+=e.y*r,this.z+=e.z*r,this}sub(e,r){return void 0!==r?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,r)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,r){return this.x=e.x-r.x,this.y=e.y-r.y,this.z=e.z-r.z,this}multiply(e,r){return void 0!==r?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,r)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,r){return this.x=e.x*r.x,this.y=e.y*r.y,this.z=e.z*r.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Al.setFromEuler(e))}applyAxisAngle(e,r){return this.applyQuaternion(Al.setFromAxisAngle(e,r))}applyMatrix3(e){const r=this.x,s=this.y,a=this.z,c=e.elements;return this.x=c[0]*r+c[3]*s+c[6]*a,this.y=c[1]*r+c[4]*s+c[7]*a,this.z=c[2]*r+c[5]*s+c[8]*a,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const r=this.x,s=this.y,a=this.z,c=e.elements,p=1/(c[3]*r+c[7]*s+c[11]*a+c[15]);return this.x=(c[0]*r+c[4]*s+c[8]*a+c[12])*p,this.y=(c[1]*r+c[5]*s+c[9]*a+c[13])*p,this.z=(c[2]*r+c[6]*s+c[10]*a+c[14])*p,this}applyQuaternion(e){const r=this.x,s=this.y,a=this.z,c=e.x,p=e.y,m=e.z,x=e.w,E=x*r+p*a-m*s,C=x*s+m*r-c*a,D=x*a+c*s-p*r,A=-c*r-p*s-m*a;return this.x=E*x+A*-c+C*-m-D*-p,this.y=C*x+A*-p+D*-c-E*-m,this.z=D*x+A*-m+E*-p-C*-c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const r=this.x,s=this.y,a=this.z,c=e.elements;return this.x=c[0]*r+c[4]*s+c[8]*a,this.y=c[1]*r+c[5]*s+c[9]*a,this.z=c[2]*r+c[6]*s+c[10]*a,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,r){return this.x=Math.max(e.x,Math.min(r.x,this.x)),this.y=Math.max(e.y,Math.min(r.y,this.y)),this.z=Math.max(e.z,Math.min(r.z,this.z)),this}clampScalar(e,r){return this.x=Math.max(e,Math.min(r,this.x)),this.y=Math.max(e,Math.min(r,this.y)),this.z=Math.max(e,Math.min(r,this.z)),this}clampLength(e,r){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(e,Math.min(r,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,r){return this.x+=(e.x-this.x)*r,this.y+=(e.y-this.y)*r,this.z+=(e.z-this.z)*r,this}lerpVectors(e,r,s){return this.x=e.x+(r.x-e.x)*s,this.y=e.y+(r.y-e.y)*s,this.z=e.z+(r.z-e.z)*s,this}cross(e,r){return void 0!==r?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,r)):this.crossVectors(this,e)}crossVectors(e,r){const s=e.x,a=e.y,c=e.z,p=r.x,m=r.y,x=r.z;return this.x=a*x-c*m,this.y=c*p-s*x,this.z=s*m-a*p,this}projectOnVector(e){const r=e.lengthSq();if(0===r)return this.set(0,0,0);const s=e.dot(this)/r;return this.copy(e).multiplyScalar(s)}projectOnPlane(e){return jc.copy(this).projectOnVector(e),this.sub(jc)}reflect(e){return this.sub(jc.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const r=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===r)return Math.PI/2;const s=this.dot(e)/r;return Math.acos(Ts(s,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const r=this.x-e.x,s=this.y-e.y,a=this.z-e.z;return r*r+s*s+a*a}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,r,s){const a=Math.sin(r)*e;return this.x=a*Math.sin(s),this.y=Math.cos(r)*e,this.z=a*Math.cos(s),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,r,s){return this.x=e*Math.sin(r),this.y=s,this.z=e*Math.cos(r),this}setFromMatrixPosition(e){const r=e.elements;return this.x=r[12],this.y=r[13],this.z=r[14],this}setFromMatrixScale(e){const r=this.setFromMatrixColumn(e,0).length(),s=this.setFromMatrixColumn(e,1).length(),a=this.setFromMatrixColumn(e,2).length();return this.x=r,this.y=s,this.z=a,this}setFromMatrixColumn(e,r){return this.fromArray(e.elements,4*r)}setFromMatrix3Column(e,r){return this.fromArray(e.elements,3*r)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,r=0){return this.x=e[r],this.y=e[r+1],this.z=e[r+2],this}toArray(e=[],r=0){return e[r]=this.x,e[r+1]=this.y,e[r+2]=this.z,e}fromBufferAttribute(e,r,s){return void 0!==s&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(r),this.y=e.getY(r),this.z=e.getZ(r),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}he.prototype.isVector3=!0;const jc=new he,Al=new as;class bs{constructor(e=new he(1/0,1/0,1/0),r=new he(-1/0,-1/0,-1/0)){this.min=e,this.max=r}set(e,r){return this.min.copy(e),this.max.copy(r),this}setFromArray(e){let r=1/0,s=1/0,a=1/0,c=-1/0,p=-1/0,m=-1/0;for(let x=0,E=e.length;x<E;x+=3){const C=e[x],D=e[x+1],A=e[x+2];C<r&&(r=C),D<s&&(s=D),A<a&&(a=A),C>c&&(c=C),D>p&&(p=D),A>m&&(m=A)}return this.min.set(r,s,a),this.max.set(c,p,m),this}setFromBufferAttribute(e){let r=1/0,s=1/0,a=1/0,c=-1/0,p=-1/0,m=-1/0;for(let x=0,E=e.count;x<E;x++){const C=e.getX(x),D=e.getY(x),A=e.getZ(x);C<r&&(r=C),D<s&&(s=D),A<a&&(a=A),C>c&&(c=C),D>p&&(p=D),A>m&&(m=A)}return this.min.set(r,s,a),this.max.set(c,p,m),this}setFromPoints(e){this.makeEmpty();for(let r=0,s=e.length;r<s;r++)this.expandByPoint(e[r]);return this}setFromCenterAndSize(e,r){const s=Dl.copy(r).multiplyScalar(.5);return this.min.copy(e).sub(s),this.max.copy(e).add(s),this}setFromObject(e){return this.makeEmpty(),this.expandByObject(e)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){e.updateWorldMatrix(!1,!1);const r=e.geometry;void 0!==r&&(null===r.boundingBox&&r.computeBoundingBox(),bc.copy(r.boundingBox),bc.applyMatrix4(e.matrixWorld),this.union(bc));const s=e.children;for(let a=0,c=s.length;a<c;a++)this.expandByObject(s[a]);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,r){return r.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Dl),Dl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let r,s;return e.normal.x>0?(r=e.normal.x*this.min.x,s=e.normal.x*this.max.x):(r=e.normal.x*this.max.x,s=e.normal.x*this.min.x),e.normal.y>0?(r+=e.normal.y*this.min.y,s+=e.normal.y*this.max.y):(r+=e.normal.y*this.max.y,s+=e.normal.y*this.min.y),e.normal.z>0?(r+=e.normal.z*this.min.z,s+=e.normal.z*this.max.z):(r+=e.normal.z*this.max.z,s+=e.normal.z*this.min.z),r<=-e.constant&&s>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(gi),fo.subVectors(this.max,gi),rl.subVectors(e.a,gi),wa.subVectors(e.b,gi),Rl.subVectors(e.c,gi),Ea.subVectors(wa,rl),pi.subVectors(Rl,wa),Hs.subVectors(rl,Rl);let r=[0,-Ea.z,Ea.y,0,-pi.z,pi.y,0,-Hs.z,Hs.y,Ea.z,0,-Ea.x,pi.z,0,-pi.x,Hs.z,0,-Hs.x,-Ea.y,Ea.x,0,-pi.y,pi.x,0,-Hs.y,Hs.x,0];return!(!xc(r,rl,wa,Rl,fo)||(r=[1,0,0,0,1,0,0,0,1],!xc(r,rl,wa,Rl,fo)))&&(Wc.crossVectors(Ea,pi),r=[Wc.x,Wc.y,Wc.z],xc(r,rl,wa,Rl,fo))}clampPoint(e,r){return r.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Dl.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(Dl).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(wo[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),wo[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),wo[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),wo[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),wo[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),wo[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),wo[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),wo[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(wo)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}bs.prototype.isBox3=!0;const wo=[new he,new he,new he,new he,new he,new he,new he,new he],Dl=new he,bc=new bs,rl=new he,wa=new he,Rl=new he,Ea=new he,pi=new he,Hs=new he,gi=new he,fo=new he,Wc=new he,Wn=new he;function xc(h,e,r,s,a){for(let c=0,p=h.length-3;c<=p;c+=3){Wn.fromArray(h,c);const m=a.x*Math.abs(Wn.x)+a.y*Math.abs(Wn.y)+a.z*Math.abs(Wn.z),x=e.dot(Wn),E=r.dot(Wn),C=s.dot(Wn);if(Math.max(-Math.max(x,E,C),Math.min(x,E,C))>m)return!1}return!0}const Ku=new bs,$c=new he,Il=new he,Fo=new he;class ko{constructor(e=new he,r=-1){this.center=e,this.radius=r}set(e,r){return this.center.copy(e),this.radius=r,this}setFromPoints(e,r){const s=this.center;void 0!==r?s.copy(r):Ku.setFromPoints(e).getCenter(s);let a=0;for(let c=0,p=e.length;c<p;c++)a=Math.max(a,s.distanceToSquared(e[c]));return this.radius=Math.sqrt(a),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const r=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=r*r}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,r){const s=this.center.distanceToSquared(e);return r.copy(e),s>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){Fo.subVectors(e,this.center);const r=Fo.lengthSq();if(r>this.radius*this.radius){const s=Math.sqrt(r),a=.5*(s-this.radius);this.center.add(Fo.multiplyScalar(a/s)),this.radius+=a}return this}union(e){return Il.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint($c.copy(e.center).add(Il)),this.expandByPoint($c.copy(e.center).sub(Il)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Ls=new he,Oa=new he,Bo=new he,ai=new he,Yi=new he,oa=new he,Uo=new he;class Gs{constructor(e=new he,r=new he(0,0,-1)){this.origin=e,this.direction=r}set(e,r){return this.origin.copy(e),this.direction.copy(r),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,r){return r.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ls)),this}closestPointToPoint(e,r){r.subVectors(e,this.origin);const s=r.dot(this.direction);return s<0?r.copy(this.origin):r.copy(this.direction).multiplyScalar(s).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const r=Ls.subVectors(e,this.origin).dot(this.direction);return r<0?this.origin.distanceToSquared(e):(Ls.copy(this.direction).multiplyScalar(r).add(this.origin),Ls.distanceToSquared(e))}distanceSqToSegment(e,r,s,a){Oa.copy(e).add(r).multiplyScalar(.5),Bo.copy(r).sub(e).normalize(),ai.copy(this.origin).sub(Oa);const c=.5*e.distanceTo(r),p=-this.direction.dot(Bo),m=ai.dot(this.direction),x=-ai.dot(Bo),E=ai.lengthSq(),C=Math.abs(1-p*p);let D,A,P,L;if(C>0)if(D=p*x-m,A=p*m-x,L=c*C,D>=0)if(A>=-L)if(A<=L){const H=1/C;D*=H,A*=H,P=D*(D+p*A+2*m)+A*(p*D+A+2*x)+E}else A=c,D=Math.max(0,-(p*A+m)),P=-D*D+A*(A+2*x)+E;else A=-c,D=Math.max(0,-(p*A+m)),P=-D*D+A*(A+2*x)+E;else A<=-L?(D=Math.max(0,-(-p*c+m)),A=D>0?-c:Math.min(Math.max(-c,-x),c),P=-D*D+A*(A+2*x)+E):A<=L?(D=0,A=Math.min(Math.max(-c,-x),c),P=A*(A+2*x)+E):(D=Math.max(0,-(p*c+m)),A=D>0?c:Math.min(Math.max(-c,-x),c),P=-D*D+A*(A+2*x)+E);else A=p>0?-c:c,D=Math.max(0,-(p*A+m)),P=-D*D+A*(A+2*x)+E;return s&&s.copy(this.direction).multiplyScalar(D).add(this.origin),a&&a.copy(Bo).multiplyScalar(A).add(Oa),P}intersectSphere(e,r){Ls.subVectors(e.center,this.origin);const s=Ls.dot(this.direction),a=Ls.dot(Ls)-s*s,c=e.radius*e.radius;if(a>c)return null;const p=Math.sqrt(c-a),m=s-p,x=s+p;return m<0&&x<0?null:this.at(m<0?x:m,r)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const r=e.normal.dot(this.direction);if(0===r)return 0===e.distanceToPoint(this.origin)?0:null;const s=-(this.origin.dot(e.normal)+e.constant)/r;return s>=0?s:null}intersectPlane(e,r){const s=this.distanceToPlane(e);return null===s?null:this.at(s,r)}intersectsPlane(e){const r=e.distanceToPoint(this.origin);return 0===r||e.normal.dot(this.direction)*r<0}intersectBox(e,r){let s,a,c,p,m,x;const E=1/this.direction.x,C=1/this.direction.y,D=1/this.direction.z,A=this.origin;return E>=0?(s=(e.min.x-A.x)*E,a=(e.max.x-A.x)*E):(s=(e.max.x-A.x)*E,a=(e.min.x-A.x)*E),C>=0?(c=(e.min.y-A.y)*C,p=(e.max.y-A.y)*C):(c=(e.max.y-A.y)*C,p=(e.min.y-A.y)*C),s>p||c>a||((c>s||s!=s)&&(s=c),(p<a||a!=a)&&(a=p),D>=0?(m=(e.min.z-A.z)*D,x=(e.max.z-A.z)*D):(m=(e.max.z-A.z)*D,x=(e.min.z-A.z)*D),s>x||m>a)||((m>s||s!=s)&&(s=m),(x<a||a!=a)&&(a=x),a<0)?null:this.at(s>=0?s:a,r)}intersectsBox(e){return null!==this.intersectBox(e,Ls)}intersectTriangle(e,r,s,a,c){Yi.subVectors(r,e),oa.subVectors(s,e),Uo.crossVectors(Yi,oa);let m,p=this.direction.dot(Uo);if(p>0){if(a)return null;m=1}else{if(!(p<0))return null;m=-1,p=-p}ai.subVectors(this.origin,e);const x=m*this.direction.dot(oa.crossVectors(ai,oa));if(x<0)return null;const E=m*this.direction.dot(Yi.cross(ai));if(E<0||x+E>p)return null;const C=-m*ai.dot(Uo);return C<0?null:this.at(C/p,c)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Nn{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,r,s,a,c,p,m,x,E,C,D,A,P,L,H,q){const k=this.elements;return k[0]=e,k[4]=r,k[8]=s,k[12]=a,k[1]=c,k[5]=p,k[9]=m,k[13]=x,k[2]=E,k[6]=C,k[10]=D,k[14]=A,k[3]=P,k[7]=L,k[11]=H,k[15]=q,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Nn).fromArray(this.elements)}copy(e){const r=this.elements,s=e.elements;return r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=s[3],r[4]=s[4],r[5]=s[5],r[6]=s[6],r[7]=s[7],r[8]=s[8],r[9]=s[9],r[10]=s[10],r[11]=s[11],r[12]=s[12],r[13]=s[13],r[14]=s[14],r[15]=s[15],this}copyPosition(e){const r=this.elements,s=e.elements;return r[12]=s[12],r[13]=s[13],r[14]=s[14],this}setFromMatrix3(e){const r=e.elements;return this.set(r[0],r[3],r[6],0,r[1],r[4],r[7],0,r[2],r[5],r[8],0,0,0,0,1),this}extractBasis(e,r,s){return e.setFromMatrixColumn(this,0),r.setFromMatrixColumn(this,1),s.setFromMatrixColumn(this,2),this}makeBasis(e,r,s){return this.set(e.x,r.x,s.x,0,e.y,r.y,s.y,0,e.z,r.z,s.z,0,0,0,0,1),this}extractRotation(e){const r=this.elements,s=e.elements,a=1/il.setFromMatrixColumn(e,0).length(),c=1/il.setFromMatrixColumn(e,1).length(),p=1/il.setFromMatrixColumn(e,2).length();return r[0]=s[0]*a,r[1]=s[1]*a,r[2]=s[2]*a,r[3]=0,r[4]=s[4]*c,r[5]=s[5]*c,r[6]=s[6]*c,r[7]=0,r[8]=s[8]*p,r[9]=s[9]*p,r[10]=s[10]*p,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const r=this.elements,s=e.x,a=e.y,c=e.z,p=Math.cos(s),m=Math.sin(s),x=Math.cos(a),E=Math.sin(a),C=Math.cos(c),D=Math.sin(c);if("XYZ"===e.order){const A=p*C,P=p*D,L=m*C,H=m*D;r[0]=x*C,r[4]=-x*D,r[8]=E,r[1]=P+L*E,r[5]=A-H*E,r[9]=-m*x,r[2]=H-A*E,r[6]=L+P*E,r[10]=p*x}else if("YXZ"===e.order){const A=x*C,P=x*D,L=E*C,H=E*D;r[0]=A+H*m,r[4]=L*m-P,r[8]=p*E,r[1]=p*D,r[5]=p*C,r[9]=-m,r[2]=P*m-L,r[6]=H+A*m,r[10]=p*x}else if("ZXY"===e.order){const A=x*C,P=x*D,L=E*C,H=E*D;r[0]=A-H*m,r[4]=-p*D,r[8]=L+P*m,r[1]=P+L*m,r[5]=p*C,r[9]=H-A*m,r[2]=-p*E,r[6]=m,r[10]=p*x}else if("ZYX"===e.order){const A=p*C,P=p*D,L=m*C,H=m*D;r[0]=x*C,r[4]=L*E-P,r[8]=A*E+H,r[1]=x*D,r[5]=H*E+A,r[9]=P*E-L,r[2]=-E,r[6]=m*x,r[10]=p*x}else if("YZX"===e.order){const A=p*x,P=p*E,L=m*x,H=m*E;r[0]=x*C,r[4]=H-A*D,r[8]=L*D+P,r[1]=D,r[5]=p*C,r[9]=-m*C,r[2]=-E*C,r[6]=P*D+L,r[10]=A-H*D}else if("XZY"===e.order){const A=p*x,P=p*E,L=m*x,H=m*E;r[0]=x*C,r[4]=-D,r[8]=E*C,r[1]=A*D+H,r[5]=p*C,r[9]=P*D-L,r[2]=L*D-P,r[6]=m*C,r[10]=H*D+A}return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromQuaternion(e){return this.compose(jd,e,Ju)}lookAt(e,r,s){const a=this.elements;return ji.subVectors(e,r),0===ji.lengthSq()&&(ji.z=1),ji.normalize(),ri.crossVectors(s,ji),0===ri.lengthSq()&&(1===Math.abs(s.z)?ji.x+=1e-4:ji.z+=1e-4,ji.normalize(),ri.crossVectors(s,ji)),ri.normalize(),Yl.crossVectors(ji,ri),a[0]=ri.x,a[4]=Yl.x,a[8]=ji.x,a[1]=ri.y,a[5]=Yl.y,a[9]=ji.y,a[2]=ri.z,a[6]=Yl.z,a[10]=ji.z,this}multiply(e,r){return void 0!==r?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,r)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,r){const s=e.elements,a=r.elements,c=this.elements,p=s[0],m=s[4],x=s[8],E=s[12],C=s[1],D=s[5],A=s[9],P=s[13],L=s[2],H=s[6],q=s[10],k=s[14],O=s[3],re=s[7],ne=s[11],ve=s[15],Ie=a[0],ue=a[4],je=a[8],wt=a[12],nt=a[1],Ge=a[5],en=a[9],bt=a[13],_t=a[2],Ct=a[6],xt=a[10],Pt=a[14],wn=a[3],ir=a[7],fr=a[11],Bn=a[15];return c[0]=p*Ie+m*nt+x*_t+E*wn,c[4]=p*ue+m*Ge+x*Ct+E*ir,c[8]=p*je+m*en+x*xt+E*fr,c[12]=p*wt+m*bt+x*Pt+E*Bn,c[1]=C*Ie+D*nt+A*_t+P*wn,c[5]=C*ue+D*Ge+A*Ct+P*ir,c[9]=C*je+D*en+A*xt+P*fr,c[13]=C*wt+D*bt+A*Pt+P*Bn,c[2]=L*Ie+H*nt+q*_t+k*wn,c[6]=L*ue+H*Ge+q*Ct+k*ir,c[10]=L*je+H*en+q*xt+k*fr,c[14]=L*wt+H*bt+q*Pt+k*Bn,c[3]=O*Ie+re*nt+ne*_t+ve*wn,c[7]=O*ue+re*Ge+ne*Ct+ve*ir,c[11]=O*je+re*en+ne*xt+ve*fr,c[15]=O*wt+re*bt+ne*Pt+ve*Bn,this}multiplyScalar(e){const r=this.elements;return r[0]*=e,r[4]*=e,r[8]*=e,r[12]*=e,r[1]*=e,r[5]*=e,r[9]*=e,r[13]*=e,r[2]*=e,r[6]*=e,r[10]*=e,r[14]*=e,r[3]*=e,r[7]*=e,r[11]*=e,r[15]*=e,this}determinant(){const e=this.elements,r=e[0],s=e[4],a=e[8],c=e[12],p=e[1],m=e[5],x=e[9],E=e[13],C=e[2],D=e[6],A=e[10],P=e[14];return e[3]*(+c*x*D-a*E*D-c*m*A+s*E*A+a*m*P-s*x*P)+e[7]*(+r*x*P-r*E*A+c*p*A-a*p*P+a*E*C-c*x*C)+e[11]*(+r*E*D-r*m*P-c*p*D+s*p*P+c*m*C-s*E*C)+e[15]*(-a*m*C-r*x*D+r*m*A+a*p*D-s*p*A+s*x*C)}transpose(){const e=this.elements;let r;return r=e[1],e[1]=e[4],e[4]=r,r=e[2],e[2]=e[8],e[8]=r,r=e[6],e[6]=e[9],e[9]=r,r=e[3],e[3]=e[12],e[12]=r,r=e[7],e[7]=e[13],e[13]=r,r=e[11],e[11]=e[14],e[14]=r,this}setPosition(e,r,s){const a=this.elements;return e.isVector3?(a[12]=e.x,a[13]=e.y,a[14]=e.z):(a[12]=e,a[13]=r,a[14]=s),this}invert(){const e=this.elements,r=e[0],s=e[1],a=e[2],c=e[3],p=e[4],m=e[5],x=e[6],E=e[7],C=e[8],D=e[9],A=e[10],P=e[11],L=e[12],H=e[13],q=e[14],k=e[15],O=D*q*E-H*A*E+H*x*P-m*q*P-D*x*k+m*A*k,re=L*A*E-C*q*E-L*x*P+p*q*P+C*x*k-p*A*k,ne=C*H*E-L*D*E+L*m*P-p*H*P-C*m*k+p*D*k,ve=L*D*x-C*H*x-L*m*A+p*H*A+C*m*q-p*D*q,Ie=r*O+s*re+a*ne+c*ve;if(0===Ie)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ue=1/Ie;return e[0]=O*ue,e[1]=(H*A*c-D*q*c-H*a*P+s*q*P+D*a*k-s*A*k)*ue,e[2]=(m*q*c-H*x*c+H*a*E-s*q*E-m*a*k+s*x*k)*ue,e[3]=(D*x*c-m*A*c-D*a*E+s*A*E+m*a*P-s*x*P)*ue,e[4]=re*ue,e[5]=(C*q*c-L*A*c+L*a*P-r*q*P-C*a*k+r*A*k)*ue,e[6]=(L*x*c-p*q*c-L*a*E+r*q*E+p*a*k-r*x*k)*ue,e[7]=(p*A*c-C*x*c+C*a*E-r*A*E-p*a*P+r*x*P)*ue,e[8]=ne*ue,e[9]=(L*D*c-C*H*c-L*s*P+r*H*P+C*s*k-r*D*k)*ue,e[10]=(p*H*c-L*m*c+L*s*E-r*H*E-p*s*k+r*m*k)*ue,e[11]=(C*m*c-p*D*c-C*s*E+r*D*E+p*s*P-r*m*P)*ue,e[12]=ve*ue,e[13]=(C*H*a-L*D*a+L*s*A-r*H*A-C*s*q+r*D*q)*ue,e[14]=(L*m*a-p*H*a-L*s*x+r*H*x+p*s*q-r*m*q)*ue,e[15]=(p*D*a-C*m*a+C*s*x-r*D*x-p*s*A+r*m*A)*ue,this}scale(e){const r=this.elements,s=e.x,a=e.y,c=e.z;return r[0]*=s,r[4]*=a,r[8]*=c,r[1]*=s,r[5]*=a,r[9]*=c,r[2]*=s,r[6]*=a,r[10]*=c,r[3]*=s,r[7]*=a,r[11]*=c,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,r,s){return this.set(1,0,0,e,0,1,0,r,0,0,1,s,0,0,0,1),this}makeRotationX(e){const r=Math.cos(e),s=Math.sin(e);return this.set(1,0,0,0,0,r,-s,0,0,s,r,0,0,0,0,1),this}makeRotationY(e){const r=Math.cos(e),s=Math.sin(e);return this.set(r,0,s,0,0,1,0,0,-s,0,r,0,0,0,0,1),this}makeRotationZ(e){const r=Math.cos(e),s=Math.sin(e);return this.set(r,-s,0,0,s,r,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,r){const s=Math.cos(r),a=Math.sin(r),c=1-s,p=e.x,m=e.y,x=e.z,E=c*p,C=c*m;return this.set(E*p+s,E*m-a*x,E*x+a*m,0,E*m+a*x,C*m+s,C*x-a*p,0,E*x-a*m,C*x+a*p,c*x*x+s,0,0,0,0,1),this}makeScale(e,r,s){return this.set(e,0,0,0,0,r,0,0,0,0,s,0,0,0,0,1),this}makeShear(e,r,s,a,c,p){return this.set(1,s,c,0,e,1,p,0,r,a,1,0,0,0,0,1),this}compose(e,r,s){const a=this.elements,c=r._x,p=r._y,m=r._z,x=r._w,E=c+c,C=p+p,D=m+m,A=c*E,P=c*C,L=c*D,H=p*C,q=p*D,k=m*D,O=x*E,re=x*C,ne=x*D,ve=s.x,Ie=s.y,ue=s.z;return a[0]=(1-(H+k))*ve,a[1]=(P+ne)*ve,a[2]=(L-re)*ve,a[3]=0,a[4]=(P-ne)*Ie,a[5]=(1-(A+k))*Ie,a[6]=(q+O)*Ie,a[7]=0,a[8]=(L+re)*ue,a[9]=(q-O)*ue,a[10]=(1-(A+H))*ue,a[11]=0,a[12]=e.x,a[13]=e.y,a[14]=e.z,a[15]=1,this}decompose(e,r,s){const a=this.elements;let c=il.set(a[0],a[1],a[2]).length();const p=il.set(a[4],a[5],a[6]).length(),m=il.set(a[8],a[9],a[10]).length();this.determinant()<0&&(c=-c),e.x=a[12],e.y=a[13],e.z=a[14],gs.copy(this);const E=1/c,C=1/p,D=1/m;return gs.elements[0]*=E,gs.elements[1]*=E,gs.elements[2]*=E,gs.elements[4]*=C,gs.elements[5]*=C,gs.elements[6]*=C,gs.elements[8]*=D,gs.elements[9]*=D,gs.elements[10]*=D,r.setFromRotationMatrix(gs),s.x=c,s.y=p,s.z=m,this}makePerspective(e,r,s,a,c,p){void 0===p&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const m=this.elements,E=2*c/(s-a),C=(r+e)/(r-e),D=(s+a)/(s-a),A=-(p+c)/(p-c),P=-2*p*c/(p-c);return m[0]=2*c/(r-e),m[4]=0,m[8]=C,m[12]=0,m[1]=0,m[5]=E,m[9]=D,m[13]=0,m[2]=0,m[6]=0,m[10]=A,m[14]=P,m[3]=0,m[7]=0,m[11]=-1,m[15]=0,this}makeOrthographic(e,r,s,a,c,p){const m=this.elements,x=1/(r-e),E=1/(s-a),C=1/(p-c),D=(r+e)*x,A=(s+a)*E,P=(p+c)*C;return m[0]=2*x,m[4]=0,m[8]=0,m[12]=-D,m[1]=0,m[5]=2*E,m[9]=0,m[13]=-A,m[2]=0,m[6]=0,m[10]=-2*C,m[14]=-P,m[3]=0,m[7]=0,m[11]=0,m[15]=1,this}equals(e){const r=this.elements,s=e.elements;for(let a=0;a<16;a++)if(r[a]!==s[a])return!1;return!0}fromArray(e,r=0){for(let s=0;s<16;s++)this.elements[s]=e[s+r];return this}toArray(e=[],r=0){const s=this.elements;return e[r]=s[0],e[r+1]=s[1],e[r+2]=s[2],e[r+3]=s[3],e[r+4]=s[4],e[r+5]=s[5],e[r+6]=s[6],e[r+7]=s[7],e[r+8]=s[8],e[r+9]=s[9],e[r+10]=s[10],e[r+11]=s[11],e[r+12]=s[12],e[r+13]=s[13],e[r+14]=s[14],e[r+15]=s[15],e}}Nn.prototype.isMatrix4=!0;const il=new he,gs=new Nn,jd=new he(0,0,0),Ju=new he(1,1,1),ri=new he,Yl=new he,ji=new he,Na=new Nn,Xl=new as;class Vo{constructor(e=0,r=0,s=0,a=Vo.DefaultOrder){this._x=e,this._y=r,this._z=s,this._order=a}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,r,s,a=this._order){return this._x=e,this._y=r,this._z=s,this._order=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,r=this._order,s=!0){const a=e.elements,c=a[0],p=a[4],m=a[8],x=a[1],E=a[5],C=a[9],D=a[2],A=a[6],P=a[10];switch(r){case"XYZ":this._y=Math.asin(Ts(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(-C,P),this._z=Math.atan2(-p,c)):(this._x=Math.atan2(A,E),this._z=0);break;case"YXZ":this._x=Math.asin(-Ts(C,-1,1)),Math.abs(C)<.9999999?(this._y=Math.atan2(m,P),this._z=Math.atan2(x,E)):(this._y=Math.atan2(-D,c),this._z=0);break;case"ZXY":this._x=Math.asin(Ts(A,-1,1)),Math.abs(A)<.9999999?(this._y=Math.atan2(-D,P),this._z=Math.atan2(-p,E)):(this._y=0,this._z=Math.atan2(x,c));break;case"ZYX":this._y=Math.asin(-Ts(D,-1,1)),Math.abs(D)<.9999999?(this._x=Math.atan2(A,P),this._z=Math.atan2(x,c)):(this._x=0,this._z=Math.atan2(-p,E));break;case"YZX":this._z=Math.asin(Ts(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(-C,E),this._y=Math.atan2(-D,c)):(this._x=0,this._y=Math.atan2(m,P));break;case"XZY":this._z=Math.asin(-Ts(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(A,E),this._y=Math.atan2(m,c)):(this._x=Math.atan2(-C,P),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+r)}return this._order=r,!0===s&&this._onChangeCallback(),this}setFromQuaternion(e,r,s){return Na.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Na,r,s)}setFromVector3(e,r=this._order){return this.set(e.x,e.y,e.z,r)}reorder(e){return Xl.setFromEuler(this),this.setFromQuaternion(Xl,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],r=0){return e[r]=this._x,e[r+1]=this._y,e[r+2]=this._z,e[r+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new he(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Vo.prototype.isEuler=!0,Vo.DefaultOrder="XYZ",Vo.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class zo{constructor(){this.mask=1}set(e){this.mask=1<<e|0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}}let wu=0;const Fa=new he,Pl=new as,Eo=new Nn,ed=new he,Ma=new he,Eu=new he,qc=new as,Wd=new he(1,0,0),eo=new he(0,1,0),Yc=new he(0,0,1),sl={type:"added"},wc={type:"removed"};class Zr extends qi{constructor(){super(),Object.defineProperty(this,"id",{value:wu++}),this.uuid=jn(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Zr.DefaultUp.clone();const e=new he,r=new Vo,s=new as,a=new he(1,1,1);r._onChange(function(){s.setFromEuler(r,!1)}),s._onChange(function(){r.setFromQuaternion(s,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:s},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new Nn},normalMatrix:{value:new ui}}),this.matrix=new Nn,this.matrixWorld=new Nn,this.matrixAutoUpdate=Zr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new zo,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,r){this.quaternion.setFromAxisAngle(e,r)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,r){return Pl.setFromAxisAngle(e,r),this.quaternion.multiply(Pl),this}rotateOnWorldAxis(e,r){return Pl.setFromAxisAngle(e,r),this.quaternion.premultiply(Pl),this}rotateX(e){return this.rotateOnAxis(Wd,e)}rotateY(e){return this.rotateOnAxis(eo,e)}rotateZ(e){return this.rotateOnAxis(Yc,e)}translateOnAxis(e,r){return Fa.copy(e).applyQuaternion(this.quaternion),this.position.add(Fa.multiplyScalar(r)),this}translateX(e){return this.translateOnAxis(Wd,e)}translateY(e){return this.translateOnAxis(eo,e)}translateZ(e){return this.translateOnAxis(Yc,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(Eo.copy(this.matrixWorld).invert())}lookAt(e,r,s){e.isVector3?ed.copy(e):ed.set(e,r,s);const a=this.parent;this.updateWorldMatrix(!0,!1),Ma.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Eo.lookAt(Ma,ed,this.up):Eo.lookAt(ed,Ma,this.up),this.quaternion.setFromRotationMatrix(Eo),a&&(Eo.extractRotation(a.matrixWorld),Pl.setFromRotationMatrix(Eo),this.quaternion.premultiply(Pl.invert()))}add(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(sl)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.remove(arguments[s]);return this}const r=this.children.indexOf(e);return-1!==r&&(e.parent=null,this.children.splice(r,1),e.dispatchEvent(wc)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const r=this.children[e];r.parent=null,r.dispatchEvent(wc)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Eo.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Eo.multiply(e.parent.matrixWorld)),e.applyMatrix4(Eo),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,r){if(this[e]===r)return this;for(let s=0,a=this.children.length;s<a;s++){const p=this.children[s].getObjectByProperty(e,r);if(void 0!==p)return p}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ma,e,Eu),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ma,qc,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const r=this.matrixWorld.elements;return e.set(r[8],r[9],r[10]).normalize()}raycast(){}traverse(e){e(this);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].traverseVisible(e)}traverseAncestors(e){const r=this.parent;null!==r&&(e(r),r.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].updateMatrixWorld(e)}updateWorldMatrix(e,r){const s=this.parent;if(!0===e&&null!==s&&s.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===r){const a=this.children;for(let c=0,p=a.length;c<p;c++)a[c].updateWorldMatrix(!1,!0)}}toJSON(e){const r=void 0===e||"string"==typeof e,s={};r&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},s.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const a={};function c(m,x){return void 0===m[x.uuid]&&(m[x.uuid]=x.toJSON(e)),x.uuid}if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),!0===this.castShadow&&(a.castShadow=!0),!0===this.receiveShadow&&(a.receiveShadow=!0),!1===this.visible&&(a.visible=!1),!1===this.frustumCulled&&(a.frustumCulled=!1),0!==this.renderOrder&&(a.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(a.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?a.background=this.background.toJSON():this.background.isTexture&&(a.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(a.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){a.geometry=c(e.geometries,this.geometry);const m=this.geometry.parameters;if(void 0!==m&&void 0!==m.shapes){const x=m.shapes;if(Array.isArray(x))for(let E=0,C=x.length;E<C;E++)c(e.shapes,x[E]);else c(e.shapes,x)}}if(this.isSkinnedMesh&&(a.bindMode=this.bindMode,a.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(c(e.skeletons,this.skeleton),a.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const m=[];for(let x=0,E=this.material.length;x<E;x++)m.push(c(e.materials,this.material[x]));a.material=m}else a.material=c(e.materials,this.material);if(this.children.length>0){a.children=[];for(let m=0;m<this.children.length;m++)a.children.push(this.children[m].toJSON(e).object)}if(this.animations.length>0){a.animations=[];for(let m=0;m<this.animations.length;m++)a.animations.push(c(e.animations,this.animations[m]))}if(r){const m=p(e.geometries),x=p(e.materials),E=p(e.textures),C=p(e.images),D=p(e.shapes),A=p(e.skeletons),P=p(e.animations);m.length>0&&(s.geometries=m),x.length>0&&(s.materials=x),E.length>0&&(s.textures=E),C.length>0&&(s.images=C),D.length>0&&(s.shapes=D),A.length>0&&(s.skeletons=A),P.length>0&&(s.animations=P)}return s.object=a,s;function p(m){const x=[];for(const E in m){const C=m[E];delete C.metadata,x.push(C)}return x}}clone(e){return(new this.constructor).copy(this,e)}copy(e,r=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===r)for(let s=0;s<e.children.length;s++)this.add(e.children[s].clone());return this}}Zr.DefaultUp=new he(0,1,0),Zr.DefaultMatrixAutoUpdate=!0,Zr.prototype.isObject3D=!0;const Ho=new he,Go=new he,Ec=new he,aa=new he,ka=new he,ol=new he,td=new he,S=new he,V=new he,Y=new he;class le{constructor(e=new he,r=new he,s=new he){this.a=e,this.b=r,this.c=s}static getNormal(e,r,s,a){a.subVectors(s,r),Ho.subVectors(e,r),a.cross(Ho);const c=a.lengthSq();return c>0?a.multiplyScalar(1/Math.sqrt(c)):a.set(0,0,0)}static getBarycoord(e,r,s,a,c){Ho.subVectors(a,r),Go.subVectors(s,r),Ec.subVectors(e,r);const p=Ho.dot(Ho),m=Ho.dot(Go),x=Ho.dot(Ec),E=Go.dot(Go),C=Go.dot(Ec),D=p*E-m*m;if(0===D)return c.set(-2,-1,-1);const A=1/D,P=(E*x-m*C)*A,L=(p*C-m*x)*A;return c.set(1-P-L,L,P)}static containsPoint(e,r,s,a){return this.getBarycoord(e,r,s,a,aa),aa.x>=0&&aa.y>=0&&aa.x+aa.y<=1}static getUV(e,r,s,a,c,p,m,x){return this.getBarycoord(e,r,s,a,aa),x.set(0,0),x.addScaledVector(c,aa.x),x.addScaledVector(p,aa.y),x.addScaledVector(m,aa.z),x}static isFrontFacing(e,r,s,a){return Ho.subVectors(s,r),Go.subVectors(e,r),Ho.cross(Go).dot(a)<0}set(e,r,s){return this.a.copy(e),this.b.copy(r),this.c.copy(s),this}setFromPointsAndIndices(e,r,s,a){return this.a.copy(e[r]),this.b.copy(e[s]),this.c.copy(e[a]),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ho.subVectors(this.c,this.b),Go.subVectors(this.a,this.b),.5*Ho.cross(Go).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return le.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,r){return le.getBarycoord(e,this.a,this.b,this.c,r)}getUV(e,r,s,a,c){return le.getUV(e,this.a,this.b,this.c,r,s,a,c)}containsPoint(e){return le.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return le.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,r){const s=this.a,a=this.b,c=this.c;let p,m;ka.subVectors(a,s),ol.subVectors(c,s),S.subVectors(e,s);const x=ka.dot(S),E=ol.dot(S);if(x<=0&&E<=0)return r.copy(s);V.subVectors(e,a);const C=ka.dot(V),D=ol.dot(V);if(C>=0&&D<=C)return r.copy(a);const A=x*D-C*E;if(A<=0&&x>=0&&C<=0)return p=x/(x-C),r.copy(s).addScaledVector(ka,p);Y.subVectors(e,c);const P=ka.dot(Y),L=ol.dot(Y);if(L>=0&&P<=L)return r.copy(c);const H=P*E-x*L;if(H<=0&&E>=0&&L<=0)return m=E/(E-L),r.copy(s).addScaledVector(ol,m);const q=C*L-P*D;if(q<=0&&D-C>=0&&P-L>=0)return td.subVectors(c,a),m=(D-C)/(D-C+(P-L)),r.copy(a).addScaledVector(td,m);const k=1/(q+H+A);return p=H*k,m=A*k,r.copy(s).addScaledVector(ka,p).addScaledVector(ol,m)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let we=0;class Re extends qi{constructor(){super(),Object.defineProperty(this,"id",{value:we++}),this.uuid=jn(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.format=ds,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const r in e){const s=e[r];if(void 0===s){console.warn("THREE.Material: '"+r+"' parameter is undefined.");continue}if("shading"===r){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===s;continue}const a=this[r];void 0!==a?a&&a.isColor?a.set(s):a&&a.isVector3&&s&&s.isVector3?a.copy(s):this[r]=s:console.warn("THREE."+this.type+": '"+r+"' is not a property of this material.")}}toJSON(e){const r=void 0===e||"string"==typeof e;r&&(e={textures:{},images:{}});const s={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function a(c){const p=[];for(const m in c){const x=c[m];delete x.metadata,p.push(x)}return p}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),this.color&&this.color.isColor&&(s.color=this.color.getHex()),void 0!==this.roughness&&(s.roughness=this.roughness),void 0!==this.metalness&&(s.metalness=this.metalness),this.sheenTint&&this.sheenTint.isColor&&(s.sheenTint=this.sheenTint.getHex()),this.emissive&&this.emissive.isColor&&(s.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(s.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(s.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(s.specularIntensity=this.specularIntensity),this.specularTint&&this.specularTint.isColor&&(s.specularTint=this.specularTint.getHex()),void 0!==this.shininess&&(s.shininess=this.shininess),void 0!==this.clearcoat&&(s.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(s.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(s.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(s.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(s.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,s.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(s.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(s.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(s.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(s.lightMap=this.lightMap.toJSON(e).uuid,s.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(s.aoMap=this.aoMap.toJSON(e).uuid,s.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(s.bumpMap=this.bumpMap.toJSON(e).uuid,s.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(s.normalMap=this.normalMap.toJSON(e).uuid,s.normalMapType=this.normalMapType,s.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(s.displacementMap=this.displacementMap.toJSON(e).uuid,s.displacementScale=this.displacementScale,s.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(s.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(s.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(s.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(s.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(s.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularTintMap&&this.specularTintMap.isTexture&&(s.specularTintMap=this.specularTintMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(s.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(s.combine=this.combine)),void 0!==this.envMapIntensity&&(s.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(s.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(s.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(s.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(s.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(s.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(s.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(s.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(s.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationTint&&(s.attenuationTint=this.attenuationTint.getHex()),void 0!==this.size&&(s.size=this.size),null!==this.shadowSide&&(s.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(s.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(s.blending=this.blending),0!==this.side&&(s.side=this.side),this.vertexColors&&(s.vertexColors=!0),this.opacity<1&&(s.opacity=this.opacity),this.format!==ds&&(s.format=this.format),!0===this.transparent&&(s.transparent=this.transparent),s.depthFunc=this.depthFunc,s.depthTest=this.depthTest,s.depthWrite=this.depthWrite,s.colorWrite=this.colorWrite,s.stencilWrite=this.stencilWrite,s.stencilWriteMask=this.stencilWriteMask,s.stencilFunc=this.stencilFunc,s.stencilRef=this.stencilRef,s.stencilFuncMask=this.stencilFuncMask,s.stencilFail=this.stencilFail,s.stencilZFail=this.stencilZFail,s.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(s.rotation=this.rotation),!0===this.polygonOffset&&(s.polygonOffset=!0),0!==this.polygonOffsetFactor&&(s.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(s.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(s.linewidth=this.linewidth),void 0!==this.dashSize&&(s.dashSize=this.dashSize),void 0!==this.gapSize&&(s.gapSize=this.gapSize),void 0!==this.scale&&(s.scale=this.scale),!0===this.dithering&&(s.dithering=!0),this.alphaTest>0&&(s.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(s.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(s.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(s.wireframe=this.wireframe),this.wireframeLinewidth>1&&(s.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(s.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(s.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(s.flatShading=this.flatShading),!1===this.visible&&(s.visible=!1),!1===this.toneMapped&&(s.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(s.userData=this.userData),r){const c=a(e.textures),p=a(e.images);c.length>0&&(s.textures=c),p.length>0&&(s.images=p)}return s}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.format=e.format,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const r=e.clippingPlanes;let s=null;if(null!==r){const a=r.length;s=new Array(a);for(let c=0;c!==a;++c)s[c]=r[c].clone()}return this.clippingPlanes=s,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}Re.prototype.isMaterial=!0;const Le={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},M={h:0,s:0,l:0},b={h:0,s:0,l:0};function _(h,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?h+6*(e-h)*r:r<.5?e:r<2/3?h+6*(e-h)*(2/3-r):h}function R(h){return h<.04045?.0773993808*h:Math.pow(.9478672986*h+.0521327014,2.4)}function F(h){return h<.0031308?12.92*h:1.055*Math.pow(h,.41666)-.055}let j=(()=>{class h{constructor(r,s,a){return void 0===s&&void 0===a?this.set(r):this.setRGB(r,s,a)}set(r){return r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r),this}setScalar(r){return this.r=r,this.g=r,this.b=r,this}setHex(r){return r=Math.floor(r),this.r=(r>>16&255)/255,this.g=(r>>8&255)/255,this.b=(255&r)/255,this}setRGB(r,s,a){return this.r=r,this.g=s,this.b=a,this}setHSL(r,s,a){if(r=function(h,e){return(h%e+e)%e}(r,1),s=Ts(s,0,1),a=Ts(a,0,1),0===s)this.r=this.g=this.b=a;else{const c=a<=.5?a*(1+s):a+s-a*s,p=2*a-c;this.r=_(p,c,r+1/3),this.g=_(p,c,r),this.b=_(p,c,r-1/3)}return this}setStyle(r){function s(c){void 0!==c&&parseFloat(c)<1&&console.warn("THREE.Color: Alpha component of "+r+" will be ignored.")}let a;if(a=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(r)){let c;const m=a[2];switch(a[1]){case"rgb":case"rgba":if(c=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(m))return this.r=Math.min(255,parseInt(c[1],10))/255,this.g=Math.min(255,parseInt(c[2],10))/255,this.b=Math.min(255,parseInt(c[3],10))/255,s(c[4]),this;if(c=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(m))return this.r=Math.min(100,parseInt(c[1],10))/100,this.g=Math.min(100,parseInt(c[2],10))/100,this.b=Math.min(100,parseInt(c[3],10))/100,s(c[4]),this;break;case"hsl":case"hsla":if(c=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(m)){const x=parseFloat(c[1])/360,E=parseInt(c[2],10)/100,C=parseInt(c[3],10)/100;return s(c[4]),this.setHSL(x,E,C)}}}else if(a=/^\#([A-Fa-f\d]+)$/.exec(r)){const c=a[1],p=c.length;if(3===p)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===p)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}return r&&r.length>0?this.setColorName(r):this}setColorName(r){const s=Le[r.toLowerCase()];return void 0!==s?this.setHex(s):console.warn("THREE.Color: Unknown color "+r),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(r){return this.r=r.r,this.g=r.g,this.b=r.b,this}copyGammaToLinear(r,s=2){return this.r=Math.pow(r.r,s),this.g=Math.pow(r.g,s),this.b=Math.pow(r.b,s),this}copyLinearToGamma(r,s=2){const a=s>0?1/s:1;return this.r=Math.pow(r.r,a),this.g=Math.pow(r.g,a),this.b=Math.pow(r.b,a),this}convertGammaToLinear(r){return this.copyGammaToLinear(this,r),this}convertLinearToGamma(r){return this.copyLinearToGamma(this,r),this}copySRGBToLinear(r){return this.r=R(r.r),this.g=R(r.g),this.b=R(r.b),this}copyLinearToSRGB(r){return this.r=F(r.r),this.g=F(r.g),this.b=F(r.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(r){const s=this.r,a=this.g,c=this.b,p=Math.max(s,a,c),m=Math.min(s,a,c);let x,E;const C=(m+p)/2;if(m===p)x=0,E=0;else{const D=p-m;switch(E=C<=.5?D/(p+m):D/(2-p-m),p){case s:x=(a-c)/D+(a<c?6:0);break;case a:x=(c-s)/D+2;break;case c:x=(s-a)/D+4}x/=6}return r.h=x,r.s=E,r.l=C,r}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(r,s,a){return this.getHSL(M),M.h+=r,M.s+=s,M.l+=a,this.setHSL(M.h,M.s,M.l),this}add(r){return this.r+=r.r,this.g+=r.g,this.b+=r.b,this}addColors(r,s){return this.r=r.r+s.r,this.g=r.g+s.g,this.b=r.b+s.b,this}addScalar(r){return this.r+=r,this.g+=r,this.b+=r,this}sub(r){return this.r=Math.max(0,this.r-r.r),this.g=Math.max(0,this.g-r.g),this.b=Math.max(0,this.b-r.b),this}multiply(r){return this.r*=r.r,this.g*=r.g,this.b*=r.b,this}multiplyScalar(r){return this.r*=r,this.g*=r,this.b*=r,this}lerp(r,s){return this.r+=(r.r-this.r)*s,this.g+=(r.g-this.g)*s,this.b+=(r.b-this.b)*s,this}lerpColors(r,s,a){return this.r=r.r+(s.r-r.r)*a,this.g=r.g+(s.g-r.g)*a,this.b=r.b+(s.b-r.b)*a,this}lerpHSL(r,s){this.getHSL(M),r.getHSL(b);const a=Ja(M.h,b.h,s),c=Ja(M.s,b.s,s),p=Ja(M.l,b.l,s);return this.setHSL(a,c,p),this}equals(r){return r.r===this.r&&r.g===this.g&&r.b===this.b}fromArray(r,s=0){return this.r=r[s],this.g=r[s+1],this.b=r[s+2],this}toArray(r=[],s=0){return r[s]=this.r,r[s+1]=this.g,r[s+2]=this.b,r}fromBufferAttribute(r,s){return this.r=r.getX(s),this.g=r.getY(s),this.b=r.getZ(s),!0===r.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}return h.NAMES=Le,h})();j.prototype.isColor=!0,j.prototype.r=1,j.prototype.g=1,j.prototype.b=1;class oe extends Re{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new j(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}oe.prototype.isMeshBasicMaterial=!0;const ye=new he,lt=new Rt;class Ke{constructor(e,r,s){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=r,this.count=void 0!==e?e.length/r:0,this.normalized=!0===s,this.usage=Ar,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,r,s){e*=this.itemSize,s*=r.itemSize;for(let a=0,c=this.itemSize;a<c;a++)this.array[e+a]=r.array[s+a];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const r=this.array;let s=0;for(let a=0,c=e.length;a<c;a++){let p=e[a];void 0===p&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",a),p=new j),r[s++]=p.r,r[s++]=p.g,r[s++]=p.b}return this}copyVector2sArray(e){const r=this.array;let s=0;for(let a=0,c=e.length;a<c;a++){let p=e[a];void 0===p&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",a),p=new Rt),r[s++]=p.x,r[s++]=p.y}return this}copyVector3sArray(e){const r=this.array;let s=0;for(let a=0,c=e.length;a<c;a++){let p=e[a];void 0===p&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",a),p=new he),r[s++]=p.x,r[s++]=p.y,r[s++]=p.z}return this}copyVector4sArray(e){const r=this.array;let s=0;for(let a=0,c=e.length;a<c;a++){let p=e[a];void 0===p&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",a),p=new di),r[s++]=p.x,r[s++]=p.y,r[s++]=p.z,r[s++]=p.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let r=0,s=this.count;r<s;r++)lt.fromBufferAttribute(this,r),lt.applyMatrix3(e),this.setXY(r,lt.x,lt.y);else if(3===this.itemSize)for(let r=0,s=this.count;r<s;r++)ye.fromBufferAttribute(this,r),ye.applyMatrix3(e),this.setXYZ(r,ye.x,ye.y,ye.z);return this}applyMatrix4(e){for(let r=0,s=this.count;r<s;r++)ye.x=this.getX(r),ye.y=this.getY(r),ye.z=this.getZ(r),ye.applyMatrix4(e),this.setXYZ(r,ye.x,ye.y,ye.z);return this}applyNormalMatrix(e){for(let r=0,s=this.count;r<s;r++)ye.x=this.getX(r),ye.y=this.getY(r),ye.z=this.getZ(r),ye.applyNormalMatrix(e),this.setXYZ(r,ye.x,ye.y,ye.z);return this}transformDirection(e){for(let r=0,s=this.count;r<s;r++)ye.x=this.getX(r),ye.y=this.getY(r),ye.z=this.getZ(r),ye.transformDirection(e),this.setXYZ(r,ye.x,ye.y,ye.z);return this}set(e,r=0){return this.array.set(e,r),this}getX(e){return this.array[e*this.itemSize]}setX(e,r){return this.array[e*this.itemSize]=r,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,r){return this.array[e*this.itemSize+1]=r,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,r){return this.array[e*this.itemSize+2]=r,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,r){return this.array[e*this.itemSize+3]=r,this}setXY(e,r,s){return this.array[0+(e*=this.itemSize)]=r,this.array[e+1]=s,this}setXYZ(e,r,s,a){return this.array[0+(e*=this.itemSize)]=r,this.array[e+1]=s,this.array[e+2]=a,this}setXYZW(e,r,s,a,c){return this.array[0+(e*=this.itemSize)]=r,this.array[e+1]=s,this.array[e+2]=a,this.array[e+3]=c,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Ar&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}Ke.prototype.isBufferAttribute=!0;class vr extends Ke{constructor(e,r,s){super(new Uint16Array(e),r,s)}}class Si extends Ke{constructor(e,r,s){super(new Uint32Array(e),r,s)}}(class extends Ke{constructor(e,r,s){super(new Uint16Array(e),r,s)}}).prototype.isFloat16BufferAttribute=!0;class dn extends Ke{constructor(e,r,s){super(new Float32Array(e),r,s)}}function Ji(h){if(0===h.length)return-1/0;let e=h[0];for(let r=1,s=h.length;r<s;++r)h[r]>e&&(e=h[r]);return e}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;let ot=0;const bn=new Nn,It=new Zr,xn=new he,rn=new bs,Gn=new bs,fn=new he;class jt extends qi{constructor(){super(),Object.defineProperty(this,"id",{value:ot++}),this.uuid=jn(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(Ji(e)>65535?Si:vr)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,r){return this.attributes[e]=r,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,r,s=0){this.groups.push({start:e,count:r,materialIndex:s})}clearGroups(){this.groups=[]}setDrawRange(e,r){this.drawRange.start=e,this.drawRange.count=r}applyMatrix4(e){const r=this.attributes.position;void 0!==r&&(r.applyMatrix4(e),r.needsUpdate=!0);const s=this.attributes.normal;if(void 0!==s){const c=(new ui).getNormalMatrix(e);s.applyNormalMatrix(c),s.needsUpdate=!0}const a=this.attributes.tangent;return void 0!==a&&(a.transformDirection(e),a.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return bn.makeRotationFromQuaternion(e),this.applyMatrix4(bn),this}rotateX(e){return bn.makeRotationX(e),this.applyMatrix4(bn),this}rotateY(e){return bn.makeRotationY(e),this.applyMatrix4(bn),this}rotateZ(e){return bn.makeRotationZ(e),this.applyMatrix4(bn),this}translate(e,r,s){return bn.makeTranslation(e,r,s),this.applyMatrix4(bn),this}scale(e,r,s){return bn.makeScale(e,r,s),this.applyMatrix4(bn),this}lookAt(e){return It.lookAt(e),It.updateMatrix(),this.applyMatrix4(It.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(xn).negate(),this.translate(xn.x,xn.y,xn.z),this}setFromPoints(e){const r=[];for(let s=0,a=e.length;s<a;s++){const c=e[s];r.push(c.x,c.y,c.z||0)}return this.setAttribute("position",new dn(r,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new bs);const e=this.attributes.position,r=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new he(-1/0,-1/0,-1/0),new he(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),r)for(let s=0,a=r.length;s<a;s++)rn.setFromBufferAttribute(r[s]),this.morphTargetsRelative?(fn.addVectors(this.boundingBox.min,rn.min),this.boundingBox.expandByPoint(fn),fn.addVectors(this.boundingBox.max,rn.max),this.boundingBox.expandByPoint(fn)):(this.boundingBox.expandByPoint(rn.min),this.boundingBox.expandByPoint(rn.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ko);const e=this.attributes.position,r=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new he,1/0);if(e){const s=this.boundingSphere.center;if(rn.setFromBufferAttribute(e),r)for(let c=0,p=r.length;c<p;c++)Gn.setFromBufferAttribute(r[c]),this.morphTargetsRelative?(fn.addVectors(rn.min,Gn.min),rn.expandByPoint(fn),fn.addVectors(rn.max,Gn.max),rn.expandByPoint(fn)):(rn.expandByPoint(Gn.min),rn.expandByPoint(Gn.max));rn.getCenter(s);let a=0;for(let c=0,p=e.count;c<p;c++)fn.fromBufferAttribute(e,c),a=Math.max(a,s.distanceToSquared(fn));if(r)for(let c=0,p=r.length;c<p;c++){const m=r[c],x=this.morphTargetsRelative;for(let E=0,C=m.count;E<C;E++)fn.fromBufferAttribute(m,E),x&&(xn.fromBufferAttribute(e,E),fn.add(xn)),a=Math.max(a,s.distanceToSquared(fn))}this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,r=this.attributes;if(null===e||void 0===r.position||void 0===r.normal||void 0===r.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const s=e.array,a=r.position.array,c=r.normal.array,p=r.uv.array,m=a.length/3;void 0===r.tangent&&this.setAttribute("tangent",new Ke(new Float32Array(4*m),4));const x=r.tangent.array,E=[],C=[];for(let nt=0;nt<m;nt++)E[nt]=new he,C[nt]=new he;const D=new he,A=new he,P=new he,L=new Rt,H=new Rt,q=new Rt,k=new he,O=new he;function re(nt,Ge,en){D.fromArray(a,3*nt),A.fromArray(a,3*Ge),P.fromArray(a,3*en),L.fromArray(p,2*nt),H.fromArray(p,2*Ge),q.fromArray(p,2*en),A.sub(D),P.sub(D),H.sub(L),q.sub(L);const bt=1/(H.x*q.y-q.x*H.y);!isFinite(bt)||(k.copy(A).multiplyScalar(q.y).addScaledVector(P,-H.y).multiplyScalar(bt),O.copy(P).multiplyScalar(H.x).addScaledVector(A,-q.x).multiplyScalar(bt),E[nt].add(k),E[Ge].add(k),E[en].add(k),C[nt].add(O),C[Ge].add(O),C[en].add(O))}let ne=this.groups;0===ne.length&&(ne=[{start:0,count:s.length}]);for(let nt=0,Ge=ne.length;nt<Ge;++nt){const en=ne[nt],bt=en.start;for(let Ct=bt,xt=bt+en.count;Ct<xt;Ct+=3)re(s[Ct+0],s[Ct+1],s[Ct+2])}const ve=new he,Ie=new he,ue=new he,je=new he;function wt(nt){ue.fromArray(c,3*nt),je.copy(ue);const Ge=E[nt];ve.copy(Ge),ve.sub(ue.multiplyScalar(ue.dot(Ge))).normalize(),Ie.crossVectors(je,Ge);const bt=Ie.dot(C[nt])<0?-1:1;x[4*nt]=ve.x,x[4*nt+1]=ve.y,x[4*nt+2]=ve.z,x[4*nt+3]=bt}for(let nt=0,Ge=ne.length;nt<Ge;++nt){const en=ne[nt],bt=en.start;for(let Ct=bt,xt=bt+en.count;Ct<xt;Ct+=3)wt(s[Ct+0]),wt(s[Ct+1]),wt(s[Ct+2])}}computeVertexNormals(){const e=this.index,r=this.getAttribute("position");if(void 0!==r){let s=this.getAttribute("normal");if(void 0===s)s=new Ke(new Float32Array(3*r.count),3),this.setAttribute("normal",s);else for(let A=0,P=s.count;A<P;A++)s.setXYZ(A,0,0,0);const a=new he,c=new he,p=new he,m=new he,x=new he,E=new he,C=new he,D=new he;if(e)for(let A=0,P=e.count;A<P;A+=3){const L=e.getX(A+0),H=e.getX(A+1),q=e.getX(A+2);a.fromBufferAttribute(r,L),c.fromBufferAttribute(r,H),p.fromBufferAttribute(r,q),C.subVectors(p,c),D.subVectors(a,c),C.cross(D),m.fromBufferAttribute(s,L),x.fromBufferAttribute(s,H),E.fromBufferAttribute(s,q),m.add(C),x.add(C),E.add(C),s.setXYZ(L,m.x,m.y,m.z),s.setXYZ(H,x.x,x.y,x.z),s.setXYZ(q,E.x,E.y,E.z)}else for(let A=0,P=r.count;A<P;A+=3)a.fromBufferAttribute(r,A+0),c.fromBufferAttribute(r,A+1),p.fromBufferAttribute(r,A+2),C.subVectors(p,c),D.subVectors(a,c),C.cross(D),s.setXYZ(A+0,C.x,C.y,C.z),s.setXYZ(A+1,C.x,C.y,C.z),s.setXYZ(A+2,C.x,C.y,C.z);this.normalizeNormals(),s.needsUpdate=!0}}merge(e,r){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===r&&(r=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const s=this.attributes;for(const a in s){if(void 0===e.attributes[a])continue;const p=s[a].array,m=e.attributes[a],x=m.array,E=m.itemSize*r,C=Math.min(x.length,p.length-E);for(let D=0,A=E;D<C;D++,A++)p[A]=x[D]}return this}normalizeNormals(){const e=this.attributes.normal;for(let r=0,s=e.count;r<s;r++)fn.fromBufferAttribute(e,r),fn.normalize(),e.setXYZ(r,fn.x,fn.y,fn.z)}toNonIndexed(){function e(m,x){const E=m.array,C=m.itemSize,D=m.normalized,A=new E.constructor(x.length*C);let P=0,L=0;for(let H=0,q=x.length;H<q;H++){P=m.isInterleavedBufferAttribute?x[H]*m.data.stride+m.offset:x[H]*C;for(let k=0;k<C;k++)A[L++]=E[P++]}return new Ke(A,C,D)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const r=new jt,s=this.index.array,a=this.attributes;for(const m in a){const E=e(a[m],s);r.setAttribute(m,E)}const c=this.morphAttributes;for(const m in c){const x=[],E=c[m];for(let C=0,D=E.length;C<D;C++){const P=e(E[C],s);x.push(P)}r.morphAttributes[m]=x}r.morphTargetsRelative=this.morphTargetsRelative;const p=this.groups;for(let m=0,x=p.length;m<x;m++){const E=p[m];r.addGroup(E.start,E.count,E.materialIndex)}return r}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const x=this.parameters;for(const E in x)void 0!==x[E]&&(e[E]=x[E]);return e}e.data={attributes:{}};const r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});const s=this.attributes;for(const x in s)e.data.attributes[x]=s[x].toJSON(e.data);const a={};let c=!1;for(const x in this.morphAttributes){const E=this.morphAttributes[x],C=[];for(let D=0,A=E.length;D<A;D++)C.push(E[D].toJSON(e.data));C.length>0&&(a[x]=C,c=!0)}c&&(e.data.morphAttributes=a,e.data.morphTargetsRelative=this.morphTargetsRelative);const p=this.groups;p.length>0&&(e.data.groups=JSON.parse(JSON.stringify(p)));const m=this.boundingSphere;return null!==m&&(e.data.boundingSphere={center:m.center.toArray(),radius:m.radius}),e}clone(){return(new jt).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const r={};this.name=e.name;const s=e.index;null!==s&&this.setIndex(s.clone(r));const a=e.attributes;for(const E in a)this.setAttribute(E,a[E].clone(r));const c=e.morphAttributes;for(const E in c){const C=[],D=c[E];for(let A=0,P=D.length;A<P;A++)C.push(D[A].clone(r));this.morphAttributes[E]=C}this.morphTargetsRelative=e.morphTargetsRelative;const p=e.groups;for(let E=0,C=p.length;E<C;E++){const D=p[E];this.addGroup(D.start,D.count,D.materialIndex)}const m=e.boundingBox;null!==m&&(this.boundingBox=m.clone());const x=e.boundingSphere;return null!==x&&(this.boundingSphere=x.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}jt.prototype.isBufferGeometry=!0;const mr=new Nn,fi=new Gs,li=new ko,Ci=new he,Ri=new he,Ir=new he,ms=new he,la=new he,Zl=new he,Mu=new he,Su=new he,Sa=new he,Ni=new Rt,Ql=new Rt,ll=new Rt,Pr=new he,ls=new he;class cs extends Zr{constructor(e=new jt,r=new oe){super(),this.type="Mesh",this.geometry=e,this.material=r,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const r=e.morphAttributes,s=Object.keys(r);if(s.length>0){const a=r[s[0]];if(void 0!==a){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let c=0,p=a.length;c<p;c++){const m=a[c].name||String(c);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=c}}}}else{const r=e.morphTargets;void 0!==r&&r.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,r){const s=this.geometry,a=this.material,c=this.matrixWorld;if(void 0===a||(null===s.boundingSphere&&s.computeBoundingSphere(),li.copy(s.boundingSphere),li.applyMatrix4(c),!1===e.ray.intersectsSphere(li))||(mr.copy(c).invert(),fi.copy(e.ray).applyMatrix4(mr),null!==s.boundingBox&&!1===fi.intersectsBox(s.boundingBox)))return;let p;if(s.isBufferGeometry){const m=s.index,x=s.attributes.position,E=s.morphAttributes.position,C=s.morphTargetsRelative,D=s.attributes.uv,A=s.attributes.uv2,P=s.groups,L=s.drawRange;if(null!==m)if(Array.isArray(a))for(let H=0,q=P.length;H<q;H++){const k=P[H],O=a[k.materialIndex];for(let ve=Math.max(k.start,L.start),Ie=Math.min(k.start+k.count,L.start+L.count);ve<Ie;ve+=3){const ue=m.getX(ve),je=m.getX(ve+1),wt=m.getX(ve+2);p=If(this,O,e,fi,x,E,C,D,A,ue,je,wt),p&&(p.faceIndex=Math.floor(ve/3),p.face.materialIndex=k.materialIndex,r.push(p))}}else for(let k=Math.max(0,L.start),O=Math.min(m.count,L.start+L.count);k<O;k+=3){const re=m.getX(k),ne=m.getX(k+1),ve=m.getX(k+2);p=If(this,a,e,fi,x,E,C,D,A,re,ne,ve),p&&(p.faceIndex=Math.floor(k/3),r.push(p))}else if(void 0!==x)if(Array.isArray(a))for(let H=0,q=P.length;H<q;H++){const k=P[H],O=a[k.materialIndex];for(let ve=Math.max(k.start,L.start),Ie=Math.min(k.start+k.count,L.start+L.count);ve<Ie;ve+=3)p=If(this,O,e,fi,x,E,C,D,A,ve,ve+1,ve+2),p&&(p.faceIndex=Math.floor(ve/3),p.face.materialIndex=k.materialIndex,r.push(p))}else for(let k=Math.max(0,L.start),O=Math.min(x.count,L.start+L.count);k<O;k+=3)p=If(this,a,e,fi,x,E,C,D,A,k,k+1,k+2),p&&(p.faceIndex=Math.floor(k/3),r.push(p))}else s.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function If(h,e,r,s,a,c,p,m,x,E,C,D){Ci.fromBufferAttribute(a,E),Ri.fromBufferAttribute(a,C),Ir.fromBufferAttribute(a,D);const A=h.morphTargetInfluences;if(c&&A){Mu.set(0,0,0),Su.set(0,0,0),Sa.set(0,0,0);for(let L=0,H=c.length;L<H;L++){const q=A[L],k=c[L];0!==q&&(ms.fromBufferAttribute(k,E),la.fromBufferAttribute(k,C),Zl.fromBufferAttribute(k,D),p?(Mu.addScaledVector(ms,q),Su.addScaledVector(la,q),Sa.addScaledVector(Zl,q)):(Mu.addScaledVector(ms.sub(Ci),q),Su.addScaledVector(la.sub(Ri),q),Sa.addScaledVector(Zl.sub(Ir),q)))}Ci.add(Mu),Ri.add(Su),Ir.add(Sa)}h.isSkinnedMesh&&(h.boneTransform(E,Ci),h.boneTransform(C,Ri),h.boneTransform(D,Ir));const P=function(h,e,r,s,a,c,p,m){let x;if(x=e.side===Ve?s.intersectTriangle(p,c,a,!0,m):s.intersectTriangle(a,c,p,2!==e.side,m),null===x)return null;ls.copy(m),ls.applyMatrix4(h.matrixWorld);const E=r.ray.origin.distanceTo(ls);return E<r.near||E>r.far?null:{distance:E,point:ls.clone(),object:h}}(h,e,r,s,Ci,Ri,Ir,Pr);if(P){m&&(Ni.fromBufferAttribute(m,E),Ql.fromBufferAttribute(m,C),ll.fromBufferAttribute(m,D),P.uv=le.getUV(Pr,Ci,Ri,Ir,Ni,Ql,ll,new Rt)),x&&(Ni.fromBufferAttribute(x,E),Ql.fromBufferAttribute(x,C),ll.fromBufferAttribute(x,D),P.uv2=le.getUV(Pr,Ci,Ri,Ir,Ni,Ql,ll,new Rt));const L={a:E,b:C,c:D,normal:new he,materialIndex:0};le.getNormal(Ci,Ri,Ir,L.normal),P.face=L}return P}cs.prototype.isMesh=!0;class Cu extends jt{constructor(e=1,r=1,s=1,a=1,c=1,p=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:r,depth:s,widthSegments:a,heightSegments:c,depthSegments:p};const m=this;a=Math.floor(a),c=Math.floor(c),p=Math.floor(p);const x=[],E=[],C=[],D=[];let A=0,P=0;function L(H,q,k,O,re,ne,ve,Ie,ue,je,wt){const nt=ne/ue,Ge=ve/je,en=ne/2,bt=ve/2,_t=Ie/2,Ct=ue+1,xt=je+1;let Pt=0,wn=0;const ir=new he;for(let fr=0;fr<xt;fr++){const Bn=fr*Ge-bt;for(let Dr=0;Dr<Ct;Dr++)ir[H]=(Dr*nt-en)*O,ir[q]=Bn*re,ir[k]=_t,E.push(ir.x,ir.y,ir.z),ir[H]=0,ir[q]=0,ir[k]=Ie>0?1:-1,C.push(ir.x,ir.y,ir.z),D.push(Dr/ue),D.push(1-fr/je),Pt+=1}for(let fr=0;fr<je;fr++)for(let Bn=0;Bn<ue;Bn++){const Yt=A+Bn+Ct*(fr+1),Fn=A+(Bn+1)+Ct*(fr+1),Kn=A+(Bn+1)+Ct*fr;x.push(A+Bn+Ct*fr,Yt,Kn),x.push(Yt,Fn,Kn),wn+=6}m.addGroup(P,wn,wt),P+=wn,A+=Pt}L("z","y","x",-1,-1,s,r,e,p,c,0),L("z","y","x",1,-1,s,r,-e,p,c,1),L("x","z","y",1,1,e,s,r,a,p,2),L("x","z","y",1,-1,e,s,-r,a,p,3),L("x","y","z",1,-1,e,r,s,a,c,4),L("x","y","z",-1,-1,e,r,-s,a,c,5),this.setIndex(x),this.setAttribute("position",new dn(E,3)),this.setAttribute("normal",new dn(C,3)),this.setAttribute("uv",new dn(D,2))}static fromJSON(e){return new Cu(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function nd(h){const e={};for(const r in h){e[r]={};for(const s in h[r]){const a=h[r][s];e[r][s]=a&&(a.isColor||a.isMatrix3||a.isMatrix4||a.isVector2||a.isVector3||a.isVector4||a.isTexture||a.isQuaternion)?a.clone():Array.isArray(a)?a.slice():a}}return e}function js(h){const e={};for(let r=0;r<h.length;r++){const s=nd(h[r]);for(const a in s)e[a]=s[a]}return e}const Tu={clone:nd,merge:js};class Ba extends Re{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=nd(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const r=super.toJSON(e);r.glslVersion=this.glslVersion,r.uniforms={};for(const a in this.uniforms){const p=this.uniforms[a].value;r.uniforms[a]=p&&p.isTexture?{type:"t",value:p.toJSON(e).uuid}:p&&p.isColor?{type:"c",value:p.getHex()}:p&&p.isVector2?{type:"v2",value:p.toArray()}:p&&p.isVector3?{type:"v3",value:p.toArray()}:p&&p.isVector4?{type:"v4",value:p.toArray()}:p&&p.isMatrix3?{type:"m3",value:p.toArray()}:p&&p.isMatrix4?{type:"m4",value:p.toArray()}:{value:p}}Object.keys(this.defines).length>0&&(r.defines=this.defines),r.vertexShader=this.vertexShader,r.fragmentShader=this.fragmentShader;const s={};for(const a in this.extensions)!0===this.extensions[a]&&(s[a]=!0);return Object.keys(s).length>0&&(r.extensions=s),r}}Ba.prototype.isShaderMaterial=!0;class id extends Zr{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Nn,this.projectionMatrix=new Nn,this.projectionMatrixInverse=new Nn}copy(e,r){return super.copy(e,r),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const r=this.matrixWorld.elements;return e.set(-r[8],-r[9],-r[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,r){super.updateWorldMatrix(e,r),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}id.prototype.isCamera=!0;class xs extends id{constructor(e=50,r=1,s=.1,a=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=s,this.far=a,this.focus=10,this.aspect=r,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,r){return super.copy(e,r),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const r=.5*this.getFilmHeight()/e;this.fov=2*sa*Math.atan(r),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Po*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*sa*Math.atan(Math.tan(.5*Po*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,r,s,a,c,p){this.aspect=e/r,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=r,this.view.offsetX=s,this.view.offsetY=a,this.view.width=c,this.view.height=p,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let r=e*Math.tan(.5*Po*this.fov)/this.zoom,s=2*r,a=this.aspect*s,c=-.5*a;const p=this.view;if(null!==this.view&&this.view.enabled){const x=p.fullWidth,E=p.fullHeight;c+=p.offsetX*a/x,r-=p.offsetY*s/E,a*=p.width/x,s*=p.height/E}const m=this.filmOffset;0!==m&&(c+=e*m/this.getFilmWidth()),this.projectionMatrix.makePerspective(c,c+a,r,r-s,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const r=super.toJSON(e);return r.object.fov=this.fov,r.object.zoom=this.zoom,r.object.near=this.near,r.object.far=this.far,r.object.focus=this.focus,r.object.aspect=this.aspect,null!==this.view&&(r.object.view=Object.assign({},this.view)),r.object.filmGauge=this.filmGauge,r.object.filmOffset=this.filmOffset,r}}xs.prototype.isPerspectiveCamera=!0;class Dh extends Zr{constructor(e,r,s){if(super(),this.type="CubeCamera",!0!==s.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=s;const a=new xs(90,1,e,r);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new he(1,0,0)),this.add(a);const c=new xs(90,1,e,r);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new he(-1,0,0)),this.add(c);const p=new xs(90,1,e,r);p.layers=this.layers,p.up.set(0,0,1),p.lookAt(new he(0,1,0)),this.add(p);const m=new xs(90,1,e,r);m.layers=this.layers,m.up.set(0,0,-1),m.lookAt(new he(0,-1,0)),this.add(m);const x=new xs(90,1,e,r);x.layers=this.layers,x.up.set(0,-1,0),x.lookAt(new he(0,0,1)),this.add(x);const E=new xs(90,1,e,r);E.layers=this.layers,E.up.set(0,-1,0),E.lookAt(new he(0,0,-1)),this.add(E)}update(e,r){null===this.parent&&this.updateMatrixWorld();const s=this.renderTarget,[a,c,p,m,x,E]=this.children,C=e.xr.enabled,D=e.getRenderTarget();e.xr.enabled=!1;const A=s.texture.generateMipmaps;s.texture.generateMipmaps=!1,e.setRenderTarget(s,0),e.render(r,a),e.setRenderTarget(s,1),e.render(r,c),e.setRenderTarget(s,2),e.render(r,p),e.setRenderTarget(s,3),e.render(r,m),e.setRenderTarget(s,4),e.render(r,x),s.texture.generateMipmaps=A,e.setRenderTarget(s,5),e.render(r,E),e.setRenderTarget(D),e.xr.enabled=C}}class Mc extends As{constructor(e,r,s,a,c,p,m,x,E,C){super(e=void 0!==e?e:[],r=void 0!==r?r:301,s,a,c,p,m=void 0!==m?m:Zs,x,E,C),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}Mc.prototype.isCubeTexture=!0;class Rh extends No{constructor(e,r,s){Number.isInteger(r)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),r=s),super(e,e,r),this.texture=new Mc(void 0,(r=r||{}).mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,this.texture.minFilter=void 0!==r.minFilter?r.minFilter:zn,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(e,r){this.texture.type=r.type,this.texture.format=ds,this.texture.encoding=r.encoding,this.texture.generateMipmaps=r.generateMipmaps,this.texture.minFilter=r.minFilter,this.texture.magFilter=r.magFilter;const s_uniforms={tEquirect:{value:null}},s_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",s_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",a=new Cu(5,5,5),c=new Ba({name:"CubemapFromEquirect",uniforms:nd(s_uniforms),vertexShader:s_vertexShader,fragmentShader:s_fragmentShader,side:Ve,blending:0});c.uniforms.tEquirect.value=r;const p=new cs(a,c),m=r.minFilter;return 1008===r.minFilter&&(r.minFilter=zn),new Dh(1,10,this).update(e,p),r.minFilter=m,p.geometry.dispose(),p.material.dispose(),this}clear(e,r,s,a){const c=e.getRenderTarget();for(let p=0;p<6;p++)e.setRenderTarget(this,p),e.clear(r,s,a);e.setRenderTarget(c)}}Rh.prototype.isWebGLCubeRenderTarget=!0;const ad=new he,Au=new he,Xc=new ui;class Kl{constructor(e=new he(1,0,0),r=0){this.normal=e,this.constant=r}set(e,r){return this.normal.copy(e),this.constant=r,this}setComponents(e,r,s,a){return this.normal.set(e,r,s),this.constant=a,this}setFromNormalAndCoplanarPoint(e,r){return this.normal.copy(e),this.constant=-r.dot(this.normal),this}setFromCoplanarPoints(e,r,s){const a=ad.subVectors(s,r).cross(Au.subVectors(e,r)).normalize();return this.setFromNormalAndCoplanarPoint(a,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,r){return r.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,r){const s=e.delta(ad),a=this.normal.dot(s);if(0===a)return 0===this.distanceToPoint(e.start)?r.copy(e.start):null;const c=-(e.start.dot(this.normal)+this.constant)/a;return c<0||c>1?null:r.copy(s).multiplyScalar(c).add(e.start)}intersectsLine(e){const r=this.distanceToPoint(e.start),s=this.distanceToPoint(e.end);return r<0&&s>0||s<0&&r>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,r){const s=r||Xc.getNormalMatrix(e),a=this.coplanarPoint(ad).applyMatrix4(e),c=this.normal.applyMatrix3(s).normalize();return this.constant=-a.dot(c),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}Kl.prototype.isPlane=!0;const us=new ko,$d=new he;class Ih{constructor(e=new Kl,r=new Kl,s=new Kl,a=new Kl,c=new Kl,p=new Kl){this.planes=[e,r,s,a,c,p]}set(e,r,s,a,c,p){const m=this.planes;return m[0].copy(e),m[1].copy(r),m[2].copy(s),m[3].copy(a),m[4].copy(c),m[5].copy(p),this}copy(e){const r=this.planes;for(let s=0;s<6;s++)r[s].copy(e.planes[s]);return this}setFromProjectionMatrix(e){const r=this.planes,s=e.elements,a=s[0],c=s[1],p=s[2],m=s[3],x=s[4],E=s[5],C=s[6],D=s[7],A=s[8],P=s[9],L=s[10],H=s[11],q=s[12],k=s[13],O=s[14],re=s[15];return r[0].setComponents(m-a,D-x,H-A,re-q).normalize(),r[1].setComponents(m+a,D+x,H+A,re+q).normalize(),r[2].setComponents(m+c,D+E,H+P,re+k).normalize(),r[3].setComponents(m-c,D-E,H-P,re-k).normalize(),r[4].setComponents(m-p,D-C,H-L,re-O).normalize(),r[5].setComponents(m+p,D+C,H+L,re+O).normalize(),this}intersectsObject(e){const r=e.geometry;return null===r.boundingSphere&&r.computeBoundingSphere(),us.copy(r.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(us)}intersectsSprite(e){return us.center.set(0,0,0),us.radius=.7071067811865476,us.applyMatrix4(e.matrixWorld),this.intersectsSphere(us)}intersectsSphere(e){const r=this.planes,s=e.center,a=-e.radius;for(let c=0;c<6;c++)if(r[c].distanceToPoint(s)<a)return!1;return!0}intersectsBox(e){const r=this.planes;for(let s=0;s<6;s++){const a=r[s];if($d.x=a.normal.x>0?e.max.x:e.min.x,$d.y=a.normal.y>0?e.max.y:e.min.y,$d.z=a.normal.z>0?e.max.z:e.min.z,a.distanceToPoint($d)<0)return!1}return!0}containsPoint(e){const r=this.planes;for(let s=0;s<6;s++)if(r[s].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Zc(){let h=null,e=!1,r=null,s=null;function a(c,p){r(c,p),s=h.requestAnimationFrame(a)}return{start:function(){!0!==e&&null!==r&&(s=h.requestAnimationFrame(a),e=!0)},stop:function(){h.cancelAnimationFrame(s),e=!1},setAnimationLoop:function(c){r=c},setContext:function(c){h=c}}}function qd(h,e){const r=e.isWebGL2,s=new WeakMap;return{get:function(E){return E.isInterleavedBufferAttribute&&(E=E.data),s.get(E)},remove:function(E){E.isInterleavedBufferAttribute&&(E=E.data);const C=s.get(E);C&&(h.deleteBuffer(C.buffer),s.delete(E))},update:function(E,C){if(E.isGLBufferAttribute){const A=s.get(E);return void((!A||A.version<E.version)&&s.set(E,{buffer:E.buffer,type:E.type,bytesPerElement:E.elementSize,version:E.version}))}E.isInterleavedBufferAttribute&&(E=E.data);const D=s.get(E);void 0===D?s.set(E,function(E,C){const D=E.array,A=E.usage,P=h.createBuffer();h.bindBuffer(C,P),h.bufferData(C,D,A),E.onUploadCallback();let L=5126;return D instanceof Float32Array?L=5126:D instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):D instanceof Uint16Array?E.isFloat16BufferAttribute?r?L=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):L=5123:D instanceof Int16Array?L=5122:D instanceof Uint32Array?L=5125:D instanceof Int32Array?L=5124:D instanceof Int8Array?L=5120:(D instanceof Uint8Array||D instanceof Uint8ClampedArray)&&(L=5121),{buffer:P,type:L,bytesPerElement:D.BYTES_PER_ELEMENT,version:E.version}}(E,C)):D.version<E.version&&(function(E,C,D){const A=C.array,P=C.updateRange;h.bindBuffer(D,E),-1===P.count?h.bufferSubData(D,0,A):(r?h.bufferSubData(D,P.offset*A.BYTES_PER_ELEMENT,A,P.offset,P.count):h.bufferSubData(D,P.offset*A.BYTES_PER_ELEMENT,A.subarray(P.offset,P.offset+P.count)),P.count=-1)}(D.buffer,E,C),D.version=E.version)}}}class Yd extends jt{constructor(e=1,r=1,s=1,a=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:r,widthSegments:s,heightSegments:a};const c=e/2,p=r/2,m=Math.floor(s),x=Math.floor(a),E=m+1,C=x+1,D=e/m,A=r/x,P=[],L=[],H=[],q=[];for(let k=0;k<C;k++){const O=k*A-p;for(let re=0;re<E;re++)L.push(re*D-c,-O,0),H.push(0,0,1),q.push(re/m),q.push(1-k/x)}for(let k=0;k<x;k++)for(let O=0;O<m;O++){const ne=O+E*(k+1),ve=O+1+E*(k+1),Ie=O+1+E*k;P.push(O+E*k,ne,Ie),P.push(ne,ve,Ie)}this.setIndex(P),this.setAttribute("position",new dn(L,3)),this.setAttribute("normal",new dn(H,3)),this.setAttribute("uv",new dn(q,2))}static fromJSON(e){return new Yd(e.width,e.height,e.widthSegments,e.heightSegments)}}const Sn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotVH = saturate( dot( geometry.viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float NoH ) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float NoV, float NoL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( NoL + NoV - NoL * NoV ) ) );\n}\nvec3 BRDF_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in GeometricContext geometry ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularTintFactor = specularTint;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARTINTMAP\n\t\t\tspecularTintFactor *= specularTintMapTexelToLinear( texture2D( specularTintMap, vUv ) ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularTintFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularTintFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenTint = sheenTint;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenTint;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += irradiance * BRDF_Sheen( material.roughness, directLight.direction, geometry, material.sheenTint );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationTint, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = transmission.a;\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationTint;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( float roughness, float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,\n\t\tvec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,\n\t\tvec3 attenuationColor, float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularTint;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARTINTMAP\n\t\tuniform sampler2D specularTintMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenTint;\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - clearcoat * Fcc ) + clearcoatSpecular * clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Ft={common:{diffuse:{value:new j(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ui},uv2Transform:{value:new ui},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Rt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new j(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new j(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ui}},sprite:{diffuse:{value:new j(16777215)},opacity:{value:1},center:{value:new Rt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ui}}},Nr={basic:{uniforms:js([Ft.common,Ft.specularmap,Ft.envmap,Ft.aomap,Ft.lightmap,Ft.fog]),vertexShader:Sn.meshbasic_vert,fragmentShader:Sn.meshbasic_frag},lambert:{uniforms:js([Ft.common,Ft.specularmap,Ft.envmap,Ft.aomap,Ft.lightmap,Ft.emissivemap,Ft.fog,Ft.lights,{emissive:{value:new j(0)}}]),vertexShader:Sn.meshlambert_vert,fragmentShader:Sn.meshlambert_frag},phong:{uniforms:js([Ft.common,Ft.specularmap,Ft.envmap,Ft.aomap,Ft.lightmap,Ft.emissivemap,Ft.bumpmap,Ft.normalmap,Ft.displacementmap,Ft.fog,Ft.lights,{emissive:{value:new j(0)},specular:{value:new j(1118481)},shininess:{value:30}}]),vertexShader:Sn.meshphong_vert,fragmentShader:Sn.meshphong_frag},standard:{uniforms:js([Ft.common,Ft.envmap,Ft.aomap,Ft.lightmap,Ft.emissivemap,Ft.bumpmap,Ft.normalmap,Ft.displacementmap,Ft.roughnessmap,Ft.metalnessmap,Ft.fog,Ft.lights,{emissive:{value:new j(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Sn.meshphysical_vert,fragmentShader:Sn.meshphysical_frag},toon:{uniforms:js([Ft.common,Ft.aomap,Ft.lightmap,Ft.emissivemap,Ft.bumpmap,Ft.normalmap,Ft.displacementmap,Ft.gradientmap,Ft.fog,Ft.lights,{emissive:{value:new j(0)}}]),vertexShader:Sn.meshtoon_vert,fragmentShader:Sn.meshtoon_frag},matcap:{uniforms:js([Ft.common,Ft.bumpmap,Ft.normalmap,Ft.displacementmap,Ft.fog,{matcap:{value:null}}]),vertexShader:Sn.meshmatcap_vert,fragmentShader:Sn.meshmatcap_frag},points:{uniforms:js([Ft.points,Ft.fog]),vertexShader:Sn.points_vert,fragmentShader:Sn.points_frag},dashed:{uniforms:js([Ft.common,Ft.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Sn.linedashed_vert,fragmentShader:Sn.linedashed_frag},depth:{uniforms:js([Ft.common,Ft.displacementmap]),vertexShader:Sn.depth_vert,fragmentShader:Sn.depth_frag},normal:{uniforms:js([Ft.common,Ft.bumpmap,Ft.normalmap,Ft.displacementmap,{opacity:{value:1}}]),vertexShader:Sn.meshnormal_vert,fragmentShader:Sn.meshnormal_frag},sprite:{uniforms:js([Ft.sprite,Ft.fog]),vertexShader:Sn.sprite_vert,fragmentShader:Sn.sprite_frag},background:{uniforms:{uvTransform:{value:new ui},t2D:{value:null}},vertexShader:Sn.background_vert,fragmentShader:Sn.background_frag},cube:{uniforms:js([Ft.envmap,{opacity:{value:1}}]),vertexShader:Sn.cube_vert,fragmentShader:Sn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Sn.equirect_vert,fragmentShader:Sn.equirect_frag},distanceRGBA:{uniforms:js([Ft.common,Ft.displacementmap,{referencePosition:{value:new he},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Sn.distanceRGBA_vert,fragmentShader:Sn.distanceRGBA_frag},shadow:{uniforms:js([Ft.lights,Ft.fog,{color:{value:new j(0)},opacity:{value:1}}]),vertexShader:Sn.shadow_vert,fragmentShader:Sn.shadow_frag}};function zi(h,e,r,s,a){const c=new j(0);let m,x,p=0,E=null,C=0,D=null;function P(L,H){r.buffers.color.setClear(L.r,L.g,L.b,H,a)}return{getClearColor:function(){return c},setClearColor:function(L,H=1){c.set(L),p=H,P(c,p)},getClearAlpha:function(){return p},setClearAlpha:function(L){p=L,P(c,p)},render:function(L,H){let q=!1,k=!0===H.isScene?H.background:null;k&&k.isTexture&&(k=e.get(k));const O=h.xr,re=O.getSession&&O.getSession();re&&"additive"===re.environmentBlendMode&&(k=null),null===k?P(c,p):k&&k.isColor&&(P(k,1),q=!0),(h.autoClear||q)&&h.clear(h.autoClearColor,h.autoClearDepth,h.autoClearStencil),k&&(k.isCubeTexture||306===k.mapping)?(void 0===x&&(x=new cs(new Cu(1,1,1),new Ba({name:"BackgroundCubeMaterial",uniforms:nd(Nr.cube.uniforms),vertexShader:Nr.cube.vertexShader,fragmentShader:Nr.cube.fragmentShader,side:Ve,depthTest:!1,depthWrite:!1,fog:!1})),x.geometry.deleteAttribute("normal"),x.geometry.deleteAttribute("uv"),x.onBeforeRender=function(ne,ve,Ie){this.matrixWorld.copyPosition(Ie.matrixWorld)},Object.defineProperty(x.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(x)),x.material.uniforms.envMap.value=k,x.material.uniforms.flipEnvMap.value=k.isCubeTexture&&!1===k.isRenderTargetTexture?-1:1,(E!==k||C!==k.version||D!==h.toneMapping)&&(x.material.needsUpdate=!0,E=k,C=k.version,D=h.toneMapping),L.unshift(x,x.geometry,x.material,0,0,null)):k&&k.isTexture&&(void 0===m&&(m=new cs(new Yd(2,2),new Ba({name:"BackgroundMaterial",uniforms:nd(Nr.background.uniforms),vertexShader:Nr.background.vertexShader,fragmentShader:Nr.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),Object.defineProperty(m.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(m)),m.material.uniforms.t2D.value=k,!0===k.matrixAutoUpdate&&k.updateMatrix(),m.material.uniforms.uvTransform.value.copy(k.matrix),(E!==k||C!==k.version||D!==h.toneMapping)&&(m.material.needsUpdate=!0,E=k,C=k.version,D=h.toneMapping),L.unshift(m,m.geometry,m.material,0,0,null))}}}function ho(h,e,r,s){const a=h.getParameter(34921),c=s.isWebGL2?null:e.get("OES_vertex_array_object"),p=s.isWebGL2||null!==c,m={},x=H(null);let E=x;function A(bt){return s.isWebGL2?h.bindVertexArray(bt):c.bindVertexArrayOES(bt)}function P(bt){return s.isWebGL2?h.deleteVertexArray(bt):c.deleteVertexArrayOES(bt)}function H(bt){const _t=[],Ct=[],xt=[];for(let Pt=0;Pt<a;Pt++)_t[Pt]=0,Ct[Pt]=0,xt[Pt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:_t,enabledAttributes:Ct,attributeDivisors:xt,object:bt,attributes:{},index:null}}function O(){const bt=E.newAttributes;for(let _t=0,Ct=bt.length;_t<Ct;_t++)bt[_t]=0}function re(bt){ne(bt,0)}function ne(bt,_t){const xt=E.enabledAttributes,Pt=E.attributeDivisors;E.newAttributes[bt]=1,0===xt[bt]&&(h.enableVertexAttribArray(bt),xt[bt]=1),Pt[bt]!==_t&&((s.isWebGL2?h:e.get("ANGLE_instanced_arrays"))[s.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](bt,_t),Pt[bt]=_t)}function ve(){const bt=E.newAttributes,_t=E.enabledAttributes;for(let Ct=0,xt=_t.length;Ct<xt;Ct++)_t[Ct]!==bt[Ct]&&(h.disableVertexAttribArray(Ct),_t[Ct]=0)}function Ie(bt,_t,Ct,xt,Pt,wn){!0!==s.isWebGL2||5124!==Ct&&5125!==Ct?h.vertexAttribPointer(bt,_t,Ct,xt,Pt,wn):h.vertexAttribIPointer(bt,_t,Ct,Pt,wn)}function Ge(){en(),E!==x&&(E=x,A(E.object))}function en(){x.geometry=null,x.program=null,x.wireframe=!1}return{setup:function(bt,_t,Ct,xt,Pt){let wn=!1;if(p){const ir=function(bt,_t,Ct){const xt=!0===Ct.wireframe;let Pt=m[bt.id];void 0===Pt&&(Pt={},m[bt.id]=Pt);let wn=Pt[_t.id];void 0===wn&&(wn={},Pt[_t.id]=wn);let ir=wn[xt];return void 0===ir&&(ir=H(s.isWebGL2?h.createVertexArray():c.createVertexArrayOES()),wn[xt]=ir),ir}(xt,Ct,_t);E!==ir&&(E=ir,A(E.object)),wn=function(bt,_t){const Ct=E.attributes,xt=bt.attributes;let Pt=0;for(const wn in xt){const ir=Ct[wn],fr=xt[wn];if(void 0===ir||ir.attribute!==fr||ir.data!==fr.data)return!0;Pt++}return E.attributesNum!==Pt||E.index!==_t}(xt,Pt),wn&&function(bt,_t){const Ct={},xt=bt.attributes;let Pt=0;for(const wn in xt){const ir=xt[wn],fr={};fr.attribute=ir,ir.data&&(fr.data=ir.data),Ct[wn]=fr,Pt++}E.attributes=Ct,E.attributesNum=Pt,E.index=_t}(xt,Pt)}else{const ir=!0===_t.wireframe;(E.geometry!==xt.id||E.program!==Ct.id||E.wireframe!==ir)&&(E.geometry=xt.id,E.program=Ct.id,E.wireframe=ir,wn=!0)}!0===bt.isInstancedMesh&&(wn=!0),null!==Pt&&r.update(Pt,34963),wn&&(function(bt,_t,Ct,xt){if(!1===s.isWebGL2&&(bt.isInstancedMesh||xt.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;O();const Pt=xt.attributes,wn=Ct.getAttributes(),ir=_t.defaultAttributeValues;for(const fr in wn){const Bn=wn[fr];if(Bn.location>=0){let Dr=Pt[fr];if(void 0===Dr&&("instanceMatrix"===fr&&bt.instanceMatrix&&(Dr=bt.instanceMatrix),"instanceColor"===fr&&bt.instanceColor&&(Dr=bt.instanceColor)),void 0!==Dr){const Yt=Dr.normalized,Fn=Dr.itemSize,Kn=r.get(Dr);if(void 0===Kn)continue;const yt=Kn.buffer,gr=Kn.type,kr=Kn.bytesPerElement;if(Dr.isInterleavedBufferAttribute){const sr=Dr.data,lr=sr.stride,$r=Dr.offset;if(sr&&sr.isInstancedInterleavedBuffer){for(let At=0;At<Bn.locationSize;At++)ne(Bn.location+At,sr.meshPerAttribute);!0!==bt.isInstancedMesh&&void 0===xt._maxInstanceCount&&(xt._maxInstanceCount=sr.meshPerAttribute*sr.count)}else for(let At=0;At<Bn.locationSize;At++)re(Bn.location+At);h.bindBuffer(34962,yt);for(let At=0;At<Bn.locationSize;At++)Ie(Bn.location+At,Fn/Bn.locationSize,gr,Yt,lr*kr,($r+Fn/Bn.locationSize*At)*kr)}else{if(Dr.isInstancedBufferAttribute){for(let sr=0;sr<Bn.locationSize;sr++)ne(Bn.location+sr,Dr.meshPerAttribute);!0!==bt.isInstancedMesh&&void 0===xt._maxInstanceCount&&(xt._maxInstanceCount=Dr.meshPerAttribute*Dr.count)}else for(let sr=0;sr<Bn.locationSize;sr++)re(Bn.location+sr);h.bindBuffer(34962,yt);for(let sr=0;sr<Bn.locationSize;sr++)Ie(Bn.location+sr,Fn/Bn.locationSize,gr,Yt,Fn*kr,Fn/Bn.locationSize*sr*kr)}}else if(void 0!==ir){const Yt=ir[fr];if(void 0!==Yt)switch(Yt.length){case 2:h.vertexAttrib2fv(Bn.location,Yt);break;case 3:h.vertexAttrib3fv(Bn.location,Yt);break;case 4:h.vertexAttrib4fv(Bn.location,Yt);break;default:h.vertexAttrib1fv(Bn.location,Yt)}}}}ve()}(bt,_t,Ct,xt),null!==Pt&&h.bindBuffer(34963,r.get(Pt).buffer))},reset:Ge,resetDefaultState:en,dispose:function(){Ge();for(const bt in m){const _t=m[bt];for(const Ct in _t){const xt=_t[Ct];for(const Pt in xt)P(xt[Pt].object),delete xt[Pt];delete _t[Ct]}delete m[bt]}},releaseStatesOfGeometry:function(bt){if(void 0===m[bt.id])return;const _t=m[bt.id];for(const Ct in _t){const xt=_t[Ct];for(const Pt in xt)P(xt[Pt].object),delete xt[Pt];delete _t[Ct]}delete m[bt.id]},releaseStatesOfProgram:function(bt){for(const _t in m){const Ct=m[_t];if(void 0===Ct[bt.id])continue;const xt=Ct[bt.id];for(const Pt in xt)P(xt[Pt].object),delete xt[Pt];delete Ct[bt.id]}},initAttributes:O,enableAttribute:re,disableUnusedAttributes:ve}}function ca(h,e,r,s){const a=s.isWebGL2;let c;this.setMode=function(E){c=E},this.render=function(E,C){h.drawArrays(c,E,C),r.update(C,c,1)},this.renderInstances=function(E,C,D){if(0===D)return;let A,P;if(a)A=h,P="drawArraysInstanced";else if(A=e.get("ANGLE_instanced_arrays"),P="drawArraysInstancedANGLE",null===A)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");A[P](c,E,C,D),r.update(C,c,D)}}function Dc(h,e,r){let s;function c(ue){if("highp"===ue){if(h.getShaderPrecisionFormat(35633,36338).precision>0&&h.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";ue="mediump"}return"mediump"===ue&&h.getShaderPrecisionFormat(35633,36337).precision>0&&h.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const p="undefined"!=typeof WebGL2RenderingContext&&h instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&h instanceof WebGL2ComputeRenderingContext;let m=void 0!==r.precision?r.precision:"highp";const x=c(m);x!==m&&(console.warn("THREE.WebGLRenderer:",m,"not supported, using",x,"instead."),m=x);const E=p||e.has("WEBGL_draw_buffers"),C=!0===r.logarithmicDepthBuffer,D=h.getParameter(34930),A=h.getParameter(35660),P=h.getParameter(3379),L=h.getParameter(34076),H=h.getParameter(34921),q=h.getParameter(36347),k=h.getParameter(36348),O=h.getParameter(36349),re=A>0,ne=p||e.has("OES_texture_float");return{isWebGL2:p,drawBuffers:E,getMaxAnisotropy:function(){if(void 0!==s)return s;if(!0===e.has("EXT_texture_filter_anisotropic")){const ue=e.get("EXT_texture_filter_anisotropic");s=h.getParameter(ue.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s},getMaxPrecision:c,precision:m,logarithmicDepthBuffer:C,maxTextures:D,maxVertexTextures:A,maxTextureSize:P,maxCubemapSize:L,maxAttributes:H,maxVertexUniforms:q,maxVaryings:k,maxFragmentUniforms:O,vertexTextures:re,floatFragmentTextures:ne,floatVertexTextures:re&&ne,maxSamples:p?h.getParameter(36183):0}}function Ua(h){const e=this;let r=null,s=0,a=!1,c=!1;const p=new Kl,m=new ui,x={value:null,needsUpdate:!1};function E(){x.value!==r&&(x.value=r,x.needsUpdate=s>0),e.numPlanes=s,e.numIntersection=0}function C(D,A,P,L){const H=null!==D?D.length:0;let q=null;if(0!==H){if(q=x.value,!0!==L||null===q){const k=P+4*H,O=A.matrixWorldInverse;m.getNormalMatrix(O),(null===q||q.length<k)&&(q=new Float32Array(k));for(let re=0,ne=P;re!==H;++re,ne+=4)p.copy(D[re]).applyMatrix4(O,m),p.normal.toArray(q,ne),q[ne+3]=p.constant}x.value=q,x.needsUpdate=!0}return e.numPlanes=H,e.numIntersection=0,q}this.uniform=x,this.numPlanes=0,this.numIntersection=0,this.init=function(D,A,P){const L=0!==D.length||A||0!==s||a;return a=A,r=C(D,P,0),s=D.length,L},this.beginShadows=function(){c=!0,C(null)},this.endShadows=function(){c=!1,E()},this.setState=function(D,A,P){const L=D.clippingPlanes,H=D.clipIntersection,q=D.clipShadows,k=h.get(D);if(!a||null===L||0===L.length||c&&!q)c?C(null):E();else{const O=c?0:s,re=4*O;let ne=k.clippingState||null;x.value=ne,ne=C(L,A,re,P);for(let ve=0;ve!==re;++ve)ne[ve]=r[ve];k.clippingState=ne,this.numIntersection=H?this.numPlanes:0,this.numPlanes+=O}}}function Va(h){let e=new WeakMap;function r(p,m){return 303===m?p.mapping=301:304===m&&(p.mapping=302),p}function a(p){const m=p.target;m.removeEventListener("dispose",a);const x=e.get(m);void 0!==x&&(e.delete(m),x.dispose())}return{get:function(p){if(p&&p.isTexture&&!1===p.isRenderTargetTexture){const m=p.mapping;if(303===m||304===m){if(e.has(p))return r(e.get(p).texture,p.mapping);{const x=p.image;if(x&&x.height>0){const E=h.getRenderTarget(),C=new Rh(x.height/2);return C.fromEquirectangularTexture(h,p),e.set(p,C),h.setRenderTarget(E),p.addEventListener("dispose",a),r(C.texture,p.mapping)}return null}}}return p},dispose:function(){e=new WeakMap}}}Nr.physical={uniforms:js([Nr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Rt(1,1)},clearcoatNormalMap:{value:null},sheenTint:{value:new j(0)},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Rt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationTint:{value:new j(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularTint:{value:new j(1,1,1)},specularTintMap:{value:null}}]),vertexShader:Sn.meshphysical_vert,fragmentShader:Sn.meshphysical_frag};class Ns extends id{constructor(e=-1,r=1,s=1,a=-1,c=.1,p=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=r,this.top=s,this.bottom=a,this.near=c,this.far=p,this.updateProjectionMatrix()}copy(e,r){return super.copy(e,r),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,r,s,a,c,p){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=r,this.view.offsetX=s,this.view.offsetY=a,this.view.width=c,this.view.height=p,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),r=(this.top-this.bottom)/(2*this.zoom),s=(this.right+this.left)/2,a=(this.top+this.bottom)/2;let c=s-e,p=s+e,m=a+r,x=a-r;if(null!==this.view&&this.view.enabled){const E=(this.right-this.left)/this.view.fullWidth/this.zoom,C=(this.top-this.bottom)/this.view.fullHeight/this.zoom;c+=E*this.view.offsetX,p=c+E*this.view.width,m-=C*this.view.offsetY,x=m-C*this.view.height}this.projectionMatrix.makeOrthographic(c,p,m,x,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const r=super.toJSON(e);return r.object.zoom=this.zoom,r.object.left=this.left,r.object.right=this.right,r.object.top=this.top,r.object.bottom=this.bottom,r.object.near=this.near,r.object.far=this.far,null!==this.view&&(r.object.view=Object.assign({},this.view)),r}}Ns.prototype.isOrthographicCamera=!0;class Rc extends Ba{constructor(e){super(e),this.type="RawShaderMaterial"}}Rc.prototype.isRawShaderMaterial=!0;const ul=Math.pow(2,8),Jc=[.125,.215,.35,.446,.526,.582],tf=5+Jc.length,za={[Rs]:0,3001:1,3002:2,3004:3,3005:4,3006:5,3007:6},md=new Ns,{_lodPlanes:tu,_sizeLods:xg,_sigmas:Ol}=Fu(),yd=new j;let Nu=null;const it=(1+Math.sqrt(5))/2,ar=1/it,Ws=[new he(1,1,1),new he(-1,1,1),new he(1,1,-1),new he(-1,1,-1),new he(0,it,ar),new he(0,it,-ar),new he(ar,0,it),new he(-ar,0,it),new he(it,ar,0),new he(-it,ar,0)];class po{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=function(h){const e=new Float32Array(20),r=new he(0,1,0);return new Rc({name:"SphericalGaussianBlur",defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r},inputEncoding:{value:za[Rs]},outputEncoding:{value:za[Rs]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,r=0,s=.1,a=100){Nu=this._renderer.getRenderTarget();const c=this._allocateTargets();return this._sceneToCubeUV(e,s,a,c),r>0&&this._blur(c,0,0,r),this._applyPMREM(c),this._cleanup(c),c}fromEquirectangular(e){return this._fromTexture(e)}fromCubemap(e){return this._fromTexture(e)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=wg(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=Ha(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let e=0;e<tu.length;e++)tu[e].dispose()}_cleanup(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Nu),e.scissorTest=!1,_d(e,0,0,e.width,e.height)}_fromTexture(e){Nu=this._renderer.getRenderTarget();const r=this._allocateTargets(e);return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(e){const r={magFilter:Pi,minFilter:Pi,generateMipmaps:!1,type:Xn,format:Di,encoding:(h=e,void 0===h||h.type!==Xn||h.encoding!==Rs&&3001!==h.encoding&&3007!==h.encoding?3002:e.encoding),depthBuffer:!1},s=vd(r);var h;return s.depthBuffer=!e,this._pingPongRenderTarget=vd(r),s}_compileMaterial(e){const r=new cs(tu[0],e);this._renderer.compile(r,md)}_sceneToCubeUV(e,r,s,a){const m=new xs(90,1,r,s),x=[1,-1,1,1,1,1],E=[1,1,1,-1,-1,-1],C=this._renderer,D=C.autoClear,A=C.outputEncoding,P=C.toneMapping;C.getClearColor(yd),C.toneMapping=0,C.outputEncoding=Rs,C.autoClear=!1;const L=new oe({name:"PMREM.Background",side:Ve,depthWrite:!1,depthTest:!1}),H=new cs(new Cu,L);let q=!1;const k=e.background;k?k.isColor&&(L.color.copy(k),e.background=null,q=!0):(L.color.copy(yd),q=!0);for(let O=0;O<6;O++){const re=O%3;0==re?(m.up.set(0,x[O],0),m.lookAt(E[O],0,0)):1==re?(m.up.set(0,0,x[O]),m.lookAt(0,E[O],0)):(m.up.set(0,x[O],0),m.lookAt(0,0,E[O])),_d(a,re*ul,O>2?ul:0,ul,ul),C.setRenderTarget(a),q&&C.render(H,m),C.render(e,m)}H.geometry.dispose(),H.material.dispose(),C.toneMapping=P,C.outputEncoding=A,C.autoClear=D,e.background=k}_textureToCubeUV(e,r){const s=this._renderer;e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=wg()):null==this._equirectShader&&(this._equirectShader=Ha());const a=e.isCubeTexture?this._cubemapShader:this._equirectShader,c=new cs(tu[0],a),p=a.uniforms;p.envMap.value=e,e.isCubeTexture||p.texelSize.value.set(1/e.image.width,1/e.image.height),p.inputEncoding.value=za[e.encoding],p.outputEncoding.value=za[r.texture.encoding],_d(r,0,0,3*ul,2*ul),s.setRenderTarget(r),s.render(c,md)}_applyPMREM(e){const r=this._renderer,s=r.autoClear;r.autoClear=!1;for(let a=1;a<tf;a++){const c=Math.sqrt(Ol[a]*Ol[a]-Ol[a-1]*Ol[a-1]);this._blur(e,a-1,a,c,Ws[(a-1)%Ws.length])}r.autoClear=s}_blur(e,r,s,a,c){const p=this._pingPongRenderTarget;this._halfBlur(e,p,r,s,a,"latitudinal",c),this._halfBlur(p,e,s,s,a,"longitudinal",c)}_halfBlur(e,r,s,a,c,p,m){const x=this._renderer,E=this._blurMaterial;"latitudinal"!==p&&"longitudinal"!==p&&console.error("blur direction must be either latitudinal or longitudinal!");const D=new cs(tu[a],E),A=E.uniforms,P=xg[s]-1,L=isFinite(c)?Math.PI/(2*P):2*Math.PI/39,H=c/L,q=isFinite(c)?1+Math.floor(3*H):20;q>20&&console.warn(`sigmaRadians, ${c}, is too large and will clip, as it requested ${q} samples when the maximum is set to 20`);const k=[];let O=0;for(let Ie=0;Ie<20;++Ie){const ue=Ie/H,je=Math.exp(-ue*ue/2);k.push(je),0==Ie?O+=je:Ie<q&&(O+=2*je)}for(let Ie=0;Ie<k.length;Ie++)k[Ie]=k[Ie]/O;A.envMap.value=e.texture,A.samples.value=q,A.weights.value=k,A.latitudinal.value="latitudinal"===p,m&&(A.poleAxis.value=m),A.dTheta.value=L,A.mipInt.value=8-s,A.inputEncoding.value=za[e.texture.encoding],A.outputEncoding.value=za[e.texture.encoding];const re=xg[a];_d(r,3*Math.max(0,ul-2*re),(0===a?0:2*ul)+2*re*(a>4?a-8+4:0),3*re,2*re),x.setRenderTarget(r),x.render(D,md)}}function Fu(){const h=[],e=[],r=[];let s=8;for(let a=0;a<tf;a++){const c=Math.pow(2,s);e.push(c);let p=1/c;a>4?p=Jc[a-8+4-1]:0==a&&(p=0),r.push(p);const m=1/(c-1),x=-m/2,E=1+m/2,C=[x,x,E,x,E,E,x,x,E,E,x,E],D=6,A=6,P=3,L=2,H=1,q=new Float32Array(P*A*D),k=new Float32Array(L*A*D),O=new Float32Array(H*A*D);for(let ne=0;ne<D;ne++){const ve=ne%3*2/3-1,Ie=ne>2?0:-1;q.set([ve,Ie,0,ve+2/3,Ie,0,ve+2/3,Ie+1,0,ve,Ie,0,ve+2/3,Ie+1,0,ve,Ie+1,0],P*A*ne),k.set(C,L*A*ne),O.set([ne,ne,ne,ne,ne,ne],H*A*ne)}const re=new jt;re.setAttribute("position",new Ke(q,P)),re.setAttribute("uv",new Ke(k,L)),re.setAttribute("faceIndex",new Ke(O,H)),h.push(re),s>4&&s--}return{_lodPlanes:h,_sizeLods:e,_sigmas:r}}function vd(h){const e=new No(3*ul,3*ul,h);return e.texture.mapping=306,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function _d(h,e,r,s,a){h.viewport.set(e,r,s,a),h.scissor.set(e,r,s,a)}function Ha(){const h=new Rt(1,1);return new Rc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:h},inputEncoding:{value:za[Rs]},outputEncoding:{value:za[Rs]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function wg(){return new Rc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:za[Rs]},outputEncoding:{value:za[Rs]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Fv(h){let e=new WeakMap,r=null;function c(m){const x=m.target;x.removeEventListener("dispose",c);const E=e.get(x);void 0!==E&&(e.delete(x),E.dispose())}return{get:function(m){if(m&&m.isTexture&&!1===m.isRenderTargetTexture){const x=m.mapping,E=303===x||304===x,C=301===x||302===x;if(E||C){if(e.has(m))return e.get(m).texture;{const D=m.image;if(E&&D&&D.height>0||C&&D&&function(m){let x=0;for(let C=0;C<6;C++)void 0!==m[C]&&x++;return 6===x}(D)){const A=h.getRenderTarget();null===r&&(r=new po(h));const P=E?r.fromEquirectangular(m):r.fromCubemap(m);return e.set(m,P),h.setRenderTarget(A),m.addEventListener("dispose",c),P.texture}return null}}}return m},dispose:function(){e=new WeakMap,null!==r&&(r.dispose(),r=null)}}}function _y(h){const e={};function r(s){if(void 0!==e[s])return e[s];let a;switch(s){case"WEBGL_depth_texture":a=h.getExtension("WEBGL_depth_texture")||h.getExtension("MOZ_WEBGL_depth_texture")||h.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":a=h.getExtension("EXT_texture_filter_anisotropic")||h.getExtension("MOZ_EXT_texture_filter_anisotropic")||h.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":a=h.getExtension("WEBGL_compressed_texture_s3tc")||h.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||h.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":a=h.getExtension("WEBGL_compressed_texture_pvrtc")||h.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:a=h.getExtension(s)}return e[s]=a,a}return{has:function(s){return null!==r(s)},init:function(s){s.isWebGL2?r("EXT_color_buffer_float"):(r("WEBGL_depth_texture"),r("OES_texture_float"),r("OES_texture_half_float"),r("OES_texture_half_float_linear"),r("OES_standard_derivatives"),r("OES_element_index_uint"),r("OES_vertex_array_object"),r("ANGLE_instanced_arrays")),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float")},get:function(s){const a=r(s);return null===a&&console.warn("THREE.WebGLRenderer: "+s+" extension not supported."),a}}}function by(h,e,r,s){const a={},c=new WeakMap;function p(D){const A=D.target;null!==A.index&&e.remove(A.index);for(const L in A.attributes)e.remove(A.attributes[L]);A.removeEventListener("dispose",p),delete a[A.id];const P=c.get(A);P&&(e.remove(P),c.delete(A)),s.releaseStatesOfGeometry(A),!0===A.isInstancedBufferGeometry&&delete A._maxInstanceCount,r.memory.geometries--}function E(D){const A=[],P=D.index,L=D.attributes.position;let H=0;if(null!==P){const O=P.array;H=P.version;for(let re=0,ne=O.length;re<ne;re+=3){const ve=O[re+0],Ie=O[re+1],ue=O[re+2];A.push(ve,Ie,Ie,ue,ue,ve)}}else{H=L.version;for(let re=0,ne=L.array.length/3-1;re<ne;re+=3){const ve=re+0,Ie=re+1,ue=re+2;A.push(ve,Ie,Ie,ue,ue,ve)}}const q=new(Ji(A)>65535?Si:vr)(A,1);q.version=H;const k=c.get(D);k&&e.remove(k),c.set(D,q)}return{get:function(D,A){return!0===a[A.id]||(A.addEventListener("dispose",p),a[A.id]=!0,r.memory.geometries++),A},update:function(D){const A=D.attributes;for(const L in A)e.update(A[L],34962);const P=D.morphAttributes;for(const L in P){const H=P[L];for(let q=0,k=H.length;q<k;q++)e.update(H[q],34962)}},getWireframeAttribute:function(D){const A=c.get(D);if(A){const P=D.index;null!==P&&A.version<P.version&&E(D)}else E(D);return c.get(D)}}}function bd(h,e,r,s){const a=s.isWebGL2;let c,m,x;this.setMode=function(A){c=A},this.setIndex=function(A){m=A.type,x=A.bytesPerElement},this.render=function(A,P){h.drawElements(c,P,m,A*x),r.update(P,c,1)},this.renderInstances=function(A,P,L){if(0===L)return;let H,q;if(a)H=h,q="drawElementsInstanced";else if(H=e.get("ANGLE_instanced_arrays"),q="drawElementsInstancedANGLE",null===H)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");H[q](c,P,m,A*x,L),r.update(P,c,L)}}function xy(h){const r={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:r,programs:null,autoReset:!0,reset:function(){r.frame++,r.calls=0,r.triangles=0,r.points=0,r.lines=0},update:function(c,p,m){switch(r.calls++,p){case 4:r.triangles+=m*(c/3);break;case 1:r.lines+=m*(c/2);break;case 3:r.lines+=m*(c-1);break;case 2:r.lines+=m*c;break;case 0:r.points+=m*c;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",p)}}}}function wy(h,e){return h[0]-e[0]}function kv(h,e){return Math.abs(e[1])-Math.abs(h[1])}function Gh(h){const e={},r=new Float32Array(8),s=[];for(let c=0;c<8;c++)s[c]=[c,0];return{update:function(c,p,m,x){const E=c.morphTargetInfluences,C=void 0===E?0:E.length;let D=e[p.id];if(void 0===D||D.length!==C){D=[];for(let q=0;q<C;q++)D[q]=[q,0];e[p.id]=D}for(let q=0;q<C;q++){const k=D[q];k[0]=q,k[1]=E[q]}D.sort(kv);for(let q=0;q<8;q++)q<C&&D[q][1]?(s[q][0]=D[q][0],s[q][1]=D[q][1]):(s[q][0]=Number.MAX_SAFE_INTEGER,s[q][1]=0);s.sort(wy);const A=p.morphAttributes.position,P=p.morphAttributes.normal;let L=0;for(let q=0;q<8;q++){const k=s[q],O=k[0],re=k[1];O!==Number.MAX_SAFE_INTEGER&&re?(A&&p.getAttribute("morphTarget"+q)!==A[O]&&p.setAttribute("morphTarget"+q,A[O]),P&&p.getAttribute("morphNormal"+q)!==P[O]&&p.setAttribute("morphNormal"+q,P[O]),r[q]=re,L+=re):(A&&!0===p.hasAttribute("morphTarget"+q)&&p.deleteAttribute("morphTarget"+q),P&&!0===p.hasAttribute("morphNormal"+q)&&p.deleteAttribute("morphNormal"+q),r[q]=0)}const H=p.morphTargetsRelative?1:1-L;x.getUniforms().setValue(h,"morphTargetBaseInfluence",H),x.getUniforms().setValue(h,"morphTargetInfluences",r)}}}function Bv(h,e,r,s){let a=new WeakMap;function m(x){const E=x.target;E.removeEventListener("dispose",m),r.remove(E.instanceMatrix),null!==E.instanceColor&&r.remove(E.instanceColor)}return{update:function(x){const E=s.render.frame,D=e.get(x,x.geometry);return a.get(D)!==E&&(e.update(D),a.set(D,E)),x.isInstancedMesh&&(!1===x.hasEventListener("dispose",m)&&x.addEventListener("dispose",m),r.update(x.instanceMatrix,34962),null!==x.instanceColor&&r.update(x.instanceColor,34962)),D},dispose:function(){a=new WeakMap}}}class Mg extends As{constructor(e=null,r=1,s=1,a=1){super(null),this.image={data:e,width:r,height:s,depth:a},this.magFilter=Pi,this.minFilter=Pi,this.wrapR=Tn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Mg.prototype.isDataTexture2DArray=!0;class Sg extends As{constructor(e=null,r=1,s=1,a=1){super(null),this.image={data:e,width:r,height:s,depth:a},this.magFilter=Pi,this.minFilter=Pi,this.wrapR=Tn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Sg.prototype.isDataTexture3D=!0;const Cg=new As,Tg=new Mg,Ey=new Sg,qf=new Mc,Yf=[],Ag=[],jh=new Float32Array(16),Dg=new Float32Array(9),Wh=new Float32Array(4);function Lc(h,e,r){const s=h[0];if(s<=0||s>0)return h;const a=e*r;let c=Yf[a];if(void 0===c&&(c=new Float32Array(a),Yf[a]=c),0!==e){s.toArray(c,0);for(let p=1,m=0;p!==e;++p)m+=r,h[p].toArray(c,m)}return c}function Ca(h,e){if(h.length!==e.length)return!1;for(let r=0,s=h.length;r<s;r++)if(h[r]!==e[r])return!1;return!0}function qo(h,e){for(let r=0,s=e.length;r<s;r++)h[r]=e[r]}function My(h,e){let r=Ag[e];void 0===r&&(r=new Int32Array(e),Ag[e]=r);for(let s=0;s!==e;++s)r[s]=h.allocateTextureUnit();return r}function Uv(h,e){const r=this.cache;r[0]!==e&&(h.uniform1f(this.addr,e),r[0]=e)}function Sy(h,e){const r=this.cache;if(void 0!==e.x)(r[0]!==e.x||r[1]!==e.y)&&(h.uniform2f(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y);else{if(Ca(r,e))return;h.uniform2fv(this.addr,e),qo(r,e)}}function Rg(h,e){const r=this.cache;if(void 0!==e.x)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z)&&(h.uniform3f(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z);else if(void 0!==e.r)(r[0]!==e.r||r[1]!==e.g||r[2]!==e.b)&&(h.uniform3f(this.addr,e.r,e.g,e.b),r[0]=e.r,r[1]=e.g,r[2]=e.b);else{if(Ca(r,e))return;h.uniform3fv(this.addr,e),qo(r,e)}}function Cy(h,e){const r=this.cache;if(void 0!==e.x)(r[0]!==e.x||r[1]!==e.y||r[2]!==e.z||r[3]!==e.w)&&(h.uniform4f(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w);else{if(Ca(r,e))return;h.uniform4fv(this.addr,e),qo(r,e)}}function vx(h,e){const r=this.cache,s=e.elements;if(void 0===s){if(Ca(r,e))return;h.uniformMatrix2fv(this.addr,!1,e),qo(r,e)}else{if(Ca(r,s))return;Wh.set(s),h.uniformMatrix2fv(this.addr,!1,Wh),qo(r,s)}}function Ty(h,e){const r=this.cache,s=e.elements;if(void 0===s){if(Ca(r,e))return;h.uniformMatrix3fv(this.addr,!1,e),qo(r,e)}else{if(Ca(r,s))return;Dg.set(s),h.uniformMatrix3fv(this.addr,!1,Dg),qo(r,s)}}function Vv(h,e){const r=this.cache,s=e.elements;if(void 0===s){if(Ca(r,e))return;h.uniformMatrix4fv(this.addr,!1,e),qo(r,e)}else{if(Ca(r,s))return;jh.set(s),h.uniformMatrix4fv(this.addr,!1,jh),qo(r,s)}}function Ay(h,e){const r=this.cache;r[0]!==e&&(h.uniform1i(this.addr,e),r[0]=e)}function zv(h,e){const r=this.cache;Ca(r,e)||(h.uniform2iv(this.addr,e),qo(r,e))}function Hv(h,e){const r=this.cache;Ca(r,e)||(h.uniform3iv(this.addr,e),qo(r,e))}function nc(h,e){const r=this.cache;Ca(r,e)||(h.uniform4iv(this.addr,e),qo(r,e))}function Gv(h,e){const r=this.cache;r[0]!==e&&(h.uniform1ui(this.addr,e),r[0]=e)}function Dy(h,e){const r=this.cache;Ca(r,e)||(h.uniform2uiv(this.addr,e),qo(r,e))}function jv(h,e){const r=this.cache;Ca(r,e)||(h.uniform3uiv(this.addr,e),qo(r,e))}function Wv(h,e){const r=this.cache;Ca(r,e)||(h.uniform4uiv(this.addr,e),qo(r,e))}function $v(h,e,r){const s=this.cache,a=r.allocateTextureUnit();s[0]!==a&&(h.uniform1i(this.addr,a),s[0]=a),r.safeSetTexture2D(e||Cg,a)}function qv(h,e,r){const s=this.cache,a=r.allocateTextureUnit();s[0]!==a&&(h.uniform1i(this.addr,a),s[0]=a),r.setTexture3D(e||Ey,a)}function Ry(h,e,r){const s=this.cache,a=r.allocateTextureUnit();s[0]!==a&&(h.uniform1i(this.addr,a),s[0]=a),r.safeSetTextureCube(e||qf,a)}function Yv(h,e,r){const s=this.cache,a=r.allocateTextureUnit();s[0]!==a&&(h.uniform1i(this.addr,a),s[0]=a),r.setTexture2DArray(e||Tg,a)}function Zv(h,e){h.uniform1fv(this.addr,e)}function Fr(h,e){const r=Lc(e,this.size,2);h.uniform2fv(this.addr,r)}function Iy(h,e){const r=Lc(e,this.size,3);h.uniform3fv(this.addr,r)}function Py(h,e){const r=Lc(e,this.size,4);h.uniform4fv(this.addr,r)}function $h(h,e){const r=Lc(e,this.size,4);h.uniformMatrix2fv(this.addr,!1,r)}function rc(h,e){const r=Lc(e,this.size,9);h.uniformMatrix3fv(this.addr,!1,r)}function Ly(h,e){const r=Lc(e,this.size,16);h.uniformMatrix4fv(this.addr,!1,r)}function Qv(h,e){h.uniform1iv(this.addr,e)}function Ig(h,e){h.uniform2iv(this.addr,e)}function nu(h,e){h.uniform3iv(this.addr,e)}function Pg(h,e){h.uniform4iv(this.addr,e)}function Oy(h,e){h.uniform1uiv(this.addr,e)}function Lg(h,e){h.uniform2uiv(this.addr,e)}function _x(h,e){h.uniform3uiv(this.addr,e)}function Ny(h,e){h.uniform4uiv(this.addr,e)}function bx(h,e,r){const s=e.length,a=My(r,s);h.uniform1iv(this.addr,a);for(let c=0;c!==s;++c)r.safeSetTexture2D(e[c]||Cg,a[c])}function ru(h,e,r){const s=e.length,a=My(r,s);h.uniform1iv(this.addr,a);for(let c=0;c!==s;++c)r.safeSetTextureCube(e[c]||qf,a[c])}function Yh(h,e,r){this.id=h,this.addr=r,this.cache=[],this.setValue=function(h){switch(h){case 5126:return Uv;case 35664:return Sy;case 35665:return Rg;case 35666:return Cy;case 35674:return vx;case 35675:return Ty;case 35676:return Vv;case 5124:case 35670:return Ay;case 35667:case 35671:return zv;case 35668:case 35672:return Hv;case 35669:case 35673:return nc;case 5125:return Gv;case 36294:return Dy;case 36295:return jv;case 36296:return Wv;case 35678:case 36198:case 36298:case 36306:case 35682:return $v;case 35679:case 36299:case 36307:return qv;case 35680:case 36300:case 36308:case 36293:return Ry;case 36289:case 36303:case 36311:case 36292:return Yv}}(e.type)}function Xh(h,e,r){this.id=h,this.addr=r,this.cache=[],this.size=e.size,this.setValue=function(h){switch(h){case 5126:return Zv;case 35664:return Fr;case 35665:return Iy;case 35666:return Py;case 35674:return $h;case 35675:return rc;case 35676:return Ly;case 5124:case 35670:return Qv;case 35667:case 35671:return Ig;case 35668:case 35672:return nu;case 35669:case 35673:return Pg;case 5125:return Oy;case 36294:return Lg;case 36295:return _x;case 36296:return Ny;case 35678:case 36198:case 36298:case 36306:case 35682:return bx;case 35680:case 36300:case 36308:case 36293:return ru}}(e.type)}function Kv(h){this.id=h,this.seq=[],this.map={}}Xh.prototype.updateCache=function(h){const e=this.cache;h instanceof Float32Array&&e.length!==h.length&&(this.cache=new Float32Array(h.length)),qo(e,h)},Kv.prototype.setValue=function(h,e,r){const s=this.seq;for(let a=0,c=s.length;a!==c;++a){const p=s[a];p.setValue(h,e[p.id],r)}};const Og=/(\w+)(\])?(\[|\.)?/g;function Ng(h,e){h.seq.push(e),h.map[e.id]=e}function xx(h,e,r){const s=h.name,a=s.length;for(Og.lastIndex=0;;){const c=Og.exec(s),p=Og.lastIndex;let m=c[1];const E=c[3];if("]"===c[2]&&(m|=0),void 0===E||"["===E&&p+2===a){Ng(r,void 0===E?new Yh(m,h,e):new Xh(m,h,e));break}{let D=r.map[m];void 0===D&&(D=new Kv(m),Ng(r,D)),r=D}}}function ku(h,e){this.seq=[],this.map={};const r=h.getProgramParameter(e,35718);for(let s=0;s<r;++s){const a=h.getActiveUniform(e,s);xx(a,h.getUniformLocation(e,a.name),this)}}function Jv(h,e,r){const s=h.createShader(e);return h.shaderSource(s,r),h.compileShader(s),s}ku.prototype.setValue=function(h,e,r,s){const a=this.map[e];void 0!==a&&a.setValue(h,r,s)},ku.prototype.setOptional=function(h,e,r){const s=e[r];void 0!==s&&this.setValue(h,r,s)},ku.upload=function(h,e,r,s){for(let a=0,c=e.length;a!==c;++a){const p=e[a],m=r[p.id];!1!==m.needsUpdate&&p.setValue(h,m.value,s)}},ku.seqWithValue=function(h,e){const r=[];for(let s=0,a=h.length;s!==a;++s){const c=h[s];c.id in e&&r.push(c)}return r};let Fy=0;function By(h){switch(h){case Rs:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",h),["Linear","( value )"]}}function Zh(h,e,r){const s=h.getShaderParameter(e,35713),a=h.getShaderInfoLog(e).trim();return s&&""===a?"":r.toUpperCase()+"\n\n"+a+"\n\n"+function(h){const e=h.split("\n");for(let r=0;r<e.length;r++)e[r]=r+1+": "+e[r];return e.join("\n")}(h.getShaderSource(e))}function Xf(h,e){const r=By(e);return"vec4 "+h+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function wx(h,e){const r=By(e);return"vec4 "+h+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function Ex(h,e){let r;switch(e){case 1:r="Linear";break;case 2:r="Reinhard";break;case 3:r="OptimizedCineon";break;case 4:r="ACESFilmic";break;case 5:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),r="Linear"}return"vec3 "+h+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function Qh(h){return""!==h}function e_(h,e){return h.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function t_(h,e){return h.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Tx=/^[ \t]*#include +<([\w\d./]+)>/gm;function Uy(h){return h.replace(Tx,Bu)}function Bu(h,e){const r=Sn[e];if(void 0===r)throw new Error("Can not resolve #include <"+e+">");return Uy(r)}const Fg=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,n_=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function kg(h){return h.replace(n_,Ug).replace(Fg,Bg)}function Bg(h,e,r,s){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Ug(0,e,r,s)}function Ug(h,e,r,s){let a="";for(let c=parseInt(e);c<parseInt(r);c++)a+=s.replace(/\[\s*i\s*\]/g,"[ "+c+" ]").replace(/UNROLLED_LOOP_INDEX/g,c);return a}function Kh(h){let e="precision "+h.precision+" float;\nprecision "+h.precision+" int;";return"highp"===h.precision?e+="\n#define HIGH_PRECISION":"mediump"===h.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===h.precision&&(e+="\n#define LOW_PRECISION"),e}function Ax(h,e,r,s){const a=h.getContext(),c=r.defines;let p=r.vertexShader,m=r.fragmentShader;const x=function(h){let e="SHADOWMAP_TYPE_BASIC";return 1===h.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===h.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===h.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(r),E=function(h){let e="ENVMAP_TYPE_CUBE";if(h.envMap)switch(h.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:case 307:e="ENVMAP_TYPE_CUBE_UV"}return e}(r),C=function(h){let e="ENVMAP_MODE_REFLECTION";if(h.envMap)switch(h.envMapMode){case 302:case 307:e="ENVMAP_MODE_REFRACTION"}return e}(r),D=function(h){let e="ENVMAP_BLENDING_NONE";if(h.envMap)switch(h.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(r),A=h.gammaFactor>0?h.gammaFactor:1,P=r.isWebGL2?"":function(h){return[h.extensionDerivatives||h.envMapCubeUV||h.bumpMap||h.tangentSpaceNormalMap||h.clearcoatNormalMap||h.flatShading||"physical"===h.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(h.extensionFragDepth||h.logarithmicDepthBuffer)&&h.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",h.extensionDrawBuffers&&h.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(h.extensionShaderTextureLOD||h.envMap||h.transmission)&&h.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Qh).join("\n")}(r),L=function(h){const e=[];for(const r in h){const s=h[r];!1!==s&&e.push("#define "+r+" "+s)}return e.join("\n")}(c),H=a.createProgram();let q,k,O=r.glslVersion?"#version "+r.glslVersion+"\n":"";r.isRawShaderMaterial?(q=[L].filter(Qh).join("\n"),q.length>0&&(q+="\n"),k=[P,L].filter(Qh).join("\n"),k.length>0&&(k+="\n")):(q=[Kh(r),"#define SHADER_NAME "+r.shaderName,L,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+A,"#define MAX_BONES "+r.maxBones,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+C:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularTintMap?"#define USE_SPECULARTINTMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+x:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Qh).join("\n"),k=[P,Kh(r),"#define SHADER_NAME "+r.shaderName,L,"#define GAMMA_FACTOR "+A,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+E:"",r.envMap?"#define "+C:"",r.envMap?"#define "+D:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularTintMap?"#define USE_SPECULARTINTMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.sheenTint?"#define USE_SHEEN":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+x:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(r.extensionShaderTextureLOD||r.envMap)&&r.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==r.toneMapping?"#define TONE_MAPPING":"",0!==r.toneMapping?Sn.tonemapping_pars_fragment:"",0!==r.toneMapping?Ex("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.format===Zs?"#define OPAQUE":"",Sn.encodings_pars_fragment,r.map?Xf("mapTexelToLinear",r.mapEncoding):"",r.matcap?Xf("matcapTexelToLinear",r.matcapEncoding):"",r.envMap?Xf("envMapTexelToLinear",r.envMapEncoding):"",r.emissiveMap?Xf("emissiveMapTexelToLinear",r.emissiveMapEncoding):"",r.specularTintMap?Xf("specularTintMapTexelToLinear",r.specularTintMapEncoding):"",r.lightMap?Xf("lightMapTexelToLinear",r.lightMapEncoding):"",wx("linearToOutputTexel",r.outputEncoding),r.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(Qh).join("\n")),p=Uy(p),p=e_(p,r),p=t_(p,r),m=Uy(m),m=e_(m,r),m=t_(m,r),p=kg(p),m=kg(m),r.isWebGL2&&!0!==r.isRawShaderMaterial&&(O="#version 300 es\n",q=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+q,k=["#define varying in","300 es"===r.glslVersion?"":"out highp vec4 pc_fragColor;","300 es"===r.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+k);const ne=O+k+m,ve=Jv(a,35633,O+q+p),Ie=Jv(a,35632,ne);if(a.attachShader(H,ve),a.attachShader(H,Ie),void 0!==r.index0AttributeName?a.bindAttribLocation(H,0,r.index0AttributeName):!0===r.morphTargets&&a.bindAttribLocation(H,0,"position"),a.linkProgram(H),h.debug.checkShaderErrors){const wt=a.getProgramInfoLog(H).trim(),nt=a.getShaderInfoLog(ve).trim(),Ge=a.getShaderInfoLog(Ie).trim();let en=!0,bt=!0;if(!1===a.getProgramParameter(H,35714)){en=!1;const _t=Zh(a,ve,"vertex"),Ct=Zh(a,Ie,"fragment");console.error("THREE.WebGLProgram: Shader Error "+a.getError()+" - VALIDATE_STATUS "+a.getProgramParameter(H,35715)+"\n\nProgram Info Log: "+wt+"\n"+_t+"\n"+Ct)}else""!==wt?console.warn("THREE.WebGLProgram: Program Info Log:",wt):(""===nt||""===Ge)&&(bt=!1);bt&&(this.diagnostics={runnable:en,programLog:wt,vertexShader:{log:nt,prefix:q},fragmentShader:{log:Ge,prefix:k}})}let ue,je;return a.deleteShader(ve),a.deleteShader(Ie),this.getUniforms=function(){return void 0===ue&&(ue=new ku(a,H)),ue},this.getAttributes=function(){return void 0===je&&(je=function(h,e){const r={},s=h.getProgramParameter(e,35721);for(let a=0;a<s;a++){const c=h.getActiveAttrib(e,a),p=c.name;let m=1;35674===c.type&&(m=2),35675===c.type&&(m=3),35676===c.type&&(m=4),r[p]={type:c.type,location:h.getAttribLocation(e,p),locationSize:m}}return r}(a,H)),je},this.destroy=function(){s.releaseStatesOfProgram(this),a.deleteProgram(H),this.program=void 0},this.name=r.shaderName,this.id=Fy++,this.cacheKey=e,this.usedTimes=1,this.program=H,this.vertexShader=ve,this.fragmentShader=Ie,this}function Vg(h,e,r,s,a,c,p){const m=[],x=a.isWebGL2,E=a.logarithmicDepthBuffer,C=a.floatVertexTextures,D=a.maxVertexUniforms,A=a.vertexTextures;let P=a.precision;const L={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},H=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoat","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","specularIntensityMap","specularTintMap","specularTintMapEncoding","roughnessMap","metalnessMap","gradientMap","alphaMap","alphaTest","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","format","sheenTint","transmission","transmissionMap","thicknessMap"];function k(ue){let je;return ue&&ue.isTexture?je=ue.encoding:ue&&ue.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),je=ue.texture.encoding):je=Rs,je}return{getParameters:function(ue,je,wt,nt,Ge){const en=nt.fog,_t=(ue.isMeshStandardMaterial?r:e).get(ue.envMap||(ue.isMeshStandardMaterial?nt.environment:null)),Ct=L[ue.type],xt=Ge.isSkinnedMesh?function(ue){const wt=ue.skeleton.bones;if(C)return 1024;{const Ge=Math.floor((D-20)/4),en=Math.min(Ge,wt.length);return en<wt.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+wt.length+" bones. This GPU supports "+en+"."),0):en}}(Ge):0;let Pt,wn;if(null!==ue.precision&&(P=a.getMaxPrecision(ue.precision),P!==ue.precision&&console.warn("THREE.WebGLProgram.getParameters:",ue.precision,"not supported, using",P,"instead.")),Ct){const Yt=Nr[Ct];Pt=Yt.vertexShader,wn=Yt.fragmentShader}else Pt=ue.vertexShader,wn=ue.fragmentShader;const ir=h.getRenderTarget(),fr=ue.alphaTest>0,Bn=ue.clearcoat>0;return{isWebGL2:x,shaderID:Ct,shaderName:ue.type,vertexShader:Pt,fragmentShader:wn,defines:ue.defines,isRawShaderMaterial:!0===ue.isRawShaderMaterial,glslVersion:ue.glslVersion,precision:P,instancing:!0===Ge.isInstancedMesh,instancingColor:!0===Ge.isInstancedMesh&&null!==Ge.instanceColor,supportsVertexTextures:A,outputEncoding:null!==ir?k(ir.texture):h.outputEncoding,map:!!ue.map,mapEncoding:k(ue.map),matcap:!!ue.matcap,matcapEncoding:k(ue.matcap),envMap:!!_t,envMapMode:_t&&_t.mapping,envMapEncoding:k(_t),envMapCubeUV:!!_t&&(306===_t.mapping||307===_t.mapping),lightMap:!!ue.lightMap,lightMapEncoding:k(ue.lightMap),aoMap:!!ue.aoMap,emissiveMap:!!ue.emissiveMap,emissiveMapEncoding:k(ue.emissiveMap),bumpMap:!!ue.bumpMap,normalMap:!!ue.normalMap,objectSpaceNormalMap:1===ue.normalMapType,tangentSpaceNormalMap:0===ue.normalMapType,clearcoat:Bn,clearcoatMap:Bn&&!!ue.clearcoatMap,clearcoatRoughnessMap:Bn&&!!ue.clearcoatRoughnessMap,clearcoatNormalMap:Bn&&!!ue.clearcoatNormalMap,displacementMap:!!ue.displacementMap,roughnessMap:!!ue.roughnessMap,metalnessMap:!!ue.metalnessMap,specularMap:!!ue.specularMap,specularIntensityMap:!!ue.specularIntensityMap,specularTintMap:!!ue.specularTintMap,specularTintMapEncoding:k(ue.specularTintMap),alphaMap:!!ue.alphaMap,alphaTest:fr,gradientMap:!!ue.gradientMap,sheenTint:!!ue.sheenTint&&(ue.sheenTint.r>0||ue.sheenTint.g>0||ue.sheenTint.b>0),transmission:ue.transmission>0,transmissionMap:!!ue.transmissionMap,thicknessMap:!!ue.thicknessMap,combine:ue.combine,vertexTangents:!!ue.normalMap&&!!Ge.geometry&&!!Ge.geometry.attributes.tangent,vertexColors:ue.vertexColors,vertexAlphas:!0===ue.vertexColors&&!!Ge.geometry&&!!Ge.geometry.attributes.color&&4===Ge.geometry.attributes.color.itemSize,vertexUvs:!!(ue.map||ue.bumpMap||ue.normalMap||ue.specularMap||ue.alphaMap||ue.emissiveMap||ue.roughnessMap||ue.metalnessMap||ue.clearcoatMap||ue.clearcoatRoughnessMap||ue.clearcoatNormalMap||ue.displacementMap||ue.transmissionMap||ue.thicknessMap||ue.specularIntensityMap||ue.specularTintMap),uvsVertexOnly:!(ue.map||ue.bumpMap||ue.normalMap||ue.specularMap||ue.alphaMap||ue.emissiveMap||ue.roughnessMap||ue.metalnessMap||ue.clearcoatNormalMap||ue.transmission>0||ue.transmissionMap||ue.thicknessMap||ue.specularIntensityMap||ue.specularTintMap||!ue.displacementMap),fog:!!en,useFog:ue.fog,fogExp2:en&&en.isFogExp2,flatShading:!!ue.flatShading,sizeAttenuation:ue.sizeAttenuation,logarithmicDepthBuffer:E,skinning:!0===Ge.isSkinnedMesh&&xt>0,maxBones:xt,useVertexTexture:C,morphTargets:!!Ge.geometry&&!!Ge.geometry.morphAttributes.position,morphNormals:!!Ge.geometry&&!!Ge.geometry.morphAttributes.normal,numDirLights:je.directional.length,numPointLights:je.point.length,numSpotLights:je.spot.length,numRectAreaLights:je.rectArea.length,numHemiLights:je.hemi.length,numDirLightShadows:je.directionalShadowMap.length,numPointLightShadows:je.pointShadowMap.length,numSpotLightShadows:je.spotShadowMap.length,numClippingPlanes:p.numPlanes,numClipIntersection:p.numIntersection,format:ue.format,dithering:ue.dithering,shadowMapEnabled:h.shadowMap.enabled&&wt.length>0,shadowMapType:h.shadowMap.type,toneMapping:ue.toneMapped?h.toneMapping:0,physicallyCorrectLights:h.physicallyCorrectLights,premultipliedAlpha:ue.premultipliedAlpha,doubleSided:2===ue.side,flipSided:ue.side===Ve,depthPacking:void 0!==ue.depthPacking&&ue.depthPacking,index0AttributeName:ue.index0AttributeName,extensionDerivatives:ue.extensions&&ue.extensions.derivatives,extensionFragDepth:ue.extensions&&ue.extensions.fragDepth,extensionDrawBuffers:ue.extensions&&ue.extensions.drawBuffers,extensionShaderTextureLOD:ue.extensions&&ue.extensions.shaderTextureLOD,rendererExtensionFragDepth:x||s.has("EXT_frag_depth"),rendererExtensionDrawBuffers:x||s.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:x||s.has("EXT_shader_texture_lod"),customProgramCacheKey:ue.customProgramCacheKey()}},getProgramCacheKey:function(ue){const je=[];if(ue.shaderID?je.push(ue.shaderID):(je.push(ue.fragmentShader),je.push(ue.vertexShader)),void 0!==ue.defines)for(const wt in ue.defines)je.push(wt),je.push(ue.defines[wt]);if(!1===ue.isRawShaderMaterial){for(let wt=0;wt<H.length;wt++)je.push(ue[H[wt]]);je.push(h.outputEncoding),je.push(h.gammaFactor)}return je.push(ue.customProgramCacheKey),je.join()},getUniforms:function(ue){const je=L[ue.type];let wt;return wt=je?Tu.clone(Nr[je].uniforms):ue.uniforms,wt},acquireProgram:function(ue,je){let wt;for(let nt=0,Ge=m.length;nt<Ge;nt++){const en=m[nt];if(en.cacheKey===je){wt=en,++wt.usedTimes;break}}return void 0===wt&&(wt=new Ax(h,je,ue,c),m.push(wt)),wt},releaseProgram:function(ue){if(0==--ue.usedTimes){const je=m.indexOf(ue);m[je]=m[m.length-1],m.pop(),ue.destroy()}},programs:m}}function s_(){let h=new WeakMap;return{get:function(c){let p=h.get(c);return void 0===p&&(p={},h.set(c,p)),p},remove:function(c){h.delete(c)},update:function(c,p,m){h.get(c)[p]=m},dispose:function(){h=new WeakMap}}}function zy(h,e){return h.groupOrder!==e.groupOrder?h.groupOrder-e.groupOrder:h.renderOrder!==e.renderOrder?h.renderOrder-e.renderOrder:h.program!==e.program?h.program.id-e.program.id:h.material.id!==e.material.id?h.material.id-e.material.id:h.z!==e.z?h.z-e.z:h.id-e.id}function Hy(h,e){return h.groupOrder!==e.groupOrder?h.groupOrder-e.groupOrder:h.renderOrder!==e.renderOrder?h.renderOrder-e.renderOrder:h.z!==e.z?e.z-h.z:h.id-e.id}function Gy(h){const e=[];let r=0;const s=[],a=[],c=[],p={id:-1};function x(P,L,H,q,k,O){let re=e[r];const ne=h.get(H);return void 0===re?(re={id:P.id,object:P,geometry:L,material:H,program:ne.program||p,groupOrder:q,renderOrder:P.renderOrder,z:k,group:O},e[r]=re):(re.id=P.id,re.object=P,re.geometry=L,re.material=H,re.program=ne.program||p,re.groupOrder=q,re.renderOrder=P.renderOrder,re.z=k,re.group=O),r++,re}return{opaque:s,transmissive:a,transparent:c,init:function(){r=0,s.length=0,a.length=0,c.length=0},push:function(P,L,H,q,k,O){const re=x(P,L,H,q,k,O);H.transmission>0?a.push(re):!0===H.transparent?c.push(re):s.push(re)},unshift:function(P,L,H,q,k,O){const re=x(P,L,H,q,k,O);H.transmission>0?a.unshift(re):!0===H.transparent?c.unshift(re):s.unshift(re)},finish:function(){for(let P=r,L=e.length;P<L;P++){const H=e[P];if(null===H.id)break;H.id=null,H.object=null,H.geometry=null,H.material=null,H.program=null,H.group=null}},sort:function(P,L){s.length>1&&s.sort(P||zy),a.length>1&&a.sort(L||Hy),c.length>1&&c.sort(L||Hy)}}}function Zf(h){let e=new WeakMap;return{get:function(a,c){let p;return!1===e.has(a)?(p=new Gy(h),e.set(a,[p])):c>=e.get(a).length?(p=new Gy(h),e.get(a).push(p)):p=e.get(a)[c],p},dispose:function(){e=new WeakMap}}}function nf(){const h={};return{get:function(e){if(void 0!==h[e.id])return h[e.id];let r;switch(e.type){case"DirectionalLight":r={direction:new he,color:new j};break;case"SpotLight":r={position:new he,direction:new he,color:new j,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new he,color:new j,distance:0,decay:0};break;case"HemisphereLight":r={direction:new he,skyColor:new j,groundColor:new j};break;case"RectAreaLight":r={color:new j,position:new he,halfWidth:new he,halfHeight:new he}}return h[e.id]=r,r}}}let rf=0;function Qf(h,e){return(e.castShadow?1:0)-(h.castShadow?1:0)}function sf(h,e){const r=new nf,s=function(){const h={};return{get:function(e){if(void 0!==h[e.id])return h[e.id];let r;switch(e.type){case"DirectionalLight":case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Rt};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Rt,shadowCameraNear:1,shadowCameraFar:1e3}}return h[e.id]=r,r}}}(),a={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let C=0;C<9;C++)a.probe.push(new he);const c=new he,p=new Nn,m=new Nn;return{setup:function(C,D){let A=0,P=0,L=0;for(let wt=0;wt<9;wt++)a.probe[wt].set(0,0,0);let H=0,q=0,k=0,O=0,re=0,ne=0,ve=0,Ie=0;C.sort(Qf);const ue=!0!==D?Math.PI:1;for(let wt=0,nt=C.length;wt<nt;wt++){const Ge=C[wt],en=Ge.color,bt=Ge.intensity,_t=Ge.distance,Ct=Ge.shadow&&Ge.shadow.map?Ge.shadow.map.texture:null;if(Ge.isAmbientLight)A+=en.r*bt*ue,P+=en.g*bt*ue,L+=en.b*bt*ue;else if(Ge.isLightProbe)for(let xt=0;xt<9;xt++)a.probe[xt].addScaledVector(Ge.sh.coefficients[xt],bt);else if(Ge.isDirectionalLight){const xt=r.get(Ge);if(xt.color.copy(Ge.color).multiplyScalar(Ge.intensity*ue),Ge.castShadow){const Pt=Ge.shadow,wn=s.get(Ge);wn.shadowBias=Pt.bias,wn.shadowNormalBias=Pt.normalBias,wn.shadowRadius=Pt.radius,wn.shadowMapSize=Pt.mapSize,a.directionalShadow[H]=wn,a.directionalShadowMap[H]=Ct,a.directionalShadowMatrix[H]=Ge.shadow.matrix,ne++}a.directional[H]=xt,H++}else if(Ge.isSpotLight){const xt=r.get(Ge);if(xt.position.setFromMatrixPosition(Ge.matrixWorld),xt.color.copy(en).multiplyScalar(bt*ue),xt.distance=_t,xt.coneCos=Math.cos(Ge.angle),xt.penumbraCos=Math.cos(Ge.angle*(1-Ge.penumbra)),xt.decay=Ge.decay,Ge.castShadow){const Pt=Ge.shadow,wn=s.get(Ge);wn.shadowBias=Pt.bias,wn.shadowNormalBias=Pt.normalBias,wn.shadowRadius=Pt.radius,wn.shadowMapSize=Pt.mapSize,a.spotShadow[k]=wn,a.spotShadowMap[k]=Ct,a.spotShadowMatrix[k]=Ge.shadow.matrix,Ie++}a.spot[k]=xt,k++}else if(Ge.isRectAreaLight){const xt=r.get(Ge);xt.color.copy(en).multiplyScalar(bt),xt.halfWidth.set(.5*Ge.width,0,0),xt.halfHeight.set(0,.5*Ge.height,0),a.rectArea[O]=xt,O++}else if(Ge.isPointLight){const xt=r.get(Ge);if(xt.color.copy(Ge.color).multiplyScalar(Ge.intensity*ue),xt.distance=Ge.distance,xt.decay=Ge.decay,Ge.castShadow){const Pt=Ge.shadow,wn=s.get(Ge);wn.shadowBias=Pt.bias,wn.shadowNormalBias=Pt.normalBias,wn.shadowRadius=Pt.radius,wn.shadowMapSize=Pt.mapSize,wn.shadowCameraNear=Pt.camera.near,wn.shadowCameraFar=Pt.camera.far,a.pointShadow[q]=wn,a.pointShadowMap[q]=Ct,a.pointShadowMatrix[q]=Ge.shadow.matrix,ve++}a.point[q]=xt,q++}else if(Ge.isHemisphereLight){const xt=r.get(Ge);xt.skyColor.copy(Ge.color).multiplyScalar(bt*ue),xt.groundColor.copy(Ge.groundColor).multiplyScalar(bt*ue),a.hemi[re]=xt,re++}}O>0&&(e.isWebGL2||!0===h.has("OES_texture_float_linear")?(a.rectAreaLTC1=Ft.LTC_FLOAT_1,a.rectAreaLTC2=Ft.LTC_FLOAT_2):!0===h.has("OES_texture_half_float_linear")?(a.rectAreaLTC1=Ft.LTC_HALF_1,a.rectAreaLTC2=Ft.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),a.ambient[0]=A,a.ambient[1]=P,a.ambient[2]=L;const je=a.hash;(je.directionalLength!==H||je.pointLength!==q||je.spotLength!==k||je.rectAreaLength!==O||je.hemiLength!==re||je.numDirectionalShadows!==ne||je.numPointShadows!==ve||je.numSpotShadows!==Ie)&&(a.directional.length=H,a.spot.length=k,a.rectArea.length=O,a.point.length=q,a.hemi.length=re,a.directionalShadow.length=ne,a.directionalShadowMap.length=ne,a.pointShadow.length=ve,a.pointShadowMap.length=ve,a.spotShadow.length=Ie,a.spotShadowMap.length=Ie,a.directionalShadowMatrix.length=ne,a.pointShadowMatrix.length=ve,a.spotShadowMatrix.length=Ie,je.directionalLength=H,je.pointLength=q,je.spotLength=k,je.rectAreaLength=O,je.hemiLength=re,je.numDirectionalShadows=ne,je.numPointShadows=ve,je.numSpotShadows=Ie,a.version=rf++)},setupView:function(C,D){let A=0,P=0,L=0,H=0,q=0;const k=D.matrixWorldInverse;for(let O=0,re=C.length;O<re;O++){const ne=C[O];if(ne.isDirectionalLight){const ve=a.directional[A];ve.direction.setFromMatrixPosition(ne.matrixWorld),c.setFromMatrixPosition(ne.target.matrixWorld),ve.direction.sub(c),ve.direction.transformDirection(k),A++}else if(ne.isSpotLight){const ve=a.spot[L];ve.position.setFromMatrixPosition(ne.matrixWorld),ve.position.applyMatrix4(k),ve.direction.setFromMatrixPosition(ne.matrixWorld),c.setFromMatrixPosition(ne.target.matrixWorld),ve.direction.sub(c),ve.direction.transformDirection(k),L++}else if(ne.isRectAreaLight){const ve=a.rectArea[H];ve.position.setFromMatrixPosition(ne.matrixWorld),ve.position.applyMatrix4(k),m.identity(),p.copy(ne.matrixWorld),p.premultiply(k),m.extractRotation(p),ve.halfWidth.set(.5*ne.width,0,0),ve.halfHeight.set(0,.5*ne.height,0),ve.halfWidth.applyMatrix4(m),ve.halfHeight.applyMatrix4(m),H++}else if(ne.isPointLight){const ve=a.point[P];ve.position.setFromMatrixPosition(ne.matrixWorld),ve.position.applyMatrix4(k),P++}else if(ne.isHemisphereLight){const ve=a.hemi[q];ve.direction.setFromMatrixPosition(ne.matrixWorld),ve.direction.transformDirection(k),ve.direction.normalize(),q++}}},state:a}}function jy(h,e){const r=new sf(h,e),s=[],a=[];return{init:function(){s.length=0,a.length=0},state:{lightsArray:s,shadowsArray:a,lights:r},setupLights:function(D){r.setup(s,D)},setupLightsView:function(D){r.setupView(s,D)},pushLight:function(D){s.push(D)},pushShadow:function(D){a.push(D)}}}function Wy(h,e){let r=new WeakMap;return{get:function(c,p=0){let m;return!1===r.has(c)?(m=new jy(h,e),r.set(c,[m])):p>=r.get(c).length?(m=new jy(h,e),r.get(c).push(m)):m=r.get(c)[p],m},dispose:function(){r=new WeakMap}}}class Jh extends Re{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}Jh.prototype.isMeshDepthMaterial=!0;class Kf extends Re{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new he,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Jf(h,e,r){let s=new Ih;const a=new Rt,c=new Rt,p=new di,m=new Jh({depthPacking:3201}),x=new Kf,E={},C=r.maxTextureSize,D={0:Ve,1:0,2:2},A=new Ba({uniforms:{shadow_pass:{value:null},resolution:{value:new Rt},radius:{value:4},samples:{value:8}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\nuniform float samples;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),P=A.clone();P.defines.HORIZONTAL_PASS=1;const L=new jt;L.setAttribute("position",new Ke(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const H=new cs(L,A),q=this;function k(ne,ve){const Ie=e.update(H);A.uniforms.shadow_pass.value=ne.map.texture,A.uniforms.resolution.value=ne.mapSize,A.uniforms.radius.value=ne.radius,A.uniforms.samples.value=ne.blurSamples,h.setRenderTarget(ne.mapPass),h.clear(),h.renderBufferDirect(ve,null,Ie,A,H,null),P.uniforms.shadow_pass.value=ne.mapPass.texture,P.uniforms.resolution.value=ne.mapSize,P.uniforms.radius.value=ne.radius,P.uniforms.samples.value=ne.blurSamples,h.setRenderTarget(ne.map),h.clear(),h.renderBufferDirect(ve,null,Ie,P,H,null)}function O(ne,ve,Ie,ue,je,wt,nt){let Ge=null;const en=!0===ue.isPointLight?ne.customDistanceMaterial:ne.customDepthMaterial;if(Ge=void 0!==en?en:!0===ue.isPointLight?x:m,h.localClippingEnabled&&!0===Ie.clipShadows&&0!==Ie.clippingPlanes.length||Ie.displacementMap&&0!==Ie.displacementScale||Ie.alphaMap&&Ie.alphaTest>0){const bt=Ge.uuid,_t=Ie.uuid;let Ct=E[bt];void 0===Ct&&(Ct={},E[bt]=Ct);let xt=Ct[_t];void 0===xt&&(xt=Ge.clone(),Ct[_t]=xt),Ge=xt}return Ge.visible=Ie.visible,Ge.wireframe=Ie.wireframe,Ge.side=3===nt?null!==Ie.shadowSide?Ie.shadowSide:Ie.side:null!==Ie.shadowSide?Ie.shadowSide:D[Ie.side],Ge.alphaMap=Ie.alphaMap,Ge.alphaTest=Ie.alphaTest,Ge.clipShadows=Ie.clipShadows,Ge.clippingPlanes=Ie.clippingPlanes,Ge.clipIntersection=Ie.clipIntersection,Ge.displacementMap=Ie.displacementMap,Ge.displacementScale=Ie.displacementScale,Ge.displacementBias=Ie.displacementBias,Ge.wireframeLinewidth=Ie.wireframeLinewidth,Ge.linewidth=Ie.linewidth,!0===ue.isPointLight&&!0===Ge.isMeshDistanceMaterial&&(Ge.referencePosition.setFromMatrixPosition(ue.matrixWorld),Ge.nearDistance=je,Ge.farDistance=wt),Ge}function re(ne,ve,Ie,ue,je){if(!1===ne.visible)return;if(ne.layers.test(ve.layers)&&(ne.isMesh||ne.isLine||ne.isPoints)&&(ne.castShadow||ne.receiveShadow&&3===je)&&(!ne.frustumCulled||s.intersectsObject(ne))){ne.modelViewMatrix.multiplyMatrices(Ie.matrixWorldInverse,ne.matrixWorld);const Ge=e.update(ne),en=ne.material;if(Array.isArray(en)){const bt=Ge.groups;for(let _t=0,Ct=bt.length;_t<Ct;_t++){const xt=bt[_t],Pt=en[xt.materialIndex];if(Pt&&Pt.visible){const wn=O(ne,0,Pt,ue,Ie.near,Ie.far,je);h.renderBufferDirect(Ie,null,Ge,wn,ne,xt)}}}else if(en.visible){const bt=O(ne,0,en,ue,Ie.near,Ie.far,je);h.renderBufferDirect(Ie,null,Ge,bt,ne,null)}}const nt=ne.children;for(let Ge=0,en=nt.length;Ge<en;Ge++)re(nt[Ge],ve,Ie,ue,je)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(ne,ve,Ie){if(!1===q.enabled||!1===q.autoUpdate&&!1===q.needsUpdate||0===ne.length)return;const ue=h.getRenderTarget(),je=h.getActiveCubeFace(),wt=h.getActiveMipmapLevel(),nt=h.state;nt.setBlending(0),nt.buffers.color.setClear(1,1,1,1),nt.buffers.depth.setTest(!0),nt.setScissorTest(!1);for(let Ge=0,en=ne.length;Ge<en;Ge++){const bt=ne[Ge],_t=bt.shadow;if(void 0===_t){console.warn("THREE.WebGLShadowMap:",bt,"has no shadow.");continue}if(!1===_t.autoUpdate&&!1===_t.needsUpdate)continue;a.copy(_t.mapSize);const Ct=_t.getFrameExtents();if(a.multiply(Ct),c.copy(_t.mapSize),(a.x>C||a.y>C)&&(a.x>C&&(c.x=Math.floor(C/Ct.x),a.x=c.x*Ct.x,_t.mapSize.x=c.x),a.y>C&&(c.y=Math.floor(C/Ct.y),a.y=c.y*Ct.y,_t.mapSize.y=c.y)),null===_t.map&&!_t.isPointLightShadow&&3===this.type){const Pt={minFilter:zn,magFilter:zn,format:ds};_t.map=new No(a.x,a.y,Pt),_t.map.texture.name=bt.name+".shadowMap",_t.mapPass=new No(a.x,a.y,Pt),_t.camera.updateProjectionMatrix()}null===_t.map&&(_t.map=new No(a.x,a.y,{minFilter:Pi,magFilter:Pi,format:ds}),_t.map.texture.name=bt.name+".shadowMap",_t.camera.updateProjectionMatrix()),h.setRenderTarget(_t.map),h.clear();const xt=_t.getViewportCount();for(let Pt=0;Pt<xt;Pt++){const wn=_t.getViewport(Pt);p.set(c.x*wn.x,c.y*wn.y,c.x*wn.z,c.y*wn.w),nt.viewport(p),_t.updateMatrices(bt,Pt),s=_t.getFrustum(),re(ve,Ie,_t.camera,bt,this.type)}!_t.isPointLightShadow&&3===this.type&&k(_t,Ie),_t.needsUpdate=!1}q.needsUpdate=!1,h.setRenderTarget(ue,je,wt)}}function o_(h,e,r){const s=r.isWebGL2,m=new function(){let Je=!1;const kn=new di;let Gt=null;const Jn=new di(0,0,0,0);return{setMask:function(or){Gt!==or&&!Je&&(h.colorMask(or,or,or,or),Gt=or)},setLocked:function(or){Je=or},setClear:function(or,mi,So,ua,uu){!0===uu&&(or*=ua,mi*=ua,So*=ua),kn.set(or,mi,So,ua),!1===Jn.equals(kn)&&(h.clearColor(or,mi,So,ua),Jn.copy(kn))},reset:function(){Je=!1,Gt=null,Jn.set(-1,0,0,0)}}},x=new function(){let Je=!1,kn=null,Gt=null,Jn=null;return{setTest:function(or){or?Fn(2929):Kn(2929)},setMask:function(or){kn!==or&&!Je&&(h.depthMask(or),kn=or)},setFunc:function(or){if(Gt!==or){if(or)switch(or){case 0:h.depthFunc(512);break;case 1:h.depthFunc(519);break;case 2:h.depthFunc(513);break;case 3:h.depthFunc(515);break;case 4:h.depthFunc(514);break;case 5:h.depthFunc(518);break;case 6:h.depthFunc(516);break;case 7:h.depthFunc(517);break;default:h.depthFunc(515)}else h.depthFunc(515);Gt=or}},setLocked:function(or){Je=or},setClear:function(or){Jn!==or&&(h.clearDepth(or),Jn=or)},reset:function(){Je=!1,kn=null,Gt=null,Jn=null}}},E=new function(){let Je=!1,kn=null,Gt=null,Jn=null,or=null,mi=null,So=null,ua=null,uu=null;return{setTest:function(Bs){Je||(Bs?Fn(2960):Kn(2960))},setMask:function(Bs){kn!==Bs&&!Je&&(h.stencilMask(Bs),kn=Bs)},setFunc:function(Bs,du,fu){(Gt!==Bs||Jn!==du||or!==fu)&&(h.stencilFunc(Bs,du,fu),Gt=Bs,Jn=du,or=fu)},setOp:function(Bs,du,fu){(mi!==Bs||So!==du||ua!==fu)&&(h.stencilOp(Bs,du,fu),mi=Bs,So=du,ua=fu)},setLocked:function(Bs){Je=Bs},setClear:function(Bs){uu!==Bs&&(h.clearStencil(Bs),uu=Bs)},reset:function(){Je=!1,kn=null,Gt=null,Jn=null,or=null,mi=null,So=null,ua=null,uu=null}}};let C={},D=null,A={},P=null,L=!1,H=null,q=null,k=null,O=null,re=null,ne=null,ve=null,Ie=!1,ue=null,je=null,wt=null,nt=null,Ge=null;const en=h.getParameter(35661);let bt=!1,_t=0;const Ct=h.getParameter(7938);-1!==Ct.indexOf("WebGL")?(_t=parseFloat(/^WebGL (\d)/.exec(Ct)[1]),bt=_t>=1):-1!==Ct.indexOf("OpenGL ES")&&(_t=parseFloat(/^OpenGL ES (\d)/.exec(Ct)[1]),bt=_t>=2);let xt=null,Pt={};const wn=h.getParameter(3088),ir=h.getParameter(2978),fr=(new di).fromArray(wn),Bn=(new di).fromArray(ir);function Dr(Je,kn,Gt){const Jn=new Uint8Array(4),or=h.createTexture();h.bindTexture(Je,or),h.texParameteri(Je,10241,9728),h.texParameteri(Je,10240,9728);for(let mi=0;mi<Gt;mi++)h.texImage2D(kn+mi,0,6408,1,1,0,6408,5121,Jn);return or}const Yt={};function Fn(Je){!0!==C[Je]&&(h.enable(Je),C[Je]=!0)}function Kn(Je){!1!==C[Je]&&(h.disable(Je),C[Je]=!1)}Yt[3553]=Dr(3553,3553,1),Yt[34067]=Dr(34067,34069,6),m.setClear(0,0,0,1),x.setClear(1),E.setClear(0),Fn(2929),x.setFunc(3),sn(!1),En(1),Fn(2884),$r(0);const sr={100:32774,101:32778,102:32779};if(s)sr[103]=32775,sr[104]=32776;else{const Je=e.get("EXT_blend_minmax");null!==Je&&(sr[103]=Je.MIN_EXT,sr[104]=Je.MAX_EXT)}const lr={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function $r(Je,kn,Gt,Jn,or,mi,So,ua){if(0!==Je){if(!1===L&&(Fn(3042),L=!0),5===Je)or=or||kn,mi=mi||Gt,So=So||Jn,(kn!==q||or!==re)&&(h.blendEquationSeparate(sr[kn],sr[or]),q=kn,re=or),(Gt!==k||Jn!==O||mi!==ne||So!==ve)&&(h.blendFuncSeparate(lr[Gt],lr[Jn],lr[mi],lr[So]),k=Gt,O=Jn,ne=mi,ve=So),H=Je,Ie=null;else if(Je!==H||ua!==Ie){if((100!==q||100!==re)&&(h.blendEquation(32774),q=100,re=100),ua)switch(Je){case 1:h.blendFuncSeparate(1,771,1,771);break;case 2:h.blendFunc(1,1);break;case 3:h.blendFuncSeparate(0,0,769,771);break;case 4:h.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Je)}else switch(Je){case 1:h.blendFuncSeparate(770,771,1,771);break;case 2:h.blendFunc(770,1);break;case 3:h.blendFunc(0,769);break;case 4:h.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Je)}k=null,O=null,ne=null,ve=null,H=Je,Ie=ua}}else!0===L&&(Kn(3042),L=!1)}function sn(Je){ue!==Je&&(h.frontFace(Je?2304:2305),ue=Je)}function En(Je){0!==Je?(Fn(2884),Je!==je&&h.cullFace(1===Je?1029:2===Je?1028:1032)):Kn(2884),je=Je}function An(Je,kn,Gt){Je?(Fn(32823),(nt!==kn||Ge!==Gt)&&(h.polygonOffset(kn,Gt),nt=kn,Ge=Gt)):Kn(32823)}function me(Je){void 0===Je&&(Je=33984+en-1),xt!==Je&&(h.activeTexture(Je),xt=Je)}return{buffers:{color:m,depth:x,stencil:E},enable:Fn,disable:Kn,bindFramebuffer:function(Je,kn){return null===kn&&null!==D&&(kn=D),A[Je]!==kn&&(h.bindFramebuffer(Je,kn),A[Je]=kn,s&&(36009===Je&&(A[36160]=kn),36160===Je&&(A[36009]=kn)),!0)},bindXRFramebuffer:function(Je){Je!==D&&(h.bindFramebuffer(36160,Je),D=Je)},useProgram:function(Je){return P!==Je&&(h.useProgram(Je),P=Je,!0)},setBlending:$r,setMaterial:function(Je,kn){2===Je.side?Kn(2884):Fn(2884);let Gt=Je.side===Ve;kn&&(Gt=!Gt),sn(Gt),1===Je.blending&&!1===Je.transparent?$r(0):$r(Je.blending,Je.blendEquation,Je.blendSrc,Je.blendDst,Je.blendEquationAlpha,Je.blendSrcAlpha,Je.blendDstAlpha,Je.premultipliedAlpha),x.setFunc(Je.depthFunc),x.setTest(Je.depthTest),x.setMask(Je.depthWrite),m.setMask(Je.colorWrite);const Jn=Je.stencilWrite;E.setTest(Jn),Jn&&(E.setMask(Je.stencilWriteMask),E.setFunc(Je.stencilFunc,Je.stencilRef,Je.stencilFuncMask),E.setOp(Je.stencilFail,Je.stencilZFail,Je.stencilZPass)),An(Je.polygonOffset,Je.polygonOffsetFactor,Je.polygonOffsetUnits),!0===Je.alphaToCoverage?Fn(32926):Kn(32926)},setFlipSided:sn,setCullFace:En,setLineWidth:function(Je){Je!==wt&&(bt&&h.lineWidth(Je),wt=Je)},setPolygonOffset:An,setScissorTest:function(Je){Je?Fn(3089):Kn(3089)},activeTexture:me,bindTexture:function(Je,kn){null===xt&&me();let Gt=Pt[xt];void 0===Gt&&(Gt={type:void 0,texture:void 0},Pt[xt]=Gt),(Gt.type!==Je||Gt.texture!==kn)&&(h.bindTexture(Je,kn||Yt[Je]),Gt.type=Je,Gt.texture=kn)},unbindTexture:function(){const Je=Pt[xt];void 0!==Je&&void 0!==Je.type&&(h.bindTexture(Je.type,null),Je.type=void 0,Je.texture=void 0)},compressedTexImage2D:function(){try{h.compressedTexImage2D.apply(h,arguments)}catch(Je){console.error("THREE.WebGLState:",Je)}},texImage2D:function(){try{h.texImage2D.apply(h,arguments)}catch(Je){console.error("THREE.WebGLState:",Je)}},texImage3D:function(){try{h.texImage3D.apply(h,arguments)}catch(Je){console.error("THREE.WebGLState:",Je)}},scissor:function(Je){!1===fr.equals(Je)&&(h.scissor(Je.x,Je.y,Je.z,Je.w),fr.copy(Je))},viewport:function(Je){!1===Bn.equals(Je)&&(h.viewport(Je.x,Je.y,Je.z,Je.w),Bn.copy(Je))},reset:function(){h.disable(3042),h.disable(2884),h.disable(2929),h.disable(32823),h.disable(3089),h.disable(2960),h.disable(32926),h.blendEquation(32774),h.blendFunc(1,0),h.blendFuncSeparate(1,0,1,0),h.colorMask(!0,!0,!0,!0),h.clearColor(0,0,0,0),h.depthMask(!0),h.depthFunc(513),h.clearDepth(1),h.stencilMask(4294967295),h.stencilFunc(519,0,4294967295),h.stencilOp(7680,7680,7680),h.clearStencil(0),h.cullFace(1029),h.frontFace(2305),h.polygonOffset(0,0),h.activeTexture(33984),h.bindFramebuffer(36160,null),!0===s&&(h.bindFramebuffer(36009,null),h.bindFramebuffer(36008,null)),h.useProgram(null),h.lineWidth(1),h.scissor(0,0,h.canvas.width,h.canvas.height),h.viewport(0,0,h.canvas.width,h.canvas.height),C={},xt=null,Pt={},D=null,A={},P=null,L=!1,H=null,q=null,k=null,O=null,re=null,ne=null,ve=null,Ie=!1,ue=null,je=null,wt=null,nt=null,Ge=null,fr.set(0,0,h.canvas.width,h.canvas.height),Bn.set(0,0,h.canvas.width,h.canvas.height),m.reset(),x.reset(),E.reset()}}}function qy(h,e,r,s,a,c,p){const m=a.isWebGL2,x=a.maxTextures,E=a.maxCubemapSize,C=a.maxTextureSize,D=a.maxSamples,A=new WeakMap;let P,L=!1;try{L="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(Se){}function H(Se,me){return L?new OffscreenCanvas(Se,me):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function q(Se,me,Dt,Xt){let Ln=1;if((Se.width>Xt||Se.height>Xt)&&(Ln=Xt/Math.max(Se.width,Se.height)),Ln<1||!0===me){if("undefined"!=typeof HTMLImageElement&&Se instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&Se instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&Se instanceof ImageBitmap){const qn=me?Gc:Math.floor,Cr=qn(Ln*Se.width),hr=qn(Ln*Se.height);void 0===P&&(P=H(Cr,hr));const Er=Dt?H(Cr,hr):P;return Er.width=Cr,Er.height=hr,Er.getContext("2d").drawImage(Se,0,0,Cr,hr),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Se.width+"x"+Se.height+") to ("+Cr+"x"+hr+")."),Er}return"data"in Se&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Se.width+"x"+Se.height+")."),Se}return Se}function k(Se){return tl(Se.width)&&tl(Se.height)}function re(Se,me){return Se.generateMipmaps&&me&&Se.minFilter!==Pi&&Se.minFilter!==zn}function ne(Se,me,Dt,Xt,Ln=1){h.generateMipmap(Se),s.get(me).__maxMipLevel=Math.log2(Math.max(Dt,Xt,Ln))}function ve(Se,me,Dt){if(!1===m)return me;if(null!==Se){if(void 0!==h[Se])return h[Se];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Se+"'")}let Xt=me;return 6403===me&&(5126===Dt&&(Xt=33326),5131===Dt&&(Xt=33325),5121===Dt&&(Xt=33321)),6407===me&&(5126===Dt&&(Xt=34837),5131===Dt&&(Xt=34843),5121===Dt&&(Xt=32849)),6408===me&&(5126===Dt&&(Xt=34836),5131===Dt&&(Xt=34842),5121===Dt&&(Xt=32856)),(33325===Xt||33326===Xt||34842===Xt||34836===Xt)&&e.get("EXT_color_buffer_float"),Xt}function Ie(Se){return Se===Pi||1004===Se||1005===Se?9728:9729}function ue(Se){const me=Se.target;me.removeEventListener("dispose",ue),function(Se){const me=s.get(Se);void 0!==me.__webglInit&&(h.deleteTexture(me.__webglTexture),s.remove(Se))}(me),me.isVideoTexture&&A.delete(me),p.memory.textures--}function je(Se){const me=Se.target;me.removeEventListener("dispose",je),function(Se){const me=Se.texture,Dt=s.get(Se),Xt=s.get(me);if(Se){if(void 0!==Xt.__webglTexture&&(h.deleteTexture(Xt.__webglTexture),p.memory.textures--),Se.depthTexture&&Se.depthTexture.dispose(),Se.isWebGLCubeRenderTarget)for(let Ln=0;Ln<6;Ln++)h.deleteFramebuffer(Dt.__webglFramebuffer[Ln]),Dt.__webglDepthbuffer&&h.deleteRenderbuffer(Dt.__webglDepthbuffer[Ln]);else h.deleteFramebuffer(Dt.__webglFramebuffer),Dt.__webglDepthbuffer&&h.deleteRenderbuffer(Dt.__webglDepthbuffer),Dt.__webglMultisampledFramebuffer&&h.deleteFramebuffer(Dt.__webglMultisampledFramebuffer),Dt.__webglColorRenderbuffer&&h.deleteRenderbuffer(Dt.__webglColorRenderbuffer),Dt.__webglDepthRenderbuffer&&h.deleteRenderbuffer(Dt.__webglDepthRenderbuffer);if(Se.isWebGLMultipleRenderTargets)for(let Ln=0,qn=me.length;Ln<qn;Ln++){const Cr=s.get(me[Ln]);Cr.__webglTexture&&(h.deleteTexture(Cr.__webglTexture),p.memory.textures--),s.remove(me[Ln])}s.remove(me),s.remove(Se)}}(me)}let Ge=0;function _t(Se,me){const Dt=s.get(Se);if(Se.isVideoTexture&&function(Se){const me=p.render.frame;A.get(Se)!==me&&(A.set(Se,me),Se.update())}(Se),Se.version>0&&Dt.__version!==Se.version){const Xt=Se.image;if(void 0===Xt)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==Xt.complete)return void Dr(Dt,Se,me);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}r.activeTexture(33984+me),r.bindTexture(3553,Dt.__webglTexture)}function Pt(Se,me){const Dt=s.get(Se);Se.version>0&&Dt.__version!==Se.version?function(Se,me,Dt){if(6!==me.image.length)return;Bn(Se,me),r.activeTexture(33984+Dt),r.bindTexture(34067,Se.__webglTexture),h.pixelStorei(37440,me.flipY),h.pixelStorei(37441,me.premultiplyAlpha),h.pixelStorei(3317,me.unpackAlignment),h.pixelStorei(37443,0);const Xt=me&&(me.isCompressedTexture||me.image[0].isCompressedTexture),Ln=me.image[0]&&me.image[0].isDataTexture,qn=[];for(let Gt=0;Gt<6;Gt++)qn[Gt]=Xt||Ln?Ln?me.image[Gt].image:me.image[Gt]:q(me.image[Gt],!1,!0,E);const Cr=qn[0],hr=k(Cr)||m,Er=c.convert(me.format),dr=c.convert(me.type),Je=ve(me.internalFormat,Er,dr);let kn;if(fr(34067,me,hr),Xt){for(let Gt=0;Gt<6;Gt++){kn=qn[Gt].mipmaps;for(let Jn=0;Jn<kn.length;Jn++){const or=kn[Jn];me.format!==ds&&me.format!==Zs?null!==Er?r.compressedTexImage2D(34069+Gt,Jn,Je,or.width,or.height,0,or.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):r.texImage2D(34069+Gt,Jn,Je,or.width,or.height,0,Er,dr,or.data)}}Se.__maxMipLevel=kn.length-1}else{kn=me.mipmaps;for(let Gt=0;Gt<6;Gt++)if(Ln){r.texImage2D(34069+Gt,0,Je,qn[Gt].width,qn[Gt].height,0,Er,dr,qn[Gt].data);for(let Jn=0;Jn<kn.length;Jn++){const mi=kn[Jn].image[Gt].image;r.texImage2D(34069+Gt,Jn+1,Je,mi.width,mi.height,0,Er,dr,mi.data)}}else{r.texImage2D(34069+Gt,0,Je,Er,dr,qn[Gt]);for(let Jn=0;Jn<kn.length;Jn++)r.texImage2D(34069+Gt,Jn+1,Je,Er,dr,kn[Jn].image[Gt])}Se.__maxMipLevel=kn.length}re(me,hr)&&ne(34067,me,Cr.width,Cr.height),Se.__version=me.version,me.onUpdate&&me.onUpdate(me)}(Dt,Se,me):(r.activeTexture(33984+me),r.bindTexture(34067,Dt.__webglTexture))}const wn={1e3:10497,[Tn]:33071,1002:33648},ir={[Pi]:9728,1004:9984,1005:9986,[zn]:9729,1007:9985,1008:9987};function fr(Se,me,Dt){if(Dt?(h.texParameteri(Se,10242,wn[me.wrapS]),h.texParameteri(Se,10243,wn[me.wrapT]),(32879===Se||35866===Se)&&h.texParameteri(Se,32882,wn[me.wrapR]),h.texParameteri(Se,10240,ir[me.magFilter]),h.texParameteri(Se,10241,ir[me.minFilter])):(h.texParameteri(Se,10242,33071),h.texParameteri(Se,10243,33071),(32879===Se||35866===Se)&&h.texParameteri(Se,32882,33071),(me.wrapS!==Tn||me.wrapT!==Tn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),h.texParameteri(Se,10240,Ie(me.magFilter)),h.texParameteri(Se,10241,Ie(me.minFilter)),me.minFilter!==Pi&&me.minFilter!==zn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const Xt=e.get("EXT_texture_filter_anisotropic");if(me.type===Us&&!1===e.has("OES_texture_float_linear")||!1===m&&me.type===Xs&&!1===e.has("OES_texture_half_float_linear"))return;(me.anisotropy>1||s.get(me).__currentAnisotropy)&&(h.texParameterf(Se,Xt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(me.anisotropy,a.getMaxAnisotropy())),s.get(me).__currentAnisotropy=me.anisotropy)}}function Bn(Se,me){void 0===Se.__webglInit&&(Se.__webglInit=!0,me.addEventListener("dispose",ue),Se.__webglTexture=h.createTexture(),p.memory.textures++)}function Dr(Se,me,Dt){let Xt=3553;me.isDataTexture2DArray&&(Xt=35866),me.isDataTexture3D&&(Xt=32879),Bn(Se,me),r.activeTexture(33984+Dt),r.bindTexture(Xt,Se.__webglTexture),h.pixelStorei(37440,me.flipY),h.pixelStorei(37441,me.premultiplyAlpha),h.pixelStorei(3317,me.unpackAlignment),h.pixelStorei(37443,0);const Ln=function(Se){return!m&&(Se.wrapS!==Tn||Se.wrapT!==Tn||Se.minFilter!==Pi&&Se.minFilter!==zn)}(me)&&!1===k(me.image),qn=q(me.image,Ln,!1,C),Cr=k(qn)||m,hr=c.convert(me.format);let Je,Er=c.convert(me.type),dr=ve(me.internalFormat,hr,Er);fr(Xt,me,Cr);const kn=me.mipmaps;if(me.isDepthTexture)dr=6402,m?dr=me.type===Us?36012:1014===me.type?33190:me.type===io?35056:33189:me.type===Us&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),me.format===so&&6402===dr&&1012!==me.type&&1014!==me.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),me.type=1012,Er=c.convert(me.type)),me.format===oo&&6402===dr&&(dr=34041,me.type!==io&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),me.type=io,Er=c.convert(me.type))),r.texImage2D(3553,0,dr,qn.width,qn.height,0,hr,Er,null);else if(me.isDataTexture)if(kn.length>0&&Cr){for(let Gt=0,Jn=kn.length;Gt<Jn;Gt++)Je=kn[Gt],r.texImage2D(3553,Gt,dr,Je.width,Je.height,0,hr,Er,Je.data);me.generateMipmaps=!1,Se.__maxMipLevel=kn.length-1}else r.texImage2D(3553,0,dr,qn.width,qn.height,0,hr,Er,qn.data),Se.__maxMipLevel=0;else if(me.isCompressedTexture){for(let Gt=0,Jn=kn.length;Gt<Jn;Gt++)Je=kn[Gt],me.format!==ds&&me.format!==Zs?null!==hr?r.compressedTexImage2D(3553,Gt,dr,Je.width,Je.height,0,Je.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texImage2D(3553,Gt,dr,Je.width,Je.height,0,hr,Er,Je.data);Se.__maxMipLevel=kn.length-1}else if(me.isDataTexture2DArray)r.texImage3D(35866,0,dr,qn.width,qn.height,qn.depth,0,hr,Er,qn.data),Se.__maxMipLevel=0;else if(me.isDataTexture3D)r.texImage3D(32879,0,dr,qn.width,qn.height,qn.depth,0,hr,Er,qn.data),Se.__maxMipLevel=0;else if(kn.length>0&&Cr){for(let Gt=0,Jn=kn.length;Gt<Jn;Gt++)Je=kn[Gt],r.texImage2D(3553,Gt,dr,hr,Er,Je);me.generateMipmaps=!1,Se.__maxMipLevel=kn.length-1}else r.texImage2D(3553,0,dr,hr,Er,qn),Se.__maxMipLevel=0;re(me,Cr)&&ne(Xt,me,qn.width,qn.height),Se.__version=me.version,me.onUpdate&&me.onUpdate(me)}function Fn(Se,me,Dt,Xt,Ln){const qn=c.convert(Dt.format),Cr=c.convert(Dt.type),hr=ve(Dt.internalFormat,qn,Cr);32879===Ln||35866===Ln?r.texImage3D(Ln,0,hr,me.width,me.height,me.depth,0,qn,Cr,null):r.texImage2D(Ln,0,hr,me.width,me.height,0,qn,Cr,null),r.bindFramebuffer(36160,Se),h.framebufferTexture2D(36160,Xt,Ln,s.get(Dt).__webglTexture,0),r.bindFramebuffer(36160,null)}function Kn(Se,me,Dt){if(h.bindRenderbuffer(36161,Se),me.depthBuffer&&!me.stencilBuffer){let Xt=33189;if(Dt){const Ln=me.depthTexture;Ln&&Ln.isDepthTexture&&(Ln.type===Us?Xt=36012:1014===Ln.type&&(Xt=33190));const qn=$r(me);h.renderbufferStorageMultisample(36161,qn,Xt,me.width,me.height)}else h.renderbufferStorage(36161,Xt,me.width,me.height);h.framebufferRenderbuffer(36160,36096,36161,Se)}else if(me.depthBuffer&&me.stencilBuffer){if(Dt){const Xt=$r(me);h.renderbufferStorageMultisample(36161,Xt,35056,me.width,me.height)}else h.renderbufferStorage(36161,34041,me.width,me.height);h.framebufferRenderbuffer(36160,33306,36161,Se)}else{const Xt=!0===me.isWebGLMultipleRenderTargets?me.texture[0]:me.texture,Ln=c.convert(Xt.format),qn=c.convert(Xt.type),Cr=ve(Xt.internalFormat,Ln,qn);if(Dt){const hr=$r(me);h.renderbufferStorageMultisample(36161,hr,Cr,me.width,me.height)}else h.renderbufferStorage(36161,Cr,me.width,me.height)}h.bindRenderbuffer(36161,null)}function $r(Se){return m&&Se.isWebGLMultisampleRenderTarget?Math.min(D,Se.samples):0}let sn=!1,En=!1;this.allocateTextureUnit=function(){const Se=Ge;return Se>=x&&console.warn("THREE.WebGLTextures: Trying to use "+Se+" texture units while this GPU supports only "+x),Ge+=1,Se},this.resetTextureUnits=function(){Ge=0},this.setTexture2D=_t,this.setTexture2DArray=function(Se,me){const Dt=s.get(Se);Se.version>0&&Dt.__version!==Se.version?Dr(Dt,Se,me):(r.activeTexture(33984+me),r.bindTexture(35866,Dt.__webglTexture))},this.setTexture3D=function(Se,me){const Dt=s.get(Se);Se.version>0&&Dt.__version!==Se.version?Dr(Dt,Se,me):(r.activeTexture(33984+me),r.bindTexture(32879,Dt.__webglTexture))},this.setTextureCube=Pt,this.setupRenderTarget=function(Se){const me=Se.texture,Dt=s.get(Se),Xt=s.get(me);Se.addEventListener("dispose",je),!0!==Se.isWebGLMultipleRenderTargets&&(Xt.__webglTexture=h.createTexture(),Xt.__version=me.version,p.memory.textures++);const Ln=!0===Se.isWebGLCubeRenderTarget,qn=!0===Se.isWebGLMultipleRenderTargets,Cr=!0===Se.isWebGLMultisampleRenderTarget,hr=me.isDataTexture3D||me.isDataTexture2DArray,Er=k(Se)||m;if(m&&me.format===Zs&&(me.type===Us||me.type===Xs)&&(me.format=ds,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),Ln){Dt.__webglFramebuffer=[];for(let dr=0;dr<6;dr++)Dt.__webglFramebuffer[dr]=h.createFramebuffer()}else if(Dt.__webglFramebuffer=h.createFramebuffer(),qn)if(a.drawBuffers){const dr=Se.texture;for(let Je=0,kn=dr.length;Je<kn;Je++){const Gt=s.get(dr[Je]);void 0===Gt.__webglTexture&&(Gt.__webglTexture=h.createTexture(),p.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(Cr)if(m){Dt.__webglMultisampledFramebuffer=h.createFramebuffer(),Dt.__webglColorRenderbuffer=h.createRenderbuffer(),h.bindRenderbuffer(36161,Dt.__webglColorRenderbuffer);const dr=c.convert(me.format),Je=c.convert(me.type),kn=ve(me.internalFormat,dr,Je),Gt=$r(Se);h.renderbufferStorageMultisample(36161,Gt,kn,Se.width,Se.height),r.bindFramebuffer(36160,Dt.__webglMultisampledFramebuffer),h.framebufferRenderbuffer(36160,36064,36161,Dt.__webglColorRenderbuffer),h.bindRenderbuffer(36161,null),Se.depthBuffer&&(Dt.__webglDepthRenderbuffer=h.createRenderbuffer(),Kn(Dt.__webglDepthRenderbuffer,Se,!0)),r.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(Ln){r.bindTexture(34067,Xt.__webglTexture),fr(34067,me,Er);for(let dr=0;dr<6;dr++)Fn(Dt.__webglFramebuffer[dr],Se,me,36064,34069+dr);re(me,Er)&&ne(34067,me,Se.width,Se.height),r.unbindTexture()}else if(qn){const dr=Se.texture;for(let Je=0,kn=dr.length;Je<kn;Je++){const Gt=dr[Je],Jn=s.get(Gt);r.bindTexture(3553,Jn.__webglTexture),fr(3553,Gt,Er),Fn(Dt.__webglFramebuffer,Se,Gt,36064+Je,3553),re(Gt,Er)&&ne(3553,Gt,Se.width,Se.height)}r.unbindTexture()}else{let dr=3553;hr&&(m?dr=me.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),r.bindTexture(dr,Xt.__webglTexture),fr(dr,me,Er),Fn(Dt.__webglFramebuffer,Se,me,36064,dr),re(me,Er)&&ne(dr,me,Se.width,Se.height,Se.depth),r.unbindTexture()}Se.depthBuffer&&function(Se){const me=s.get(Se),Dt=!0===Se.isWebGLCubeRenderTarget;if(Se.depthTexture){if(Dt)throw new Error("target.depthTexture not supported in Cube render targets");!function(Se,me){if(me&&me.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(36160,Se),!me.depthTexture||!me.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!s.get(me.depthTexture).__webglTexture||me.depthTexture.image.width!==me.width||me.depthTexture.image.height!==me.height)&&(me.depthTexture.image.width=me.width,me.depthTexture.image.height=me.height,me.depthTexture.needsUpdate=!0),_t(me.depthTexture,0);const Xt=s.get(me.depthTexture).__webglTexture;if(me.depthTexture.format===so)h.framebufferTexture2D(36160,36096,3553,Xt,0);else{if(me.depthTexture.format!==oo)throw new Error("Unknown depthTexture format");h.framebufferTexture2D(36160,33306,3553,Xt,0)}}(me.__webglFramebuffer,Se)}else if(Dt){me.__webglDepthbuffer=[];for(let Xt=0;Xt<6;Xt++)r.bindFramebuffer(36160,me.__webglFramebuffer[Xt]),me.__webglDepthbuffer[Xt]=h.createRenderbuffer(),Kn(me.__webglDepthbuffer[Xt],Se,!1)}else r.bindFramebuffer(36160,me.__webglFramebuffer),me.__webglDepthbuffer=h.createRenderbuffer(),Kn(me.__webglDepthbuffer,Se,!1);r.bindFramebuffer(36160,null)}(Se)},this.updateRenderTargetMipmap=function(Se){const me=k(Se)||m,Dt=!0===Se.isWebGLMultipleRenderTargets?Se.texture:[Se.texture];for(let Xt=0,Ln=Dt.length;Xt<Ln;Xt++){const qn=Dt[Xt];if(re(qn,me)){const Cr=Se.isWebGLCubeRenderTarget?34067:3553,hr=s.get(qn).__webglTexture;r.bindTexture(Cr,hr),ne(Cr,qn,Se.width,Se.height),r.unbindTexture()}}},this.updateMultisampleRenderTarget=function(Se){if(Se.isWebGLMultisampleRenderTarget)if(m){const me=Se.width,Dt=Se.height;let Xt=16384;Se.depthBuffer&&(Xt|=256),Se.stencilBuffer&&(Xt|=1024);const Ln=s.get(Se);r.bindFramebuffer(36008,Ln.__webglMultisampledFramebuffer),r.bindFramebuffer(36009,Ln.__webglFramebuffer),h.blitFramebuffer(0,0,me,Dt,0,0,me,Dt,Xt,9728),r.bindFramebuffer(36008,null),r.bindFramebuffer(36009,Ln.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(Se,me){Se&&Se.isWebGLRenderTarget&&(!1===sn&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),sn=!0),Se=Se.texture),_t(Se,me)},this.safeSetTextureCube=function(Se,me){Se&&Se.isWebGLCubeRenderTarget&&(!1===En&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),En=!0),Se=Se.texture),Pt(Se,me)}}function Dx(h,e,r){const s=r.isWebGL2;return{convert:function(c){let p;if(c===Xn)return 5121;if(1017===c)return 32819;if(1018===c)return 32820;if(1019===c)return 33635;if(1010===c)return 5120;if(1011===c)return 5122;if(1012===c)return 5123;if(1013===c)return 5124;if(1014===c)return 5125;if(c===Us)return 5126;if(c===Xs)return s?5131:(p=e.get("OES_texture_half_float"),null!==p?p.HALF_FLOAT_OES:null);if(1021===c)return 6406;if(c===Zs)return 6407;if(c===ds)return 6408;if(1024===c)return 6409;if(1025===c)return 6410;if(c===so)return 6402;if(c===oo)return 34041;if(1028===c)return 6403;if(1029===c)return 36244;if(1030===c)return 33319;if(1031===c)return 33320;if(1032===c)return 36248;if(1033===c)return 36249;if(33776===c||33777===c||33778===c||33779===c){if(p=e.get("WEBGL_compressed_texture_s3tc"),null===p)return null;if(33776===c)return p.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===c)return p.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===c)return p.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===c)return p.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===c||35841===c||35842===c||35843===c){if(p=e.get("WEBGL_compressed_texture_pvrtc"),null===p)return null;if(35840===c)return p.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===c)return p.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===c)return p.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===c)return p.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===c)return p=e.get("WEBGL_compressed_texture_etc1"),null!==p?p.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===c||37496===c)&&(p=e.get("WEBGL_compressed_texture_etc"),null!==p)){if(37492===c)return p.COMPRESSED_RGB8_ETC2;if(37496===c)return p.COMPRESSED_RGBA8_ETC2_EAC}return 37808===c||37809===c||37810===c||37811===c||37812===c||37813===c||37814===c||37815===c||37816===c||37817===c||37818===c||37819===c||37820===c||37821===c||37840===c||37841===c||37842===c||37843===c||37844===c||37845===c||37846===c||37847===c||37848===c||37849===c||37850===c||37851===c||37852===c||37853===c?(p=e.get("WEBGL_compressed_texture_astc"),null!==p?c:null):36492===c?(p=e.get("EXT_texture_compression_bptc"),null!==p?c:null):c===io?s?34042:(p=e.get("WEBGL_depth_texture"),null!==p?p.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}Kf.prototype.isMeshDistanceMaterial=!0;class Gg extends xs{constructor(e=[]){super(),this.cameras=e}}Gg.prototype.isArrayCamera=!0;class Vu extends Zr{constructor(){super(),this.type="Group"}}Vu.prototype.isGroup=!0;const a_={type:"move"};class ep{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Vu,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Vu,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new he,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new he),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Vu,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new he,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new he),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,r,s){let a=null,c=null,p=null;const m=this._targetRay,x=this._grip,E=this._hand;if(e&&"visible-blurred"!==r.session.visibilityState)if(null!==m&&(a=r.getPose(e.targetRaySpace,s),null!==a&&(m.matrix.fromArray(a.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),a.linearVelocity?(m.hasLinearVelocity=!0,m.linearVelocity.copy(a.linearVelocity)):m.hasLinearVelocity=!1,a.angularVelocity?(m.hasAngularVelocity=!0,m.angularVelocity.copy(a.angularVelocity)):m.hasAngularVelocity=!1,this.dispatchEvent(a_))),E&&e.hand){p=!0;for(const H of e.hand.values()){const q=r.getJointPose(H,s);if(void 0===E.joints[H.jointName]){const O=new Vu;O.matrixAutoUpdate=!1,O.visible=!1,E.joints[H.jointName]=O,E.add(O)}const k=E.joints[H.jointName];null!==q&&(k.matrix.fromArray(q.transform.matrix),k.matrix.decompose(k.position,k.rotation,k.scale),k.jointRadius=q.radius),k.visible=null!==q}const A=E.joints["index-finger-tip"].position.distanceTo(E.joints["thumb-tip"].position),P=.02,L=.005;E.inputState.pinching&&A>P+L?(E.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!E.inputState.pinching&&A<=P-L&&(E.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==x&&e.gripSpace&&(c=r.getPose(e.gripSpace,s),null!==c&&(x.matrix.fromArray(c.transform.matrix),x.matrix.decompose(x.position,x.rotation,x.scale),c.linearVelocity?(x.hasLinearVelocity=!0,x.linearVelocity.copy(c.linearVelocity)):x.hasLinearVelocity=!1,c.angularVelocity?(x.hasAngularVelocity=!0,x.angularVelocity.copy(c.angularVelocity)):x.hasAngularVelocity=!1));return null!==m&&(m.visible=null!==a),null!==x&&(x.visible=null!==c),null!==E&&(E.visible=null!==p),this}}class l_ extends qi{constructor(e,r){super();const s=this,a=e.state;let c=null,p=1,m=null,x="local-floor",E=null,C=null,D=null,A=null,P=null,L=!1,H=null,q=null,k=null,O=null,re=null,ne=null;const ve=[],Ie=new Map,ue=new xs;ue.layers.enable(1),ue.viewport=new di;const je=new xs;je.layers.enable(2),je.viewport=new di;const wt=[ue,je],nt=new Gg;nt.layers.enable(1),nt.layers.enable(2);let Ge=null,en=null;function bt(Yt){const Fn=Ie.get(Yt.inputSource);Fn&&Fn.dispatchEvent({type:Yt.type,data:Yt.inputSource})}function _t(){Ie.forEach(function(Yt,Fn){Yt.disconnect(Fn)}),Ie.clear(),Ge=null,en=null,a.bindXRFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),D&&r.deleteFramebuffer(D),H&&r.deleteFramebuffer(H),q&&r.deleteRenderbuffer(q),k&&r.deleteRenderbuffer(k),D=null,H=null,q=null,k=null,P=null,A=null,C=null,c=null,Dr.stop(),s.isPresenting=!1,s.dispatchEvent({type:"sessionend"})}function Ct(Yt){const Fn=c.inputSources;for(let Kn=0;Kn<ve.length;Kn++)Ie.set(Fn[Kn],ve[Kn]);for(let Kn=0;Kn<Yt.removed.length;Kn++){const yt=Yt.removed[Kn],gr=Ie.get(yt);gr&&(gr.dispatchEvent({type:"disconnected",data:yt}),Ie.delete(yt))}for(let Kn=0;Kn<Yt.added.length;Kn++){const yt=Yt.added[Kn],gr=Ie.get(yt);gr&&gr.dispatchEvent({type:"connected",data:yt})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Yt){let Fn=ve[Yt];return void 0===Fn&&(Fn=new ep,ve[Yt]=Fn),Fn.getTargetRaySpace()},this.getControllerGrip=function(Yt){let Fn=ve[Yt];return void 0===Fn&&(Fn=new ep,ve[Yt]=Fn),Fn.getGripSpace()},this.getHand=function(Yt){let Fn=ve[Yt];return void 0===Fn&&(Fn=new ep,ve[Yt]=Fn),Fn.getHandSpace()},this.setFramebufferScaleFactor=function(Yt){p=Yt,!0===s.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Yt){x=Yt,!0===s.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return m},this.getBaseLayer=function(){return null!==A?A:P},this.getBinding=function(){return C},this.getFrame=function(){return O},this.getSession=function(){return c},this.setSession=function(){var Yt=(0,G.Z)(function*(Fn){if(c=Fn,null!==c){c.addEventListener("select",bt),c.addEventListener("selectstart",bt),c.addEventListener("selectend",bt),c.addEventListener("squeeze",bt),c.addEventListener("squeezestart",bt),c.addEventListener("squeezeend",bt),c.addEventListener("end",_t),c.addEventListener("inputsourceschange",Ct);const Kn=r.getContextAttributes();if(!0!==Kn.xrCompatible&&(yield r.makeXRCompatible()),void 0===c.renderState.layers)P=new XRWebGLLayer(c,r,{antialias:Kn.antialias,alpha:Kn.alpha,depth:Kn.depth,stencil:Kn.stencil,framebufferScaleFactor:p}),c.updateRenderState({baseLayer:P});else if(r instanceof WebGLRenderingContext)P=new XRWebGLLayer(c,r,{antialias:!0,alpha:Kn.alpha,depth:Kn.depth,stencil:Kn.stencil,framebufferScaleFactor:p}),c.updateRenderState({layers:[P]});else{L=Kn.antialias;let yt=null;Kn.depth&&(ne=256,Kn.stencil&&(ne|=1024),re=Kn.stencil?33306:36096,yt=Kn.stencil?35056:33190);const gr={colorFormat:Kn.alpha?32856:32849,depthFormat:yt,scaleFactor:p};C=new XRWebGLBinding(c,r),A=C.createProjectionLayer(gr),D=r.createFramebuffer(),c.updateRenderState({layers:[A]}),L&&(H=r.createFramebuffer(),q=r.createRenderbuffer(),r.bindRenderbuffer(36161,q),r.renderbufferStorageMultisample(36161,4,32856,A.textureWidth,A.textureHeight),a.bindFramebuffer(36160,H),r.framebufferRenderbuffer(36160,36064,36161,q),r.bindRenderbuffer(36161,null),null!==yt&&(k=r.createRenderbuffer(),r.bindRenderbuffer(36161,k),r.renderbufferStorageMultisample(36161,4,yt,A.textureWidth,A.textureHeight),r.framebufferRenderbuffer(36160,re,36161,k),r.bindRenderbuffer(36161,null)),a.bindFramebuffer(36160,null))}m=yield c.requestReferenceSpace(x),Dr.setContext(c),Dr.start(),s.isPresenting=!0,s.dispatchEvent({type:"sessionstart"})}});return function(Fn){return Yt.apply(this,arguments)}}();const xt=new he,Pt=new he;function ir(Yt,Fn){null===Fn?Yt.matrixWorld.copy(Yt.matrix):Yt.matrixWorld.multiplyMatrices(Fn.matrixWorld,Yt.matrix),Yt.matrixWorldInverse.copy(Yt.matrixWorld).invert()}this.updateCamera=function(Yt){if(null===c)return;nt.near=je.near=ue.near=Yt.near,nt.far=je.far=ue.far=Yt.far,(Ge!==nt.near||en!==nt.far)&&(c.updateRenderState({depthNear:nt.near,depthFar:nt.far}),Ge=nt.near,en=nt.far);const Fn=Yt.parent,Kn=nt.cameras;ir(nt,Fn);for(let gr=0;gr<Kn.length;gr++)ir(Kn[gr],Fn);nt.matrixWorld.decompose(nt.position,nt.quaternion,nt.scale),Yt.position.copy(nt.position),Yt.quaternion.copy(nt.quaternion),Yt.scale.copy(nt.scale),Yt.matrix.copy(nt.matrix),Yt.matrixWorld.copy(nt.matrixWorld);const yt=Yt.children;for(let gr=0,kr=yt.length;gr<kr;gr++)yt[gr].updateMatrixWorld(!0);2===Kn.length?function(Yt,Fn,Kn){xt.setFromMatrixPosition(Fn.matrixWorld),Pt.setFromMatrixPosition(Kn.matrixWorld);const yt=xt.distanceTo(Pt),gr=Fn.projectionMatrix.elements,kr=Kn.projectionMatrix.elements,sr=gr[14]/(gr[10]-1),lr=gr[14]/(gr[10]+1),$r=(gr[9]+1)/gr[5],At=(gr[9]-1)/gr[5],sn=(gr[8]-1)/gr[0],En=(kr[8]+1)/kr[0],cr=sr*sn,An=sr*En,Se=yt/(-sn+En),me=Se*-sn;Fn.matrixWorld.decompose(Yt.position,Yt.quaternion,Yt.scale),Yt.translateX(me),Yt.translateZ(Se),Yt.matrixWorld.compose(Yt.position,Yt.quaternion,Yt.scale),Yt.matrixWorldInverse.copy(Yt.matrixWorld).invert();const Dt=sr+Se,Xt=lr+Se;Yt.projectionMatrix.makePerspective(cr-me,An+(yt-me),$r*lr/Xt*Dt,At*lr/Xt*Dt,Dt,Xt)}(nt,ue,je):nt.projectionMatrix.copy(ue.projectionMatrix)},this.getCamera=function(){return nt},this.getFoveation=function(){return null!==A?A.fixedFoveation:null!==P?P.fixedFoveation:void 0},this.setFoveation=function(Yt){null!==A&&(A.fixedFoveation=Yt),null!==P&&void 0!==P.fixedFoveation&&(P.fixedFoveation=Yt)};let fr=null;const Dr=new Zc;Dr.setAnimationLoop(function(Yt,Fn){if(E=Fn.getViewerPose(m),O=Fn,null!==E){const yt=E.views;null!==P&&a.bindXRFramebuffer(P.framebuffer);let gr=!1;yt.length!==nt.cameras.length&&(nt.cameras.length=0,gr=!0);for(let kr=0;kr<yt.length;kr++){const sr=yt[kr];let lr=null;if(null!==P)lr=P.getViewport(sr);else{const At=C.getViewSubImage(A,sr);a.bindXRFramebuffer(D),void 0!==At.depthStencilTexture&&r.framebufferTexture2D(36160,re,3553,At.depthStencilTexture,0),r.framebufferTexture2D(36160,36064,3553,At.colorTexture,0),lr=At.viewport}const $r=wt[kr];$r.matrix.fromArray(sr.transform.matrix),$r.projectionMatrix.fromArray(sr.projectionMatrix),$r.viewport.set(lr.x,lr.y,lr.width,lr.height),0===kr&&nt.matrix.copy($r.matrix),!0===gr&&nt.cameras.push($r)}L&&(a.bindXRFramebuffer(H),null!==ne&&r.clear(ne))}const Kn=c.inputSources;for(let yt=0;yt<ve.length;yt++)ve[yt].update(Kn[yt],Fn,m);if(fr&&fr(Yt,Fn),L){const yt=A.textureWidth,gr=A.textureHeight;a.bindFramebuffer(36008,H),a.bindFramebuffer(36009,D),r.invalidateFramebuffer(36008,[re]),r.invalidateFramebuffer(36009,[re]),r.blitFramebuffer(0,0,yt,gr,0,0,yt,gr,16384,9728),r.invalidateFramebuffer(36008,[36064]),a.bindFramebuffer(36008,null),a.bindFramebuffer(36009,null),a.bindFramebuffer(36160,H)}O=null}),this.setAnimationLoop=function(Yt){fr=Yt},this.dispose=function(){}}}function c_(h){function s(k,O){k.opacity.value=O.opacity,O.color&&k.diffuse.value.copy(O.color),O.emissive&&k.emissive.value.copy(O.emissive).multiplyScalar(O.emissiveIntensity),O.map&&(k.map.value=O.map),O.alphaMap&&(k.alphaMap.value=O.alphaMap),O.specularMap&&(k.specularMap.value=O.specularMap),O.alphaTest>0&&(k.alphaTest.value=O.alphaTest);const re=h.get(O).envMap;if(re){k.envMap.value=re,k.flipEnvMap.value=re.isCubeTexture&&!1===re.isRenderTargetTexture?-1:1,k.reflectivity.value=O.reflectivity,k.ior.value=O.ior,k.refractionRatio.value=O.refractionRatio;const Ie=h.get(re).__maxMipLevel;void 0!==Ie&&(k.maxMipLevel.value=Ie)}let ne,ve;O.lightMap&&(k.lightMap.value=O.lightMap,k.lightMapIntensity.value=O.lightMapIntensity),O.aoMap&&(k.aoMap.value=O.aoMap,k.aoMapIntensity.value=O.aoMapIntensity),O.map?ne=O.map:O.specularMap?ne=O.specularMap:O.displacementMap?ne=O.displacementMap:O.normalMap?ne=O.normalMap:O.bumpMap?ne=O.bumpMap:O.roughnessMap?ne=O.roughnessMap:O.metalnessMap?ne=O.metalnessMap:O.alphaMap?ne=O.alphaMap:O.emissiveMap?ne=O.emissiveMap:O.clearcoatMap?ne=O.clearcoatMap:O.clearcoatNormalMap?ne=O.clearcoatNormalMap:O.clearcoatRoughnessMap?ne=O.clearcoatRoughnessMap:O.specularIntensityMap?ne=O.specularIntensityMap:O.specularTintMap?ne=O.specularTintMap:O.transmissionMap?ne=O.transmissionMap:O.thicknessMap&&(ne=O.thicknessMap),void 0!==ne&&(ne.isWebGLRenderTarget&&(ne=ne.texture),!0===ne.matrixAutoUpdate&&ne.updateMatrix(),k.uvTransform.value.copy(ne.matrix)),O.aoMap?ve=O.aoMap:O.lightMap&&(ve=O.lightMap),void 0!==ve&&(ve.isWebGLRenderTarget&&(ve=ve.texture),!0===ve.matrixAutoUpdate&&ve.updateMatrix(),k.uv2Transform.value.copy(ve.matrix))}function D(k,O){k.roughness.value=O.roughness,k.metalness.value=O.metalness,O.roughnessMap&&(k.roughnessMap.value=O.roughnessMap),O.metalnessMap&&(k.metalnessMap.value=O.metalnessMap),O.emissiveMap&&(k.emissiveMap.value=O.emissiveMap),O.bumpMap&&(k.bumpMap.value=O.bumpMap,k.bumpScale.value=O.bumpScale,O.side===Ve&&(k.bumpScale.value*=-1)),O.normalMap&&(k.normalMap.value=O.normalMap,k.normalScale.value.copy(O.normalScale),O.side===Ve&&k.normalScale.value.negate()),O.displacementMap&&(k.displacementMap.value=O.displacementMap,k.displacementScale.value=O.displacementScale,k.displacementBias.value=O.displacementBias),h.get(O).envMap&&(k.envMapIntensity.value=O.envMapIntensity)}return{refreshFogUniforms:function(k,O){k.fogColor.value.copy(O.color),O.isFog?(k.fogNear.value=O.near,k.fogFar.value=O.far):O.isFogExp2&&(k.fogDensity.value=O.density)},refreshMaterialUniforms:function(k,O,re,ne,ve){O.isMeshBasicMaterial?s(k,O):O.isMeshLambertMaterial?(s(k,O),function(k,O){O.emissiveMap&&(k.emissiveMap.value=O.emissiveMap)}(k,O)):O.isMeshToonMaterial?(s(k,O),function(k,O){O.gradientMap&&(k.gradientMap.value=O.gradientMap),O.emissiveMap&&(k.emissiveMap.value=O.emissiveMap),O.bumpMap&&(k.bumpMap.value=O.bumpMap,k.bumpScale.value=O.bumpScale,O.side===Ve&&(k.bumpScale.value*=-1)),O.normalMap&&(k.normalMap.value=O.normalMap,k.normalScale.value.copy(O.normalScale),O.side===Ve&&k.normalScale.value.negate()),O.displacementMap&&(k.displacementMap.value=O.displacementMap,k.displacementScale.value=O.displacementScale,k.displacementBias.value=O.displacementBias)}(k,O)):O.isMeshPhongMaterial?(s(k,O),function(k,O){k.specular.value.copy(O.specular),k.shininess.value=Math.max(O.shininess,1e-4),O.emissiveMap&&(k.emissiveMap.value=O.emissiveMap),O.bumpMap&&(k.bumpMap.value=O.bumpMap,k.bumpScale.value=O.bumpScale,O.side===Ve&&(k.bumpScale.value*=-1)),O.normalMap&&(k.normalMap.value=O.normalMap,k.normalScale.value.copy(O.normalScale),O.side===Ve&&k.normalScale.value.negate()),O.displacementMap&&(k.displacementMap.value=O.displacementMap,k.displacementScale.value=O.displacementScale,k.displacementBias.value=O.displacementBias)}(k,O)):O.isMeshStandardMaterial?(s(k,O),O.isMeshPhysicalMaterial?function(k,O,re){D(k,O),k.ior.value=O.ior,O.sheenTint&&k.sheenTint.value.copy(O.sheenTint),O.clearcoat>0&&(k.clearcoat.value=O.clearcoat,k.clearcoatRoughness.value=O.clearcoatRoughness,O.clearcoatMap&&(k.clearcoatMap.value=O.clearcoatMap),O.clearcoatRoughnessMap&&(k.clearcoatRoughnessMap.value=O.clearcoatRoughnessMap),O.clearcoatNormalMap&&(k.clearcoatNormalScale.value.copy(O.clearcoatNormalScale),k.clearcoatNormalMap.value=O.clearcoatNormalMap,O.side===Ve&&k.clearcoatNormalScale.value.negate())),O.transmission>0&&(k.transmission.value=O.transmission,k.transmissionSamplerMap.value=re.texture,k.transmissionSamplerSize.value.set(re.width,re.height),O.transmissionMap&&(k.transmissionMap.value=O.transmissionMap),k.thickness.value=O.thickness,O.thicknessMap&&(k.thicknessMap.value=O.thicknessMap),k.attenuationDistance.value=O.attenuationDistance,k.attenuationTint.value.copy(O.attenuationTint)),k.specularIntensity.value=O.specularIntensity,k.specularTint.value.copy(O.specularTint),O.specularIntensityMap&&(k.specularIntensityMap.value=O.specularIntensityMap),O.specularTintMap&&(k.specularTintMap.value=O.specularTintMap)}(k,O,ve):D(k,O)):O.isMeshMatcapMaterial?(s(k,O),function(k,O){O.matcap&&(k.matcap.value=O.matcap),O.bumpMap&&(k.bumpMap.value=O.bumpMap,k.bumpScale.value=O.bumpScale,O.side===Ve&&(k.bumpScale.value*=-1)),O.normalMap&&(k.normalMap.value=O.normalMap,k.normalScale.value.copy(O.normalScale),O.side===Ve&&k.normalScale.value.negate()),O.displacementMap&&(k.displacementMap.value=O.displacementMap,k.displacementScale.value=O.displacementScale,k.displacementBias.value=O.displacementBias)}(k,O)):O.isMeshDepthMaterial?(s(k,O),function(k,O){O.displacementMap&&(k.displacementMap.value=O.displacementMap,k.displacementScale.value=O.displacementScale,k.displacementBias.value=O.displacementBias)}(k,O)):O.isMeshDistanceMaterial?(s(k,O),function(k,O){O.displacementMap&&(k.displacementMap.value=O.displacementMap,k.displacementScale.value=O.displacementScale,k.displacementBias.value=O.displacementBias),k.referencePosition.value.copy(O.referencePosition),k.nearDistance.value=O.nearDistance,k.farDistance.value=O.farDistance}(k,O)):O.isMeshNormalMaterial?(s(k,O),function(k,O){O.bumpMap&&(k.bumpMap.value=O.bumpMap,k.bumpScale.value=O.bumpScale,O.side===Ve&&(k.bumpScale.value*=-1)),O.normalMap&&(k.normalMap.value=O.normalMap,k.normalScale.value.copy(O.normalScale),O.side===Ve&&k.normalScale.value.negate()),O.displacementMap&&(k.displacementMap.value=O.displacementMap,k.displacementScale.value=O.displacementScale,k.displacementBias.value=O.displacementBias)}(k,O)):O.isLineBasicMaterial?(function(k,O){k.diffuse.value.copy(O.color),k.opacity.value=O.opacity}(k,O),O.isLineDashedMaterial&&function(k,O){k.dashSize.value=O.dashSize,k.totalSize.value=O.dashSize+O.gapSize,k.scale.value=O.scale}(k,O)):O.isPointsMaterial?function(k,O,re,ne){let ve;k.diffuse.value.copy(O.color),k.opacity.value=O.opacity,k.size.value=O.size*re,k.scale.value=.5*ne,O.map&&(k.map.value=O.map),O.alphaMap&&(k.alphaMap.value=O.alphaMap),O.alphaTest>0&&(k.alphaTest.value=O.alphaTest),O.map?ve=O.map:O.alphaMap&&(ve=O.alphaMap),void 0!==ve&&(!0===ve.matrixAutoUpdate&&ve.updateMatrix(),k.uvTransform.value.copy(ve.matrix))}(k,O,re,ne):O.isSpriteMaterial?function(k,O){let re;k.diffuse.value.copy(O.color),k.opacity.value=O.opacity,k.rotation.value=O.rotation,O.map&&(k.map.value=O.map),O.alphaMap&&(k.alphaMap.value=O.alphaMap),O.alphaTest>0&&(k.alphaTest.value=O.alphaTest),O.map?re=O.map:O.alphaMap&&(re=O.alphaMap),void 0!==re&&(!0===re.matrixAutoUpdate&&re.updateMatrix(),k.uvTransform.value.copy(re.matrix))}(k,O):O.isShadowMaterial?(k.color.value.copy(O.color),k.opacity.value=O.opacity):O.isShaderMaterial&&(O.uniformsNeedUpdate=!1)}}}function Zi(h={}){const e=void 0!==h.canvas?h.canvas:function(){const h=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return h.style.display="block",h}(),r=void 0!==h.context?h.context:null,s=void 0!==h.alpha&&h.alpha,a=void 0===h.depth||h.depth,c=void 0===h.stencil||h.stencil,p=void 0!==h.antialias&&h.antialias,m=void 0===h.premultipliedAlpha||h.premultipliedAlpha,x=void 0!==h.preserveDrawingBuffer&&h.preserveDrawingBuffer,E=void 0!==h.powerPreference?h.powerPreference:"default",C=void 0!==h.failIfMajorPerformanceCaveat&&h.failIfMajorPerformanceCaveat;let D=null,A=null;const P=[],L=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Rs,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const H=this;let q=!1,k=0,O=0,re=null,ne=-1,ve=null;const Ie=new di,ue=new di;let je=null,wt=e.width,nt=e.height,Ge=1,en=null,bt=null;const _t=new di(0,0,wt,nt),Ct=new di(0,0,wt,nt);let xt=!1;const Pt=[],wn=new Ih;let ir=!1,fr=!1,Bn=null;const Dr=new Nn,Yt=new he,Fn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Kn(){return null===re?Ge:1}let kr,sr,lr,$r,At,sn,En,cr,An,Se,me,Dt,Xt,Ln,qn,Cr,hr,Er,dr,Je,kn,Gt,Jn,yt=r;function gr(ge,ct){for(let rt=0;rt<ge.length;rt++){const tn=e.getContext(ge[rt],ct);if(null!==tn)return tn}return null}try{const ge={alpha:s,depth:a,stencil:c,antialias:p,premultipliedAlpha:m,preserveDrawingBuffer:x,powerPreference:E,failIfMajorPerformanceCaveat:C};if(e.addEventListener("webglcontextlost",So,!1),e.addEventListener("webglcontextrestored",ua,!1),null===yt){const ct=["webgl2","webgl","experimental-webgl"];if(!0===H.isWebGL1Renderer&&ct.shift(),yt=gr(ct,ge),null===yt)throw gr(ct)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===yt.getShaderPrecisionFormat&&(yt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ge){throw console.error("THREE.WebGLRenderer: "+ge.message),ge}function or(){kr=new _y(yt),sr=new Dc(yt,kr,h),kr.init(sr),Gt=new Dx(yt,kr,sr),lr=new o_(yt,kr,sr),Pt[0]=1029,$r=new xy(yt),At=new s_,sn=new qy(yt,kr,lr,At,sr,Gt,$r),En=new Va(H),cr=new Fv(H),An=new qd(yt,sr),Jn=new ho(yt,kr,An,sr),Se=new by(yt,An,$r,Jn),me=new Bv(yt,Se,An,$r),dr=new Gh(yt),Cr=new Ua(At),Dt=new Vg(H,En,cr,kr,sr,Jn,Cr),Xt=new c_(At),Ln=new Zf(At),qn=new Wy(kr,sr),Er=new zi(H,En,lr,me,m),hr=new Jf(H,me,sr),Je=new ca(yt,kr,$r,sr),kn=new bd(yt,kr,$r,sr),$r.programs=Dt.programs,H.capabilities=sr,H.extensions=kr,H.properties=At,H.renderLists=Ln,H.shadowMap=hr,H.state=lr,H.info=$r}or();const mi=new l_(H,yt);function So(ge){ge.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),q=!0}function ua(){console.log("THREE.WebGLRenderer: Context Restored."),q=!1;const ge=$r.autoReset,ct=hr.enabled,rt=hr.autoUpdate,Mt=hr.needsUpdate,tn=hr.type;or(),$r.autoReset=ge,hr.enabled=ct,hr.autoUpdate=rt,hr.needsUpdate=Mt,hr.type=tn}function uu(ge){const ct=ge.target;ct.removeEventListener("dispose",uu),function(ge){(function(ge){const ct=At.get(ge).programs;void 0!==ct&&ct.forEach(function(rt){Dt.releaseProgram(rt)})})(ge),At.remove(ge)}(ct)}this.xr=mi,this.getContext=function(){return yt},this.getContextAttributes=function(){return yt.getContextAttributes()},this.forceContextLoss=function(){const ge=kr.get("WEBGL_lose_context");ge&&ge.loseContext()},this.forceContextRestore=function(){const ge=kr.get("WEBGL_lose_context");ge&&ge.restoreContext()},this.getPixelRatio=function(){return Ge},this.setPixelRatio=function(ge){void 0!==ge&&(Ge=ge,this.setSize(wt,nt,!1))},this.getSize=function(ge){return ge.set(wt,nt)},this.setSize=function(ge,ct,rt){mi.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(wt=ge,nt=ct,e.width=Math.floor(ge*Ge),e.height=Math.floor(ct*Ge),!1!==rt&&(e.style.width=ge+"px",e.style.height=ct+"px"),this.setViewport(0,0,ge,ct))},this.getDrawingBufferSize=function(ge){return ge.set(wt*Ge,nt*Ge).floor()},this.setDrawingBufferSize=function(ge,ct,rt){wt=ge,nt=ct,Ge=rt,e.width=Math.floor(ge*rt),e.height=Math.floor(ct*rt),this.setViewport(0,0,ge,ct)},this.getCurrentViewport=function(ge){return ge.copy(Ie)},this.getViewport=function(ge){return ge.copy(_t)},this.setViewport=function(ge,ct,rt,Mt){ge.isVector4?_t.set(ge.x,ge.y,ge.z,ge.w):_t.set(ge,ct,rt,Mt),lr.viewport(Ie.copy(_t).multiplyScalar(Ge).floor())},this.getScissor=function(ge){return ge.copy(Ct)},this.setScissor=function(ge,ct,rt,Mt){ge.isVector4?Ct.set(ge.x,ge.y,ge.z,ge.w):Ct.set(ge,ct,rt,Mt),lr.scissor(ue.copy(Ct).multiplyScalar(Ge).floor())},this.getScissorTest=function(){return xt},this.setScissorTest=function(ge){lr.setScissorTest(xt=ge)},this.setOpaqueSort=function(ge){en=ge},this.setTransparentSort=function(ge){bt=ge},this.getClearColor=function(ge){return ge.copy(Er.getClearColor())},this.setClearColor=function(){Er.setClearColor.apply(Er,arguments)},this.getClearAlpha=function(){return Er.getClearAlpha()},this.setClearAlpha=function(){Er.setClearAlpha.apply(Er,arguments)},this.clear=function(ge,ct,rt){let Mt=0;(void 0===ge||ge)&&(Mt|=16384),(void 0===ct||ct)&&(Mt|=256),(void 0===rt||rt)&&(Mt|=1024),yt.clear(Mt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",So,!1),e.removeEventListener("webglcontextrestored",ua,!1),Ln.dispose(),qn.dispose(),At.dispose(),En.dispose(),cr.dispose(),me.dispose(),Jn.dispose(),mi.dispose(),mi.removeEventListener("sessionstart",rv),mi.removeEventListener("sessionend",zm),Bn&&(Bn.dispose(),Bn=null),Vd.stop()},this.renderBufferImmediate=function(ge,ct){Jn.initAttributes();const rt=At.get(ge);ge.hasPositions&&!rt.position&&(rt.position=yt.createBuffer()),ge.hasNormals&&!rt.normal&&(rt.normal=yt.createBuffer()),ge.hasUvs&&!rt.uv&&(rt.uv=yt.createBuffer()),ge.hasColors&&!rt.color&&(rt.color=yt.createBuffer());const Mt=ct.getAttributes();ge.hasPositions&&(yt.bindBuffer(34962,rt.position),yt.bufferData(34962,ge.positionArray,35048),Jn.enableAttribute(Mt.position.location),yt.vertexAttribPointer(Mt.position.location,3,5126,!1,0,0)),ge.hasNormals&&(yt.bindBuffer(34962,rt.normal),yt.bufferData(34962,ge.normalArray,35048),Jn.enableAttribute(Mt.normal.location),yt.vertexAttribPointer(Mt.normal.location,3,5126,!1,0,0)),ge.hasUvs&&(yt.bindBuffer(34962,rt.uv),yt.bufferData(34962,ge.uvArray,35048),Jn.enableAttribute(Mt.uv.location),yt.vertexAttribPointer(Mt.uv.location,2,5126,!1,0,0)),ge.hasColors&&(yt.bindBuffer(34962,rt.color),yt.bufferData(34962,ge.colorArray,35048),Jn.enableAttribute(Mt.color.location),yt.vertexAttribPointer(Mt.color.location,3,5126,!1,0,0)),Jn.disableUnusedAttributes(),yt.drawArrays(4,0,ge.count),ge.count=0},this.renderBufferDirect=function(ge,ct,rt,Mt,tn,qr){null===ct&&(ct=Fn);const _r=tn.isMesh&&tn.matrixWorld.determinant()<0,br=Gm(ge,ct,Mt,tn);lr.setMaterial(Mt,_r);let ni=rt.index;const Wi=rt.attributes.position;if(null===ni){if(void 0===Wi||0===Wi.count)return}else if(0===ni.count)return;let yi=1;!0===Mt.wireframe&&(ni=Se.getWireframeAttribute(rt),yi=2),(void 0!==rt.morphAttributes.position||void 0!==rt.morphAttributes.normal)&&dr.update(tn,rt,Mt,br),Jn.setup(tn,Mt,br,rt,ni);let xi,Rr=Je;null!==ni&&(xi=An.get(ni),Rr=kn,Rr.setIndex(xi));const zd=null!==ni?ni.count:Wi.count,no=rt.drawRange.start*yi,hu=rt.drawRange.count*yi,Ul=null!==qr?qr.start*yi:0,Yu=null!==qr?qr.count*yi:1/0,Hd=Math.max(no,Ul),Co=Math.min(zd,no+hu,Ul+Yu)-1,da=Math.max(0,Co-Hd+1);if(0!==da){if(tn.isMesh)!0===Mt.wireframe?(lr.setLineWidth(Mt.wireframeLinewidth*Kn()),Rr.setMode(1)):Rr.setMode(4);else if(tn.isLine){let fa=Mt.linewidth;void 0===fa&&(fa=1),lr.setLineWidth(fa*Kn()),Rr.setMode(tn.isLineSegments?1:tn.isLineLoop?2:3)}else tn.isPoints?Rr.setMode(0):tn.isSprite&&Rr.setMode(4);if(tn.isInstancedMesh)Rr.renderInstances(Hd,da,tn.count);else if(rt.isInstancedBufferGeometry){const fa=Math.min(rt.instanceCount,rt._maxInstanceCount);Rr.renderInstances(Hd,da,fa)}else Rr.render(Hd,da)}},this.compile=function(ge,ct){A=qn.get(ge),A.init(),L.push(A),ge.traverseVisible(function(rt){rt.isLight&&rt.layers.test(ct.layers)&&(A.pushLight(rt),rt.castShadow&&A.pushShadow(rt))}),A.setupLights(H.physicallyCorrectLights),ge.traverse(function(rt){const Mt=rt.material;if(Mt)if(Array.isArray(Mt))for(let tn=0;tn<Mt.length;tn++)Hm(Mt[tn],ge,rt);else Hm(Mt,ge,rt)}),L.pop(),A=null};let Um=null;function rv(){Vd.stop()}function zm(){Vd.start()}const Vd=new Zc;function iv(ge,ct,rt,Mt){if(!1===ge.visible)return;if(ge.layers.test(ct.layers))if(ge.isGroup)rt=ge.renderOrder;else if(ge.isLOD)!0===ge.autoUpdate&&ge.update(ct);else if(ge.isLight)A.pushLight(ge),ge.castShadow&&A.pushShadow(ge);else if(ge.isSprite){if(!ge.frustumCulled||wn.intersectsSprite(ge)){Mt&&Yt.setFromMatrixPosition(ge.matrixWorld).applyMatrix4(Dr);const _r=me.update(ge),br=ge.material;br.visible&&D.push(ge,_r,br,rt,Yt.z,null)}}else if(ge.isImmediateRenderObject)Mt&&Yt.setFromMatrixPosition(ge.matrixWorld).applyMatrix4(Dr),D.push(ge,null,ge.material,rt,Yt.z,null);else if((ge.isMesh||ge.isLine||ge.isPoints)&&(ge.isSkinnedMesh&&ge.skeleton.frame!==$r.render.frame&&(ge.skeleton.update(),ge.skeleton.frame=$r.render.frame),!ge.frustumCulled||wn.intersectsObject(ge))){Mt&&Yt.setFromMatrixPosition(ge.matrixWorld).applyMatrix4(Dr);const _r=me.update(ge),br=ge.material;if(Array.isArray(br)){const ni=_r.groups;for(let Wi=0,yi=ni.length;Wi<yi;Wi++){const xi=ni[Wi],Rr=br[xi.materialIndex];Rr&&Rr.visible&&D.push(ge,_r,Rr,rt,Yt.z,xi)}}else br.visible&&D.push(ge,_r,br,rt,Yt.z,null)}const qr=ge.children;for(let _r=0,br=qr.length;_r<br;_r++)iv(qr[_r],ct,rt,Mt)}function sv(ge,ct,rt,Mt){const tn=ge.opaque,qr=ge.transmissive,_r=ge.transparent;A.setupLightsView(rt),qr.length>0&&function(ge,ct,rt){null===Bn&&(Bn=new(!0===p&&!0===sr.isWebGL2?_c:No)(1024,1024,{generateMipmaps:!0,type:null!==Gt.convert(Xs)?Xs:Xn,minFilter:1008,magFilter:Pi,wrapS:Tn,wrapT:Tn}));const Mt=H.getRenderTarget();H.setRenderTarget(Bn),H.clear();const tn=H.toneMapping;H.toneMapping=0,Np(ge,ct,rt),H.toneMapping=tn,sn.updateMultisampleRenderTarget(Bn),sn.updateRenderTargetMipmap(Bn),H.setRenderTarget(Mt)}(tn,ct,rt),Mt&&lr.viewport(Ie.copy(Mt)),tn.length>0&&Np(tn,ct,rt),qr.length>0&&Np(qr,ct,rt),_r.length>0&&Np(_r,ct,rt)}function Np(ge,ct,rt){const Mt=!0===ct.isScene?ct.overrideMaterial:null;for(let tn=0,qr=ge.length;tn<qr;tn++){const _r=ge[tn],br=_r.object,ni=_r.geometry,Wi=null===Mt?_r.material:Mt,yi=_r.group;br.layers.test(rt.layers)&&mb(br,ct,rt,ni,Wi,yi)}}function mb(ge,ct,rt,Mt,tn,qr){if(ge.onBeforeRender(H,ct,rt,Mt,tn,qr),ge.modelViewMatrix.multiplyMatrices(rt.matrixWorldInverse,ge.matrixWorld),ge.normalMatrix.getNormalMatrix(ge.modelViewMatrix),ge.isImmediateRenderObject){const _r=Gm(rt,ct,tn,ge);lr.setMaterial(tn),Jn.reset(),function(ge,ct){ge.render(function(rt){H.renderBufferImmediate(rt,ct)})}(ge,_r)}else!0===tn.transparent&&2===tn.side?(tn.side=Ve,tn.needsUpdate=!0,H.renderBufferDirect(rt,ct,Mt,tn,ge,qr),tn.side=0,tn.needsUpdate=!0,H.renderBufferDirect(rt,ct,Mt,tn,ge,qr),tn.side=2):H.renderBufferDirect(rt,ct,Mt,tn,ge,qr);ge.onAfterRender(H,ct,rt,Mt,tn,qr)}function Hm(ge,ct,rt){!0!==ct.isScene&&(ct=Fn);const Mt=At.get(ge),tn=A.state.lights,_r=tn.state.version,br=Dt.getParameters(ge,tn.state,A.state.shadowsArray,ct,rt),ni=Dt.getProgramCacheKey(br);let Wi=Mt.programs;Mt.environment=ge.isMeshStandardMaterial?ct.environment:null,Mt.fog=ct.fog,Mt.envMap=(ge.isMeshStandardMaterial?cr:En).get(ge.envMap||Mt.environment),void 0===Wi&&(ge.addEventListener("dispose",uu),Wi=new Map,Mt.programs=Wi);let yi=Wi.get(ni);if(void 0!==yi){if(Mt.currentProgram===yi&&Mt.lightsStateVersion===_r)return ov(ge,br),yi}else br.uniforms=Dt.getUniforms(ge),ge.onBuild(br,H),ge.onBeforeCompile(br,H),yi=Dt.acquireProgram(br,ni),Wi.set(ni,yi),Mt.uniforms=br.uniforms;const xi=Mt.uniforms;(!ge.isShaderMaterial&&!ge.isRawShaderMaterial||!0===ge.clipping)&&(xi.clippingPlanes=Cr.uniform),ov(ge,br),Mt.needsLights=function(ge){return ge.isMeshLambertMaterial||ge.isMeshToonMaterial||ge.isMeshPhongMaterial||ge.isMeshStandardMaterial||ge.isShadowMaterial||ge.isShaderMaterial&&!0===ge.lights}(ge),Mt.lightsStateVersion=_r,Mt.needsLights&&(xi.ambientLightColor.value=tn.state.ambient,xi.lightProbe.value=tn.state.probe,xi.directionalLights.value=tn.state.directional,xi.directionalLightShadows.value=tn.state.directionalShadow,xi.spotLights.value=tn.state.spot,xi.spotLightShadows.value=tn.state.spotShadow,xi.rectAreaLights.value=tn.state.rectArea,xi.ltc_1.value=tn.state.rectAreaLTC1,xi.ltc_2.value=tn.state.rectAreaLTC2,xi.pointLights.value=tn.state.point,xi.pointLightShadows.value=tn.state.pointShadow,xi.hemisphereLights.value=tn.state.hemi,xi.directionalShadowMap.value=tn.state.directionalShadowMap,xi.directionalShadowMatrix.value=tn.state.directionalShadowMatrix,xi.spotShadowMap.value=tn.state.spotShadowMap,xi.spotShadowMatrix.value=tn.state.spotShadowMatrix,xi.pointShadowMap.value=tn.state.pointShadowMap,xi.pointShadowMatrix.value=tn.state.pointShadowMatrix);const Rr=yi.getUniforms(),zd=ku.seqWithValue(Rr.seq,xi);return Mt.currentProgram=yi,Mt.uniformsList=zd,yi}function ov(ge,ct){const rt=At.get(ge);rt.outputEncoding=ct.outputEncoding,rt.instancing=ct.instancing,rt.skinning=ct.skinning,rt.morphTargets=ct.morphTargets,rt.morphNormals=ct.morphNormals,rt.numClippingPlanes=ct.numClippingPlanes,rt.numIntersection=ct.numClipIntersection,rt.vertexAlphas=ct.vertexAlphas,rt.vertexTangents=ct.vertexTangents}function Gm(ge,ct,rt,Mt){!0!==ct.isScene&&(ct=Fn),sn.resetTextureUnits();const tn=ct.fog,_r=null===re?H.outputEncoding:re.texture.encoding,br=(rt.isMeshStandardMaterial?cr:En).get(rt.envMap||(rt.isMeshStandardMaterial?ct.environment:null)),ni=!0===rt.vertexColors&&!!Mt.geometry&&!!Mt.geometry.attributes.color&&4===Mt.geometry.attributes.color.itemSize,Wi=!!Mt.geometry&&!!Mt.geometry.attributes.tangent,yi=!!Mt.geometry&&!!Mt.geometry.morphAttributes.position,xi=!!Mt.geometry&&!!Mt.geometry.morphAttributes.normal,Rr=At.get(rt),zd=A.state.lights;!0!==ir||!0!==fr&&ge===ve||Cr.setState(rt,ge,ge===ve&&rt.id===ne);let no=!1;rt.version===Rr.__version?(Rr.needsLights&&Rr.lightsStateVersion!==zd.state.version||Rr.outputEncoding!==_r||Mt.isInstancedMesh&&!1===Rr.instancing||!Mt.isInstancedMesh&&!0===Rr.instancing||Mt.isSkinnedMesh&&!1===Rr.skinning||!Mt.isSkinnedMesh&&!0===Rr.skinning||Rr.envMap!==br||rt.fog&&Rr.fog!==tn||void 0!==Rr.numClippingPlanes&&(Rr.numClippingPlanes!==Cr.numPlanes||Rr.numIntersection!==Cr.numIntersection)||Rr.vertexAlphas!==ni||Rr.vertexTangents!==Wi||Rr.morphTargets!==yi||Rr.morphNormals!==xi)&&(no=!0):(no=!0,Rr.__version=rt.version);let hu=Rr.currentProgram;!0===no&&(hu=Hm(rt,ct,Mt));let Ul=!1,Yu=!1,Hd=!1;const Co=hu.getUniforms(),da=Rr.uniforms;if(lr.useProgram(hu.program)&&(Ul=!0,Yu=!0,Hd=!0),rt.id!==ne&&(ne=rt.id,Yu=!0),Ul||ve!==ge){if(Co.setValue(yt,"projectionMatrix",ge.projectionMatrix),sr.logarithmicDepthBuffer&&Co.setValue(yt,"logDepthBufFC",2/(Math.log(ge.far+1)/Math.LN2)),ve!==ge&&(ve=ge,Yu=!0,Hd=!0),rt.isShaderMaterial||rt.isMeshPhongMaterial||rt.isMeshToonMaterial||rt.isMeshStandardMaterial||rt.envMap){const fa=Co.map.cameraPosition;void 0!==fa&&fa.setValue(yt,Yt.setFromMatrixPosition(ge.matrixWorld))}(rt.isMeshPhongMaterial||rt.isMeshToonMaterial||rt.isMeshLambertMaterial||rt.isMeshBasicMaterial||rt.isMeshStandardMaterial||rt.isShaderMaterial)&&Co.setValue(yt,"isOrthographic",!0===ge.isOrthographicCamera),(rt.isMeshPhongMaterial||rt.isMeshToonMaterial||rt.isMeshLambertMaterial||rt.isMeshBasicMaterial||rt.isMeshStandardMaterial||rt.isShaderMaterial||rt.isShadowMaterial||Mt.isSkinnedMesh)&&Co.setValue(yt,"viewMatrix",ge.matrixWorldInverse)}if(Mt.isSkinnedMesh){Co.setOptional(yt,Mt,"bindMatrix"),Co.setOptional(yt,Mt,"bindMatrixInverse");const fa=Mt.skeleton;fa&&(sr.floatVertexTextures?(null===fa.boneTexture&&fa.computeBoneTexture(),Co.setValue(yt,"boneTexture",fa.boneTexture,sn),Co.setValue(yt,"boneTextureSize",fa.boneTextureSize)):Co.setOptional(yt,fa,"boneMatrices"))}return(Yu||Rr.receiveShadow!==Mt.receiveShadow)&&(Rr.receiveShadow=Mt.receiveShadow,Co.setValue(yt,"receiveShadow",Mt.receiveShadow)),Yu&&(Co.setValue(yt,"toneMappingExposure",H.toneMappingExposure),Rr.needsLights&&function(ge,ct){ge.ambientLightColor.needsUpdate=ct,ge.lightProbe.needsUpdate=ct,ge.directionalLights.needsUpdate=ct,ge.directionalLightShadows.needsUpdate=ct,ge.pointLights.needsUpdate=ct,ge.pointLightShadows.needsUpdate=ct,ge.spotLights.needsUpdate=ct,ge.spotLightShadows.needsUpdate=ct,ge.rectAreaLights.needsUpdate=ct,ge.hemisphereLights.needsUpdate=ct}(da,Hd),tn&&rt.fog&&Xt.refreshFogUniforms(da,tn),Xt.refreshMaterialUniforms(da,rt,Ge,nt,Bn),ku.upload(yt,Rr.uniformsList,da,sn)),rt.isShaderMaterial&&!0===rt.uniformsNeedUpdate&&(ku.upload(yt,Rr.uniformsList,da,sn),rt.uniformsNeedUpdate=!1),rt.isSpriteMaterial&&Co.setValue(yt,"center",Mt.center),Co.setValue(yt,"modelViewMatrix",Mt.modelViewMatrix),Co.setValue(yt,"normalMatrix",Mt.normalMatrix),Co.setValue(yt,"modelMatrix",Mt.matrixWorld),hu}Vd.setAnimationLoop(function(ge){Um&&Um(ge)}),"undefined"!=typeof window&&Vd.setContext(window),this.setAnimationLoop=function(ge){Um=ge,mi.setAnimationLoop(ge),null===ge?Vd.stop():Vd.start()},mi.addEventListener("sessionstart",rv),mi.addEventListener("sessionend",zm),this.render=function(ge,ct){if(void 0===ct||!0===ct.isCamera){if(!0!==q){if(!0===ge.autoUpdate&&ge.updateMatrixWorld(),null===ct.parent&&ct.updateMatrixWorld(),!0===mi.enabled&&!0===mi.isPresenting&&(!0===mi.cameraAutoUpdate&&mi.updateCamera(ct),ct=mi.getCamera()),!0===ge.isScene&&ge.onBeforeRender(H,ge,ct,re),A=qn.get(ge,L.length),A.init(),L.push(A),Dr.multiplyMatrices(ct.projectionMatrix,ct.matrixWorldInverse),wn.setFromProjectionMatrix(Dr),fr=this.localClippingEnabled,ir=Cr.init(this.clippingPlanes,fr,ct),D=Ln.get(ge,P.length),D.init(),P.push(D),iv(ge,ct,0,H.sortObjects),D.finish(),!0===H.sortObjects&&D.sort(en,bt),!0===ir&&Cr.beginShadows(),hr.render(A.state.shadowsArray,ge,ct),!0===ir&&Cr.endShadows(),!0===this.info.autoReset&&this.info.reset(),Er.render(D,ge),A.setupLights(H.physicallyCorrectLights),ct.isArrayCamera){const Mt=ct.cameras;for(let tn=0,qr=Mt.length;tn<qr;tn++){const _r=Mt[tn];sv(D,ge,_r,_r.viewport)}}else sv(D,ge,ct);null!==re&&(sn.updateMultisampleRenderTarget(re),sn.updateRenderTargetMipmap(re)),!0===ge.isScene&&ge.onAfterRender(H,ge,ct),lr.buffers.depth.setTest(!0),lr.buffers.depth.setMask(!0),lr.buffers.color.setMask(!0),lr.setPolygonOffset(!1),Jn.resetDefaultState(),ne=-1,ve=null,L.pop(),A=L.length>0?L[L.length-1]:null,P.pop(),D=P.length>0?P[P.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return k},this.getActiveMipmapLevel=function(){return O},this.getRenderTarget=function(){return re},this.setRenderTarget=function(ge,ct=0,rt=0){re=ge,k=ct,O=rt,ge&&void 0===At.get(ge).__webglFramebuffer&&sn.setupRenderTarget(ge);let Mt=null,tn=!1,qr=!1;if(ge){const br=ge.texture;(br.isDataTexture3D||br.isDataTexture2DArray)&&(qr=!0);const ni=At.get(ge).__webglFramebuffer;ge.isWebGLCubeRenderTarget?(Mt=ni[ct],tn=!0):Mt=ge.isWebGLMultisampleRenderTarget?At.get(ge).__webglMultisampledFramebuffer:ni,Ie.copy(ge.viewport),ue.copy(ge.scissor),je=ge.scissorTest}else Ie.copy(_t).multiplyScalar(Ge).floor(),ue.copy(Ct).multiplyScalar(Ge).floor(),je=xt;if(lr.bindFramebuffer(36160,Mt)&&sr.drawBuffers){let br=!1;if(ge)if(ge.isWebGLMultipleRenderTargets){const ni=ge.texture;if(Pt.length!==ni.length||36064!==Pt[0]){for(let Wi=0,yi=ni.length;Wi<yi;Wi++)Pt[Wi]=36064+Wi;Pt.length=ni.length,br=!0}}else(1!==Pt.length||36064!==Pt[0])&&(Pt[0]=36064,Pt.length=1,br=!0);else(1!==Pt.length||1029!==Pt[0])&&(Pt[0]=1029,Pt.length=1,br=!0);br&&(sr.isWebGL2?yt.drawBuffers(Pt):kr.get("WEBGL_draw_buffers").drawBuffersWEBGL(Pt))}if(lr.viewport(Ie),lr.scissor(ue),lr.setScissorTest(je),tn){const br=At.get(ge.texture);yt.framebufferTexture2D(36160,36064,34069+ct,br.__webglTexture,rt)}else if(qr){const br=At.get(ge.texture);yt.framebufferTextureLayer(36160,36064,br.__webglTexture,rt||0,ct||0)}ne=-1},this.readRenderTargetPixels=function(ge,ct,rt,Mt,tn,qr,_r){if(!ge||!ge.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let br=At.get(ge).__webglFramebuffer;if(ge.isWebGLCubeRenderTarget&&void 0!==_r&&(br=br[_r]),br){lr.bindFramebuffer(36160,br);try{const ni=ge.texture,Wi=ni.format,yi=ni.type;if(Wi!==ds&&Gt.convert(Wi)!==yt.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const xi=yi===Xs&&(kr.has("EXT_color_buffer_half_float")||sr.isWebGL2&&kr.has("EXT_color_buffer_float"));if(!(yi===Xn||Gt.convert(yi)===yt.getParameter(35738)||yi===Us&&(sr.isWebGL2||kr.has("OES_texture_float")||kr.has("WEBGL_color_buffer_float"))||xi))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===yt.checkFramebufferStatus(36160)?ct>=0&&ct<=ge.width-Mt&&rt>=0&&rt<=ge.height-tn&&yt.readPixels(ct,rt,Mt,tn,Gt.convert(Wi),Gt.convert(yi),qr):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const ni=null!==re?At.get(re).__webglFramebuffer:null;lr.bindFramebuffer(36160,ni)}}},this.copyFramebufferToTexture=function(ge,ct,rt=0){const Mt=Math.pow(2,-rt),tn=Math.floor(ct.image.width*Mt),qr=Math.floor(ct.image.height*Mt);let _r=Gt.convert(ct.format);sr.isWebGL2&&(6407===_r&&(_r=32849),6408===_r&&(_r=32856)),sn.setTexture2D(ct,0),yt.copyTexImage2D(3553,rt,_r,ge.x,ge.y,tn,qr,0),lr.unbindTexture()},this.copyTextureToTexture=function(ge,ct,rt,Mt=0){const tn=ct.image.width,qr=ct.image.height,_r=Gt.convert(rt.format),br=Gt.convert(rt.type);sn.setTexture2D(rt,0),yt.pixelStorei(37440,rt.flipY),yt.pixelStorei(37441,rt.premultiplyAlpha),yt.pixelStorei(3317,rt.unpackAlignment),ct.isDataTexture?yt.texSubImage2D(3553,Mt,ge.x,ge.y,tn,qr,_r,br,ct.image.data):ct.isCompressedTexture?yt.compressedTexSubImage2D(3553,Mt,ge.x,ge.y,ct.mipmaps[0].width,ct.mipmaps[0].height,_r,ct.mipmaps[0].data):yt.texSubImage2D(3553,Mt,ge.x,ge.y,_r,br,ct.image),0===Mt&&rt.generateMipmaps&&yt.generateMipmap(3553),lr.unbindTexture()},this.copyTextureToTexture3D=function(ge,ct,rt,Mt,tn=0){if(H.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const qr=ge.max.x-ge.min.x+1,_r=ge.max.y-ge.min.y+1,br=ge.max.z-ge.min.z+1,ni=Gt.convert(Mt.format),Wi=Gt.convert(Mt.type);let yi;if(Mt.isDataTexture3D)sn.setTexture3D(Mt,0),yi=32879;else{if(!Mt.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");sn.setTexture2DArray(Mt,0),yi=35866}yt.pixelStorei(37440,Mt.flipY),yt.pixelStorei(37441,Mt.premultiplyAlpha),yt.pixelStorei(3317,Mt.unpackAlignment);const xi=yt.getParameter(3314),Rr=yt.getParameter(32878),zd=yt.getParameter(3316),no=yt.getParameter(3315),hu=yt.getParameter(32877),Ul=rt.isCompressedTexture?rt.mipmaps[0]:rt.image;yt.pixelStorei(3314,Ul.width),yt.pixelStorei(32878,Ul.height),yt.pixelStorei(3316,ge.min.x),yt.pixelStorei(3315,ge.min.y),yt.pixelStorei(32877,ge.min.z),rt.isDataTexture||rt.isDataTexture3D?yt.texSubImage3D(yi,tn,ct.x,ct.y,ct.z,qr,_r,br,ni,Wi,Ul.data):rt.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),yt.compressedTexSubImage3D(yi,tn,ct.x,ct.y,ct.z,qr,_r,br,ni,Ul.data)):yt.texSubImage3D(yi,tn,ct.x,ct.y,ct.z,qr,_r,br,ni,Wi,Ul),yt.pixelStorei(3314,xi),yt.pixelStorei(32878,Rr),yt.pixelStorei(3316,zd),yt.pixelStorei(3315,no),yt.pixelStorei(32877,hu),0===tn&&Mt.generateMipmaps&&yt.generateMipmap(yi),lr.unbindTexture()},this.initTexture=function(ge){sn.setTexture2D(ge,0),lr.unbindTexture()},this.resetState=function(){k=0,O=0,re=null,lr.reset(),Jn.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}(class extends Zi{}).prototype.isWebGL1Renderer=!0;class jg{constructor(e,r=25e-5){this.name="",this.color=new j(e),this.density=r}clone(){return new jg(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}jg.prototype.isFogExp2=!0;class Wg{constructor(e,r=1,s=1e3){this.name="",this.color=new j(e),this.near=r,this.far=s}clone(){return new Wg(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Wg.prototype.isFog=!0;class eh extends Zr{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,r){return super.copy(e,r),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const r=super.toJSON(e);return null!==this.fog&&(r.object.fog=this.fog.toJSON()),r}}eh.prototype.isScene=!0;class th{constructor(e,r){this.array=e,this.stride=r,this.count=void 0!==e?e.length/r:0,this.usage=Ar,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=jn()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,r,s){e*=this.stride,s*=r.stride;for(let a=0,c=this.stride;a<c;a++)this.array[e+a]=r.array[s+a];return this}set(e,r=0){return this.array.set(e,r),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=jn()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const r=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),s=new this.constructor(r,this.stride);return s.setUsage(this.usage),s}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=jn()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}th.prototype.isInterleavedBuffer=!0;const $s=new he;class iu{constructor(e,r,s,a=!1){this.name="",this.data=e,this.itemSize=r,this.offset=s,this.normalized=!0===a}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let r=0,s=this.data.count;r<s;r++)$s.x=this.getX(r),$s.y=this.getY(r),$s.z=this.getZ(r),$s.applyMatrix4(e),this.setXYZ(r,$s.x,$s.y,$s.z);return this}applyNormalMatrix(e){for(let r=0,s=this.count;r<s;r++)$s.x=this.getX(r),$s.y=this.getY(r),$s.z=this.getZ(r),$s.applyNormalMatrix(e),this.setXYZ(r,$s.x,$s.y,$s.z);return this}transformDirection(e){for(let r=0,s=this.count;r<s;r++)$s.x=this.getX(r),$s.y=this.getY(r),$s.z=this.getZ(r),$s.transformDirection(e),this.setXYZ(r,$s.x,$s.y,$s.z);return this}setX(e,r){return this.data.array[e*this.data.stride+this.offset]=r,this}setY(e,r){return this.data.array[e*this.data.stride+this.offset+1]=r,this}setZ(e,r){return this.data.array[e*this.data.stride+this.offset+2]=r,this}setW(e,r){return this.data.array[e*this.data.stride+this.offset+3]=r,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,r,s){return this.data.array[(e=e*this.data.stride+this.offset)+0]=r,this.data.array[e+1]=s,this}setXYZ(e,r,s,a){return this.data.array[(e=e*this.data.stride+this.offset)+0]=r,this.data.array[e+1]=s,this.data.array[e+2]=a,this}setXYZW(e,r,s,a,c){return this.data.array[(e=e*this.data.stride+this.offset)+0]=r,this.data.array[e+1]=s,this.data.array[e+2]=a,this.data.array[e+3]=c,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const r=[];for(let s=0;s<this.count;s++){const a=s*this.data.stride+this.offset;for(let c=0;c<this.itemSize;c++)r.push(this.data.array[a+c])}return new Ke(new this.array.constructor(r),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new iu(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const r=[];for(let s=0;s<this.count;s++){const a=s*this.data.stride+this.offset;for(let c=0;c<this.itemSize;c++)r.push(this.data.array[a+c])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:r,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}iu.prototype.isInterleavedBufferAttribute=!0;class tp extends Re{constructor(e){super(),this.type="SpriteMaterial",this.color=new j(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let of;tp.prototype.isSpriteMaterial=!0;const nh=new he,af=new he,xd=new he,lf=new Rt,cf=new Rt,Yy=new Nn,np=new he,uf=new he,rh=new he,Xy=new Rt,Fl=new Rt,rp=new Rt;function ip(h,e,r,s,a,c){lf.subVectors(h,r).addScalar(.5).multiply(s),void 0!==a?(cf.x=c*lf.x-a*lf.y,cf.y=a*lf.x+c*lf.y):cf.copy(lf),h.copy(e),h.x+=cf.x,h.y+=cf.y,h.applyMatrix4(Yy)}(class extends Zr{constructor(e){if(super(),this.type="Sprite",void 0===of){of=new jt;const r=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),s=new th(r,5);of.setIndex([0,1,2,0,2,3]),of.setAttribute("position",new iu(s,3,0,!1)),of.setAttribute("uv",new iu(s,2,3,!1))}this.geometry=of,this.material=void 0!==e?e:new tp,this.center=new Rt(.5,.5)}raycast(e,r){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),af.setFromMatrixScale(this.matrixWorld),Yy.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),xd.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&af.multiplyScalar(-xd.z);const s=this.material.rotation;let a,c;0!==s&&(c=Math.cos(s),a=Math.sin(s));const p=this.center;ip(np.set(-.5,-.5,0),xd,p,af,a,c),ip(uf.set(.5,-.5,0),xd,p,af,a,c),ip(rh.set(.5,.5,0),xd,p,af,a,c),Xy.set(0,0),Fl.set(1,0),rp.set(1,1);let m=e.ray.intersectTriangle(np,uf,rh,!1,nh);if(null===m&&(ip(uf.set(-.5,.5,0),xd,p,af,a,c),Fl.set(0,1),m=e.ray.intersectTriangle(np,rh,uf,!1,nh),null===m))return;const x=e.ray.origin.distanceTo(nh);x<e.near||x>e.far||r.push({distance:x,point:nh.clone(),uv:le.getUV(nh,np,uf,rh,Xy,Fl,rp,new Rt),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}).prototype.isSprite=!0;const Zy=new he,Qy=new di,sp=new di,f_=new he,Ky=new Nn;class df extends cs{constructor(e,r){super(e,r),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Nn,this.bindMatrixInverse=new Nn}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,r){this.skeleton=e,void 0===r&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),r=this.matrixWorld),this.bindMatrix.copy(r),this.bindMatrixInverse.copy(r).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new di,r=this.geometry.attributes.skinWeight;for(let s=0,a=r.count;s<a;s++){e.x=r.getX(s),e.y=r.getY(s),e.z=r.getZ(s),e.w=r.getW(s);const c=1/e.manhattanLength();c!==1/0?e.multiplyScalar(c):e.set(1,0,0,0),r.setXYZW(s,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,r){const s=this.skeleton,a=this.geometry;Qy.fromBufferAttribute(a.attributes.skinIndex,e),sp.fromBufferAttribute(a.attributes.skinWeight,e),Zy.fromBufferAttribute(a.attributes.position,e).applyMatrix4(this.bindMatrix),r.set(0,0,0);for(let c=0;c<4;c++){const p=sp.getComponent(c);if(0!==p){const m=Qy.getComponent(c);Ky.multiplyMatrices(s.bones[m].matrixWorld,s.boneInverses[m]),r.addScaledVector(f_.copy(Zy).applyMatrix4(Ky),p)}}return r.applyMatrix4(this.bindMatrixInverse)}}df.prototype.isSkinnedMesh=!0;(class extends Zr{constructor(){super(),this.type="Bone"}}).prototype.isBone=!0;(class extends As{constructor(e=null,r=1,s=1,a,c,p,m,x,E=Pi,C=Pi,D,A){super(null,p,m,x,E,C,a,c,D,A),this.image={data:e,width:r,height:s},this.magFilter=E,this.minFilter=C,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}).prototype.isDataTexture=!0;class hf extends Ke{constructor(e,r,s,a=1){"number"==typeof s&&(a=s,s=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,r,s),this.meshPerAttribute=a}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}hf.prototype.isInstancedBufferAttribute=!0;const Jy=new Nn,lp=new Nn,Zg=[],sh=new cs;(class extends cs{constructor(e,r,s){super(e,r),this.instanceMatrix=new hf(new Float32Array(16*s),16),this.instanceColor=null,this.count=s,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,r){r.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,r){r.fromArray(this.instanceMatrix.array,16*e)}raycast(e,r){const s=this.matrixWorld,a=this.count;if(sh.geometry=this.geometry,sh.material=this.material,void 0!==sh.material)for(let c=0;c<a;c++){this.getMatrixAt(c,Jy),lp.multiplyMatrices(s,Jy),sh.matrixWorld=lp,sh.raycast(e,Zg);for(let p=0,m=Zg.length;p<m;p++){const x=Zg[p];x.instanceId=c,x.object=this,r.push(x)}Zg.length=0}}setColorAt(e,r){null===this.instanceColor&&(this.instanceColor=new hf(new Float32Array(3*this.instanceMatrix.count),3)),r.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,r){r.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}).prototype.isInstancedMesh=!0;class go extends Re{constructor(e){super(),this.type="LineBasicMaterial",this.color=new j(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}go.prototype.isLineBasicMaterial=!0;const Kg=new he,Jg=new he,em=new Nn,ic=new Gs,wd=new ko;class zu extends Zr{constructor(e=new jt,r=new go){super(),this.type="Line",this.geometry=e,this.material=r,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const r=e.attributes.position,s=[0];for(let a=1,c=r.count;a<c;a++)Kg.fromBufferAttribute(r,a-1),Jg.fromBufferAttribute(r,a),s[a]=s[a-1],s[a]+=Kg.distanceTo(Jg);e.setAttribute("lineDistance",new dn(s,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,r){const s=this.geometry,a=this.matrixWorld,c=e.params.Line.threshold,p=s.drawRange;if(null===s.boundingSphere&&s.computeBoundingSphere(),wd.copy(s.boundingSphere),wd.applyMatrix4(a),wd.radius+=c,!1===e.ray.intersectsSphere(wd))return;em.copy(a).invert(),ic.copy(e.ray).applyMatrix4(em);const m=c/((this.scale.x+this.scale.y+this.scale.z)/3),x=m*m,E=new he,C=new he,D=new he,A=new he,P=this.isLineSegments?2:1;if(s.isBufferGeometry){const L=s.index,q=s.attributes.position;if(null!==L)for(let re=Math.max(0,p.start),ne=Math.min(L.count,p.start+p.count)-1;re<ne;re+=P){const ve=L.getX(re),Ie=L.getX(re+1);if(E.fromBufferAttribute(q,ve),C.fromBufferAttribute(q,Ie),ic.distanceSqToSegment(E,C,A,D)>x)continue;A.applyMatrix4(this.matrixWorld);const je=e.ray.origin.distanceTo(A);je<e.near||je>e.far||r.push({distance:je,point:D.clone().applyMatrix4(this.matrixWorld),index:re,face:null,faceIndex:null,object:this})}else for(let re=Math.max(0,p.start),ne=Math.min(q.count,p.start+p.count)-1;re<ne;re+=P){if(E.fromBufferAttribute(q,re),C.fromBufferAttribute(q,re+1),ic.distanceSqToSegment(E,C,A,D)>x)continue;A.applyMatrix4(this.matrixWorld);const Ie=e.ray.origin.distanceTo(A);Ie<e.near||Ie>e.far||r.push({distance:Ie,point:D.clone().applyMatrix4(this.matrixWorld),index:re,face:null,faceIndex:null,object:this})}}else s.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const r=e.morphAttributes,s=Object.keys(r);if(s.length>0){const a=r[s[0]];if(void 0!==a){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let c=0,p=a.length;c<p;c++){const m=a[c].name||String(c);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=c}}}}else{const r=e.morphTargets;void 0!==r&&r.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}zu.prototype.isLine=!0;const e0=new he,h_=new he;class hl extends zu{constructor(e,r){super(e,r),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const r=e.attributes.position,s=[];for(let a=0,c=r.count;a<c;a+=2)e0.fromBufferAttribute(r,a),h_.fromBufferAttribute(r,a+1),s[a]=0===a?0:s[a-1],s[a+1]=s[a]+e0.distanceTo(h_);e.setAttribute("lineDistance",new dn(s,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}hl.prototype.isLineSegments=!0;(class extends zu{constructor(e,r){super(e,r),this.type="LineLoop"}}).prototype.isLineLoop=!0;class Oc extends Re{constructor(e){super(),this.type="PointsMaterial",this.color=new j(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}Oc.prototype.isPointsMaterial=!0;const pf=new Nn,nm=new Gs,gf=new ko,oh=new he;function rm(h,e,r,s,a,c,p){const m=nm.distanceSqToPoint(h);if(m<r){const x=new he;nm.closestPointToPoint(h,x),x.applyMatrix4(s);const E=a.ray.origin.distanceTo(x);if(E<a.near||E>a.far)return;c.push({distance:E,distanceToRay:Math.sqrt(m),point:x,index:e,face:null,object:p})}}(class extends Zr{constructor(e=new jt,r=new Oc){super(),this.type="Points",this.geometry=e,this.material=r,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,r){const s=this.geometry,a=this.matrixWorld,c=e.params.Points.threshold,p=s.drawRange;if(null===s.boundingSphere&&s.computeBoundingSphere(),gf.copy(s.boundingSphere),gf.applyMatrix4(a),gf.radius+=c,!1===e.ray.intersectsSphere(gf))return;pf.copy(a).invert(),nm.copy(e.ray).applyMatrix4(pf);const m=c/((this.scale.x+this.scale.y+this.scale.z)/3),x=m*m;if(s.isBufferGeometry){const E=s.index,D=s.attributes.position;if(null!==E)for(let L=Math.max(0,p.start),H=Math.min(E.count,p.start+p.count);L<H;L++){const q=E.getX(L);oh.fromBufferAttribute(D,q),rm(oh,q,x,a,e,r,this)}else for(let L=Math.max(0,p.start),H=Math.min(D.count,p.start+p.count);L<H;L++)oh.fromBufferAttribute(D,L),rm(oh,L,x,a,e,r,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const r=e.morphAttributes,s=Object.keys(r);if(s.length>0){const a=r[s[0]];if(void 0!==a){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let c=0,p=a.length;c<p;c++){const m=a[c].name||String(c);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=c}}}}else{const r=e.morphTargets;void 0!==r&&r.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}).prototype.isPoints=!0,class extends As{constructor(e,r,s,a,c,p,m,x,E){super(e,r,s,a,c,p,m,x,E),this.format=void 0!==m?m:Zs,this.minFilter=void 0!==p?p:zn,this.magFilter=void 0!==c?c:zn,this.generateMipmaps=!1;const C=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function D(){C.needsUpdate=!0,e.requestVideoFrameCallback(D)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e==0&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0;(class extends As{constructor(e,r,s,a,c,p,m,x,E,C,D,A){super(null,p,m,x,E,C,a,c,D,A),this.image={width:r,height:s},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}).prototype.isCompressedTexture=!0,class extends As{constructor(e,r,s,a,c,p,m,x,E){super(e,r,s,a,c,p,m,x,E),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0,class extends As{constructor(e,r,s,a,c,p,m,x,E,C){if((C=void 0!==C?C:so)!==so&&C!==oo)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===s&&C===so&&(s=1012),void 0===s&&C===oo&&(s=io),super(null,a,c,p,m,x,C,s,E),this.image={width:e,height:r},this.magFilter=void 0!==m?m:Pi,this.minFilter=void 0!==x?x:Pi,this.flipY=!1,this.generateMipmaps=!1}}.prototype.isDepthTexture=!0;class kl extends jt{constructor(e=1,r=1,s=1,a=8,c=1,p=!1,m=0,x=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:r,height:s,radialSegments:a,heightSegments:c,openEnded:p,thetaStart:m,thetaLength:x};const E=this;a=Math.floor(a),c=Math.floor(c);const C=[],D=[],A=[],P=[];let L=0;const H=[],q=s/2;let k=0;function re(ne){const ve=L,Ie=new Rt,ue=new he;let je=0;const wt=!0===ne?e:r,nt=!0===ne?1:-1;for(let en=1;en<=a;en++)D.push(0,q*nt,0),A.push(0,nt,0),P.push(.5,.5),L++;const Ge=L;for(let en=0;en<=a;en++){const _t=en/a*x+m,Ct=Math.cos(_t),xt=Math.sin(_t);ue.x=wt*xt,ue.y=q*nt,ue.z=wt*Ct,D.push(ue.x,ue.y,ue.z),A.push(0,nt,0),Ie.x=.5*Ct+.5,Ie.y=.5*xt*nt+.5,P.push(Ie.x,Ie.y),L++}for(let en=0;en<a;en++){const bt=ve+en,_t=Ge+en;!0===ne?C.push(_t,_t+1,bt):C.push(_t+1,_t,bt),je+=3}E.addGroup(k,je,!0===ne?1:2),k+=je}(function(){const ne=new he,ve=new he;let Ie=0;const ue=(r-e)/s;for(let je=0;je<=c;je++){const wt=[],nt=je/c,Ge=nt*(r-e)+e;for(let en=0;en<=a;en++){const bt=en/a,_t=bt*x+m,Ct=Math.sin(_t),xt=Math.cos(_t);ve.x=Ge*Ct,ve.y=-nt*s+q,ve.z=Ge*xt,D.push(ve.x,ve.y,ve.z),ne.set(Ct,ue,xt).normalize(),A.push(ne.x,ne.y,ne.z),P.push(bt,1-nt),wt.push(L++)}H.push(wt)}for(let je=0;je<a;je++)for(let wt=0;wt<c;wt++){const Ge=H[wt+1][je],en=H[wt+1][je+1],bt=H[wt][je+1];C.push(H[wt][je],Ge,bt),C.push(Ge,en,bt),Ie+=6}E.addGroup(k,Ie,0),k+=Ie})(),!1===p&&(e>0&&re(!0),r>0&&re(!1)),this.setIndex(C),this.setAttribute("position",new dn(D,3)),this.setAttribute("normal",new dn(A,3)),this.setAttribute("uv",new dn(P,2))}static fromJSON(e){return new kl(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class mf extends kl{constructor(e=1,r=1,s=8,a=1,c=!1,p=0,m=2*Math.PI){super(0,e,r,s,a,c,p,m),this.type="ConeGeometry",this.parameters={radius:e,height:r,radialSegments:s,heightSegments:a,openEnded:c,thetaStart:p,thetaLength:m}}static fromJSON(e){return new mf(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}new he,new he,new he,new le;class sc{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,r){const s=this.getUtoTmapping(e);return this.getPoint(s,r)}getPoints(e=5){const r=[];for(let s=0;s<=e;s++)r.push(this.getPoint(s/e));return r}getSpacedPoints(e=5){const r=[];for(let s=0;s<=e;s++)r.push(this.getPointAt(s/e));return r}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const r=[];let s,a=this.getPoint(0),c=0;r.push(0);for(let p=1;p<=e;p++)s=this.getPoint(p/e),c+=s.distanceTo(a),r.push(c),a=s;return this.cacheArcLengths=r,r}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,r){const s=this.getLengths();let a=0;const c=s.length;let p;p=r||e*s[c-1];let E,m=0,x=c-1;for(;m<=x;)if(a=Math.floor(m+(x-m)/2),E=s[a]-p,E<0)m=a+1;else{if(!(E>0)){x=a;break}x=a-1}if(a=x,s[a]===p)return a/(c-1);const C=s[a];return(a+(p-C)/(s[a+1]-C))/(c-1)}getTangent(e,r){const s=1e-4;let a=e-s,c=e+s;a<0&&(a=0),c>1&&(c=1);const p=this.getPoint(a),m=this.getPoint(c),x=r||(p.isVector2?new Rt:new he);return x.copy(m).sub(p).normalize(),x}getTangentAt(e,r){const s=this.getUtoTmapping(e);return this.getTangent(s,r)}computeFrenetFrames(e,r){const s=new he,a=[],c=[],p=[],m=new he,x=new Nn;for(let P=0;P<=e;P++)a[P]=this.getTangentAt(P/e,new he),a[P].normalize();c[0]=new he,p[0]=new he;let E=Number.MAX_VALUE;const C=Math.abs(a[0].x),D=Math.abs(a[0].y),A=Math.abs(a[0].z);C<=E&&(E=C,s.set(1,0,0)),D<=E&&(E=D,s.set(0,1,0)),A<=E&&s.set(0,0,1),m.crossVectors(a[0],s).normalize(),c[0].crossVectors(a[0],m),p[0].crossVectors(a[0],c[0]);for(let P=1;P<=e;P++){if(c[P]=c[P-1].clone(),p[P]=p[P-1].clone(),m.crossVectors(a[P-1],a[P]),m.length()>Number.EPSILON){m.normalize();const L=Math.acos(Ts(a[P-1].dot(a[P]),-1,1));c[P].applyMatrix4(x.makeRotationAxis(m,L))}p[P].crossVectors(a[P],c[P])}if(!0===r){let P=Math.acos(Ts(c[0].dot(c[e]),-1,1));P/=e,a[0].dot(m.crossVectors(c[0],c[e]))>0&&(P=-P);for(let L=1;L<=e;L++)c[L].applyMatrix4(x.makeRotationAxis(a[L],P*L)),p[L].crossVectors(a[L],c[L])}return{tangents:a,normals:c,binormals:p}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class pp extends sc{constructor(e=0,r=0,s=1,a=1,c=0,p=2*Math.PI,m=!1,x=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=r,this.xRadius=s,this.yRadius=a,this.aStartAngle=c,this.aEndAngle=p,this.aClockwise=m,this.aRotation=x}getPoint(e,r){const s=r||new Rt,a=2*Math.PI;let c=this.aEndAngle-this.aStartAngle;const p=Math.abs(c)<Number.EPSILON;for(;c<0;)c+=a;for(;c>a;)c-=a;c<Number.EPSILON&&(c=p?0:a),!0===this.aClockwise&&!p&&(c===a?c=-a:c-=a);const m=this.aStartAngle+e*c;let x=this.aX+this.xRadius*Math.cos(m),E=this.aY+this.yRadius*Math.sin(m);if(0!==this.aRotation){const C=Math.cos(this.aRotation),D=Math.sin(this.aRotation),A=x-this.aX,P=E-this.aY;x=A*C-P*D+this.aX,E=A*D+P*C+this.aY}return s.set(x,E)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}pp.prototype.isEllipseCurve=!0;class sm extends pp{constructor(e,r,s,a,c,p){super(e,r,s,s,a,c,p),this.type="ArcCurve"}}function Fi(){let h=0,e=0,r=0,s=0;function a(c,p,m,x){h=c,e=m,r=-3*c+3*p-2*m-x,s=2*c-2*p+m+x}return{initCatmullRom:function(c,p,m,x,E){a(p,m,E*(m-c),E*(x-p))},initNonuniformCatmullRom:function(c,p,m,x,E,C,D){let A=(p-c)/E-(m-c)/(E+C)+(m-p)/C,P=(m-p)/C-(x-p)/(C+D)+(x-m)/D;A*=C,P*=C,a(p,m,A,P)},calc:function(c){const p=c*c;return h+e*c+r*p+s*(p*c)}}}sm.prototype.isArcCurve=!0;const yf=new he,n0=new Fi,oc=new Fi,lh=new Fi;class gp extends sc{constructor(e=[],r=!1,s="centripetal",a=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=r,this.curveType=s,this.tension=a}getPoint(e,r=new he){const s=r,a=this.points,c=a.length,p=(c-(this.closed?0:1))*e;let E,C,m=Math.floor(p),x=p-m;this.closed?m+=m>0?0:(Math.floor(Math.abs(m)/c)+1)*c:0===x&&m===c-1&&(m=c-2,x=1),this.closed||m>0?E=a[(m-1)%c]:(yf.subVectors(a[0],a[1]).add(a[0]),E=yf);const D=a[m%c],A=a[(m+1)%c];if(this.closed||m+2<c?C=a[(m+2)%c]:(yf.subVectors(a[c-1],a[c-2]).add(a[c-1]),C=yf),"centripetal"===this.curveType||"chordal"===this.curveType){const P="chordal"===this.curveType?.5:.25;let L=Math.pow(E.distanceToSquared(D),P),H=Math.pow(D.distanceToSquared(A),P),q=Math.pow(A.distanceToSquared(C),P);H<1e-4&&(H=1),L<1e-4&&(L=H),q<1e-4&&(q=H),n0.initNonuniformCatmullRom(E.x,D.x,A.x,C.x,L,H,q),oc.initNonuniformCatmullRom(E.y,D.y,A.y,C.y,L,H,q),lh.initNonuniformCatmullRom(E.z,D.z,A.z,C.z,L,H,q)}else"catmullrom"===this.curveType&&(n0.initCatmullRom(E.x,D.x,A.x,C.x,this.tension),oc.initCatmullRom(E.y,D.y,A.y,C.y,this.tension),lh.initCatmullRom(E.z,D.z,A.z,C.z,this.tension));return s.set(n0.calc(x),oc.calc(x),lh.calc(x)),s}copy(e){super.copy(e),this.points=[];for(let r=0,s=e.points.length;r<s;r++)this.points.push(e.points[r].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let r=0,s=this.points.length;r<s;r++)e.points.push(this.points[r].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let r=0,s=e.points.length;r<s;r++){const a=e.points[r];this.points.push((new he).fromArray(a))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function y_(h,e,r,s,a){const c=.5*(s-e),p=.5*(a-r),m=h*h;return(2*r-2*s+c+p)*(h*m)+(-3*r+3*s-2*c-p)*m+c*h+r}function vf(h,e,r,s){return function(h,e){const r=1-h;return r*r*e}(h,e)+function(h,e){return 2*(1-h)*h*e}(h,r)+function(h,e){return h*h*e}(h,s)}function ou(h,e,r,s,a){return function(h,e){const r=1-h;return r*r*r*e}(h,e)+function(h,e){const r=1-h;return 3*r*r*h*e}(h,r)+function(h,e){return 3*(1-h)*h*h*e}(h,s)+function(h,e){return h*h*h*e}(h,a)}gp.prototype.isCatmullRomCurve3=!0;class ch extends sc{constructor(e=new Rt,r=new Rt,s=new Rt,a=new Rt){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=r,this.v2=s,this.v3=a}getPoint(e,r=new Rt){const s=r,a=this.v0,c=this.v1,p=this.v2,m=this.v3;return s.set(ou(e,a.x,c.x,p.x,m.x),ou(e,a.y,c.y,p.y,m.y)),s}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}ch.prototype.isCubicBezierCurve=!0;class mp extends sc{constructor(e=new he,r=new he,s=new he,a=new he){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=r,this.v2=s,this.v3=a}getPoint(e,r=new he){const s=r,a=this.v0,c=this.v1,p=this.v2,m=this.v3;return s.set(ou(e,a.x,c.x,p.x,m.x),ou(e,a.y,c.y,p.y,m.y),ou(e,a.z,c.z,p.z,m.z)),s}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}mp.prototype.isCubicBezierCurve3=!0;class uh extends sc{constructor(e=new Rt,r=new Rt){super(),this.type="LineCurve",this.v1=e,this.v2=r}getPoint(e,r=new Rt){const s=r;return 1===e?s.copy(this.v2):(s.copy(this.v2).sub(this.v1),s.multiplyScalar(e).add(this.v1)),s}getPointAt(e,r){return this.getPoint(e,r)}getTangent(e,r){const s=r||new Rt;return s.copy(this.v2).sub(this.v1).normalize(),s}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}uh.prototype.isLineCurve=!0;class yp extends sc{constructor(e=new Rt,r=new Rt,s=new Rt){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=r,this.v2=s}getPoint(e,r=new Rt){const s=r,a=this.v0,c=this.v1,p=this.v2;return s.set(vf(e,a.x,c.x,p.x),vf(e,a.y,c.y,p.y)),s}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}yp.prototype.isQuadraticBezierCurve=!0;class om extends sc{constructor(e=new he,r=new he,s=new he){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=r,this.v2=s}getPoint(e,r=new he){const s=r,a=this.v0,c=this.v1,p=this.v2;return s.set(vf(e,a.x,c.x,p.x),vf(e,a.y,c.y,p.y),vf(e,a.z,c.z,p.z)),s}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}om.prototype.isQuadraticBezierCurve3=!0;class am extends sc{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,r=new Rt){const s=r,a=this.points,c=(a.length-1)*e,p=Math.floor(c),m=c-p,x=a[0===p?p:p-1],E=a[p],C=a[p>a.length-2?a.length-1:p+1],D=a[p>a.length-3?a.length-1:p+2];return s.set(y_(m,x.x,E.x,C.x,D.x),y_(m,x.y,E.y,C.y,D.y)),s}copy(e){super.copy(e),this.points=[];for(let r=0,s=e.points.length;r<s;r++)this.points.push(e.points[r].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let r=0,s=this.points.length;r<s;r++)e.points.push(this.points[r].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let r=0,s=e.points.length;r<s;r++){const a=e.points[r];this.points.push((new Rt).fromArray(a))}return this}}am.prototype.isSplineCurve=!0;var lm=Object.freeze({__proto__:null,ArcCurve:sm,CatmullRomCurve3:gp,CubicBezierCurve:ch,CubicBezierCurve3:mp,EllipseCurve:pp,LineCurve:uh,LineCurve3:class extends sc{constructor(e=new he,r=new he){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=r}getPoint(e,r=new he){const s=r;return 1===e?s.copy(this.v2):(s.copy(this.v2).sub(this.v1),s.multiplyScalar(e).add(this.v1)),s}getPointAt(e,r){return this.getPoint(e,r)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:yp,QuadraticBezierCurve3:om,SplineCurve:am});function cm(h,e,r,s,a){let c,p;if(a===function(h,e,r,s){let a=0;for(let c=e,p=r-s;c<r;c+=s)a+=(h[p]-h[c])*(h[c+1]+h[p+1]),p=c;return a}(h,e,r,s)>0)for(c=e;c<r;c+=s)p=f0(c,h[c],h[c+1],p);else for(c=r-s;c>=e;c-=s)p=f0(c,h[c],h[c+1],p);return p&&vp(p,p.next)&&(fh(p),p=p.next),p}function Ed(h,e){if(!h)return h;e||(e=h);let s,r=h;do{if(s=!1,r.steiner||!vp(r,r.next)&&0!==Ms(r.prev,r,r.next))r=r.next;else{if(fh(r),r=e=r.prev,r===r.next)break;s=!0}}while(s||r!==e);return e}function _f(h,e,r,s,a,c,p){if(!h)return;!p&&c&&function(h,e,r,s){let a=h;do{null===a.z&&(a.z=c0(a.x,a.y,e,r,s)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next}while(a!==h);a.prevZ.nextZ=null,a.prevZ=null,function(h){let e,r,s,a,c,p,m,x,E=1;do{for(r=h,h=null,c=null,p=0;r;){for(p++,s=r,m=0,e=0;e<E&&(m++,s=s.nextZ,s);e++);for(x=E;m>0||x>0&&s;)0!==m&&(0===x||!s||r.z<=s.z)?(a=r,r=r.nextZ,m--):(a=s,s=s.nextZ,x--),c?c.nextZ=a:h=a,a.prevZ=c,c=a;r=s}c.nextZ=null,E*=2}while(p>1)}(a)}(h,s,a,c);let x,E,m=h;for(;h.prev!==h.next;)if(x=h.prev,E=h.next,c?M_(h,s,a,c):E_(h))e.push(x.i/r),e.push(h.i/r),e.push(E.i/r),fh(h),h=E.next,m=E.next;else if((h=E)===m){p?1===p?_f(h=Rx(Ed(h),e,r),e,r,s,a,c,2):2===p&&Ix(h,e,r,s,a,c):_f(Ed(h),e,r,s,a,c,1);break}}function E_(h){const e=h.prev,r=h,s=h.next;if(Ms(e,r,s)>=0)return!1;let a=h.next.next;for(;a!==h.prev;){if(Md(e.x,e.y,r.x,r.y,s.x,s.y,a.x,a.y)&&Ms(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function M_(h,e,r,s){const a=h.prev,c=h,p=h.next;if(Ms(a,c,p)>=0)return!1;const E=a.x>c.x?a.x>p.x?a.x:p.x:c.x>p.x?c.x:p.x,C=a.y>c.y?a.y>p.y?a.y:p.y:c.y>p.y?c.y:p.y,D=c0(a.x<c.x?a.x<p.x?a.x:p.x:c.x<p.x?c.x:p.x,a.y<c.y?a.y<p.y?a.y:p.y:c.y<p.y?c.y:p.y,e,r,s),A=c0(E,C,e,r,s);let P=h.prevZ,L=h.nextZ;for(;P&&P.z>=D&&L&&L.z<=A;){if(P!==h.prev&&P!==h.next&&Md(a.x,a.y,c.x,c.y,p.x,p.y,P.x,P.y)&&Ms(P.prev,P,P.next)>=0||(P=P.prevZ,L!==h.prev&&L!==h.next&&Md(a.x,a.y,c.x,c.y,p.x,p.y,L.x,L.y)&&Ms(L.prev,L,L.next)>=0))return!1;L=L.nextZ}for(;P&&P.z>=D;){if(P!==h.prev&&P!==h.next&&Md(a.x,a.y,c.x,c.y,p.x,p.y,P.x,P.y)&&Ms(P.prev,P,P.next)>=0)return!1;P=P.prevZ}for(;L&&L.z<=A;){if(L!==h.prev&&L!==h.next&&Md(a.x,a.y,c.x,c.y,p.x,p.y,L.x,L.y)&&Ms(L.prev,L,L.next)>=0)return!1;L=L.nextZ}return!0}function Rx(h,e,r){let s=h;do{const a=s.prev,c=s.next.next;!vp(a,c)&&C_(a,s,s.next,c)&&Sd(a,c)&&Sd(c,a)&&(e.push(a.i/r),e.push(s.i/r),e.push(c.i/r),fh(s),fh(s.next),s=h=c),s=s.next}while(s!==h);return Ed(s)}function Ix(h,e,r,s,a,c){let p=h;do{let m=p.next.next;for(;m!==p.prev;){if(p.i!==m.i&&u0(p,m)){let x=d0(p,m);return p=Ed(p,p.next),x=Ed(x,x.next),_f(p,e,r,s,a,c),void _f(x,e,r,s,a,c)}m=m.next}p=p.next}while(p!==h)}function S_(h,e){return h.x-e.x}function a0(h,e){if(e=function(h,e){let r=e;const s=h.x,a=h.y;let p,c=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){const A=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(A<=s&&A>c){if(c=A,A===s){if(a===r.y)return r;if(a===r.next.y)return r.next}p=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!p)return null;if(s===c)return p;const m=p,x=p.x,E=p.y;let D,C=1/0;r=p;do{s>=r.x&&r.x>=x&&s!==r.x&&Md(a<E?s:c,a,x,E,a<E?c:s,a,r.x,r.y)&&(D=Math.abs(a-r.y)/(s-r.x),Sd(r,h)&&(D<C||D===C&&(r.x>p.x||r.x===p.x&&Px(p,r)))&&(p=r,C=D)),r=r.next}while(r!==m);return p}(h,e)){const r=d0(e,h);Ed(e,e.next),Ed(r,r.next)}}function Px(h,e){return Ms(h.prev,h,e.prev)<0&&Ms(e.next,h,h.next)<0}function c0(h,e,r,s,a){return(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=32767*(h-r)*a)|h<<8))|h<<4))|h<<2))|h<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-s)*a)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Ox(h){let e=h,r=h;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==h);return r}function Md(h,e,r,s,a,c,p,m){return(a-p)*(e-m)-(h-p)*(c-m)>=0&&(h-p)*(s-m)-(r-p)*(e-m)>=0&&(r-p)*(c-m)-(a-p)*(s-m)>=0}function u0(h,e){return h.next.i!==e.i&&h.prev.i!==e.i&&!function(h,e){let r=h;do{if(r.i!==h.i&&r.next.i!==h.i&&r.i!==e.i&&r.next.i!==e.i&&C_(r,r.next,h,e))return!0;r=r.next}while(r!==h);return!1}(h,e)&&(Sd(h,e)&&Sd(e,h)&&function(h,e){let r=h,s=!1;const a=(h.x+e.x)/2,c=(h.y+e.y)/2;do{r.y>c!=r.next.y>c&&r.next.y!==r.y&&a<(r.next.x-r.x)*(c-r.y)/(r.next.y-r.y)+r.x&&(s=!s),r=r.next}while(r!==h);return s}(h,e)&&(Ms(h.prev,h,e.prev)||Ms(h,e.prev,e))||vp(h,e)&&Ms(h.prev,h,h.next)>0&&Ms(e.prev,e,e.next)>0)}function Ms(h,e,r){return(e.y-h.y)*(r.x-e.x)-(e.x-h.x)*(r.y-e.y)}function vp(h,e){return h.x===e.x&&h.y===e.y}function C_(h,e,r,s){const a=bf(Ms(h,e,r)),c=bf(Ms(h,e,s)),p=bf(Ms(r,s,h)),m=bf(Ms(r,s,e));return!!(a!==c&&p!==m||0===a&&dh(h,r,e)||0===c&&dh(h,s,e)||0===p&&dh(r,h,s)||0===m&&dh(r,e,s))}function dh(h,e,r){return e.x<=Math.max(h.x,r.x)&&e.x>=Math.min(h.x,r.x)&&e.y<=Math.max(h.y,r.y)&&e.y>=Math.min(h.y,r.y)}function bf(h){return h>0?1:h<0?-1:0}function Sd(h,e){return Ms(h.prev,h,h.next)<0?Ms(h,e,h.next)>=0&&Ms(h,h.prev,e)>=0:Ms(h,e,h.prev)<0||Ms(h,h.next,e)<0}function d0(h,e){const r=new dm(h.i,h.x,h.y),s=new dm(e.i,e.x,e.y),a=h.next,c=e.prev;return h.next=e,e.prev=h,r.next=a,a.prev=r,s.next=r,r.prev=s,c.next=s,s.prev=c,s}function f0(h,e,r,s){const a=new dm(h,e,r);return s?(a.next=s.next,a.prev=s,s.next.prev=a,s.next=a):(a.prev=a,a.next=a),a}function fh(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function dm(h,e,r){this.i=h,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Bl{static area(e){const r=e.length;let s=0;for(let a=r-1,c=0;c<r;a=c++)s+=e[a].x*e[c].y-e[c].x*e[a].y;return.5*s}static isClockWise(e){return Bl.area(e)<0}static triangulateShape(e,r){const s=[],a=[],c=[];Cd(e),fm(s,e);let p=e.length;r.forEach(Cd);for(let x=0;x<r.length;x++)a.push(p),p+=r[x].length,fm(s,r[x]);const m=function(h,e,r=2){const s=e&&e.length,a=s?e[0]*r:h.length;let c=cm(h,0,a,r,!0);const p=[];if(!c||c.next===c.prev)return p;let m,x,E,C,D,A,P;if(s&&(c=function(h,e,r,s){const a=[];let c,p,m,x,E;for(c=0,p=e.length;c<p;c++)m=e[c]*s,x=c<p-1?e[c+1]*s:h.length,E=cm(h,m,x,s,!1),E===E.next&&(E.steiner=!0),a.push(Ox(E));for(a.sort(S_),c=0;c<a.length;c++)a0(a[c],r),r=Ed(r,r.next);return r}(h,e,c,r)),h.length>80*r){m=E=h[0],x=C=h[1];for(let L=r;L<a;L+=r)D=h[L],A=h[L+1],D<m&&(m=D),A<x&&(x=A),D>E&&(E=D),A>C&&(C=A);P=Math.max(E-m,C-x),P=0!==P?1/P:0}return _f(c,p,r,m,x,P),p}(s,a);for(let x=0;x<m.length;x+=3)c.push(m.slice(x,x+3));return c}}function Cd(h){const e=h.length;e>2&&h[e-1].equals(h[0])&&h.pop()}function fm(h,e){for(let r=0;r<e.length;r++)h.push(e[r].x),h.push(e[r].y)}class mo extends jt{constructor(e,r){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:r},e=Array.isArray(e)?e:[e];const s=this,a=[],c=[];for(let m=0,x=e.length;m<x;m++)p(e[m]);function p(m){const x=[],E=void 0!==r.curveSegments?r.curveSegments:12,C=void 0!==r.steps?r.steps:1;let D=void 0!==r.depth?r.depth:100,A=void 0===r.bevelEnabled||r.bevelEnabled,P=void 0!==r.bevelThickness?r.bevelThickness:6,L=void 0!==r.bevelSize?r.bevelSize:P-2,H=void 0!==r.bevelOffset?r.bevelOffset:0,q=void 0!==r.bevelSegments?r.bevelSegments:3;const k=r.extrudePath,O=void 0!==r.UVGenerator?r.UVGenerator:hh;void 0!==r.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),D=r.amount);let re,ve,Ie,ue,je,ne=!1;k&&(re=k.getSpacedPoints(C),ne=!0,A=!1,ve=k.computeFrenetFrames(C,!1),Ie=new he,ue=new he,je=new he),A||(q=0,P=0,L=0,H=0);const wt=m.extractPoints(E);let nt=wt.shape;const Ge=wt.holes;if(!Bl.isClockWise(nt)){nt=nt.reverse();for(let At=0,sn=Ge.length;At<sn;At++){const En=Ge[At];Bl.isClockWise(En)&&(Ge[At]=En.reverse())}}const bt=Bl.triangulateShape(nt,Ge),_t=nt;for(let At=0,sn=Ge.length;At<sn;At++)nt=nt.concat(Ge[At]);function Ct(At,sn,En){return sn||console.error("THREE.ExtrudeGeometry: vec does not exist"),sn.clone().multiplyScalar(En).add(At)}const xt=nt.length,Pt=bt.length;function wn(At,sn,En){let cr,An,Se;const me=At.x-sn.x,Dt=At.y-sn.y,Xt=En.x-At.x,Ln=En.y-At.y,qn=me*me+Dt*Dt;if(Math.abs(me*Ln-Dt*Xt)>Number.EPSILON){const hr=Math.sqrt(qn),Er=Math.sqrt(Xt*Xt+Ln*Ln),dr=sn.x-Dt/hr,Je=sn.y+me/hr,Jn=((En.x-Ln/Er-dr)*Ln-(En.y+Xt/Er-Je)*Xt)/(me*Ln-Dt*Xt);cr=dr+me*Jn-At.x,An=Je+Dt*Jn-At.y;const or=cr*cr+An*An;if(or<=2)return new Rt(cr,An);Se=Math.sqrt(or/2)}else{let hr=!1;me>Number.EPSILON?Xt>Number.EPSILON&&(hr=!0):me<-Number.EPSILON?Xt<-Number.EPSILON&&(hr=!0):Math.sign(Dt)===Math.sign(Ln)&&(hr=!0),hr?(cr=-Dt,An=me,Se=Math.sqrt(qn)):(cr=me,An=Dt,Se=Math.sqrt(qn/2))}return new Rt(cr/Se,An/Se)}const ir=[];for(let At=0,sn=_t.length,En=sn-1,cr=At+1;At<sn;At++,En++,cr++)En===sn&&(En=0),cr===sn&&(cr=0),ir[At]=wn(_t[At],_t[En],_t[cr]);const fr=[];let Bn,Dr=ir.concat();for(let At=0,sn=Ge.length;At<sn;At++){const En=Ge[At];Bn=[];for(let cr=0,An=En.length,Se=An-1,me=cr+1;cr<An;cr++,Se++,me++)Se===An&&(Se=0),me===An&&(me=0),Bn[cr]=wn(En[cr],En[Se],En[me]);fr.push(Bn),Dr=Dr.concat(Bn)}for(let At=0;At<q;At++){const sn=At/q,En=P*Math.cos(sn*Math.PI/2),cr=L*Math.sin(sn*Math.PI/2)+H;for(let An=0,Se=_t.length;An<Se;An++){const me=Ct(_t[An],ir[An],cr);gr(me.x,me.y,-En)}for(let An=0,Se=Ge.length;An<Se;An++){const me=Ge[An];Bn=fr[An];for(let Dt=0,Xt=me.length;Dt<Xt;Dt++){const Ln=Ct(me[Dt],Bn[Dt],cr);gr(Ln.x,Ln.y,-En)}}}const Yt=L+H;for(let At=0;At<xt;At++){const sn=A?Ct(nt[At],Dr[At],Yt):nt[At];ne?(ue.copy(ve.normals[0]).multiplyScalar(sn.x),Ie.copy(ve.binormals[0]).multiplyScalar(sn.y),je.copy(re[0]).add(ue).add(Ie),gr(je.x,je.y,je.z)):gr(sn.x,sn.y,0)}for(let At=1;At<=C;At++)for(let sn=0;sn<xt;sn++){const En=A?Ct(nt[sn],Dr[sn],Yt):nt[sn];ne?(ue.copy(ve.normals[At]).multiplyScalar(En.x),Ie.copy(ve.binormals[At]).multiplyScalar(En.y),je.copy(re[At]).add(ue).add(Ie),gr(je.x,je.y,je.z)):gr(En.x,En.y,D/C*At)}for(let At=q-1;At>=0;At--){const sn=At/q,En=P*Math.cos(sn*Math.PI/2),cr=L*Math.sin(sn*Math.PI/2)+H;for(let An=0,Se=_t.length;An<Se;An++){const me=Ct(_t[An],ir[An],cr);gr(me.x,me.y,D+En)}for(let An=0,Se=Ge.length;An<Se;An++){const me=Ge[An];Bn=fr[An];for(let Dt=0,Xt=me.length;Dt<Xt;Dt++){const Ln=Ct(me[Dt],Bn[Dt],cr);ne?gr(Ln.x,Ln.y+re[C-1].y,re[C-1].x+En):gr(Ln.x,Ln.y,D+En)}}}function yt(At,sn){let En=At.length;for(;--En>=0;){const cr=En;let An=En-1;An<0&&(An=At.length-1);for(let Se=0,me=C+2*q;Se<me;Se++){const Dt=xt*Se,Xt=xt*(Se+1);sr(sn+cr+Dt,sn+An+Dt,sn+An+Xt,sn+cr+Xt)}}}function gr(At,sn,En){x.push(At),x.push(sn),x.push(En)}function kr(At,sn,En){lr(At),lr(sn),lr(En);const cr=a.length/3,An=O.generateTopUV(s,a,cr-3,cr-2,cr-1);$r(An[0]),$r(An[1]),$r(An[2])}function sr(At,sn,En,cr){lr(At),lr(sn),lr(cr),lr(sn),lr(En),lr(cr);const An=a.length/3,Se=O.generateSideWallUV(s,a,An-6,An-3,An-2,An-1);$r(Se[0]),$r(Se[1]),$r(Se[3]),$r(Se[1]),$r(Se[2]),$r(Se[3])}function lr(At){a.push(x[3*At+0]),a.push(x[3*At+1]),a.push(x[3*At+2])}function $r(At){c.push(At.x),c.push(At.y)}(function(){const At=a.length/3;if(A){let sn=0,En=xt*sn;for(let cr=0;cr<Pt;cr++){const An=bt[cr];kr(An[2]+En,An[1]+En,An[0]+En)}sn=C+2*q,En=xt*sn;for(let cr=0;cr<Pt;cr++){const An=bt[cr];kr(An[0]+En,An[1]+En,An[2]+En)}}else{for(let sn=0;sn<Pt;sn++){const En=bt[sn];kr(En[2],En[1],En[0])}for(let sn=0;sn<Pt;sn++){const En=bt[sn];kr(En[0]+xt*C,En[1]+xt*C,En[2]+xt*C)}}s.addGroup(At,a.length/3-At,0)})(),function(){const At=a.length/3;let sn=0;yt(_t,sn),sn+=_t.length;for(let En=0,cr=Ge.length;En<cr;En++){const An=Ge[En];yt(An,sn),sn+=An.length}s.addGroup(At,a.length/3-At,1)}()}this.setAttribute("position",new dn(a,3)),this.setAttribute("uv",new dn(c,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function(h,e,r){if(r.shapes=[],Array.isArray(h))for(let s=0,a=h.length;s<a;s++)r.shapes.push(h[s].uuid);else r.shapes.push(h.uuid);return void 0!==e.extrudePath&&(r.options.extrudePath=e.extrudePath.toJSON()),r}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,r){const s=[];for(let c=0,p=e.shapes.length;c<p;c++)s.push(r[e.shapes[c]]);const a=e.options.extrudePath;return void 0!==a&&(e.options.extrudePath=(new lm[a.type]).fromJSON(a)),new mo(s,e.options)}}const hh={generateTopUV:function(h,e,r,s,a){const m=e[3*s],x=e[3*s+1],E=e[3*a],C=e[3*a+1];return[new Rt(e[3*r],e[3*r+1]),new Rt(m,x),new Rt(E,C)]},generateSideWallUV:function(h,e,r,s,a,c){const p=e[3*r],m=e[3*r+1],x=e[3*r+2],E=e[3*s],C=e[3*s+1],D=e[3*s+2],A=e[3*a],P=e[3*a+1],L=e[3*a+2],H=e[3*c],q=e[3*c+1],k=e[3*c+2];return Math.abs(m-C)<Math.abs(p-E)?[new Rt(p,1-x),new Rt(E,1-D),new Rt(A,1-L),new Rt(H,1-k)]:[new Rt(m,1-x),new Rt(C,1-D),new Rt(P,1-L),new Rt(q,1-k)]}};class lc extends jt{constructor(e,r=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:r};const s=[],a=[],c=[],p=[];let m=0,x=0;if(!1===Array.isArray(e))E(e);else for(let C=0;C<e.length;C++)E(e[C]),this.addGroup(m,x,C),m+=x,x=0;function E(C){const D=a.length/3,A=C.extractPoints(r);let P=A.shape;const L=A.holes;!1===Bl.isClockWise(P)&&(P=P.reverse());for(let q=0,k=L.length;q<k;q++){const O=L[q];!0===Bl.isClockWise(O)&&(L[q]=O.reverse())}const H=Bl.triangulateShape(P,L);for(let q=0,k=L.length;q<k;q++)P=P.concat(L[q]);for(let q=0,k=P.length;q<k;q++){const O=P[q];a.push(O.x,O.y,0),c.push(0,0,1),p.push(O.x,O.y)}for(let q=0,k=H.length;q<k;q++){const O=H[q];s.push(O[0]+D,O[1]+D,O[2]+D),x+=3}}this.setIndex(s),this.setAttribute("position",new dn(a,3)),this.setAttribute("normal",new dn(c,3)),this.setAttribute("uv",new dn(p,2))}toJSON(){const e=super.toJSON();return function(h,e){if(e.shapes=[],Array.isArray(h))for(let r=0,s=h.length;r<s;r++)e.shapes.push(h[r].uuid);else e.shapes.push(h.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,r){const s=[];for(let a=0,c=e.shapes.length;a<c;a++)s.push(r[e.shapes[a]]);return new lc(s,e.curveSegments)}}class Mo extends jt{constructor(e=1,r=32,s=16,a=0,c=2*Math.PI,p=0,m=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:r,heightSegments:s,phiStart:a,phiLength:c,thetaStart:p,thetaLength:m},r=Math.max(3,Math.floor(r)),s=Math.max(2,Math.floor(s));const x=Math.min(p+m,Math.PI);let E=0;const C=[],D=new he,A=new he,P=[],L=[],H=[],q=[];for(let k=0;k<=s;k++){const O=[],re=k/s;let ne=0;0==k&&0==p?ne=.5/r:k==s&&x==Math.PI&&(ne=-.5/r);for(let ve=0;ve<=r;ve++){const Ie=ve/r;D.x=-e*Math.cos(a+Ie*c)*Math.sin(p+re*m),D.y=e*Math.cos(p+re*m),D.z=e*Math.sin(a+Ie*c)*Math.sin(p+re*m),L.push(D.x,D.y,D.z),A.copy(D).normalize(),H.push(A.x,A.y,A.z),q.push(Ie+ne,1-re),O.push(E++)}C.push(O)}for(let k=0;k<s;k++)for(let O=0;O<r;O++){const re=C[k][O+1],ne=C[k][O],ve=C[k+1][O],Ie=C[k+1][O+1];(0!==k||p>0)&&P.push(re,ne,Ie),(k!==s-1||x<Math.PI)&&P.push(ne,ve,Ie)}this.setIndex(P),this.setAttribute("position",new dn(L,3)),this.setAttribute("normal",new dn(H,3)),this.setAttribute("uv",new dn(q,2))}static fromJSON(e){return new Mo(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Nc extends jt{constructor(e,r=64,s=1,a=8,c=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:r,radius:s,radialSegments:a,closed:c};const p=e.computeFrenetFrames(r,c);this.tangents=p.tangents,this.normals=p.normals,this.binormals=p.binormals;const m=new he,x=new he,E=new Rt;let C=new he;const D=[],A=[],P=[],L=[];function q(re){C=e.getPointAt(re/r,C);const ne=p.normals[re],ve=p.binormals[re];for(let Ie=0;Ie<=a;Ie++){const ue=Ie/a*Math.PI*2,je=Math.sin(ue),wt=-Math.cos(ue);x.x=wt*ne.x+je*ve.x,x.y=wt*ne.y+je*ve.y,x.z=wt*ne.z+je*ve.z,x.normalize(),A.push(x.x,x.y,x.z),m.x=C.x+s*x.x,m.y=C.y+s*x.y,m.z=C.z+s*x.z,D.push(m.x,m.y,m.z)}}(function(){for(let re=0;re<r;re++)q(re);q(!1===c?r:0),function(){for(let re=0;re<=r;re++)for(let ne=0;ne<=a;ne++)E.x=re/r,E.y=ne/a,P.push(E.x,E.y)}(),function(){for(let re=1;re<=r;re++)for(let ne=1;ne<=a;ne++){const Ie=(a+1)*re+(ne-1),ue=(a+1)*re+ne,je=(a+1)*(re-1)+ne;L.push((a+1)*(re-1)+(ne-1),Ie,je),L.push(Ie,ue,je)}}()})(),this.setIndex(L),this.setAttribute("position",new dn(D,3)),this.setAttribute("normal",new dn(A,3)),this.setAttribute("uv",new dn(P,2))}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Nc((new lm[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}(class extends Re{constructor(e){super(),this.type="ShadowMaterial",this.color=new j(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}).prototype.isShadowMaterial=!0;class Gu extends Re{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new j(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new j(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}Gu.prototype.isMeshStandardMaterial=!0;(class extends Gu{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Rt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Ts(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(r){this.ior=(1+.4*r)/(1-.4*r)}}),this.sheenTint=new j(0),this.transmission=0,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationTint=new j(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularTint=new j(1,1,1),this.specularTintMap=null,this._clearcoat=0,this._transmission=0,this.setValues(e)}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheenTint.copy(e.sheenTint),this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationTint.copy(e.attenuationTint),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularTint.copy(e.specularTint),this.specularTintMap=e.specularTintMap,this}}).prototype.isMeshPhysicalMaterial=!0;(class extends Re{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new j(16777215),this.specular=new j(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new j(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}).prototype.isMeshPhongMaterial=!0;(class extends Re{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new j(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new j(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}).prototype.isMeshToonMaterial=!0;(class extends Re{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}).prototype.isMeshNormalMaterial=!0;class xp extends Re{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new j(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new j(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}xp.prototype.isMeshLambertMaterial=!0;(class extends Re{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new j(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}).prototype.isMeshMatcapMaterial=!0;(class extends go{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}).prototype.isLineDashedMaterial=!0;const ys={arraySlice:function(h,e,r){return ys.isTypedArray(h)?new h.constructor(h.subarray(e,void 0!==r?r:h.length)):h.slice(e,r)},convertArray:function(h,e,r){return!h||!r&&h.constructor===e?h:"number"==typeof e.BYTES_PER_ELEMENT?new e(h):Array.prototype.slice.call(h)},isTypedArray:function(h){return ArrayBuffer.isView(h)&&!(h instanceof DataView)},getKeyframeOrder:function(h){const r=h.length,s=new Array(r);for(let a=0;a!==r;++a)s[a]=a;return s.sort(function(a,c){return h[a]-h[c]}),s},sortedArray:function(h,e,r){const s=h.length,a=new h.constructor(s);for(let c=0,p=0;p!==s;++c){const m=r[c]*e;for(let x=0;x!==e;++x)a[p++]=h[m+x]}return a},flattenJSON:function(h,e,r,s){let a=1,c=h[0];for(;void 0!==c&&void 0===c[s];)c=h[a++];if(void 0===c)return;let p=c[s];if(void 0!==p)if(Array.isArray(p))do{p=c[s],void 0!==p&&(e.push(c.time),r.push.apply(r,p)),c=h[a++]}while(void 0!==c);else if(void 0!==p.toArray)do{p=c[s],void 0!==p&&(e.push(c.time),p.toArray(r,r.length)),c=h[a++]}while(void 0!==c);else do{p=c[s],void 0!==p&&(e.push(c.time),r.push(p)),c=h[a++]}while(void 0!==c)},subclip:function(h,e,r,s,a=30){const c=h.clone();c.name=e;const p=[];for(let x=0;x<c.tracks.length;++x){const E=c.tracks[x],C=E.getValueSize(),D=[],A=[];for(let P=0;P<E.times.length;++P){const L=E.times[P]*a;if(!(L<r||L>=s)){D.push(E.times[P]);for(let H=0;H<C;++H)A.push(E.values[P*C+H])}}0!==D.length&&(E.times=ys.convertArray(D,E.times.constructor),E.values=ys.convertArray(A,E.values.constructor),p.push(E))}c.tracks=p;let m=1/0;for(let x=0;x<c.tracks.length;++x)m>c.tracks[x].times[0]&&(m=c.tracks[x].times[0]);for(let x=0;x<c.tracks.length;++x)c.tracks[x].shift(-1*m);return c.resetDuration(),c},makeClipAdditive:function(h,e=0,r=h,s=30){s<=0&&(s=30);const a=r.tracks.length,c=e/s;for(let p=0;p<a;++p){const m=r.tracks[p],x=m.ValueTypeName;if("bool"===x||"string"===x)continue;const E=h.tracks.find(function(k){return k.name===m.name&&k.ValueTypeName===x});if(void 0===E)continue;let C=0;const D=m.getValueSize();m.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(C=D/3);let A=0;const P=E.getValueSize();E.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(A=P/3);const L=m.times.length-1;let H;if(c<=m.times[0])H=ys.arraySlice(m.values,C,D-C);else if(c>=m.times[L]){const k=L*D+C;H=ys.arraySlice(m.values,k,k+D-C)}else{const k=m.createInterpolant(),O=C,re=D-C;k.evaluate(c),H=ys.arraySlice(k.resultBuffer,O,re)}"quaternion"===x&&(new as).fromArray(H).normalize().conjugate().toArray(H);const q=E.times.length;for(let k=0;k<q;++k){const O=k*P+A;if("quaternion"===x)as.multiplyQuaternionsFlat(E.values,O,H,0,E.values,O);else{const re=P-2*A;for(let ne=0;ne<re;++ne)E.values[O+ne]-=H[ne]}}}return h.blendMode=2501,h}};class ju{constructor(e,r,s,a){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==a?a:new r.constructor(s),this.sampleValues=r,this.valueSize=s,this.settings=null,this.DefaultSettings_={}}evaluate(e){const r=this.parameterPositions;let s=this._cachedIndex,a=r[s],c=r[s-1];e:{t:{let p;n:{r:if(!(e<a)){for(let m=s+2;;){if(void 0===a){if(e<c)break r;return s=r.length,this._cachedIndex=s,this.afterEnd_(s-1,e,c)}if(s===m)break;if(c=a,a=r[++s],e<a)break t}p=r.length;break n}if(e>=c)break e;{const m=r[1];e<m&&(s=2,c=m);for(let x=s-2;;){if(void 0===c)return this._cachedIndex=0,this.beforeStart_(0,e,a);if(s===x)break;if(a=c,c=r[--s-1],e>=c)break t}p=s,s=0}}for(;s<p;){const m=s+p>>>1;e<r[m]?p=m:s=m+1}if(a=r[s],c=r[s-1],void 0===c)return this._cachedIndex=0,this.beforeStart_(0,e,a);if(void 0===a)return s=r.length,this._cachedIndex=s,this.afterEnd_(s-1,c,e)}this._cachedIndex=s,this.intervalChanged_(s,c,a)}return this.interpolate_(s,c,e,a)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,c=e*a;for(let p=0;p!==a;++p)r[p]=s[c+p];return r}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}ju.prototype.beforeStart_=ju.prototype.copySampleValue_,ju.prototype.afterEnd_=ju.prototype.copySampleValue_;class p0 extends ju{constructor(e,r,s,a){super(e,r,s,a),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Ss,endingEnd:Ss}}intervalChanged_(e,r,s){const a=this.parameterPositions;let c=e-2,p=e+1,m=a[c],x=a[p];if(void 0===m)switch(this.getSettings_().endingStart){case na:c=e,m=2*r-s;break;case 2402:c=a.length-2,m=r+a[c]-a[c+1];break;default:c=e,m=s}if(void 0===x)switch(this.getSettings_().endingEnd){case na:p=e,x=2*s-r;break;case 2402:p=1,x=s+a[1]-a[0];break;default:p=e-1,x=r}const E=.5*(s-r),C=this.valueSize;this._weightPrev=E/(r-m),this._weightNext=E/(x-s),this._offsetPrev=c*C,this._offsetNext=p*C}interpolate_(e,r,s,a){const c=this.resultBuffer,p=this.sampleValues,m=this.valueSize,x=e*m,E=x-m,C=this._offsetPrev,D=this._offsetNext,A=this._weightPrev,P=this._weightNext,L=(s-r)/(a-r),H=L*L,q=H*L,k=-A*q+2*A*H-A*L,O=(1+A)*q+(-1.5-2*A)*H+(-.5+A)*L+1,re=(-1-P)*q+(1.5+P)*H+.5*L,ne=P*q-P*H;for(let ve=0;ve!==m;++ve)c[ve]=k*p[C+ve]+O*p[E+ve]+re*p[x+ve]+ne*p[D+ve];return c}}class g0 extends ju{constructor(e,r,s,a){super(e,r,s,a)}interpolate_(e,r,s,a){const c=this.resultBuffer,p=this.sampleValues,m=this.valueSize,x=e*m,E=x-m,C=(s-r)/(a-r),D=1-C;for(let A=0;A!==m;++A)c[A]=p[E+A]*D+p[x+A]*C;return c}}class m0 extends ju{constructor(e,r,s,a){super(e,r,s,a)}interpolate_(e){return this.copySampleValue_(e-1)}}class cc{constructor(e,r,s,a){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===r||0===r.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ys.convertArray(r,this.TimeBufferType),this.values=ys.convertArray(s,this.ValueBufferType),this.setInterpolation(a||this.DefaultInterpolation)}static toJSON(e){const r=e.constructor;let s;if(r.toJSON!==this.toJSON)s=r.toJSON(e);else{s={name:e.name,times:ys.convertArray(e.times,Array),values:ys.convertArray(e.values,Array)};const a=e.getInterpolation();a!==e.DefaultInterpolation&&(s.interpolation=a)}return s.type=e.ValueTypeName,s}InterpolantFactoryMethodDiscrete(e){return new m0(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new g0(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new p0(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let r;switch(e){case 2300:r=this.InterpolantFactoryMethodDiscrete;break;case 2301:r=this.InterpolantFactoryMethodLinear;break;case 2302:r=this.InterpolantFactoryMethodSmooth}if(void 0===r){const s="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(s);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",s),this}return this.createInterpolant=r,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const r=this.times;for(let s=0,a=r.length;s!==a;++s)r[s]+=e}return this}scale(e){if(1!==e){const r=this.times;for(let s=0,a=r.length;s!==a;++s)r[s]*=e}return this}trim(e,r){const s=this.times,a=s.length;let c=0,p=a-1;for(;c!==a&&s[c]<e;)++c;for(;-1!==p&&s[p]>r;)--p;if(++p,0!==c||p!==a){c>=p&&(p=Math.max(p,1),c=p-1);const m=this.getValueSize();this.times=ys.arraySlice(s,c,p),this.values=ys.arraySlice(this.values,c*m,p*m)}return this}validate(){let e=!0;const r=this.getValueSize();r-Math.floor(r)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const s=this.times,a=this.values,c=s.length;0===c&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let p=null;for(let m=0;m!==c;m++){const x=s[m];if("number"==typeof x&&isNaN(x)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,m,x),e=!1;break}if(null!==p&&p>x){console.error("THREE.KeyframeTrack: Out of order keys.",this,m,x,p),e=!1;break}p=x}if(void 0!==a&&ys.isTypedArray(a))for(let m=0,x=a.length;m!==x;++m){const E=a[m];if(isNaN(E)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,m,E),e=!1;break}}return e}optimize(){const e=ys.arraySlice(this.times),r=ys.arraySlice(this.values),s=this.getValueSize(),a=2302===this.getInterpolation(),c=e.length-1;let p=1;for(let m=1;m<c;++m){let x=!1;const E=e[m];if(E!==e[m+1]&&(1!==m||E!==e[0]))if(a)x=!0;else{const D=m*s,A=D-s,P=D+s;for(let L=0;L!==s;++L){const H=r[D+L];if(H!==r[A+L]||H!==r[P+L]){x=!0;break}}}if(x){if(m!==p){e[p]=e[m];const D=m*s,A=p*s;for(let P=0;P!==s;++P)r[A+P]=r[D+P]}++p}}if(c>0){e[p]=e[c];for(let m=c*s,x=p*s,E=0;E!==s;++E)r[x+E]=r[m+E];++p}return p!==e.length?(this.times=ys.arraySlice(e,0,p),this.values=ys.arraySlice(r,0,p*s)):(this.times=e,this.values=r),this}clone(){const e=ys.arraySlice(this.times,0),r=ys.arraySlice(this.values,0),a=new(0,this.constructor)(this.name,e,r);return a.createInterpolant=this.createInterpolant,a}}cc.prototype.TimeBufferType=Float32Array,cc.prototype.ValueBufferType=Float32Array,cc.prototype.DefaultInterpolation=2301;class Mf extends cc{}Mf.prototype.ValueTypeName="bool",Mf.prototype.ValueBufferType=Array,Mf.prototype.DefaultInterpolation=2300,Mf.prototype.InterpolantFactoryMethodLinear=void 0,Mf.prototype.InterpolantFactoryMethodSmooth=void 0;class I_ extends cc{}I_.prototype.ValueTypeName="color";class wp extends cc{}wp.prototype.ValueTypeName="number";class y0 extends ju{constructor(e,r,s,a){super(e,r,s,a)}interpolate_(e,r,s,a){const c=this.resultBuffer,p=this.sampleValues,m=this.valueSize,x=(s-r)/(a-r);let E=e*m;for(let C=E+m;E!==C;E+=4)as.slerpFlat(c,0,p,E-m,p,E,x);return c}}class ph extends cc{InterpolantFactoryMethodLinear(e){return new y0(this.times,this.values,this.getValueSize(),e)}}ph.prototype.ValueTypeName="quaternion",ph.prototype.DefaultInterpolation=2301,ph.prototype.InterpolantFactoryMethodSmooth=void 0;class Pd extends cc{}Pd.prototype.ValueTypeName="string",Pd.prototype.ValueBufferType=Array,Pd.prototype.DefaultInterpolation=2300,Pd.prototype.InterpolantFactoryMethodLinear=void 0,Pd.prototype.InterpolantFactoryMethodSmooth=void 0;class Ep extends cc{}Ep.prototype.ValueTypeName="vector";class Mp{constructor(e,r=-1,s,a=2500){this.name=e,this.tracks=s,this.duration=r,this.blendMode=a,this.uuid=jn(),this.duration<0&&this.resetDuration()}static parse(e){const r=[],s=e.tracks,a=1/(e.fps||1);for(let p=0,m=s.length;p!==m;++p)r.push(P_(s[p]).scale(a));const c=new this(e.name,e.duration,r,e.blendMode);return c.uuid=e.uuid,c}static toJSON(e){const r=[],s=e.tracks,a={name:e.name,duration:e.duration,tracks:r,uuid:e.uuid,blendMode:e.blendMode};for(let c=0,p=s.length;c!==p;++c)r.push(cc.toJSON(s[c]));return a}static CreateFromMorphTargetSequence(e,r,s,a){const c=r.length,p=[];for(let m=0;m<c;m++){let x=[],E=[];x.push((m+c-1)%c,m,(m+1)%c),E.push(0,1,0);const C=ys.getKeyframeOrder(x);x=ys.sortedArray(x,1,C),E=ys.sortedArray(E,1,C),!a&&0===x[0]&&(x.push(c),E.push(E[0])),p.push(new wp(".morphTargetInfluences["+r[m].name+"]",x,E).scale(1/s))}return new this(e,-1,p)}static findByName(e,r){let s=e;if(!Array.isArray(e)){const a=e;s=a.geometry&&a.geometry.animations||a.animations}for(let a=0;a<s.length;a++)if(s[a].name===r)return s[a];return null}static CreateClipsFromMorphTargetSequences(e,r,s){const a={},c=/^([\w-]*?)([\d]+)$/;for(let m=0,x=e.length;m<x;m++){const E=e[m],C=E.name.match(c);if(C&&C.length>1){const D=C[1];let A=a[D];A||(a[D]=A=[]),A.push(E)}}const p=[];for(const m in a)p.push(this.CreateFromMorphTargetSequence(m,a[m],r,s));return p}static parseAnimation(e,r){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const s=function(D,A,P,L,H){if(0!==P.length){const q=[],k=[];ys.flattenJSON(P,q,k,L),0!==q.length&&H.push(new D(A,q,k))}},a=[],c=e.name||"default",p=e.fps||30,m=e.blendMode;let x=e.length||-1;const E=e.hierarchy||[];for(let D=0;D<E.length;D++){const A=E[D].keys;if(A&&0!==A.length)if(A[0].morphTargets){const P={};let L;for(L=0;L<A.length;L++)if(A[L].morphTargets)for(let H=0;H<A[L].morphTargets.length;H++)P[A[L].morphTargets[H]]=-1;for(const H in P){const q=[],k=[];for(let O=0;O!==A[L].morphTargets.length;++O){const re=A[L];q.push(re.time),k.push(re.morphTarget===H?1:0)}a.push(new wp(".morphTargetInfluence["+H+"]",q,k))}x=P.length*(p||1)}else{const P=".bones["+r[D].name+"]";s(Ep,P+".position",A,"pos",a),s(ph,P+".quaternion",A,"rot",a),s(Ep,P+".scale",A,"scl",a)}}return 0===a.length?null:new this(c,x,a,m)}resetDuration(){let r=0;for(let s=0,a=this.tracks.length;s!==a;++s){const c=this.tracks[s];r=Math.max(r,c.times[c.times.length-1])}return this.duration=r,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let r=0;r<this.tracks.length;r++)e=e&&this.tracks[r].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let r=0;r<this.tracks.length;r++)e.push(this.tracks[r].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function P_(h){if(void 0===h.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(h){switch(h.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return wp;case"vector":case"vector2":case"vector3":case"vector4":return Ep;case"color":return I_;case"quaternion":return ph;case"bool":case"boolean":return Mf;case"string":return Pd}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+h)}(h.type);if(void 0===h.times){const r=[],s=[];ys.flattenJSON(h.keys,r,s,"value"),h.times=r,h.values=s}return void 0!==e.parse?e.parse(h):new e(h.name,h.times,h.values,h.interpolation)}const Ld={enabled:!1,files:{},add:function(h,e){!1!==this.enabled&&(this.files[h]=e)},get:function(h){if(!1!==this.enabled)return this.files[h]},remove:function(h){delete this.files[h]},clear:function(){this.files={}}};const Fx=new class{constructor(e,r,s){const a=this;let x,c=!1,p=0,m=0;const E=[];this.onStart=void 0,this.onLoad=e,this.onProgress=r,this.onError=s,this.itemStart=function(C){m++,!1===c&&void 0!==a.onStart&&a.onStart(C,p,m),c=!0},this.itemEnd=function(C){p++,void 0!==a.onProgress&&a.onProgress(C,p,m),p===m&&(c=!1,void 0!==a.onLoad&&a.onLoad())},this.itemError=function(C){void 0!==a.onError&&a.onError(C)},this.resolveURL=function(C){return x?x(C):C},this.setURLModifier=function(C){return x=C,this},this.addHandler=function(C,D){return E.push(C,D),this},this.removeHandler=function(C){const D=E.indexOf(C);return-1!==D&&E.splice(D,2),this},this.getHandler=function(C){for(let D=0,A=E.length;D<A;D+=2){const P=E[D],L=E[D+1];if(P.global&&(P.lastIndex=0),P.test(C))return L}return null}}};class Od{constructor(e){this.manager=void 0!==e?e:Fx,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,r){const s=this;return new Promise(function(a,c){s.load(e,a,r,c)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const uc={};class cu extends Od{constructor(e){super(e)}load(e,r,s,a){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const c=this,p=Ld.get(e);if(void 0!==p)return c.manager.itemStart(e),setTimeout(function(){r&&r(p),c.manager.itemEnd(e)},0),p;if(void 0!==uc[e])return void uc[e].push({onLoad:r,onProgress:s,onError:a});const x=e.match(/^data:(.*?)(;base64)?,(.*)$/);let E;if(x){const C=x[1],D=!!x[2];let A=x[3];A=decodeURIComponent(A),D&&(A=atob(A));try{let P;const L=(this.responseType||"").toLowerCase();switch(L){case"arraybuffer":case"blob":const H=new Uint8Array(A.length);for(let k=0;k<A.length;k++)H[k]=A.charCodeAt(k);P="blob"===L?new Blob([H.buffer],{type:C}):H.buffer;break;case"document":P=(new DOMParser).parseFromString(A,C);break;case"json":P=JSON.parse(A);break;default:P=A}setTimeout(function(){r&&r(P),c.manager.itemEnd(e)},0)}catch(P){setTimeout(function(){a&&a(P),c.manager.itemError(e),c.manager.itemEnd(e)},0)}}else{uc[e]=[],uc[e].push({onLoad:r,onProgress:s,onError:a}),E=new XMLHttpRequest,E.open("GET",e,!0),E.addEventListener("load",function(C){const D=this.response,A=uc[e];if(delete uc[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Ld.add(e,D);for(let P=0,L=A.length;P<L;P++){const H=A[P];H.onLoad&&H.onLoad(D)}c.manager.itemEnd(e)}else{for(let P=0,L=A.length;P<L;P++){const H=A[P];H.onError&&H.onError(C)}c.manager.itemError(e),c.manager.itemEnd(e)}},!1),E.addEventListener("progress",function(C){const D=uc[e];for(let A=0,P=D.length;A<P;A++){const L=D[A];L.onProgress&&L.onProgress(C)}},!1),E.addEventListener("error",function(C){const D=uc[e];delete uc[e];for(let A=0,P=D.length;A<P;A++){const L=D[A];L.onError&&L.onError(C)}c.manager.itemError(e),c.manager.itemEnd(e)},!1),E.addEventListener("abort",function(C){const D=uc[e];delete uc[e];for(let A=0,P=D.length;A<P;A++){const L=D[A];L.onError&&L.onError(C)}c.manager.itemError(e),c.manager.itemEnd(e)},!1),void 0!==this.responseType&&(E.responseType=this.responseType),void 0!==this.withCredentials&&(E.withCredentials=this.withCredentials),E.overrideMimeType&&E.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const C in this.requestHeader)E.setRequestHeader(C,this.requestHeader[C]);E.send(null)}return c.manager.itemStart(e),E}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Sf extends Od{constructor(e){super(e)}load(e,r,s,a){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const c=this,p=Ld.get(e);if(void 0!==p)return c.manager.itemStart(e),setTimeout(function(){r&&r(p),c.manager.itemEnd(e)},0),p;const m=document.createElementNS("http://www.w3.org/1999/xhtml","img");function x(){m.removeEventListener("load",x,!1),m.removeEventListener("error",E,!1),Ld.add(e,this),r&&r(this),c.manager.itemEnd(e)}function E(C){m.removeEventListener("load",x,!1),m.removeEventListener("error",E,!1),a&&a(C),c.manager.itemError(e),c.manager.itemEnd(e)}return m.addEventListener("load",x,!1),m.addEventListener("error",E,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(m.crossOrigin=this.crossOrigin),c.manager.itemStart(e),m.src=e,m}}class _m extends Od{constructor(e){super(e)}load(e,r,s,a){const c=new Mc,p=new Sf(this.manager);p.setCrossOrigin(this.crossOrigin),p.setPath(this.path);let m=0;function x(E){p.load(e[E],function(C){c.images[E]=C,m++,6===m&&(c.needsUpdate=!0,r&&r(c))},void 0,a)}for(let E=0;E<e.length;++E)x(E);return c}}class N_ extends Od{constructor(e){super(e)}load(e,r,s,a){const c=new As,p=new Sf(this.manager);return p.setCrossOrigin(this.crossOrigin),p.setPath(this.path),p.load(e,function(m){c.image=m;const x=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);c.format=x?Zs:ds,c.needsUpdate=!0,void 0!==r&&r(c)},s,a),c}}class Ux extends sc{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),r=this.curves[this.curves.length-1].getPoint(1);e.equals(r)||this.curves.push(new uh(r,e))}getPoint(e){const r=e*this.getLength(),s=this.getCurveLengths();let a=0;for(;a<s.length;){if(s[a]>=r){const c=s[a]-r,p=this.curves[a],m=p.getLength();return p.getPointAt(0===m?0:1-c/m)}a++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let r=0;for(let s=0,a=this.curves.length;s<a;s++)r+=this.curves[s].getLength(),e.push(r);return this.cacheLengths=e,e}getSpacedPoints(e=40){const r=[];for(let s=0;s<=e;s++)r.push(this.getPoint(s/e));return this.autoClose&&r.push(r[0]),r}getPoints(e=12){const r=[];let s;for(let a=0,c=this.curves;a<c.length;a++){const p=c[a],x=p.getPoints(p&&p.isEllipseCurve?2*e:p&&(p.isLineCurve||p.isLineCurve3)?1:p&&p.isSplineCurve?e*p.points.length:e);for(let E=0;E<x.length;E++){const C=x[E];s&&s.equals(C)||(r.push(C),s=C)}}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r}copy(e){super.copy(e),this.curves=[];for(let r=0,s=e.curves.length;r<s;r++)this.curves.push(e.curves[r].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let r=0,s=this.curves.length;r<s;r++)e.curves.push(this.curves[r].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let r=0,s=e.curves.length;r<s;r++){const a=e.curves[r];this.curves.push((new lm[a.type]).fromJSON(a))}return this}}class bm extends Ux{constructor(e){super(),this.type="Path",this.currentPoint=new Rt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let r=1,s=e.length;r<s;r++)this.lineTo(e[r].x,e[r].y);return this}moveTo(e,r){return this.currentPoint.set(e,r),this}lineTo(e,r){const s=new uh(this.currentPoint.clone(),new Rt(e,r));return this.curves.push(s),this.currentPoint.set(e,r),this}quadraticCurveTo(e,r,s,a){const c=new yp(this.currentPoint.clone(),new Rt(e,r),new Rt(s,a));return this.curves.push(c),this.currentPoint.set(s,a),this}bezierCurveTo(e,r,s,a,c,p){const m=new ch(this.currentPoint.clone(),new Rt(e,r),new Rt(s,a),new Rt(c,p));return this.curves.push(m),this.currentPoint.set(c,p),this}splineThru(e){const r=[this.currentPoint.clone()].concat(e),s=new am(r);return this.curves.push(s),this.currentPoint.copy(e[e.length-1]),this}arc(e,r,s,a,c,p){return this.absarc(e+this.currentPoint.x,r+this.currentPoint.y,s,a,c,p),this}absarc(e,r,s,a,c,p){return this.absellipse(e,r,s,s,a,c,p),this}ellipse(e,r,s,a,c,p,m,x){return this.absellipse(e+this.currentPoint.x,r+this.currentPoint.y,s,a,c,p,m,x),this}absellipse(e,r,s,a,c,p,m,x){const E=new pp(e,r,s,a,c,p,m,x);if(this.curves.length>0){const D=E.getPoint(0);D.equals(this.currentPoint)||this.lineTo(D.x,D.y)}this.curves.push(E);const C=E.getPoint(1);return this.currentPoint.copy(C),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Nd extends bm{constructor(e){super(e),this.uuid=jn(),this.type="Shape",this.holes=[]}getPointsHoles(e){const r=[];for(let s=0,a=this.holes.length;s<a;s++)r[s]=this.holes[s].getPoints(e);return r}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let r=0,s=e.holes.length;r<s;r++)this.holes.push(e.holes[r].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let r=0,s=this.holes.length;r<s;r++)e.holes.push(this.holes[r].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let r=0,s=e.holes.length;r<s;r++){const a=e.holes[r];this.holes.push((new bm).fromJSON(a))}return this}}class dc extends Zr{constructor(e,r=1){super(),this.type="Light",this.color=new j(e),this.intensity=r}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const r=super.toJSON(e);return r.object.color=this.color.getHex(),r.object.intensity=this.intensity,void 0!==this.groundColor&&(r.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(r.object.distance=this.distance),void 0!==this.angle&&(r.object.angle=this.angle),void 0!==this.decay&&(r.object.decay=this.decay),void 0!==this.penumbra&&(r.object.penumbra=this.penumbra),void 0!==this.shadow&&(r.object.shadow=this.shadow.toJSON()),r}}dc.prototype.isLight=!0;(class extends dc{constructor(e,r,s){super(e,s),this.type="HemisphereLight",this.position.copy(Zr.DefaultUp),this.updateMatrix(),this.groundColor=new j(r)}copy(e){return dc.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}).prototype.isHemisphereLight=!0;const v0=new Nn,Fd=new he,_0=new he;class Sp{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Rt(512,512),this.map=null,this.mapPass=null,this.matrix=new Nn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ih,this._frameExtents=new Rt(1,1),this._viewportCount=1,this._viewports=[new di(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const r=this.camera,s=this.matrix;Fd.setFromMatrixPosition(e.matrixWorld),r.position.copy(Fd),_0.setFromMatrixPosition(e.target.matrixWorld),r.lookAt(_0),r.updateMatrixWorld(),v0.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(v0),s.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),s.multiply(r.projectionMatrix),s.multiply(r.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class b0 extends Sp{constructor(){super(new xs(50,1,.5,500)),this.focus=1}updateMatrices(e){const r=this.camera,s=2*sa*e.angle*this.focus,a=this.mapSize.width/this.mapSize.height,c=e.distance||r.far;(s!==r.fov||a!==r.aspect||c!==r.far)&&(r.fov=s,r.aspect=a,r.far=c,r.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}b0.prototype.isSpotLightShadow=!0;(class extends dc{constructor(e,r,s=0,a=Math.PI/3,c=0,p=1){super(e,r),this.type="SpotLight",this.position.copy(Zr.DefaultUp),this.updateMatrix(),this.target=new Zr,this.distance=s,this.angle=a,this.penumbra=c,this.decay=p,this.shadow=new b0}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}).prototype.isSpotLight=!0;const gh=new Nn,mh=new he,Cp=new he;class x0 extends Sp{constructor(){super(new xs(90,1,.5,500)),this._frameExtents=new Rt(4,2),this._viewportCount=6,this._viewports=[new di(2,1,1,1),new di(0,1,1,1),new di(3,1,1,1),new di(1,1,1,1),new di(3,0,1,1),new di(1,0,1,1)],this._cubeDirections=[new he(1,0,0),new he(-1,0,0),new he(0,0,1),new he(0,0,-1),new he(0,1,0),new he(0,-1,0)],this._cubeUps=[new he(0,1,0),new he(0,1,0),new he(0,1,0),new he(0,1,0),new he(0,0,1),new he(0,0,-1)]}updateMatrices(e,r=0){const s=this.camera,a=this.matrix,c=e.distance||s.far;c!==s.far&&(s.far=c,s.updateProjectionMatrix()),mh.setFromMatrixPosition(e.matrixWorld),s.position.copy(mh),Cp.copy(s.position),Cp.add(this._cubeDirections[r]),s.up.copy(this._cubeUps[r]),s.lookAt(Cp),s.updateMatrixWorld(),a.makeTranslation(-mh.x,-mh.y,-mh.z),gh.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),this._frustum.setFromProjectionMatrix(gh)}}x0.prototype.isPointLightShadow=!0;(class extends dc{constructor(e,r,s=0,a=1){super(e,r),this.type="PointLight",this.distance=s,this.decay=a,this.shadow=new x0}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}).prototype.isPointLight=!0;class E0 extends Sp{constructor(){super(new Ns(-5,5,5,-5,.5,500))}}E0.prototype.isDirectionalLightShadow=!0;class wm extends dc{constructor(e,r){super(e,r),this.type="DirectionalLight",this.position.copy(Zr.DefaultUp),this.updateMatrix(),this.target=new Zr,this.shadow=new E0}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}wm.prototype.isDirectionalLight=!0;class Em extends dc{constructor(e,r){super(e,r),this.type="AmbientLight"}}Em.prototype.isAmbientLight=!0;(class extends dc{constructor(e,r,s=10,a=10){super(e,r),this.type="RectAreaLight",this.width=s,this.height=a}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const r=super.toJSON(e);return r.object.width=this.width,r.object.height=this.height,r}}).prototype.isRectAreaLight=!0;class M0{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new he)}set(e){for(let r=0;r<9;r++)this.coefficients[r].copy(e[r]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,r){const s=e.x,a=e.y,c=e.z,p=this.coefficients;return r.copy(p[0]).multiplyScalar(.282095),r.addScaledVector(p[1],.488603*a),r.addScaledVector(p[2],.488603*c),r.addScaledVector(p[3],.488603*s),r.addScaledVector(p[4],s*a*1.092548),r.addScaledVector(p[5],a*c*1.092548),r.addScaledVector(p[6],.315392*(3*c*c-1)),r.addScaledVector(p[7],s*c*1.092548),r.addScaledVector(p[8],.546274*(s*s-a*a)),r}getIrradianceAt(e,r){const s=e.x,a=e.y,c=e.z,p=this.coefficients;return r.copy(p[0]).multiplyScalar(.886227),r.addScaledVector(p[1],1.023328*a),r.addScaledVector(p[2],1.023328*c),r.addScaledVector(p[3],1.023328*s),r.addScaledVector(p[4],.858086*s*a),r.addScaledVector(p[5],.858086*a*c),r.addScaledVector(p[6],.743125*c*c-.247708),r.addScaledVector(p[7],.858086*s*c),r.addScaledVector(p[8],.429043*(s*s-a*a)),r}add(e){for(let r=0;r<9;r++)this.coefficients[r].add(e.coefficients[r]);return this}addScaledSH(e,r){for(let s=0;s<9;s++)this.coefficients[s].addScaledVector(e.coefficients[s],r);return this}scale(e){for(let r=0;r<9;r++)this.coefficients[r].multiplyScalar(e);return this}lerp(e,r){for(let s=0;s<9;s++)this.coefficients[s].lerp(e.coefficients[s],r);return this}equals(e){for(let r=0;r<9;r++)if(!this.coefficients[r].equals(e.coefficients[r]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,r=0){const s=this.coefficients;for(let a=0;a<9;a++)s[a].fromArray(e,r+3*a);return this}toArray(e=[],r=0){const s=this.coefficients;for(let a=0;a<9;a++)s[a].toArray(e,r+3*a);return e}static getBasisAt(e,r){const s=e.x,a=e.y,c=e.z;r[0]=.282095,r[1]=.488603*a,r[2]=.488603*c,r[3]=.488603*s,r[4]=1.092548*s*a,r[5]=1.092548*a*c,r[6]=.315392*(3*c*c-1),r[7]=1.092548*s*c,r[8]=.546274*(s*s-a*a)}}M0.prototype.isSphericalHarmonics3=!0;class yh extends dc{constructor(e=new M0,r=1){super(void 0,r),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const r=super.toJSON(e);return r.object.sh=this.sh.toArray(),r}}yh.prototype.isLightProbe=!0;(class extends jt{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}).prototype.isInstancedBufferGeometry=!0,class extends Od{constructor(e){super(e),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,r,s,a){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const c=this,p=Ld.get(e);if(void 0!==p)return c.manager.itemStart(e),setTimeout(function(){r&&r(p),c.manager.itemEnd(e)},0),p;const m={};m.credentials="anonymous"===this.crossOrigin?"same-origin":"include",m.headers=this.requestHeader,fetch(e,m).then(function(x){return x.blob()}).then(function(x){return createImageBitmap(x,Object.assign(c.options,{colorSpaceConversion:"none"}))}).then(function(x){Ld.add(e,x),r&&r(x),c.manager.itemEnd(e)}).catch(function(x){a&&a(x),c.manager.itemError(e),c.manager.itemEnd(e)}),c.manager.itemStart(e)}}.prototype.isImageBitmapLoader=!0;let Rm;class D0 extends Od{constructor(e){super(e)}load(e,r,s,a){const c=this,p=new cu(this.manager);p.setResponseType("arraybuffer"),p.setPath(this.path),p.setRequestHeader(this.requestHeader),p.setWithCredentials(this.withCredentials),p.load(e,function(m){try{const x=m.slice(0);(void 0===Rm&&(Rm=new(window.AudioContext||window.webkitAudioContext)),Rm).decodeAudioData(x,function(C){r(C)})}catch(x){a?a(x):console.error(x),c.manager.itemError(e)}},s,a)}}(class extends yh{constructor(e,r,s=1){super(void 0,s);const a=(new j).set(e),c=(new j).set(r),p=new he(a.r,a.g,a.b),m=new he(c.r,c.g,c.b),x=Math.sqrt(Math.PI),E=x*Math.sqrt(.75);this.sh.coefficients[0].copy(p).add(m).multiplyScalar(x),this.sh.coefficients[1].copy(p).sub(m).multiplyScalar(E)}}).prototype.isHemisphereLightProbe=!0,class extends yh{constructor(e,r=1){super(void 0,r);const s=(new j).set(e);this.sh.coefficients[0].set(s.r,s.g,s.b).multiplyScalar(2*Math.sqrt(Math.PI))}}.prototype.isAmbientLightProbe=!0;class Ap{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Dp(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const r=Dp();e=(r-this.oldTime)/1e3,this.oldTime=r,this.elapsedTime+=e}return e}}function Dp(){return("undefined"==typeof performance?Date:performance).now()}class B0{constructor(e,r,s){let a,c,p;switch(this.binding=e,this.valueSize=s,r){case"quaternion":a=this._slerp,c=this._slerpAdditive,p=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*s),this._workIndex=5;break;case"string":case"bool":a=this._select,c=this._select,p=this._setAdditiveIdentityOther,this.buffer=new Array(5*s);break;default:a=this._lerp,c=this._lerpAdditive,p=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*s)}this._mixBufferRegion=a,this._mixBufferRegionAdditive=c,this._setIdentity=p,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,r){const s=this.buffer,a=this.valueSize,c=e*a+a;let p=this.cumulativeWeight;if(0===p){for(let m=0;m!==a;++m)s[c+m]=s[m];p=r}else p+=r,this._mixBufferRegion(s,c,0,r/p,a);this.cumulativeWeight=p}accumulateAdditive(e){const r=this.buffer,s=this.valueSize,a=s*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(r,a,0,e,s),this.cumulativeWeightAdditive+=e}apply(e){const r=this.valueSize,s=this.buffer,a=e*r+r,c=this.cumulativeWeight,p=this.cumulativeWeightAdditive,m=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,c<1&&this._mixBufferRegion(s,a,r*this._origIndex,1-c,r),p>0&&this._mixBufferRegionAdditive(s,a,this._addIndex*r,1,r);for(let x=r,E=r+r;x!==E;++x)if(s[x]!==s[x+r]){m.setValue(s,a);break}}saveOriginalState(){const r=this.buffer,s=this.valueSize,a=s*this._origIndex;this.binding.getValue(r,a);for(let c=s,p=a;c!==p;++c)r[c]=r[a+c%s];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,r=e+this.valueSize;for(let s=e;s<r;s++)this.buffer[s]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,r=this._addIndex*this.valueSize;for(let s=0;s<this.valueSize;s++)this.buffer[r+s]=this.buffer[e+s]}_select(e,r,s,a,c){if(a>=.5)for(let p=0;p!==c;++p)e[r+p]=e[s+p]}_slerp(e,r,s,a){as.slerpFlat(e,r,e,r,e,s,a)}_slerpAdditive(e,r,s,a,c){const p=this._workIndex*c;as.multiplyQuaternionsFlat(e,p,e,r,e,s),as.slerpFlat(e,r,e,r,e,p,a)}_lerp(e,r,s,a,c){const p=1-a;for(let m=0;m!==c;++m){const x=r+m;e[x]=e[x]*p+e[s+m]*a}}_lerpAdditive(e,r,s,a,c){for(let p=0;p!==c;++p){const m=r+p;e[m]=e[m]+e[s+p]*a}}}const Rp="\\[\\]\\.:\\/",U0=new RegExp("["+Rp+"]","g"),Ip="[^"+Rp+"]",V0="[^"+Rp.replace("\\.","")+"]",z0=/((?:WC+[\/:])*)/.source.replace("WC",Ip),H0=/(WCOD+)?/.source.replace("WCOD",V0),Hx=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Ip),H_=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Ip),G_=new RegExp("^"+z0+H0+Hx+H_+"$"),G0=["material","materials","bones"];class j_{constructor(e,r,s){const a=s||Wr.parseTrackName(r);this._targetGroup=e,this._bindings=e.subscribe_(r,a)}getValue(e,r){this.bind();const a=this._bindings[this._targetGroup.nCachedObjects_];void 0!==a&&a.getValue(e,r)}setValue(e,r){const s=this._bindings;for(let a=this._targetGroup.nCachedObjects_,c=s.length;a!==c;++a)s[a].setValue(e,r)}bind(){const e=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=e.length;r!==s;++r)e[r].bind()}unbind(){const e=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=e.length;r!==s;++r)e[r].unbind()}}let Wr=(()=>{class h{constructor(r,s,a){this.path=s,this.parsedPath=a||h.parseTrackName(s),this.node=h.findNode(r,this.parsedPath.nodeName)||r,this.rootNode=r,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(r,s,a){return r&&r.isAnimationObjectGroup?new h.Composite(r,s,a):new h(r,s,a)}static sanitizeNodeName(r){return r.replace(/\s/g,"_").replace(U0,"")}static parseTrackName(r){const s=G_.exec(r);if(!s)throw new Error("PropertyBinding: Cannot parse trackName: "+r);const a={nodeName:s[2],objectName:s[3],objectIndex:s[4],propertyName:s[5],propertyIndex:s[6]},c=a.nodeName&&a.nodeName.lastIndexOf(".");if(void 0!==c&&-1!==c){const p=a.nodeName.substring(c+1);-1!==G0.indexOf(p)&&(a.nodeName=a.nodeName.substring(0,c),a.objectName=p)}if(null===a.propertyName||0===a.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+r);return a}static findNode(r,s){if(!s||""===s||"."===s||-1===s||s===r.name||s===r.uuid)return r;if(r.skeleton){const a=r.skeleton.getBoneByName(s);if(void 0!==a)return a}if(r.children){const a=function(p){for(let m=0;m<p.length;m++){const x=p[m];if(x.name===s||x.uuid===s)return x;const E=a(x.children);if(E)return E}return null},c=a(r.children);if(c)return c}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(r,s){r[s]=this.targetObject[this.propertyName]}_getValue_array(r,s){const a=this.resolvedProperty;for(let c=0,p=a.length;c!==p;++c)r[s++]=a[c]}_getValue_arrayElement(r,s){r[s]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(r,s){this.resolvedProperty.toArray(r,s)}_setValue_direct(r,s){this.targetObject[this.propertyName]=r[s]}_setValue_direct_setNeedsUpdate(r,s){this.targetObject[this.propertyName]=r[s],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(r,s){this.targetObject[this.propertyName]=r[s],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(r,s){const a=this.resolvedProperty;for(let c=0,p=a.length;c!==p;++c)a[c]=r[s++]}_setValue_array_setNeedsUpdate(r,s){const a=this.resolvedProperty;for(let c=0,p=a.length;c!==p;++c)a[c]=r[s++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(r,s){const a=this.resolvedProperty;for(let c=0,p=a.length;c!==p;++c)a[c]=r[s++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(r,s){this.resolvedProperty[this.propertyIndex]=r[s]}_setValue_arrayElement_setNeedsUpdate(r,s){this.resolvedProperty[this.propertyIndex]=r[s],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(r,s){this.resolvedProperty[this.propertyIndex]=r[s],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(r,s){this.resolvedProperty.fromArray(r,s)}_setValue_fromArray_setNeedsUpdate(r,s){this.resolvedProperty.fromArray(r,s),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(r,s){this.resolvedProperty.fromArray(r,s),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(r,s){this.bind(),this.getValue(r,s)}_setValue_unbound(r,s){this.bind(),this.setValue(r,s)}bind(){let r=this.node;const s=this.parsedPath,a=s.objectName,c=s.propertyName;let p=s.propertyIndex;if(r||(r=h.findNode(this.rootNode,s.nodeName)||this.rootNode,this.node=r),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!r)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(a){let C=s.objectIndex;switch(a){case"materials":if(!r.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!r.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);r=r.material.materials;break;case"bones":if(!r.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);r=r.skeleton.bones;for(let D=0;D<r.length;D++)if(r[D].name===C){C=D;break}break;default:if(void 0===r[a])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);r=r[a]}if(void 0!==C){if(void 0===r[C])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,r);r=r[C]}}const m=r[c];if(void 0===m)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+s.nodeName+"."+c+" but it wasn't found.",r);let x=this.Versioning.None;this.targetObject=r,void 0!==r.needsUpdate?x=this.Versioning.NeedsUpdate:void 0!==r.matrixWorldNeedsUpdate&&(x=this.Versioning.MatrixWorldNeedsUpdate);let E=this.BindingType.Direct;if(void 0!==p){if("morphTargetInfluences"===c){if(!r.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!r.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!r.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==r.morphTargetDictionary[p]&&(p=r.morphTargetDictionary[p])}E=this.BindingType.ArrayElement,this.resolvedProperty=m,this.propertyIndex=p}else void 0!==m.fromArray&&void 0!==m.toArray?(E=this.BindingType.HasFromToArray,this.resolvedProperty=m):Array.isArray(m)?(E=this.BindingType.EntireArray,this.resolvedProperty=m):this.propertyName=c;this.getValue=this.GetterByBindingType[E],this.setValue=this.SetterByBindingTypeAndVersioning[E][x]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return h.Composite=j_,h})();Wr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Wr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Wr.prototype.GetterByBindingType=[Wr.prototype._getValue_direct,Wr.prototype._getValue_array,Wr.prototype._getValue_arrayElement,Wr.prototype._getValue_toArray],Wr.prototype.SetterByBindingTypeAndVersioning=[[Wr.prototype._setValue_direct,Wr.prototype._setValue_direct_setNeedsUpdate,Wr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Wr.prototype._setValue_array,Wr.prototype._setValue_array_setNeedsUpdate,Wr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Wr.prototype._setValue_arrayElement,Wr.prototype._setValue_arrayElement_setNeedsUpdate,Wr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Wr.prototype._setValue_fromArray,Wr.prototype._setValue_fromArray_setNeedsUpdate,Wr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class W_{constructor(e,r,s=null,a=r.blendMode){this._mixer=e,this._clip=r,this._localRoot=s,this.blendMode=a;const c=r.tracks,p=c.length,m=new Array(p),x={endingStart:Ss,endingEnd:Ss};for(let E=0;E!==p;++E){const C=c[E].createInterpolant(null);m[E]=C,C.settings=x}this._interpolantSettings=x,this._interpolants=m,this._propertyBindings=new Array(p),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,r){return this.loop=e,this.repetitions=r,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,r,s){if(e.fadeOut(r),this.fadeIn(r),s){const a=this._clip.duration,c=e._clip.duration,m=a/c;e.warp(1,c/a,r),this.warp(m,1,r)}return this}crossFadeTo(e,r,s){return e.crossFadeFrom(this,r,s)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,r,s){const a=this._mixer,c=a.time,p=this.timeScale;let m=this._timeScaleInterpolant;null===m&&(m=a._lendControlInterpolant(),this._timeScaleInterpolant=m);const x=m.parameterPositions,E=m.sampleValues;return x[0]=c,x[1]=c+s,E[0]=e/p,E[1]=r/p,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,r,s,a){if(!this.enabled)return void this._updateWeight(e);const c=this._startTime;if(null!==c){const x=(e-c)*s;if(x<0||0===s)return;this._startTime=null,r=s*x}r*=this._updateTimeScale(e);const p=this._updateTime(r),m=this._updateWeight(e);if(m>0){const x=this._interpolants,E=this._propertyBindings;switch(this.blendMode){case 2501:for(let C=0,D=x.length;C!==D;++C)x[C].evaluate(p),E[C].accumulateAdditive(m);break;case 2500:default:for(let C=0,D=x.length;C!==D;++C)x[C].evaluate(p),E[C].accumulate(a,m)}}}_updateWeight(e){let r=0;if(this.enabled){r=this.weight;const s=this._weightInterpolant;if(null!==s){const a=s.evaluate(e)[0];r*=a,e>s.parameterPositions[1]&&(this.stopFading(),0===a&&(this.enabled=!1))}}return this._effectiveWeight=r,r}_updateTimeScale(e){let r=0;if(!this.paused){r=this.timeScale;const s=this._timeScaleInterpolant;null!==s&&(r*=s.evaluate(e)[0],e>s.parameterPositions[1]&&(this.stopWarping(),0===r?this.paused=!0:this.timeScale=r))}return this._effectiveTimeScale=r,r}_updateTime(e){const r=this._clip.duration,s=this.loop;let a=this.time+e,c=this._loopCount;const p=2202===s;if(0===e)return-1===c?a:p&&1==(1&c)?r-a:a;if(2200===s){-1===c&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(a>=r)a=r;else{if(!(a<0)){this.time=a;break e}a=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=a,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===c&&(e>=0?(c=0,this._setEndings(!0,0===this.repetitions,p)):this._setEndings(0===this.repetitions,!0,p)),a>=r||a<0){const m=Math.floor(a/r);a-=r*m,c+=Math.abs(m);const x=this.repetitions-c;if(x<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,a=e>0?r:0,this.time=a,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===x){const E=e<0;this._setEndings(E,!E,p)}else this._setEndings(!1,!1,p);this._loopCount=c,this.time=a,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:m})}}else this.time=a;if(p&&1==(1&c))return r-a}return a}_setEndings(e,r,s){const a=this._interpolantSettings;s?(a.endingStart=na,a.endingEnd=na):(a.endingStart=e?this.zeroSlopeAtStart?na:Ss:2402,a.endingEnd=r?this.zeroSlopeAtEnd?na:Ss:2402)}_scheduleFading(e,r,s){const a=this._mixer,c=a.time;let p=this._weightInterpolant;null===p&&(p=a._lendControlInterpolant(),this._weightInterpolant=p);const m=p.parameterPositions,x=p.sampleValues;return m[0]=c,x[0]=r,m[1]=c+e,x[1]=s,this}}(class extends qi{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,r){const s=e._localRoot||this._root,a=e._clip.tracks,c=a.length,p=e._propertyBindings,m=e._interpolants,x=s.uuid,E=this._bindingsByRootAndName;let C=E[x];void 0===C&&(C={},E[x]=C);for(let D=0;D!==c;++D){const A=a[D],P=A.name;let L=C[P];if(void 0!==L)p[D]=L;else{if(L=p[D],void 0!==L){null===L._cacheIndex&&(++L.referenceCount,this._addInactiveBinding(L,x,P));continue}L=new B0(Wr.create(s,P,r&&r._propertyBindings[D].binding.parsedPath),A.ValueTypeName,A.getValueSize()),++L.referenceCount,this._addInactiveBinding(L,x,P),p[D]=L}m[D].resultBuffer=L.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const s=(e._localRoot||this._root).uuid,a=e._clip.uuid,c=this._actionsByClip[a];this._bindAction(e,c&&c.knownActions[0]),this._addInactiveAction(e,a,s)}const r=e._propertyBindings;for(let s=0,a=r.length;s!==a;++s){const c=r[s];0==c.useCount++&&(this._lendBinding(c),c.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const r=e._propertyBindings;for(let s=0,a=r.length;s!==a;++s){const c=r[s];0==--c.useCount&&(c.restoreOriginalState(),this._takeBackBinding(c))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const r=e._cacheIndex;return null!==r&&r<this._nActiveActions}_addInactiveAction(e,r,s){const a=this._actions,c=this._actionsByClip;let p=c[r];if(void 0===p)p={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,c[r]=p;else{const m=p.knownActions;e._byClipCacheIndex=m.length,m.push(e)}e._cacheIndex=a.length,a.push(e),p.actionByRoot[s]=e}_removeInactiveAction(e){const r=this._actions,s=r[r.length-1],a=e._cacheIndex;s._cacheIndex=a,r[a]=s,r.pop(),e._cacheIndex=null;const c=e._clip.uuid,p=this._actionsByClip,m=p[c],x=m.knownActions,E=x[x.length-1],C=e._byClipCacheIndex;E._byClipCacheIndex=C,x[C]=E,x.pop(),e._byClipCacheIndex=null,delete m.actionByRoot[(e._localRoot||this._root).uuid],0===x.length&&delete p[c],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const r=e._propertyBindings;for(let s=0,a=r.length;s!==a;++s){const c=r[s];0==--c.referenceCount&&this._removeInactiveBinding(c)}}_lendAction(e){const r=this._actions,s=e._cacheIndex,a=this._nActiveActions++,c=r[a];e._cacheIndex=a,r[a]=e,c._cacheIndex=s,r[s]=c}_takeBackAction(e){const r=this._actions,s=e._cacheIndex,a=--this._nActiveActions,c=r[a];e._cacheIndex=a,r[a]=e,c._cacheIndex=s,r[s]=c}_addInactiveBinding(e,r,s){const a=this._bindingsByRootAndName,c=this._bindings;let p=a[r];void 0===p&&(p={},a[r]=p),p[s]=e,e._cacheIndex=c.length,c.push(e)}_removeInactiveBinding(e){const r=this._bindings,s=e.binding,a=s.rootNode.uuid,c=s.path,p=this._bindingsByRootAndName,m=p[a],x=r[r.length-1],E=e._cacheIndex;x._cacheIndex=E,r[E]=x,r.pop(),delete m[c],0===Object.keys(m).length&&delete p[a]}_lendBinding(e){const r=this._bindings,s=e._cacheIndex,a=this._nActiveBindings++,c=r[a];e._cacheIndex=a,r[a]=e,c._cacheIndex=s,r[s]=c}_takeBackBinding(e){const r=this._bindings,s=e._cacheIndex,a=--this._nActiveBindings,c=r[a];e._cacheIndex=a,r[a]=e,c._cacheIndex=s,r[s]=c}_lendControlInterpolant(){const e=this._controlInterpolants,r=this._nActiveControlInterpolants++;let s=e[r];return void 0===s&&(s=new g0(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),s.__cacheIndex=r,e[r]=s),s}_takeBackControlInterpolant(e){const r=this._controlInterpolants,s=e.__cacheIndex,a=--this._nActiveControlInterpolants,c=r[a];e.__cacheIndex=a,r[a]=e,c.__cacheIndex=s,r[s]=c}clipAction(e,r,s){const a=r||this._root,c=a.uuid;let p="string"==typeof e?Mp.findByName(a,e):e;const m=null!==p?p.uuid:e,x=this._actionsByClip[m];let E=null;if(void 0===s&&(s=null!==p?p.blendMode:2500),void 0!==x){const D=x.actionByRoot[c];if(void 0!==D&&D.blendMode===s)return D;E=x.knownActions[0],null===p&&(p=E._clip)}if(null===p)return null;const C=new W_(this,p,r,s);return this._bindAction(C,E),this._addInactiveAction(C,m,c),C}existingAction(e,r){const s=r||this._root,a=s.uuid,c="string"==typeof e?Mp.findByName(s,e):e,m=this._actionsByClip[c?c.uuid:e];return void 0!==m&&m.actionByRoot[a]||null}stopAllAction(){const e=this._actions;for(let s=this._nActiveActions-1;s>=0;--s)e[s].stop();return this}update(e){const r=this._actions,s=this._nActiveActions,a=this.time+=e*=this.timeScale,c=Math.sign(e),p=this._accuIndex^=1;for(let E=0;E!==s;++E)r[E]._update(a,e,c,p);const m=this._bindings,x=this._nActiveBindings;for(let E=0;E!==x;++E)m[E].apply(p);return this}setTime(e){this.time=0;for(let r=0;r<this._actions.length;r++)this._actions[r].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const r=this._actions,s=e.uuid,a=this._actionsByClip,c=a[s];if(void 0!==c){const p=c.knownActions;for(let m=0,x=p.length;m!==x;++m){const E=p[m];this._deactivateAction(E);const C=E._cacheIndex,D=r[r.length-1];E._cacheIndex=null,E._byClipCacheIndex=null,D._cacheIndex=C,r[C]=D,r.pop(),this._removeInactiveBindingsForAction(E)}delete a[s]}}uncacheRoot(e){const r=e.uuid,s=this._actionsByClip;for(const p in s){const x=s[p].actionByRoot[r];void 0!==x&&(this._deactivateAction(x),this._removeInactiveAction(x))}const c=this._bindingsByRootAndName[r];if(void 0!==c)for(const p in c){const m=c[p];m.restoreOriginalState(),this._removeInactiveBinding(m)}}uncacheAction(e,r){const s=this.existingAction(e,r);null!==s&&(this._deactivateAction(s),this._removeInactiveAction(s))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1);class Pp{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new Pp(void 0===this.value.clone?this.value:this.value.clone())}}(class extends th{constructor(e,r,s=1){super(e,r),this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const r=super.clone(e);return r.meshPerAttribute=this.meshPerAttribute,r}toJSON(e){const r=super.toJSON(e);return r.isInstancedInterleavedBuffer=!0,r.meshPerAttribute=this.meshPerAttribute,r}}).prototype.isInstancedInterleavedBuffer=!0;class $0{constructor(e,r,s=0,a=1/0){this.ray=new Gs(e,r),this.near=s,this.far=a,this.camera=null,this.layers=new zo,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,r){this.ray.set(e,r)}setFromCamera(e,r){r&&r.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(r.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(r).sub(this.ray.origin).normalize(),this.camera=r):r&&r.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(r.near+r.far)/(r.near-r.far)).unproject(r),this.ray.direction.set(0,0,-1).transformDirection(r.matrixWorld),this.camera=r):console.error("THREE.Raycaster: Unsupported camera type: "+r.type)}intersectObject(e,r=!1,s=[]){return Pm(e,this,s,r),s.sort(Bd),s}intersectObjects(e,r=!1,s=[]){for(let a=0,c=e.length;a<c;a++)Pm(e[a],this,s,r);return s.sort(Bd),s}}function Bd(h,e){return h.distance-e.distance}function Pm(h,e,r,s){if(h.layers.test(e.layers)&&h.raycast(e,r),!0===s){const a=h.children;for(let c=0,p=a.length;c<p;c++)Pm(a[c],e,r,!0)}}class Y_{constructor(e=1,r=0,s=0){return this.radius=e,this.phi=r,this.theta=s,this}set(e,r,s){return this.radius=e,this.phi=r,this.theta=s,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,r,s){return this.radius=Math.sqrt(e*e+r*r+s*s),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,s),this.phi=Math.acos(Ts(r/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const q0=new Rt;class Tf{constructor(e=new Rt(1/0,1/0),r=new Rt(-1/0,-1/0)){this.min=e,this.max=r}set(e,r){return this.min.copy(e),this.max.copy(r),this}setFromPoints(e){this.makeEmpty();for(let r=0,s=e.length;r<s;r++)this.expandByPoint(e[r]);return this}setFromCenterAndSize(e,r){const s=q0.copy(r).multiplyScalar(.5);return this.min.copy(e).sub(s),this.max.copy(e).add(s),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,r){return r.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,r){return r.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return q0.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Tf.prototype.isBox2=!0,class extends Zr{constructor(e){super(),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}}.prototype.isImmediateRenderObject=!0;const Yo=new he,ja=new Nn,pl=new Nn;function Lm(h){const e=[];h&&h.isBone&&e.push(h);for(let r=0;r<h.children.length;r++)e.push.apply(e,Lm(h.children[r]));return e}const Bm=new Float32Array(1);new Int32Array(Bm.buffer),sc.create=function(h,e){return console.log("THREE.Curve.create() has been deprecated"),h.prototype=Object.create(sc.prototype),h.prototype.constructor=h,h.prototype.getPoint=e,h},bm.prototype.fromPoints=function(h){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(h)},class extends hl{constructor(e=10,r=10,s=4473924,a=8947848){s=new j(s),a=new j(a);const c=r/2,p=e/r,m=e/2,x=[],E=[];for(let A=0,P=0,L=-m;A<=r;A++,L+=p){x.push(-m,0,L,m,0,L),x.push(L,0,-m,L,0,m);const H=A===c?s:a;H.toArray(E,P),P+=3,H.toArray(E,P),P+=3,H.toArray(E,P),P+=3,H.toArray(E,P),P+=3}const C=new jt;C.setAttribute("position",new dn(x,3)),C.setAttribute("color",new dn(E,3)),super(C,new go({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class extends hl{constructor(e){const r=Lm(e),s=new jt,a=[],c=[],p=new j(0,0,1),m=new j(0,1,0);for(let E=0;E<r.length;E++){const C=r[E];C.parent&&C.parent.isBone&&(a.push(0,0,0),a.push(0,0,0),c.push(p.r,p.g,p.b),c.push(m.r,m.g,m.b))}s.setAttribute("position",new dn(a,3)),s.setAttribute("color",new dn(c,3)),super(s,new go({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=r,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const r=this.bones,s=this.geometry,a=s.getAttribute("position");pl.copy(this.root.matrixWorld).invert();for(let c=0,p=0;c<r.length;c++){const m=r[c];m.parent&&m.parent.isBone&&(ja.multiplyMatrices(pl,m.matrixWorld),Yo.setFromMatrixPosition(ja),a.setXYZ(p,Yo.x,Yo.y,Yo.z),ja.multiplyMatrices(pl,m.parent.matrixWorld),Yo.setFromMatrixPosition(ja),a.setXYZ(p+1,Yo.x,Yo.y,Yo.z),p+=2)}s.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Od.prototype.extractUrlBase=function(h){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),class{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let r="";for(let s=0,a=e.length;s<a;s++)r+=String.fromCharCode(e[s]);try{return decodeURIComponent(escape(r))}catch(s){return r}}static extractUrlBase(e){const r=e.lastIndexOf("/");return-1===r?"./":e.substr(0,r+1)}}.extractUrlBase(h)},Od.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Tf.prototype.center=function(h){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(h)},Tf.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Tf.prototype.isIntersectionBox=function(h){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(h)},Tf.prototype.size=function(h){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(h)},bs.prototype.center=function(h){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(h)},bs.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},bs.prototype.isIntersectionBox=function(h){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(h)},bs.prototype.isIntersectionSphere=function(h){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(h)},bs.prototype.size=function(h){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(h)},ko.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Ih.prototype.setFromMatrix=function(h){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(h)},ui.prototype.flattenToArrayOffset=function(h,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(h,e)},ui.prototype.multiplyVector3=function(h){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),h.applyMatrix3(this)},ui.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},ui.prototype.applyToBufferAttribute=function(h){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),h.applyMatrix3(this)},ui.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},ui.prototype.getInverse=function(h){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(h).invert()},Nn.prototype.extractPosition=function(h){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(h)},Nn.prototype.flattenToArrayOffset=function(h,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(h,e)},Nn.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new he).setFromMatrixColumn(this,3)},Nn.prototype.setRotationFromQuaternion=function(h){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(h)},Nn.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Nn.prototype.multiplyVector3=function(h){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),h.applyMatrix4(this)},Nn.prototype.multiplyVector4=function(h){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),h.applyMatrix4(this)},Nn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Nn.prototype.rotateAxis=function(h){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),h.transformDirection(this)},Nn.prototype.crossVector=function(h){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),h.applyMatrix4(this)},Nn.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Nn.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Nn.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Nn.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Nn.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Nn.prototype.applyToBufferAttribute=function(h){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),h.applyMatrix4(this)},Nn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Nn.prototype.makeFrustum=function(h,e,r,s,a,c){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(h,e,s,r,a,c)},Nn.prototype.getInverse=function(h){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(h).invert()},Kl.prototype.isIntersectionLine=function(h){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(h)},as.prototype.multiplyVector3=function(h){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),h.applyQuaternion(this)},as.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Gs.prototype.isIntersectionBox=function(h){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(h)},Gs.prototype.isIntersectionPlane=function(h){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(h)},Gs.prototype.isIntersectionSphere=function(h){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(h)},le.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},le.prototype.barycoordFromPoint=function(h,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(h,e)},le.prototype.midpoint=function(h){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(h)},le.prototypenormal=function(h){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(h)},le.prototype.plane=function(h){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(h)},le.barycoordFromPoint=function(h,e,r,s,a){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),le.getBarycoord(h,e,r,s,a)},le.normal=function(h,e,r,s){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),le.getNormal(h,e,r,s)},Nd.prototype.extractAllPoints=function(h){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(h)},Nd.prototype.extrude=function(h){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new mo(this,h)},Nd.prototype.makeGeometry=function(h){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new lc(this,h)},Rt.prototype.fromAttribute=function(h,e,r){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(h,e,r)},Rt.prototype.distanceToManhattan=function(h){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(h)},Rt.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},he.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},he.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},he.prototype.getPositionFromMatrix=function(h){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(h)},he.prototype.getScaleFromMatrix=function(h){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(h)},he.prototype.getColumnFromMatrix=function(h,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,h)},he.prototype.applyProjection=function(h){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(h)},he.prototype.fromAttribute=function(h,e,r){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(h,e,r)},he.prototype.distanceToManhattan=function(h){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(h)},he.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},di.prototype.fromAttribute=function(h,e,r){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(h,e,r)},di.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Zr.prototype.getChildByName=function(h){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(h)},Zr.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Zr.prototype.translate=function(h,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,h)},Zr.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Zr.prototype.applyMatrix=function(h){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(h)},Object.defineProperties(Zr.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(h){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=h}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),cs.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(cs.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),df.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},xs.prototype.setLens=function(h,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(h)},Object.defineProperties(dc.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(h){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=h}},shadowCameraLeft:{set:function(h){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=h}},shadowCameraRight:{set:function(h){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=h}},shadowCameraTop:{set:function(h){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=h}},shadowCameraBottom:{set:function(h){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=h}},shadowCameraNear:{set:function(h){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=h}},shadowCameraFar:{set:function(h){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=h}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(h){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=h}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(h){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=h}},shadowMapHeight:{set:function(h){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=h}}}),Object.defineProperties(Ke.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Sr},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Sr)}}}),Ke.prototype.setDynamic=function(h){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===h?Sr:Ar),this},Ke.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Ke.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},jt.prototype.addIndex=function(h){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(h)},jt.prototype.addAttribute=function(h,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===h?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(h,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(h,new Ke(arguments[1],arguments[2])))},jt.prototype.addDrawCall=function(h,e,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(h,e)},jt.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},jt.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},jt.prototype.removeAttribute=function(h){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(h)},jt.prototype.applyMatrix=function(h){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(h)},Object.defineProperties(jt.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),th.prototype.setDynamic=function(h){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===h?Sr:Ar),this},th.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},mo.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},mo.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},mo.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},eh.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Pp.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Re.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new j}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(h){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===h}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(h){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=h}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Ba.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(h){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=h}}}),Zi.prototype.clearTarget=function(h,e,r,s){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(h),this.clear(e,r,s)},Zi.prototype.animate=function(h){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(h)},Zi.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Zi.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Zi.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Zi.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Zi.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Zi.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Zi.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Zi.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Zi.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Zi.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Zi.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Zi.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Zi.prototype.enableScissorTest=function(h){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(h)},Zi.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Zi.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Zi.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Zi.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Zi.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Zi.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Zi.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Zi.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Zi.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Zi.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Zi.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(h){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=h}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(h){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=h}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(h){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===h?3001:Rs}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Jf.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(No.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(h){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=h}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(h){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=h}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(h){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=h}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(h){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=h}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(h){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=h}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(h){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=h}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(h){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=h}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(h){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=h}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(h){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=h}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(h){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=h}}}),class extends Zr{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const r=this.context.createBufferSource();return r.buffer=this.buffer,r.loop=this.loop,r.loopStart=this.loopStart,r.loopEnd=this.loopEnd,r.onended=this.onEnded.bind(this),r.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=r,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,r=this.filters.length;e<r;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,r=this.filters.length;e<r;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}.prototype.load=function(h){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new D0).load(h,function(s){e.setBuffer(s)}),this},Dh.prototype.updateCubeMap=function(h,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(h,e)},Dh.prototype.clear=function(h,e,r,s){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(h,e,r,s)},zs.crossOrigin=void 0,zs.loadTexture=function(h,e,r,s){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const a=new N_;a.setCrossOrigin(this.crossOrigin);const c=a.load(h,r,void 0,s);return e&&(c.mapping=e),c},zs.loadTextureCube=function(h,e,r,s){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const a=new _m;a.setCrossOrigin(this.crossOrigin);const c=a.load(h,r,void 0,s);return e&&(c.mapping=e),c},zs.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},zs.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"132"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="132")},4902:(Nt,ut,se)=>{var G;!function($){var We=/^\s+/,Ze=/\s+$/,Ae=0,Me=$.round,Te=$.min,Fe=$.max,Be=$.random;function J(pe,qe){if(qe=qe||{},(pe=pe||"")instanceof J)return pe;if(!(this instanceof J))return new J(pe,qe);var Ee=function(pe){var qe={r:0,g:0,b:0},Ee=1,Ut=null,Mn=null,Ht=null,pr=!1,zr=!1;return"string"==typeof pe&&(pe=function(pe){pe=pe.replace(We,"").replace(Ze,"").toLowerCase();var Ee,qe=!1;if(ki[pe])pe=ki[pe],qe=!0;else if("transparent"==pe)return{r:0,g:0,b:0,a:0,format:"name"};return(Ee=cn.rgb.exec(pe))?{r:Ee[1],g:Ee[2],b:Ee[3]}:(Ee=cn.rgba.exec(pe))?{r:Ee[1],g:Ee[2],b:Ee[3],a:Ee[4]}:(Ee=cn.hsl.exec(pe))?{h:Ee[1],s:Ee[2],l:Ee[3]}:(Ee=cn.hsla.exec(pe))?{h:Ee[1],s:Ee[2],l:Ee[3],a:Ee[4]}:(Ee=cn.hsv.exec(pe))?{h:Ee[1],s:Ee[2],v:Ee[3]}:(Ee=cn.hsva.exec(pe))?{h:Ee[1],s:Ee[2],v:Ee[3],a:Ee[4]}:(Ee=cn.hex8.exec(pe))?{r:_i(Ee[1]),g:_i(Ee[2]),b:_i(Ee[3]),a:Pn(Ee[4]),format:qe?"name":"hex8"}:(Ee=cn.hex6.exec(pe))?{r:_i(Ee[1]),g:_i(Ee[2]),b:_i(Ee[3]),format:qe?"name":"hex"}:(Ee=cn.hex4.exec(pe))?{r:_i(Ee[1]+""+Ee[1]),g:_i(Ee[2]+""+Ee[2]),b:_i(Ee[3]+""+Ee[3]),a:Pn(Ee[4]+""+Ee[4]),format:qe?"name":"hex8"}:!!(Ee=cn.hex3.exec(pe))&&{r:_i(Ee[1]+""+Ee[1]),g:_i(Ee[2]+""+Ee[2]),b:_i(Ee[3]+""+Ee[3]),format:qe?"name":"hex"}}(pe)),"object"==typeof pe&&(Qr(pe.r)&&Qr(pe.g)&&Qr(pe.b)?(qe=function(pe,qe,Ee){return{r:255*Hn(pe,255),g:255*Hn(qe,255),b:255*Hn(Ee,255)}}(pe.r,pe.g,pe.b),pr=!0,zr="%"===String(pe.r).substr(-1)?"prgb":"rgb"):Qr(pe.h)&&Qr(pe.s)&&Qr(pe.v)?(Ut=Lt(pe.s),Mn=Lt(pe.v),qe=function(pe,qe,Ee){pe=6*Hn(pe,360),qe=Hn(qe,100),Ee=Hn(Ee,100);var Ut=$.floor(pe),Mn=pe-Ut,Ht=Ee*(1-qe),pr=Ee*(1-Mn*qe),zr=Ee*(1-(1-Mn)*qe),Mr=Ut%6;return{r:255*[Ee,pr,Ht,Ht,zr,Ee][Mr],g:255*[zr,Ee,Ee,pr,Ht,Ht][Mr],b:255*[Ht,Ht,zr,Ee,Ee,pr][Mr]}}(pe.h,Ut,Mn),pr=!0,zr="hsv"):Qr(pe.h)&&Qr(pe.s)&&Qr(pe.l)&&(Ut=Lt(pe.s),Ht=Lt(pe.l),qe=function(pe,qe,Ee){var Ut,Mn,Ht;function pr(Bi,Ti,Ii){return Ii<0&&(Ii+=1),Ii>1&&(Ii-=1),Ii<1/6?Bi+6*(Ti-Bi)*Ii:Ii<.5?Ti:Ii<2/3?Bi+(Ti-Bi)*(2/3-Ii)*6:Bi}if(pe=Hn(pe,360),qe=Hn(qe,100),Ee=Hn(Ee,100),0===qe)Ut=Mn=Ht=Ee;else{var zr=Ee<.5?Ee*(1+qe):Ee+qe-Ee*qe,Mr=2*Ee-zr;Ut=pr(Mr,zr,pe+1/3),Mn=pr(Mr,zr,pe),Ht=pr(Mr,zr,pe-1/3)}return{r:255*Ut,g:255*Mn,b:255*Ht}}(pe.h,Ut,Ht),pr=!0,zr="hsl"),pe.hasOwnProperty("a")&&(Ee=pe.a)),Ee=Un(Ee),{ok:pr,format:pe.format||zr,r:Te(255,Fe(qe.r,0)),g:Te(255,Fe(qe.g,0)),b:Te(255,Fe(qe.b,0)),a:Ee}}(pe);this._originalInput=pe,this._r=Ee.r,this._g=Ee.g,this._b=Ee.b,this._a=Ee.a,this._roundA=Me(100*this._a)/100,this._format=qe.format||Ee.format,this._gradientType=qe.gradientType,this._r<1&&(this._r=Me(this._r)),this._g<1&&(this._g=Me(this._g)),this._b<1&&(this._b=Me(this._b)),this._ok=Ee.ok,this._tc_id=Ae++}function Ue(pe,qe,Ee){pe=Hn(pe,255),qe=Hn(qe,255),Ee=Hn(Ee,255);var Ht,pr,Ut=Fe(pe,qe,Ee),Mn=Te(pe,qe,Ee),zr=(Ut+Mn)/2;if(Ut==Mn)Ht=pr=0;else{var Mr=Ut-Mn;switch(pr=zr>.5?Mr/(2-Ut-Mn):Mr/(Ut+Mn),Ut){case pe:Ht=(qe-Ee)/Mr+(qe<Ee?6:0);break;case qe:Ht=(Ee-pe)/Mr+2;break;case Ee:Ht=(pe-qe)/Mr+4}Ht/=6}return{h:Ht,s:pr,l:zr}}function at(pe,qe,Ee){pe=Hn(pe,255),qe=Hn(qe,255),Ee=Hn(Ee,255);var Ht,pr,Ut=Fe(pe,qe,Ee),Mn=Te(pe,qe,Ee),zr=Ut,Mr=Ut-Mn;if(pr=0===Ut?0:Mr/Ut,Ut==Mn)Ht=0;else{switch(Ut){case pe:Ht=(qe-Ee)/Mr+(qe<Ee?6:0);break;case qe:Ht=(Ee-pe)/Mr+2;break;case Ee:Ht=(pe-qe)/Mr+4}Ht/=6}return{h:Ht,s:pr,v:zr}}function kt(pe,qe,Ee,Ut){var Mn=[_n(Me(pe).toString(16)),_n(Me(qe).toString(16)),_n(Me(Ee).toString(16))];return Ut&&Mn[0].charAt(0)==Mn[0].charAt(1)&&Mn[1].charAt(0)==Mn[1].charAt(1)&&Mn[2].charAt(0)==Mn[2].charAt(1)?Mn[0].charAt(0)+Mn[1].charAt(0)+Mn[2].charAt(0):Mn.join("")}function Wt(pe,qe,Ee,Ut){return[_n(ln(Ut)),_n(Me(pe).toString(16)),_n(Me(qe).toString(16)),_n(Me(Ee).toString(16))].join("")}function zt(pe,qe){qe=0===qe?0:qe||10;var Ee=J(pe).toHsl();return Ee.s-=qe/100,Ee.s=ts(Ee.s),J(Ee)}function hn(pe,qe){qe=0===qe?0:qe||10;var Ee=J(pe).toHsl();return Ee.s+=qe/100,Ee.s=ts(Ee.s),J(Ee)}function an(pe){return J(pe).desaturate(100)}function er(pe,qe){qe=0===qe?0:qe||10;var Ee=J(pe).toHsl();return Ee.l+=qe/100,Ee.l=ts(Ee.l),J(Ee)}function Dn(pe,qe){qe=0===qe?0:qe||10;var Ee=J(pe).toRgb();return Ee.r=Fe(0,Te(255,Ee.r-Me(-qe/100*255))),Ee.g=Fe(0,Te(255,Ee.g-Me(-qe/100*255))),Ee.b=Fe(0,Te(255,Ee.b-Me(-qe/100*255))),J(Ee)}function Cn(pe,qe){qe=0===qe?0:qe||10;var Ee=J(pe).toHsl();return Ee.l-=qe/100,Ee.l=ts(Ee.l),J(Ee)}function st(pe,qe){var Ee=J(pe).toHsl(),Ut=(Ee.h+qe)%360;return Ee.h=Ut<0?360+Ut:Ut,J(Ee)}function Bt(pe){var qe=J(pe).toHsl();return qe.h=(qe.h+180)%360,J(qe)}function nn(pe){var qe=J(pe).toHsl(),Ee=qe.h;return[J(pe),J({h:(Ee+120)%360,s:qe.s,l:qe.l}),J({h:(Ee+240)%360,s:qe.s,l:qe.l})]}function nr(pe){var qe=J(pe).toHsl(),Ee=qe.h;return[J(pe),J({h:(Ee+90)%360,s:qe.s,l:qe.l}),J({h:(Ee+180)%360,s:qe.s,l:qe.l}),J({h:(Ee+270)%360,s:qe.s,l:qe.l})]}function Rn(pe){var qe=J(pe).toHsl(),Ee=qe.h;return[J(pe),J({h:(Ee+72)%360,s:qe.s,l:qe.l}),J({h:(Ee+216)%360,s:qe.s,l:qe.l})]}function rr(pe,qe,Ee){qe=qe||6,Ee=Ee||30;var Ut=J(pe).toHsl(),Mn=360/Ee,Ht=[J(pe)];for(Ut.h=(Ut.h-(Mn*qe>>1)+720)%360;--qe;)Ut.h=(Ut.h+Mn)%360,Ht.push(J(Ut));return Ht}function Zt(pe,qe){qe=qe||6;for(var Ee=J(pe).toHsv(),Ut=Ee.h,Mn=Ee.s,Ht=Ee.v,pr=[],zr=1/qe;qe--;)pr.push(J({h:Ut,s:Mn,v:Ht})),Ht=(Ht+zr)%1;return pr}J.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var pe=this.toRgb();return(299*pe.r+587*pe.g+114*pe.b)/1e3},getLuminance:function(){var qe,Ee,Ut,pe=this.toRgb();return Ee=pe.g/255,Ut=pe.b/255,.2126*((qe=pe.r/255)<=.03928?qe/12.92:$.pow((qe+.055)/1.055,2.4))+.7152*(Ee<=.03928?Ee/12.92:$.pow((Ee+.055)/1.055,2.4))+.0722*(Ut<=.03928?Ut/12.92:$.pow((Ut+.055)/1.055,2.4))},setAlpha:function(pe){return this._a=Un(pe),this._roundA=Me(100*this._a)/100,this},toHsv:function(){var pe=at(this._r,this._g,this._b);return{h:360*pe.h,s:pe.s,v:pe.v,a:this._a}},toHsvString:function(){var pe=at(this._r,this._g,this._b),qe=Me(360*pe.h),Ee=Me(100*pe.s),Ut=Me(100*pe.v);return 1==this._a?"hsv("+qe+", "+Ee+"%, "+Ut+"%)":"hsva("+qe+", "+Ee+"%, "+Ut+"%, "+this._roundA+")"},toHsl:function(){var pe=Ue(this._r,this._g,this._b);return{h:360*pe.h,s:pe.s,l:pe.l,a:this._a}},toHslString:function(){var pe=Ue(this._r,this._g,this._b),qe=Me(360*pe.h),Ee=Me(100*pe.s),Ut=Me(100*pe.l);return 1==this._a?"hsl("+qe+", "+Ee+"%, "+Ut+"%)":"hsla("+qe+", "+Ee+"%, "+Ut+"%, "+this._roundA+")"},toHex:function(pe){return kt(this._r,this._g,this._b,pe)},toHexString:function(pe){return"#"+this.toHex(pe)},toHex8:function(pe){return function(pe,qe,Ee,Ut,Mn){var Ht=[_n(Me(pe).toString(16)),_n(Me(qe).toString(16)),_n(Me(Ee).toString(16)),_n(ln(Ut))];return Mn&&Ht[0].charAt(0)==Ht[0].charAt(1)&&Ht[1].charAt(0)==Ht[1].charAt(1)&&Ht[2].charAt(0)==Ht[2].charAt(1)&&Ht[3].charAt(0)==Ht[3].charAt(1)?Ht[0].charAt(0)+Ht[1].charAt(0)+Ht[2].charAt(0)+Ht[3].charAt(0):Ht.join("")}(this._r,this._g,this._b,this._a,pe)},toHex8String:function(pe){return"#"+this.toHex8(pe)},toRgb:function(){return{r:Me(this._r),g:Me(this._g),b:Me(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+Me(this._r)+", "+Me(this._g)+", "+Me(this._b)+")":"rgba("+Me(this._r)+", "+Me(this._g)+", "+Me(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Me(100*Hn(this._r,255))+"%",g:Me(100*Hn(this._g,255))+"%",b:Me(100*Hn(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+Me(100*Hn(this._r,255))+"%, "+Me(100*Hn(this._g,255))+"%, "+Me(100*Hn(this._b,255))+"%)":"rgba("+Me(100*Hn(this._r,255))+"%, "+Me(100*Hn(this._g,255))+"%, "+Me(100*Hn(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&($t[kt(this._r,this._g,this._b,!0)]||!1)},toFilter:function(pe){var qe="#"+Wt(this._r,this._g,this._b,this._a),Ee=qe,Ut=this._gradientType?"GradientType = 1, ":"";if(pe){var Mn=J(pe);Ee="#"+Wt(Mn._r,Mn._g,Mn._b,Mn._a)}return"progid:DXImageTransform.Microsoft.gradient("+Ut+"startColorstr="+qe+",endColorstr="+Ee+")"},toString:function(pe){var qe=!!pe;pe=pe||this._format;var Ee=!1;return!qe&&this._a<1&&this._a>=0&&("hex"===pe||"hex6"===pe||"hex3"===pe||"hex4"===pe||"hex8"===pe||"name"===pe)?"name"===pe&&0===this._a?this.toName():this.toRgbString():("rgb"===pe&&(Ee=this.toRgbString()),"prgb"===pe&&(Ee=this.toPercentageRgbString()),("hex"===pe||"hex6"===pe)&&(Ee=this.toHexString()),"hex3"===pe&&(Ee=this.toHexString(!0)),"hex4"===pe&&(Ee=this.toHex8String(!0)),"hex8"===pe&&(Ee=this.toHex8String()),"name"===pe&&(Ee=this.toName()),"hsl"===pe&&(Ee=this.toHslString()),"hsv"===pe&&(Ee=this.toHsvString()),Ee||this.toHexString())},clone:function(){return J(this.toString())},_applyModification:function(pe,qe){var Ee=pe.apply(null,[this].concat([].slice.call(qe)));return this._r=Ee._r,this._g=Ee._g,this._b=Ee._b,this.setAlpha(Ee._a),this},lighten:function(){return this._applyModification(er,arguments)},brighten:function(){return this._applyModification(Dn,arguments)},darken:function(){return this._applyModification(Cn,arguments)},desaturate:function(){return this._applyModification(zt,arguments)},saturate:function(){return this._applyModification(hn,arguments)},greyscale:function(){return this._applyModification(an,arguments)},spin:function(){return this._applyModification(st,arguments)},_applyCombination:function(pe,qe){return pe.apply(null,[this].concat([].slice.call(qe)))},analogous:function(){return this._applyCombination(rr,arguments)},complement:function(){return this._applyCombination(Bt,arguments)},monochromatic:function(){return this._applyCombination(Zt,arguments)},splitcomplement:function(){return this._applyCombination(Rn,arguments)},triad:function(){return this._applyCombination(nn,arguments)},tetrad:function(){return this._applyCombination(nr,arguments)}},J.fromRatio=function(pe,qe){if("object"==typeof pe){var Ee={};for(var Ut in pe)pe.hasOwnProperty(Ut)&&(Ee[Ut]="a"===Ut?pe[Ut]:Lt(pe[Ut]));pe=Ee}return J(pe,qe)},J.equals=function(pe,qe){return!(!pe||!qe)&&J(pe).toRgbString()==J(qe).toRgbString()},J.random=function(){return J.fromRatio({r:Be(),g:Be(),b:Be()})},J.mix=function(pe,qe,Ee){Ee=0===Ee?0:Ee||50;var Ut=J(pe).toRgb(),Mn=J(qe).toRgb(),Ht=Ee/100;return J({r:(Mn.r-Ut.r)*Ht+Ut.r,g:(Mn.g-Ut.g)*Ht+Ut.g,b:(Mn.b-Ut.b)*Ht+Ut.b,a:(Mn.a-Ut.a)*Ht+Ut.a})},J.readability=function(pe,qe){var Ee=J(pe),Ut=J(qe);return($.max(Ee.getLuminance(),Ut.getLuminance())+.05)/($.min(Ee.getLuminance(),Ut.getLuminance())+.05)},J.isReadable=function(pe,qe,Ee){var Mn,Ht,Ut=J.readability(pe,qe);switch(Ht=!1,(Mn=function(pe){var qe,Ee;return"AA"!==(qe=((pe=pe||{level:"AA",size:"small"}).level||"AA").toUpperCase())&&"AAA"!==qe&&(qe="AA"),"small"!==(Ee=(pe.size||"small").toLowerCase())&&"large"!==Ee&&(Ee="small"),{level:qe,size:Ee}}(Ee)).level+Mn.size){case"AAsmall":case"AAAlarge":Ht=Ut>=4.5;break;case"AAlarge":Ht=Ut>=3;break;case"AAAsmall":Ht=Ut>=7}return Ht},J.mostReadable=function(pe,qe,Ee){var Ht,pr,zr,Mr,Ut=null,Mn=0;pr=(Ee=Ee||{}).includeFallbackColors,zr=Ee.level,Mr=Ee.size;for(var Bi=0;Bi<qe.length;Bi++)(Ht=J.readability(pe,qe[Bi]))>Mn&&(Mn=Ht,Ut=J(qe[Bi]));return J.isReadable(pe,Ut,{level:zr,size:Mr})||!pr?Ut:(Ee.includeFallbackColors=!1,J.mostReadable(pe,["#fff","#000"],Ee))};var ki=J.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},$t=J.hexNames=function(pe){var qe={};for(var Ee in pe)pe.hasOwnProperty(Ee)&&(qe[pe[Ee]]=Ee);return qe}(ki);function Un(pe){return pe=parseFloat(pe),(isNaN(pe)||pe<0||pe>1)&&(pe=1),pe}function Hn(pe,qe){(function(pe){return"string"==typeof pe&&-1!=pe.indexOf(".")&&1===parseFloat(pe)})(pe)&&(pe="100%");var Ee=function(pe){return"string"==typeof pe&&-1!=pe.indexOf("%")}(pe);return pe=Te(qe,Fe(0,parseFloat(pe))),Ee&&(pe=parseInt(pe*qe,10)/100),$.abs(pe-qe)<1e-6?1:pe%qe/parseFloat(qe)}function ts(pe){return Te(1,Fe(0,pe))}function _i(pe){return parseInt(pe,16)}function _n(pe){return 1==pe.length?"0"+pe:""+pe}function Lt(pe){return pe<=1&&(pe=100*pe+"%"),pe}function ln(pe){return $.round(255*parseFloat(pe)).toString(16)}function Pn(pe){return _i(pe)/255}var Ee,Ut,Mn,cn=(Ut="[\\s|\\(]+("+(Ee="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+Ee+")[,|\\s]+("+Ee+")\\s*\\)?",Mn="[\\s|\\(]+("+Ee+")[,|\\s]+("+Ee+")[,|\\s]+("+Ee+")[,|\\s]+("+Ee+")\\s*\\)?",{CSS_UNIT:new RegExp(Ee),rgb:new RegExp("rgb"+Ut),rgba:new RegExp("rgba"+Mn),hsl:new RegExp("hsl"+Ut),hsla:new RegExp("hsla"+Mn),hsv:new RegExp("hsv"+Ut),hsva:new RegExp("hsva"+Mn),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function Qr(pe){return!!cn.CSS_UNIT.exec(pe)}Nt.exports?Nt.exports=J:void 0!==(G=function(){return J}.call(ut,se,ut,Nt))&&(Nt.exports=G)}(Math)},6995:(Nt,ut,se)=>{"use strict";se.d(ut,{Z:()=>Te});var G={value:()=>{}};function $(){for(var K,Fe=0,Be=arguments.length,J={};Fe<Be;++Fe){if(!(K=arguments[Fe]+"")||K in J||/[\s.]/.test(K))throw new Error("illegal type: "+K);J[K]=[]}return new We(J)}function We(Fe){this._=Fe}function Ze(Fe,Be){return Fe.trim().split(/^|\s+/).map(function(J){var K="",_e=J.indexOf(".");if(_e>=0&&(K=J.slice(_e+1),J=J.slice(0,_e)),J&&!Be.hasOwnProperty(J))throw new Error("unknown type: "+J);return{type:J,name:K}})}function Ae(Fe,Be){for(var _e,J=0,K=Fe.length;J<K;++J)if((_e=Fe[J]).name===Be)return _e.value}function Me(Fe,Be,J){for(var K=0,_e=Fe.length;K<_e;++K)if(Fe[K].name===Be){Fe[K]=G,Fe=Fe.slice(0,K).concat(Fe.slice(K+1));break}return null!=J&&Fe.push({name:Be,value:J}),Fe}We.prototype=$.prototype={constructor:We,on:function(Fe,Be){var _e,J=this._,K=Ze(Fe+"",J),Ue=-1,Ve=K.length;if(!(arguments.length<2)){if(null!=Be&&"function"!=typeof Be)throw new Error("invalid callback: "+Be);for(;++Ue<Ve;)if(_e=(Fe=K[Ue]).type)J[_e]=Me(J[_e],Fe.name,Be);else if(null==Be)for(_e in J)J[_e]=Me(J[_e],Fe.name,null);return this}for(;++Ue<Ve;)if((_e=(Fe=K[Ue]).type)&&(_e=Ae(J[_e],Fe.name)))return _e},copy:function(){var Fe={},Be=this._;for(var J in Be)Fe[J]=Be[J].slice();return new We(Fe)},call:function(Fe,Be){if((_e=arguments.length-2)>0)for(var _e,Ue,J=new Array(_e),K=0;K<_e;++K)J[K]=arguments[K+2];if(!this._.hasOwnProperty(Fe))throw new Error("unknown type: "+Fe);for(K=0,_e=(Ue=this._[Fe]).length;K<_e;++K)Ue[K].value.apply(Be,J)},apply:function(Fe,Be,J){if(!this._.hasOwnProperty(Fe))throw new Error("unknown type: "+Fe);for(var K=this._[Fe],_e=0,Ue=K.length;_e<Ue;++_e)K[_e].value.apply(Be,J)}};const Te=$},2357:(Nt,ut,se)=>{"use strict";function G($){for(var We=$.length/6|0,Ze=new Array(We),Ae=0;Ae<We;)Ze[Ae]="#"+$.slice(6*Ae,6*++Ae);return Ze}se.d(ut,{Z:()=>G})},1753:(Nt,ut,se)=>{"use strict";se.d(ut,{Z:()=>J});class G extends Map{constructor(_e,Ue=Me){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:Ue}}),null!=_e)for(const[Ve,at]of _e)this.set(Ve,at)}get(_e){return super.get(We(this,_e))}has(_e){return super.has(We(this,_e))}set(_e,Ue){return super.set(function({_intern:K,_key:_e},Ue){const Ve=_e(Ue);return K.has(Ve)?K.get(Ve):(K.set(Ve,Ue),Ue)}(this,_e),Ue)}delete(_e){return super.delete(function({_intern:K,_key:_e},Ue){const Ve=_e(Ue);return K.has(Ve)&&(Ue=K.get(Ue),K.delete(Ve)),Ue}(this,_e))}}function We({_intern:K,_key:_e},Ue){const Ve=_e(Ue);return K.has(Ve)?K.get(Ve):Ue}function Me(K){return null!==K&&"object"==typeof K?K.valueOf():K}function Te(K,_e){switch(arguments.length){case 0:break;case 1:this.range(K);break;default:this.range(_e).domain(K)}return this}Set;const Be=Symbol("implicit");function J(){var K=new G,_e=[],Ue=[],Ve=Be;function at(Xe){let kt=K.get(Xe);if(void 0===kt){if(Ve!==Be)return Ve;K.set(Xe,kt=_e.push(Xe)-1)}return Ue[kt%Ue.length]}return at.domain=function(Xe){if(!arguments.length)return _e.slice();_e=[],K=new G;for(const kt of Xe)K.has(kt)||K.set(kt,_e.push(kt)-1);return at},at.range=function(Xe){return arguments.length?(Ue=Array.from(Xe),at):Ue.slice()},at.unknown=function(Xe){return arguments.length?(Ve=Xe,at):Ve},at.copy=function(){return J(_e,Ue).unknown(Ve)},Te.apply(at,arguments),at}},6804:(Nt,ut,se)=>{"use strict";se.d(ut,{zO:()=>_e,B7:()=>Ve,HT:()=>at});var Ae,Me,G=0,$=0,We=0,Te=0,Fe=0,Be=0,J="object"==typeof performance&&performance.now?performance:Date,K="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(hn){setTimeout(hn,17)};function _e(){return Fe||(K(Ue),Fe=J.now()+Be)}function Ue(){Fe=0}function Ve(){this._call=this._time=this._next=null}function at(hn,an,er){var Dn=new Ve;return Dn.restart(hn,an,er),Dn}function kt(){Fe=(Te=J.now())+Be,G=$=0;try{!function(){_e(),++G;for(var an,hn=Ae;hn;)(an=Fe-hn._time)>=0&&hn._call.call(void 0,an),hn=hn._next;--G}()}finally{G=0,function(){for(var hn,er,an=Ae,Dn=1/0;an;)an._call?(Dn>an._time&&(Dn=an._time),hn=an,an=an._next):(er=an._next,an._next=null,an=hn?hn._next=er:Ae=er);Me=hn,zt(Dn)}(),Fe=0}}function St(){var hn=J.now(),an=hn-Te;an>1e3&&(Be-=an,Te=hn)}function zt(hn){G||($&&($=clearTimeout($)),hn-Fe>24?(hn<1/0&&($=setTimeout(kt,hn-J.now()-Be)),We&&(We=clearInterval(We))):(We||(Te=J.now(),We=setInterval(St,1e3)),G=1,K(kt)))}Ve.prototype=at.prototype={constructor:Ve,restart:function(hn,an,er){if("function"!=typeof hn)throw new TypeError("callback is not a function");er=(null==er?_e():+er)+(null==an?0:+an),!this._next&&Me!==this&&(Me?Me._next=this:Ae=this,Me=this),this._call=hn,this._time=er,zt()},stop:function(){this._call&&(this._call=null,this._time=1/0,zt())}}},2826:(Nt,ut,se)=>{"use strict";function G(){}function $(S){return null==S?G:function(){return this.querySelector(S)}}function Ze(S){return null==S?[]:Array.isArray(S)?S:Array.from(S)}function Ae(){return[]}function Me(S){return null==S?Ae:function(){return this.querySelectorAll(S)}}function Be(S){return function(){return this.matches(S)}}function J(S){return function(V){return V.matches(S)}}se.d(ut,{$_Y:()=>Io,PKp:()=>Eu.Z,KrL:()=>eo});var K=Array.prototype.find;function Ue(){return this.firstElementChild}var at=Array.prototype.filter;function Xe(){return Array.from(this.children)}function zt(S){return new Array(S.length)}function an(S,V){this.ownerDocument=S.ownerDocument,this.namespaceURI=S.namespaceURI,this._next=null,this._parent=S,this.__data__=V}function er(S){return function(){return S}}function Dn(S,V,Y,le,we,Re){for(var M,Le=0,b=V.length,_=Re.length;Le<_;++Le)(M=V[Le])?(M.__data__=Re[Le],le[Le]=M):Y[Le]=new an(S,Re[Le]);for(;Le<b;++Le)(M=V[Le])&&(we[Le]=M)}function Cn(S,V,Y,le,we,Re,Le){var M,b,oe,_=new Map,R=V.length,F=Re.length,j=new Array(R);for(M=0;M<R;++M)(b=V[M])&&(j[M]=oe=Le.call(b,b.__data__,M,V)+"",_.has(oe)?we[M]=b:_.set(oe,b));for(M=0;M<F;++M)oe=Le.call(S,Re[M],M,Re)+"",(b=_.get(oe))?(le[M]=b,b.__data__=Re[M],_.delete(oe)):Y[M]=new an(S,Re[M]);for(M=0;M<R;++M)(b=V[M])&&_.get(j[M])===b&&(we[M]=b)}function st(S){return S.__data__}function nn(S){return"object"==typeof S&&"length"in S?S:Array.from(S)}function $t(S,V){return S<V?-1:S>V?1:S>=V?0:NaN}an.prototype={constructor:an,appendChild:function(S){return this._parent.insertBefore(S,this._next)},insertBefore:function(S,V){return this._parent.insertBefore(S,V)},querySelector:function(S){return this._parent.querySelector(S)},querySelectorAll:function(S){return this._parent.querySelectorAll(S)}};var ns="http://www.w3.org/1999/xhtml";const _n={svg:"http://www.w3.org/2000/svg",xhtml:ns,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Lt(S){var V=S+="",Y=V.indexOf(":");return Y>=0&&"xmlns"!==(V=S.slice(0,Y))&&(S=S.slice(Y+1)),_n.hasOwnProperty(V)?{space:_n[V],local:S}:S}function ln(S){return function(){this.removeAttribute(S)}}function Pn(S){return function(){this.removeAttributeNS(S.space,S.local)}}function cn(S,V){return function(){this.setAttribute(S,V)}}function Qr(S,V){return function(){this.setAttributeNS(S.space,S.local,V)}}function Br(S,V){return function(){var Y=V.apply(this,arguments);null==Y?this.removeAttribute(S):this.setAttribute(S,Y)}}function Ta(S,V){return function(){var Y=V.apply(this,arguments);null==Y?this.removeAttributeNS(S.space,S.local):this.setAttributeNS(S.space,S.local,Y)}}function qe(S){return S.ownerDocument&&S.ownerDocument.defaultView||S.document&&S||S.defaultView}function Ee(S){return function(){this.style.removeProperty(S)}}function Ut(S,V,Y){return function(){this.style.setProperty(S,V,Y)}}function Mn(S,V,Y){return function(){var le=V.apply(this,arguments);null==le?this.style.removeProperty(S):this.style.setProperty(S,le,Y)}}function pr(S,V){return S.style.getPropertyValue(V)||qe(S).getComputedStyle(S,null).getPropertyValue(V)}function zr(S){return function(){delete this[S]}}function Mr(S,V){return function(){this[S]=V}}function Bi(S,V){return function(){var Y=V.apply(this,arguments);null==Y?delete this[S]:this[S]=Y}}function Ii(S){return S.trim().split(/^|\s+/)}function Vn(S){return S.classList||new ci(S)}function ci(S){this._node=S,this._names=Ii(S.getAttribute("class")||"")}function Yn(S,V){for(var Y=Vn(S),le=-1,we=V.length;++le<we;)Y.add(V[le])}function Tn(S,V){for(var Y=Vn(S),le=-1,we=V.length;++le<we;)Y.remove(V[le])}function Zo(S){return function(){Yn(this,S)}}function Pi(S){return function(){Tn(this,S)}}function ii(S,V){return function(){(V.apply(this,arguments)?Yn:Tn)(this,S)}}function ti(){this.textContent=""}function hc(S){return function(){this.textContent=S}}function zn(S){return function(){var V=S.apply(this,arguments);this.textContent=null==V?"":V}}function si(){this.innerHTML=""}function Qo(S){return function(){this.innerHTML=S}}function ga(S){return function(){var V=S.apply(this,arguments);this.innerHTML=null==V?"":V}}function Aa(){this.nextSibling&&this.parentNode.appendChild(this)}function Ys(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ro(S){return function(){var V=this.ownerDocument,Y=this.namespaceURI;return Y===ns&&V.documentElement.namespaceURI===ns?V.createElement(S):V.createElementNS(Y,S)}}function Us(S){return function(){return this.ownerDocument.createElementNS(S.space,S.local)}}function Xs(S){var V=Lt(S);return(V.local?Us:ro)(V)}function zl(){return null}function io(){var S=this.parentNode;S&&S.removeChild(this)}function Zs(){var S=this.cloneNode(!1),V=this.parentNode;return V?V.insertBefore(S,this.nextSibling):S}function ds(){var S=this.cloneNode(!0),V=this.parentNode;return V?V.insertBefore(S,this.nextSibling):S}function so(S){return S.trim().split(/^|\s+/).map(function(V){var Y="",le=V.indexOf(".");return le>=0&&(Y=V.slice(le+1),V=V.slice(0,le)),{type:V,name:Y}})}function oo(S){return function(){var V=this.__on;if(V){for(var Re,Y=0,le=-1,we=V.length;Y<we;++Y)Re=V[Y],S.type&&Re.type!==S.type||Re.name!==S.name?V[++le]=Re:this.removeEventListener(Re.type,Re.listener,Re.options);++le?V.length=le:delete this.__on}}}function Da(S,V,Y){return function(){var we,le=this.__on,Re=function(S){return function(V){S.call(this,V,this.__data__)}}(V);if(le)for(var Le=0,M=le.length;Le<M;++Le)if((we=le[Le]).type===S.type&&we.name===S.name)return this.removeEventListener(we.type,we.listener,we.options),this.addEventListener(we.type,we.listener=Re,we.options=Y),void(we.value=V);this.addEventListener(S.type,Re,Y),we={type:S.type,name:S.name,value:V,listener:Re,options:Y},le?le.push(we):this.__on=[we]}}function Vs(S,V,Y){var le=qe(S),we=le.CustomEvent;"function"==typeof we?we=new we(V,Y):(we=le.document.createEvent("Event"),Y?(we.initEvent(V,Y.bubbles,Y.cancelable),we.detail=Y.detail):we.initEvent(V,!1,!1)),S.dispatchEvent(we)}function is(S,V){return function(){return Vs(this,S,V)}}function vo(S,V){return function(){return Vs(this,S,V.apply(this,arguments))}}ci.prototype={add:function(S){this._names.indexOf(S)<0&&(this._names.push(S),this._node.setAttribute("class",this._names.join(" ")))},remove:function(S){var V=this._names.indexOf(S);V>=0&&(this._names.splice(V,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(S){return this._names.indexOf(S)>=0}};var Ya=[null];function wi(S,V){this._groups=S,this._parents=V}function pn(){return new wi([[document.documentElement]],Ya)}wi.prototype=pn.prototype={constructor:wi,select:function(S){"function"!=typeof S&&(S=$(S));for(var V=this._groups,Y=V.length,le=new Array(Y),we=0;we<Y;++we)for(var b,_,Re=V[we],Le=Re.length,M=le[we]=new Array(Le),R=0;R<Le;++R)(b=Re[R])&&(_=S.call(b,b.__data__,R,Re))&&("__data__"in b&&(_.__data__=b.__data__),M[R]=_);return new wi(le,this._parents)},selectAll:function(S){S="function"==typeof S?function(S){return function(){return Ze(S.apply(this,arguments))}}(S):Me(S);for(var V=this._groups,Y=V.length,le=[],we=[],Re=0;Re<Y;++Re)for(var b,Le=V[Re],M=Le.length,_=0;_<M;++_)(b=Le[_])&&(le.push(S.call(b,b.__data__,_,Le)),we.push(b));return new wi(le,we)},selectChild:function(S){return this.select(null==S?Ue:function(S){return function(){return K.call(this.children,S)}}("function"==typeof S?S:J(S)))},selectChildren:function(S){return this.selectAll(null==S?Xe:function(S){return function(){return at.call(this.children,S)}}("function"==typeof S?S:J(S)))},filter:function(S){"function"!=typeof S&&(S=Be(S));for(var V=this._groups,Y=V.length,le=new Array(Y),we=0;we<Y;++we)for(var b,Re=V[we],Le=Re.length,M=le[we]=[],_=0;_<Le;++_)(b=Re[_])&&S.call(b,b.__data__,_,Re)&&M.push(b);return new wi(le,this._parents)},data:function(S,V){if(!arguments.length)return Array.from(this,st);var Y=V?Cn:Dn,le=this._parents,we=this._groups;"function"!=typeof S&&(S=er(S));for(var Re=we.length,Le=new Array(Re),M=new Array(Re),b=new Array(Re),_=0;_<Re;++_){var R=le[_],F=we[_],j=F.length,oe=nn(S.call(R,R&&R.__data__,_,le)),ye=oe.length,lt=M[_]=new Array(ye),Ke=Le[_]=new Array(ye),dt=b[_]=new Array(j);Y(R,F,lt,Ke,dt,oe,V);for(var Kt,vr,on=0,un=0;on<ye;++on)if(Kt=lt[on]){for(on>=un&&(un=on+1);!(vr=Ke[un])&&++un<ye;);Kt._next=vr||null}}return(Le=new wi(Le,le))._enter=M,Le._exit=b,Le},enter:function(){return new wi(this._enter||this._groups.map(zt),this._parents)},exit:function(){return new wi(this._exit||this._groups.map(zt),this._parents)},join:function(S,V,Y){var le=this.enter(),we=this,Re=this.exit();return"function"==typeof S?(le=S(le))&&(le=le.selection()):le=le.append(S+""),null!=V&&(we=V(we))&&(we=we.selection()),null==Y?Re.remove():Y(Re),le&&we?le.merge(we).order():we},merge:function(S){for(var V=S.selection?S.selection():S,Y=this._groups,le=V._groups,we=Y.length,Le=Math.min(we,le.length),M=new Array(we),b=0;b<Le;++b)for(var oe,_=Y[b],R=le[b],F=_.length,j=M[b]=new Array(F),ye=0;ye<F;++ye)(oe=_[ye]||R[ye])&&(j[ye]=oe);for(;b<we;++b)M[b]=Y[b];return new wi(M,this._parents)},selection:function(){return this},order:function(){for(var S=this._groups,V=-1,Y=S.length;++V<Y;)for(var Le,le=S[V],we=le.length-1,Re=le[we];--we>=0;)(Le=le[we])&&(Re&&4^Le.compareDocumentPosition(Re)&&Re.parentNode.insertBefore(Le,Re),Re=Le);return this},sort:function(S){function V(F,j){return F&&j?S(F.__data__,j.__data__):!F-!j}S||(S=$t);for(var Y=this._groups,le=Y.length,we=new Array(le),Re=0;Re<le;++Re){for(var _,Le=Y[Re],M=Le.length,b=we[Re]=new Array(M),R=0;R<M;++R)(_=Le[R])&&(b[R]=_);b.sort(V)}return new wi(we,this._parents).order()},call:function(){var S=arguments[0];return arguments[0]=this,S.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var S=this._groups,V=0,Y=S.length;V<Y;++V)for(var le=S[V],we=0,Re=le.length;we<Re;++we){var Le=le[we];if(Le)return Le}return null},size:function(){let S=0;for(const V of this)++S;return S},empty:function(){return!this.node()},each:function(S){for(var V=this._groups,Y=0,le=V.length;Y<le;++Y)for(var M,we=V[Y],Re=0,Le=we.length;Re<Le;++Re)(M=we[Re])&&S.call(M,M.__data__,Re,we);return this},attr:function(S,V){var Y=Lt(S);if(arguments.length<2){var le=this.node();return Y.local?le.getAttributeNS(Y.space,Y.local):le.getAttribute(Y)}return this.each((null==V?Y.local?Pn:ln:"function"==typeof V?Y.local?Ta:Br:Y.local?Qr:cn)(Y,V))},style:function(S,V,Y){return arguments.length>1?this.each((null==V?Ee:"function"==typeof V?Mn:Ut)(S,V,null==Y?"":Y)):pr(this.node(),S)},property:function(S,V){return arguments.length>1?this.each((null==V?zr:"function"==typeof V?Bi:Mr)(S,V)):this.node()[S]},classed:function(S,V){var Y=Ii(S+"");if(arguments.length<2){for(var le=Vn(this.node()),we=-1,Re=Y.length;++we<Re;)if(!le.contains(Y[we]))return!1;return!0}return this.each(("function"==typeof V?ii:V?Zo:Pi)(Y,V))},text:function(S){return arguments.length?this.each(null==S?ti:("function"==typeof S?zn:hc)(S)):this.node().textContent},html:function(S){return arguments.length?this.each(null==S?si:("function"==typeof S?ga:Qo)(S)):this.node().innerHTML},raise:function(){return this.each(Aa)},lower:function(){return this.each(Ys)},append:function(S){var V="function"==typeof S?S:Xs(S);return this.select(function(){return this.appendChild(V.apply(this,arguments))})},insert:function(S,V){var Y="function"==typeof S?S:Xs(S),le=null==V?zl:"function"==typeof V?V:$(V);return this.select(function(){return this.insertBefore(Y.apply(this,arguments),le.apply(this,arguments)||null)})},remove:function(){return this.each(io)},clone:function(S){return this.select(S?ds:Zs)},datum:function(S){return arguments.length?this.property("__data__",S):this.node().__data__},on:function(S,V,Y){var we,Le,le=so(S+""),Re=le.length;if(!(arguments.length<2)){for(M=V?Da:oo,we=0;we<Re;++we)this.each(M(le[we],V,Y));return this}var M=this.node().__on;if(M)for(var R,b=0,_=M.length;b<_;++b)for(we=0,R=M[b];we<Re;++we)if((Le=le[we]).type===R.type&&Le.name===R.name)return R.value},dispatch:function(S,V){return this.each(("function"==typeof V?vo:is)(S,V))},[Symbol.iterator]:function*(){for(var S=this._groups,V=0,Y=S.length;V<Y;++V)for(var Le,le=S[V],we=0,Re=le.length;we<Re;++we)(Le=le[we])&&(yield Le)}};const Xr=pn;var He=se(6995),ke=se(6804);function ae(S,V,Y){var le=new ke.B7;return le.restart(we=>{le.stop(),S(we+V)},V=null==V?0:+V,Y),le}var Qe=(0,He.Z)("start","end","cancel","interrupt"),gt=[];function ss(S,V,Y,le,we,Re){var Le=S.__transition;if(Le){if(Y in Le)return}else S.__transition={};!function(S,V,Y){var we,le=S.__transition;function Le(_){var R,F,j,oe;if(1!==Y.state)return b();for(R in le)if((oe=le[R]).name===Y.name){if(3===oe.state)return ae(Le);4===oe.state?(oe.state=6,oe.timer.stop(),oe.on.call("interrupt",S,S.__data__,oe.index,oe.group),delete le[R]):+R<V&&(oe.state=6,oe.timer.stop(),oe.on.call("cancel",S,S.__data__,oe.index,oe.group),delete le[R])}if(ae(function(){3===Y.state&&(Y.state=4,Y.timer.restart(M,Y.delay,Y.time),M(_))}),Y.state=2,Y.on.call("start",S,S.__data__,Y.index,Y.group),2===Y.state){for(Y.state=3,we=new Array(j=Y.tween.length),R=0,F=-1;R<j;++R)(oe=Y.tween[R].value.call(S,S.__data__,Y.index,Y.group))&&(we[++F]=oe);we.length=F+1}}function M(_){for(var R=_<Y.duration?Y.ease.call(null,_/Y.duration):(Y.timer.restart(b),Y.state=5,1),F=-1,j=we.length;++F<j;)we[F].call(S,R);5===Y.state&&(Y.on.call("end",S,S.__data__,Y.index,Y.group),b())}function b(){for(var _ in Y.state=6,Y.timer.stop(),delete le[V],le)return;delete S.__transition}le[V]=Y,Y.timer=(0,ke.HT)(function(_){Y.state=1,Y.timer.restart(Le,Y.delay,Y.time),Y.delay<=_&&Le(_-Y.delay)},0,Y.time)}(S,Y,{name:V,index:le,group:we,on:Qe,tween:gt,time:Re.time,delay:Re.delay,duration:Re.duration,ease:Re.ease,timer:null,state:0})}function lo(S,V){var Y=Ei(S,V);if(Y.state>0)throw new Error("too late; already scheduled");return Y}function fs(S,V){var Y=Ei(S,V);if(Y.state>3)throw new Error("too late; already running");return Y}function Ei(S,V){var Y=S.__transition;if(!Y||!(Y=Y[V]))throw new Error("transition not found");return Y}function Qs(S,V){return S=+S,V=+V,function(Y){return S*(1-Y)+V*Y}}var Ao,vl=180/Math.PI,Jo={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ea(S,V,Y,le,we,Re){var Le,M,b;return(Le=Math.sqrt(S*S+V*V))&&(S/=Le,V/=Le),(b=S*Y+V*le)&&(Y-=S*b,le-=V*b),(M=Math.sqrt(Y*Y+le*le))&&(Y/=M,le/=M,b/=M),S*le<V*Y&&(S=-S,V=-V,b=-b,Le=-Le),{translateX:we,translateY:Re,rotate:Math.atan2(V,S)*vl,skewX:Math.atan(b)*vl,scaleX:Le,scaleY:M}}function co(S,V,Y,le){function we(_){return _.length?_.pop()+" ":""}return function(_,R){var F=[],j=[];return _=S(_),R=S(R),function(_,R,F,j,oe,ye){if(_!==F||R!==j){var lt=oe.push("translate(",null,V,null,Y);ye.push({i:lt-4,x:Qs(_,F)},{i:lt-2,x:Qs(R,j)})}else(F||j)&&oe.push("translate("+F+V+j+Y)}(_.translateX,_.translateY,R.translateX,R.translateY,F,j),function(_,R,F,j){_!==R?(_-R>180?R+=360:R-_>180&&(_+=360),j.push({i:F.push(we(F)+"rotate(",null,le)-2,x:Qs(_,R)})):R&&F.push(we(F)+"rotate("+R+le)}(_.rotate,R.rotate,F,j),function(_,R,F,j){_!==R?j.push({i:F.push(we(F)+"skewX(",null,le)-2,x:Qs(_,R)}):R&&F.push(we(F)+"skewX("+R+le)}(_.skewX,R.skewX,F,j),function(_,R,F,j,oe,ye){if(_!==F||R!==j){var lt=oe.push(we(oe)+"scale(",null,",",null,")");ye.push({i:lt-4,x:Qs(_,F)},{i:lt-2,x:Qs(R,j)})}else(1!==F||1!==j)&&oe.push(we(oe)+"scale("+F+","+j+")")}(_.scaleX,_.scaleY,R.scaleX,R.scaleY,F,j),_=R=null,function(oe){for(var Ke,ye=-1,lt=j.length;++ye<lt;)F[(Ke=j[ye]).i]=Ke.x(oe);return F.join("")}}}var Ks=co(function(S){const V=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(S+"");return V.isIdentity?Jo:ea(V.a,V.b,V.c,V.d,V.e,V.f)},"px, ","px)","deg)"),_l=co(function(S){return null!=S&&(Ao||(Ao=document.createElementNS("http://www.w3.org/2000/svg","g")),Ao.setAttribute("transform",S),S=Ao.transform.baseVal.consolidate())?ea((S=S.matrix).a,S.b,S.c,S.d,S.e,S.f):Jo},", ",")",")");function ya(S,V){var Y,le;return function(){var we=fs(this,S),Re=we.tween;if(Re!==Y)for(var Le=0,M=(le=Y=Re).length;Le<M;++Le)if(le[Le].name===V){(le=le.slice()).splice(Le,1);break}we.tween=le}}function va(S,V,Y){var le,we;if("function"!=typeof Y)throw new Error;return function(){var Re=fs(this,S),Le=Re.tween;if(Le!==le){we=(le=Le).slice();for(var M={name:V,value:Y},b=0,_=we.length;b<_;++b)if(we[b].name===V){we[b]=M;break}b===_&&we.push(M)}Re.tween=we}}function _a(S,V,Y){var le=S._id;return S.each(function(){var we=fs(this,le);(we.value||(we.value={}))[V]=Y.apply(this,arguments)}),function(we){return Ei(we,le).value[V]}}function jl(S,V,Y){S.prototype=V.prototype=Y,Y.constructor=S}function Wl(S,V){var Y=Object.create(S.prototype);for(var le in V)Y[le]=V[le];return Y}function Xa(){}var Do=1/.7,ta="\\s*([+-]?\\d+)\\s*",Ro="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ss="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",na=/^#([0-9a-f]{3,8})$/,bl=new RegExp("^rgb\\("+[ta,ta,ta]+"\\)$"),xl=new RegExp("^rgb\\("+[Ss,Ss,Ss]+"\\)$"),$l=new RegExp("^rgba\\("+[ta,ta,ta,Ro]+"\\)$"),gc=new RegExp("^rgba\\("+[Ss,Ss,Ss,Ro]+"\\)$"),wl=new RegExp("^hsl\\("+[Ro,Ss,Ss]+"\\)$"),_u=new RegExp("^hsla\\("+[Ro,Ss,Ss,Ro]+"\\)$"),Rs={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Za(){return this.rgb().formatHex()}function Js(){return this.rgb().formatRgb()}function Io(S){var V,Y;return S=(S+"").trim().toLowerCase(),(V=na.exec(S))?(Y=V[1].length,V=parseInt(V[1],16),6===Y?Ia(V):3===Y?new hs(V>>8&15|V>>4&240,V>>4&15|240&V,(15&V)<<4|15&V,1):8===Y?El(V>>24&255,V>>16&255,V>>8&255,(255&V)/255):4===Y?El(V>>12&15|V>>8&240,V>>8&15|V>>4&240,V>>4&15|240&V,((15&V)<<4|15&V)/255):null):(V=bl.exec(S))?new hs(V[1],V[2],V[3],1):(V=xl.exec(S))?new hs(255*V[1]/100,255*V[2]/100,255*V[3]/100,1):(V=$l.exec(S))?El(V[1],V[2],V[3],V[4]):(V=gc.exec(S))?El(255*V[1]/100,255*V[2]/100,255*V[3]/100,V[4]):(V=wl.exec(S))?ra(V[1],V[2]/100,V[3]/100,1):(V=_u.exec(S))?ra(V[1],V[2]/100,V[3]/100,V[4]):Rs.hasOwnProperty(S)?Ia(Rs[S]):"transparent"===S?new hs(NaN,NaN,NaN,0):null}function Ia(S){return new hs(S>>16&255,S>>8&255,255&S,1)}function El(S,V,Y,le){return le<=0&&(S=V=Y=NaN),new hs(S,V,Y,le)}function uo(S){return S instanceof Xa||(S=Io(S)),S?new hs((S=S.rgb()).r,S.g,S.b,S.opacity):new hs}function ba(S,V,Y,le){return 1===arguments.length?uo(S):new hs(S,V,Y,null==le?1:le)}function hs(S,V,Y,le){this.r=+S,this.g=+V,this.b=+Y,this.opacity=+le}function bo(){return"#"+yc(this.r)+yc(this.g)+yc(this.b)}function mc(){var S=this.opacity;return(1===(S=isNaN(S)?1:Math.max(0,Math.min(1,S)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===S?")":", "+S+")")}function yc(S){return((S=Math.max(0,Math.min(255,Math.round(S)||0)))<16?"0":"")+S.toString(16)}function ra(S,V,Y,le){return le<=0?S=V=Y=NaN:Y<=0||Y>=1?S=V=NaN:V<=0&&(S=NaN),new Is(S,V,Y,le)}function Qa(S){if(S instanceof Is)return new Is(S.h,S.s,S.l,S.opacity);if(S instanceof Xa||(S=Io(S)),!S)return new Is;if(S instanceof Is)return S;var V=(S=S.rgb()).r/255,Y=S.g/255,le=S.b/255,we=Math.min(V,Y,le),Re=Math.max(V,Y,le),Le=NaN,M=Re-we,b=(Re+we)/2;return M?(Le=V===Re?(Y-le)/M+6*(Y<le):Y===Re?(le-V)/M+2:(V-Y)/M+4,M/=b<.5?Re+we:2-Re-we,Le*=60):M=b>0&&b<1?0:Le,new Is(Le,M,b,S.opacity)}function Is(S,V,Y,le){this.h=+S,this.s=+V,this.l=+Y,this.opacity=+le}function U(S,V,Y){return 255*(S<60?V+(Y-V)*S/60:S<180?Y:S<240?V+(Y-V)*(240-S)/60:V)}function Z(S,V,Y,le,we){var Re=S*S,Le=Re*S;return((1-3*S+3*Re-Le)*V+(4-6*Re+3*Le)*Y+(1+3*S+3*Re-3*Le)*le+Le*we)/6}jl(Xa,Io,{copy:function(S){return Object.assign(new this.constructor,this,S)},displayable:function(){return this.rgb().displayable()},hex:Za,formatHex:Za,formatHsl:function(){return Qa(this).formatHsl()},formatRgb:Js,toString:Js}),jl(hs,ba,Wl(Xa,{brighter:function(S){return S=null==S?Do:Math.pow(Do,S),new hs(this.r*S,this.g*S,this.b*S,this.opacity)},darker:function(S){return S=null==S?.7:Math.pow(.7,S),new hs(this.r*S,this.g*S,this.b*S,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:bo,formatHex:bo,formatRgb:mc,toString:mc})),jl(Is,function(S,V,Y,le){return 1===arguments.length?Qa(S):new Is(S,V,Y,null==le?1:le)},Wl(Xa,{brighter:function(S){return S=null==S?Do:Math.pow(Do,S),new Is(this.h,this.s,this.l*S,this.opacity)},darker:function(S){return S=null==S?.7:Math.pow(.7,S),new Is(this.h,this.s,this.l*S,this.opacity)},rgb:function(){var S=this.h%360+360*(this.h<0),V=isNaN(S)||isNaN(this.s)?0:this.s,Y=this.l,le=Y+(Y<.5?Y:1-Y)*V,we=2*Y-le;return new hs(U(S>=240?S-240:S+120,we,le),U(S,we,le),U(S<120?S+240:S-120,we,le),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var S=this.opacity;return(1===(S=isNaN(S)?1:Math.max(0,Math.min(1,S)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===S?")":", "+S+")")}}));const Ne=S=>()=>S;function Li(S,V){var Y=V-S;return Y?function(S,V){return function(Y){return S+Y*V}}(S,Y):Ne(isNaN(S)?V:S)}const Jr=function S(V){var Y=function(S){return 1==(S=+S)?Li:function(V,Y){return Y-V?function(S,V,Y){return S=Math.pow(S,Y),V=Math.pow(V,Y)-S,Y=1/Y,function(le){return Math.pow(S+le*V,Y)}}(V,Y,S):Ne(isNaN(V)?Y:V)}}(V);function le(we,Re){var Le=Y((we=ba(we)).r,(Re=ba(Re)).r),M=Y(we.g,Re.g),b=Y(we.b,Re.b),_=Li(we.opacity,Re.opacity);return function(R){return we.r=Le(R),we.g=M(R),we.b=b(R),we.opacity=_(R),we+""}}return le.gamma=S,le}(1);function Ar(S){return function(V){var Le,M,Y=V.length,le=new Array(Y),we=new Array(Y),Re=new Array(Y);for(Le=0;Le<Y;++Le)M=ba(V[Le]),le[Le]=M.r||0,we[Le]=M.g||0,Re[Le]=M.b||0;return le=S(le),we=S(we),Re=S(Re),M.opacity=1,function(b){return M.r=le(b),M.g=we(b),M.b=Re(b),M+""}}}var Sr=Ar(function(S){var V=S.length-1;return function(Y){var le=Y<=0?Y=0:Y>=1?(Y=1,V-1):Math.floor(Y*V),we=S[le],Re=S[le+1];return Z((Y-le/V)*V,le>0?S[le-1]:2*we-Re,we,Re,le<V-1?S[le+2]:2*Re-we)}}),os=(Ar(function(S){var V=S.length;return function(Y){var le=Math.floor(((Y%=1)<0?++Y:Y)*V);return Z((Y-le/V)*V,S[(le+V-1)%V],S[le%V],S[(le+1)%V],S[(le+2)%V])}}),/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g),Ps=new RegExp(os.source,"g");function ia(S,V){var le,we,Re,Y=os.lastIndex=Ps.lastIndex=0,Le=-1,M=[],b=[];for(S+="",V+="";(le=os.exec(S))&&(we=Ps.exec(V));)(Re=we.index)>Y&&(Re=V.slice(Y,Re),M[Le]?M[Le]+=Re:M[++Le]=Re),(le=le[0])===(we=we[0])?M[Le]?M[Le]+=we:M[++Le]=we:(M[++Le]=null,b.push({i:Le,x:Qs(le,we)})),Y=Ps.lastIndex;return Y<V.length&&(Re=V.slice(Y),M[Le]?M[Le]+=Re:M[++Le]=Re),M.length<2?b[0]?function(S){return function(V){return S(V)+""}}(b[0].x):function(S){return function(){return S}}(V):(V=b.length,function(_){for(var F,R=0;R<V;++R)M[(F=b[R]).i]=F.x(_);return M.join("")})}function Qn(S,V){var Y;return("number"==typeof V?Qs:V instanceof Io?Jr:(Y=Io(V))?(V=Y,Jr):ia)(S,V)}function Cs(S){return function(){this.removeAttribute(S)}}function Pa(S){return function(){this.removeAttributeNS(S.space,S.local)}}function qi(S,V,Y){var le,Re,we=Y+"";return function(){var Le=this.getAttribute(S);return Le===we?null:Le===le?Re:Re=V(le=Le,Y)}}function Ki(S,V,Y){var le,Re,we=Y+"";return function(){var Le=this.getAttributeNS(S.space,S.local);return Le===we?null:Le===le?Re:Re=V(le=Le,Y)}}function xo(S,V,Y){var le,we,Re;return function(){var Le,b,M=Y(this);return null==M?void this.removeAttribute(S):(Le=this.getAttribute(S))===(b=M+"")?null:Le===le&&b===we?Re:(we=b,Re=V(le=Le,M))}}function Po(S,V,Y){var le,we,Re;return function(){var Le,b,M=Y(this);return null==M?void this.removeAttributeNS(S.space,S.local):(Le=this.getAttributeNS(S.space,S.local))===(b=M+"")?null:Le===le&&b===we?Re:(we=b,Re=V(le=Le,M))}}function jn(S,V){return function(Y){this.setAttribute(S,V.call(this,Y))}}function Ts(S,V){return function(Y){this.setAttributeNS(S.space,S.local,V.call(this,Y))}}function ql(S,V){var Y,le;function we(){var Re=V.apply(this,arguments);return Re!==le&&(Y=(le=Re)&&Ts(S,Re)),Y}return we._value=V,we}function Vc(S,V){var Y,le;function we(){var Re=V.apply(this,arguments);return Re!==le&&(Y=(le=Re)&&jn(S,Re)),Y}return we._value=V,we}function Ja(S,V){return function(){lo(this,S).delay=+V.apply(this,arguments)}}function zc(S,V){return V=+V,function(){lo(this,S).delay=V}}function Ot(S,V){return function(){fs(this,S).duration=+V.apply(this,arguments)}}function Hr(S,V){return V=+V,function(){fs(this,S).duration=V}}function ps(S,V){if("function"!=typeof V)throw new Error;return function(){fs(this,S).ease=V}}function Gc(S,V,Y){var le,we,Re=function(S){return(S+"").trim().split(/^|\s+/).every(function(V){var Y=V.indexOf(".");return Y>=0&&(V=V.slice(0,Y)),!V||"start"===V})}(V)?lo:fs;return function(){var Le=Re(this,S),M=Le.on;M!==le&&(we=(le=M).copy()).on(V,Y),Le.on=we}}var zs=Xr.prototype.constructor;function xa(S){return function(){this.style.removeProperty(S)}}function as(S,V,Y){return function(le){this.style.setProperty(S,V.call(this,le),Y)}}function he(S,V,Y){var le,we;function Re(){var Le=V.apply(this,arguments);return Le!==we&&(le=(we=Le)&&as(S,Le,Y)),le}return Re._value=V,Re}function Dl(S){return function(V){this.textContent=S.call(this,V)}}function bc(S){var V,Y;function le(){var we=S.apply(this,arguments);return we!==Y&&(V=(Y=we)&&Dl(we)),V}return le._value=S,le}var Ea=0;function pi(S,V,Y,le){this._groups=S,this._parents=V,this._name=Y,this._id=le}function gi(){return++Ea}var fo=Xr.prototype;pi.prototype=function(S){return Xr().transition(S)}.prototype={constructor:pi,select:function(S){var V=this._name,Y=this._id;"function"!=typeof S&&(S=$(S));for(var le=this._groups,we=le.length,Re=new Array(we),Le=0;Le<we;++Le)for(var R,F,M=le[Le],b=M.length,_=Re[Le]=new Array(b),j=0;j<b;++j)(R=M[j])&&(F=S.call(R,R.__data__,j,M))&&("__data__"in R&&(F.__data__=R.__data__),_[j]=F,ss(_[j],V,Y,j,_,Ei(R,Y)));return new pi(Re,this._parents,V,Y)},selectAll:function(S){var V=this._name,Y=this._id;"function"!=typeof S&&(S=Me(S));for(var le=this._groups,we=le.length,Re=[],Le=[],M=0;M<we;++M)for(var R,b=le[M],_=b.length,F=0;F<_;++F)if(R=b[F]){for(var oe,j=S.call(R,R.__data__,F,b),ye=Ei(R,Y),lt=0,Ke=j.length;lt<Ke;++lt)(oe=j[lt])&&ss(oe,V,Y,lt,j,ye);Re.push(j),Le.push(R)}return new pi(Re,Le,V,Y)},selectChild:fo.selectChild,selectChildren:fo.selectChildren,filter:function(S){"function"!=typeof S&&(S=Be(S));for(var V=this._groups,Y=V.length,le=new Array(Y),we=0;we<Y;++we)for(var b,Re=V[we],Le=Re.length,M=le[we]=[],_=0;_<Le;++_)(b=Re[_])&&S.call(b,b.__data__,_,Re)&&M.push(b);return new pi(le,this._parents,this._name,this._id)},merge:function(S){if(S._id!==this._id)throw new Error;for(var V=this._groups,Y=S._groups,le=V.length,Re=Math.min(le,Y.length),Le=new Array(le),M=0;M<Re;++M)for(var j,b=V[M],_=Y[M],R=b.length,F=Le[M]=new Array(R),oe=0;oe<R;++oe)(j=b[oe]||_[oe])&&(F[oe]=j);for(;M<le;++M)Le[M]=V[M];return new pi(Le,this._parents,this._name,this._id)},selection:function(){return new zs(this._groups,this._parents)},transition:function(){for(var S=this._name,V=this._id,Y=gi(),le=this._groups,we=le.length,Re=0;Re<we;++Re)for(var b,Le=le[Re],M=Le.length,_=0;_<M;++_)if(b=Le[_]){var R=Ei(b,V);ss(b,S,Y,_,Le,{time:R.time+R.delay+R.duration,delay:0,duration:R.duration,ease:R.ease})}return new pi(le,this._parents,S,Y)},call:fo.call,nodes:fo.nodes,node:fo.node,size:fo.size,empty:fo.empty,each:fo.each,on:function(S,V){var Y=this._id;return arguments.length<2?Ei(this.node(),Y).on.on(S):this.each(Gc(Y,S,V))},attr:function(S,V){var Y=Lt(S),le="transform"===Y?_l:Qn;return this.attrTween(S,"function"==typeof V?(Y.local?Po:xo)(Y,le,_a(this,"attr."+S,V)):null==V?(Y.local?Pa:Cs)(Y):(Y.local?Ki:qi)(Y,le,V))},attrTween:function(S,V){var Y="attr."+S;if(arguments.length<2)return(Y=this.tween(Y))&&Y._value;if(null==V)return this.tween(Y,null);if("function"!=typeof V)throw new Error;var le=Lt(S);return this.tween(Y,(le.local?ql:Vc)(le,V))},style:function(S,V,Y){var le="transform"==(S+="")?Ks:Qn;return null==V?this.styleTween(S,function(S,V){var Y,le,we;return function(){var Re=pr(this,S),Le=(this.style.removeProperty(S),pr(this,S));return Re===Le?null:Re===Y&&Le===le?we:we=V(Y=Re,le=Le)}}(S,le)).on("end.style."+S,xa(S)):"function"==typeof V?this.styleTween(S,function(S,V,Y){var le,we,Re;return function(){var Le=pr(this,S),M=Y(this),b=M+"";return null==M&&(this.style.removeProperty(S),b=M=pr(this,S)),Le===b?null:Le===le&&b===we?Re:(we=b,Re=V(le=Le,M))}}(S,le,_a(this,"style."+S,V))).each(function(S,V){var Y,le,we,M,Re="style."+V,Le="end."+Re;return function(){var b=fs(this,S),_=b.on,R=null==b.value[Re]?M||(M=xa(V)):void 0;(_!==Y||we!==R)&&(le=(Y=_).copy()).on(Le,we=R),b.on=le}}(this._id,S)):this.styleTween(S,function(S,V,Y){var le,Re,we=Y+"";return function(){var Le=pr(this,S);return Le===we?null:Le===le?Re:Re=V(le=Le,Y)}}(S,le,V),Y).on("end.style."+S,null)},styleTween:function(S,V,Y){var le="style."+(S+="");if(arguments.length<2)return(le=this.tween(le))&&le._value;if(null==V)return this.tween(le,null);if("function"!=typeof V)throw new Error;return this.tween(le,he(S,V,null==Y?"":Y))},text:function(S){return this.tween("text","function"==typeof S?function(S){return function(){var V=S(this);this.textContent=null==V?"":V}}(_a(this,"text",S)):function(S){return function(){this.textContent=S}}(null==S?"":S+""))},textTween:function(S){var V="text";if(arguments.length<1)return(V=this.tween(V))&&V._value;if(null==S)return this.tween(V,null);if("function"!=typeof S)throw new Error;return this.tween(V,bc(S))},remove:function(){return this.on("end.remove",(S=this._id,function(){var V=this.parentNode;for(var Y in this.__transition)if(+Y!==S)return;V&&V.removeChild(this)}));var S},tween:function(S,V){var Y=this._id;if(S+="",arguments.length<2){for(var Le,le=Ei(this.node(),Y).tween,we=0,Re=le.length;we<Re;++we)if((Le=le[we]).name===S)return Le.value;return null}return this.each((null==V?ya:va)(Y,S,V))},delay:function(S){var V=this._id;return arguments.length?this.each(("function"==typeof S?Ja:zc)(V,S)):Ei(this.node(),V).delay},duration:function(S){var V=this._id;return arguments.length?this.each(("function"==typeof S?Ot:Hr)(V,S)):Ei(this.node(),V).duration},ease:function(S){var V=this._id;return arguments.length?this.each(ps(V,S)):Ei(this.node(),V).ease},easeVarying:function(S){if("function"!=typeof S)throw new Error;return this.each(function(S,V){return function(){var Y=V.apply(this,arguments);if("function"!=typeof Y)throw new Error;fs(this,S).ease=Y}}(this._id,S))},end:function(){var S,V,Y=this,le=Y._id,we=Y.size();return new Promise(function(Re,Le){var M={value:Le},b={value:function(){0==--we&&Re()}};Y.each(function(){var _=fs(this,le),R=_.on;R!==S&&((V=(S=R).copy())._.cancel.push(M),V._.interrupt.push(M),V._.end.push(b)),_.on=V}),0===we&&Re()})},[Symbol.iterator]:fo[Symbol.iterator]};var Ku={time:null,delay:0,duration:250,ease:function(S){return((S*=2)<=1?S*S*S:(S-=2)*S*S+2)/2}};function $c(S,V){for(var Y;!(Y=S.__transition)||!(Y=Y[V]);)if(!(S=S.parentNode))throw new Error(`transition ${V} not found`);return Y}Xr.prototype.interrupt=function(S){return this.each(function(){!function(S,V){var le,we,Le,Y=S.__transition,Re=!0;if(Y){for(Le in V=null==V?null:V+"",Y)(le=Y[Le]).name===V?(we=le.state>2&&le.state<5,le.state=6,le.timer.stop(),le.on.call(we?"interrupt":"cancel",S,S.__data__,le.index,le.group),delete Y[Le]):Re=!1;Re&&delete S.__transition}}(this,S)})},Xr.prototype.transition=function(S){var V,Y;S instanceof pi?(V=S._id,S=S._name):(V=gi(),(Y=Ku).time=(0,ke.zO)(),S=null==S?null:S+"");for(var le=this._groups,we=le.length,Re=0;Re<we;++Re)for(var b,Le=le[Re],M=Le.length,_=0;_<M;++_)(b=Le[_])&&ss(b,S,V,_,Le,Y||$c(b,V));return new pi(le,this._parents,S,V)};Math;function ji(S){return{type:S}}["w","e"].map(ji),["n","s"].map(ji),["n","w","e","s","nw","ne","sw","se"].map(ji);var S,Eu=se(1753),qc=se(2357),eo=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(qc.Z);function sl(S,V,Y){this.k=S,this.x=V,this.y=Y}Sr((S=eo)[S.length-1]),sl.prototype={constructor:sl,scale:function(S){return 1===S?this:new sl(this.k*S,this.x,this.y)},translate:function(S,V){return 0===S&0===V?this:new sl(this.k,this.x+this.k*S,this.y+this.k*V)},apply:function(S){return[S[0]*this.k+this.x,S[1]*this.k+this.y]},applyX:function(S){return S*this.k+this.x},applyY:function(S){return S*this.k+this.y},invert:function(S){return[(S[0]-this.x)/this.k,(S[1]-this.y)/this.k]},invertX:function(S){return(S-this.x)/this.k},invertY:function(S){return(S-this.y)/this.k},rescaleX:function(S){return S.copy().domain(S.range().map(this.invertX,this).map(S.invert,S))},rescaleY:function(S){return S.copy().domain(S.range().map(this.invertY,this).map(S.invert,S))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new sl(1,0,0)},2004:(Nt,ut,se)=>{"use strict";se.d(ut,{j:()=>$,M:()=>Fe});var G=se(7758);class $ extends G.Tme{constructor(J){super(),this.element=J||document.createElement("div"),this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(K){K.element instanceof Element&&null!==K.element.parentNode&&K.element.parentNode.removeChild(K.element)})})}copy(J,K){return super.copy(J,K),this.element=J.element.cloneNode(!0),this}}$.prototype.isCSS2DObject=!0;const We=new G.Pa4,Ze=new G.yGw,Ae=new G.yGw,Me=new G.Pa4,Te=new G.Pa4;class Fe{constructor(){const J=this;let K,_e,Ue,Ve;const at={objects:new WeakMap},Xe=document.createElement("div");function kt(hn,an,er){if(hn.isCSS2DObject){hn.onBeforeRender(J,an,er),We.setFromMatrixPosition(hn.matrixWorld),We.applyMatrix4(Ae);const Dn=hn.element;Dn.style.transform=/apple/i.test(navigator.vendor)?"translate(-50%,-50%) translate("+Math.round(We.x*Ue+Ue)+"px,"+Math.round(-We.y*Ve+Ve)+"px)":"translate(-50%,-50%) translate("+(We.x*Ue+Ue)+"px,"+(-We.y*Ve+Ve)+"px)",Dn.style.display=hn.visible&&We.z>=-1&&We.z<=1?"":"none";const Cn={distanceToCameraSquared:St(er,hn)};at.objects.set(hn,Cn),Dn.parentNode!==Xe&&Xe.appendChild(Dn),hn.onAfterRender(J,an,er)}for(let Dn=0,Cn=hn.children.length;Dn<Cn;Dn++)kt(hn.children[Dn],an,er)}function St(hn,an){return Me.setFromMatrixPosition(hn.matrixWorld),Te.setFromMatrixPosition(an.matrixWorld),Me.distanceToSquared(Te)}Xe.style.overflow="hidden",this.domElement=Xe,this.getSize=function(){return{width:K,height:_e}},this.render=function(hn,an){!0===hn.autoUpdate&&hn.updateMatrixWorld(),null===an.parent&&an.updateMatrixWorld(),Ze.copy(an.matrixWorldInverse),Ae.multiplyMatrices(an.projectionMatrix,Ze),kt(hn,hn,an),function(hn){const an=function(hn){const an=[];return hn.traverse(function(er){er.isCSS2DObject&&an.push(er)}),an}(hn).sort(function(Dn,Cn){return at.objects.get(Dn).distanceToCameraSquared-at.objects.get(Cn).distanceToCameraSquared}),er=an.length;for(let Dn=0,Cn=an.length;Dn<Cn;Dn++)an[Dn].element.style.zIndex=er-Dn}(hn)},this.setSize=function(hn,an){K=hn,_e=an,Ue=K/2,Ve=_e/2,Xe.style.width=hn+"px",Xe.style.height=an+"px"}}}},8239:(Nt,ut,se)=>{"use strict";function G(We,Ze,Ae,Me,Te,Fe,Be){try{var J=We[Fe](Be),K=J.value}catch(_e){return void Ae(_e)}J.done?Ze(K):Promise.resolve(K).then(Me,Te)}function $(We){return function(){var Ze=this,Ae=arguments;return new Promise(function(Me,Te){var Fe=We.apply(Ze,Ae);function Be(K){G(Fe,Me,Te,Be,J,"next",K)}function J(K){G(Fe,Me,Te,Be,J,"throw",K)}Be(void 0)})}}se.d(ut,{Z:()=>$})}}]);